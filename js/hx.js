LazyLoad=function(e){function t(t,n){var r=e.createElement(t),i;for(i in n)n.hasOwnProperty(i)&&r.setAttribute(i,n[i]);return r}function n(e){var t=f[e],n,r;t&&(n=t.callback,r=t.urls,r.shift(),l=0,r.length||(n&&n.call(t.context,t.obj),f[e]=null,c[e].length&&i(e)))}function r(){var t=navigator.userAgent;u={async:e.createElement("script").async===!0},(u.webkit=/AppleWebKit\//.test(t))||(u.ie=/MSIE/.test(t))||(u.opera=/Opera/.test(t))||(u.gecko=/Gecko\//.test(t))||(u.unknown=!0)}function i(i,l,h,d,v){var g=function(){n(i)},y=i==="css",b=[],E,S,x,T;u||r();if(l)if(l=typeof l=="string"?[l]:l.concat(),y||u.async||u.gecko||u.opera)c[i].push({urls:l,callback:h,obj:d,context:v});else{E=0;for(S=l.length;E<S;++E)c[i].push({urls:[l[E]],callback:E===S-1?h:null,obj:d,context:v})}if(!f[i]&&(T=f[i]=c[i].shift())){a||(a=e.head||e.getElementsByTagName("head")[0]),l=T.urls,E=0;for(S=l.length;E<S;++E)h=l[E],y?x=u.gecko?t("style"):t("link",{href:h,rel:"stylesheet"}):(x=t("script",{src:h}),x.async=!1),x.className="lazyload",x.setAttribute("charset","utf-8"),u.ie&&!y?x.onreadystatechange=function(){/loaded|complete/.test(x.readyState)&&(x.onreadystatechange=null,g())}:y&&(u.gecko||u.webkit)?u.webkit?(T.urls[E]=x.href,o()):(x.innerHTML='@import "'+h+'";',s(x)):x.onload=x.onerror=g,b.push(x);E=0;for(S=b.length;E<S;++E)a.appendChild(b[E])}}function s(e){var t;try{t=!!e.sheet.cssRules}catch(r){l+=1,l<200?setTimeout(function(){s(e)},50):t&&n("css");return}n("css")}function o(){var e=f.css,t;if(e){for(t=h.length;--t>=0;)if(h[t].href===e.urls[0]){n("css");break}l+=1,e&&(l<200?setTimeout(o,50):n("css"))}}var u,a,f={},l=0,c={css:[],js:[]},h=e.styleSheets;return{css:function(e,t,n,r){i("css",e,t,n,r)},js:function(e,t,n,r){i("js",e,t,n,r)}}}(this.document),define("lazyload",function(e){return function(){var t,n;return t||e.LazyLoad}}(this)),define("dominator/core/BuyCore/AbstractBuyCore",["require","exports"],function(e,t){"use strict";var n=function(){function e(){}return e.prototype.init=function(e,t){var n=this.initViewModel(e);return{viewModel:n,orderModel:{}}},e.prototype.run=function(){},e.prototype.initViewModel=function(e){throw new Error("you must implements initViewModel function ")},e}();t.AbstractBuyCore=n}),define("dominator/core/RegisterService/AbstractRegisterService",["require","exports"],function(e,t){"use strict";var n=function(){function e(){this._hashMap={}}return e.prototype.registerConfigParser=function(e){this._configParser=e},e.prototype.registerConstraintParser=function(e){this._constraintParser=e},e.prototype.registerViewModel=function(e){this._viewModel=e},e.prototype.registerCustomResource=function(e,t,n){this._hashMap[e]=t},e.prototype.getConfigParser=function(){return this._configParser},e.prototype.getConstraintParser=function(){return this._constraintParser},e.prototype.getViewModel=function(){return this._viewModel},e.prototype.getCustomResource=function(e){var t;if(this._hashMap[e])return this._hashMap[e];var n=new RegExp(e);for(var r in this._hashMap)n.exec(r)!=undefined&&(t||(t={}),t[r]=this._hashMap[r]);return t},e.prototype.removeCustomResource=function(e){var t;if(this._hashMap[e])delete this._hashMap[e];else{var n=new RegExp(e);for(var r in this._hashMap)n.exec(r)!=undefined&&delete this._hashMap[r]}},e}();t.AbstractRegisterService=n});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)};define("dominator/core/RegisterService/RegisterService",["require","exports","./AbstractRegisterService"],function(e,t,n){"use strict";function r(){return s||(s=new i),s}var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(n.AbstractRegisterService),s;t.getInstance=r});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)};define("dominator/core/BuyCore/BuyCore",["require","exports","./AbstractBuyCore","../RegisterService/RegisterService"],function(e,t,n,r){"use strict";var i=r.getInstance(),s=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.init=function(t,n){return i.registerCustomResource("viewModelSetting",t),i.registerCustomResource("frameworkSetting",n),e.prototype.init.call(this,t,n)},t.prototype.initViewModel=function(e){var t=i.getCustomResource("core.ViewModel");return new t(e)},t}(n.AbstractBuyCore);t.BuyCore=s}),define("dominator/core/Parser/AbstractParser",["require","exports"],function(e,t){"use strict";var n=function(){function e(){}return e.prototype.parse=function(e){throw new Error("you must implements parse function")},e}();t.AbstractParser=n});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)};define("dominator/core/Parser/FieldsParser",["require","exports","./AbstractParser","../RegisterService/RegisterService"],function(e,t,n,r){"use strict";var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.parse=function(e){var t=r.getInstance(),n=t.getCustomResource("core.Field"),i;try{i=new n(e)}catch(s){throw new Error("Failed to parse Field in FieldsParser"+s)}return i},t}(n.AbstractParser);t.FieldsParser=i});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)};define("dominator/core/Parser/ChildFieldParser",["require","exports","./FieldsParser"],function(e,t,n){"use strict";var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(n.FieldsParser);t.ChildFieldParser=r}),define("dominator/core/ViewModel/Field/AbstractField",["require","exports"],function(e,t){"use strict";var n=function(){function e(e){}return e}();t.AbstractField=n});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)};define("dominator/core/ViewModel/Field/Field",["require","exports","./AbstractField"],function(e,t,n){"use strict";var r=function(e){function t(t){e.call(this,t),this.injectResource(t)}return __extends(t,e),t.prototype.injectResource=function(e){throw new Error("you must implements injectResouce function")},t}(n.AbstractField);t.Field=r}),define("dominator/core/Util/injectResource",["require","exports","../RegisterService/RegisterService"],function(e,t,n){"use strict";function r(e){return Object.prototype.toString.call(e)==="[object Object]"}var i=n.getInstance(),s;(function(e){function t(e,n,s){var o,u;for(var a in n){o=n[a];if(typeof o=="undefined")continue;u=e[a];if(!r(o)){if(s==undefined){var f=i.getCustomResource("resource.parser.*")||{},l=[];if(f["resource.parser."+a]!=undefined){var c=f["resource.parser."+a],h=n[a];for(var p=0;p<h.length;p++){var d=c.parse(h[p]);d?l.push(d):l.push(h[p])}e[a]=l}else e[a]=n[a]}else s(e,n,a);continue}r(u)||(e[a]={}),t(e[a],o,s)}return e}e.injectResource=t})(s=t.Util||(t.Util={}))});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)};define("dominator/core/ViewModel/Field/CommonField",["require","exports","./Field","../../Util/injectResource"],function(e,t,n,r){"use strict";var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.injectResource=function(e){var t=this;r.Util.injectResource(t,e)},t}(n.Field);t.CommonField=i}),define("dominator/core/Util/Util",["require","exports"],function(e,t){"use strict";function n(e){return typeof e=="function"}function r(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function i(e){return typeof e=="string"}function s(e){return typeof e=="number"}function o(e){return Object.prototype.toString.apply(e)=="[object Array]"}function u(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function a(e){return typeof e=="undefined"?undefined:JSON.stringify(e)}function f(e){return i(e)?JSON.parse(e):e}function l(e){if(e==null||r(e))return!1;var t=e.length;return e.nodeType===1&&t?!0:i(e)||o(e)||t===0||typeof t=="number"&&t>0&&t-1 in e}function c(e){return Object.prototype.toString.apply(e)=="[object Date]"}function h(e){return Object.prototype.toString.call(e)==="[object Object]"}function p(e){if(!e)return e;var t;try{t=JSON.parse(JSON.stringify(e))}catch(n){console.log(e),console.error(n)}return t}function d(e,t,r){r===void 0&&(r=null);var i;if(e)if(n(e))for(i in e)i!="prototype"&&i!="length"&&i!="name"&&e.hasOwnProperty(i)&&t.call(r,e[i],i);else if(e.forEach&&e.forEach!==d)e.forEach(t,r);else if(l(e))for(i=0;i<e.length;i++)t.call(r,e[i],i);else for(i in e)e.hasOwnProperty(i)&&t.call(r,e[i],i);return e}function v(e,t){var n,r;for(var i in t){n=t[i];if(typeof n=="undefined")continue;r=e[i];if(!h(n)){e[i]=t[i];continue}h(r)||(e[i]={}),v(e[i],n)}return e}function m(e){if(!o(e))return e;var t={},n=[];for(var r=0;r<e.length;r++)t[e[r]]||(t[e[r]]=!0,n.push(e[r]));return n}t.Util={copy:p,forEach:d,merge:v,unique:m,isFunction:n,isString:i,isNumber:s,isArray:o,isObject:u,toJson:a,fromJson:f}});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)};define("dominator/core/ViewModel/Field/ConstraintField",["require","exports","./CommonField","../../Util/Util","../../RegisterService/RegisterService"],function(e,t,n,r,i){"use strict";var s=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.injectResource=function(t){var n=this,r=i.getInstance(),s=r.getCustomResource("core.Constraint"),o=r.getCustomResource("resource.constraint");n._constraint=s,e.prototype.injectResource.call(this,t),this.setField(o)},t.prototype.getId=function(){return this.id},t.prototype.getComponentCode=function(){return this.componentCode},t.prototype.getDepsFields=function(){return this._deps},t.prototype.getInitOptions=function(){return this._options},t.prototype.getFieldOptions=function(e,t){var n,i=[];r.Util.forEach(t,function(e,t){i.push({code:t,value:e})});try{n=this._constraint.getOptions(this.componentCode,e,i)}catch(s){throw new Error("Get Options failed : "+s)}return n},t.prototype.getFieldValue=function(){return this._value},t.prototype.setField=function(e){var t=e[this.componentCode];t!=undefined&&(this.setDepsFields(t.dependency),this.setOptions(t.options),this.setFieldValue(t.value))},t.prototype.setFieldValue=function(e){this._value=e},t.prototype.setOptions=function(e){this._options=e},t.prototype.setDepsFields=function(e){this._deps=e},t}(n.CommonField);t.ConstraintField=s}),define("dominator/core/ViewModel/AbstractViewModel",["require","exports"],function(e,t){"use strict";var n=function(){function e(e){}return e.prototype.getFields=function(){throw new Error("you must implements this getFields function")},e}();t.AbstractViewModel=n});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)};define("dominator/core/ViewModel/ViewModel",["require","exports","./AbstractViewModel","../Util/Util","../RegisterService/RegisterService"],function(e,t,n,r,i){"use strict";var s=function(e){function t(t){e.call(this,t),this.generateField(t)}return __extends(t,e),t.prototype.generateField=function(e){throw new Error("you must implements generateField function")},t.prototype.getFields=function(){return this.fields},t.prototype.getOptionsFromConstraints=function(e,t,n){var s=i.getInstance(),o=s.getCustomResource("core.Constraint"),u=[];return r.Util.forEach(n,function(e,t){u.push({code:t,value:e})}),o.getOptions(e,t,u)},t}(n.AbstractViewModel);t.ViewModel=s});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)};define("dominator/core/ViewModel/CommonViewModel",["require","exports","./ViewModel","../Util/injectResource"],function(e,t,n,r){"use strict";var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.generateField=function(e){var t=this;if(!t.validateViewModelSetting(e))throw new Error("viewModelSetting is invalid");r.Util.injectResource(t,e)},t.prototype.validateViewModelSetting=function(e){return!0},t}(n.ViewModel);t.CommonViewModel=i}),define("dominator/core/Util/ConstraintUtil",["require","exports","../Util/Util"],function(e,t,n){"use strict";t.ConstraintUtil={getCollectionProperty:function(e,t){var r=[];return n.Util.forEach(e,function(e){r.push(e[t])}),r},reverseMap:function(e){if(!e||typeof e!="object")return;var t={};for(var n in e)t[e[n]]=n;return t},mapping:function(e,t){if(!e)return;if(!t||typeof t!="object")return e;var r;return typeof e=="string"?t[e]||e:typeof e=="object"?(r={},n.Util.forEach(e,function(e,n){n=t[n]||n,r[n]=e}),r):e},filter:function(e,t,r){var i=[];return n.Util.forEach(e,function(e){var s=r?e[r]:e,o=!1;n.Util.forEach(t,function(e){if(s===e)return o=!0,!1}),o&&i.push(e)}),i},notFilter:function(e,t,r){var i=[];return n.Util.forEach(e,function(e){var s=r?e[r]:e,o=!1;n.Util.forEach(t,function(e){if(s===e)return o=!0,!1}),o||i.push(e)}),i},intersect:function(e,t,r){if(e instanceof Array){if(t instanceof Array){var i={},s=[];return n.Util.forEach(e,function(e,t){var s;r instanceof Array&&e&&typeof e=="object"?(n.Util.forEach(r,function(t,n){s||(s={}),s[t]=e[t]}),i[n.Util.toJson(s)]=!0):i[n.Util.toJson(e)]=!0}),n.Util.forEach(t,function(e,t){var o,u;r instanceof Array&&e&&typeof e=="object"?(n.Util.forEach(r,function(t,n){u||(u={}),u[t]=e[t]}),o=n.Util.toJson(u)):o=n.Util.toJson(e),i[o]&&s.push(e)}),s}throw new Error("a must be an Array")}throw new Error("a must be an Array")}}}),define("dominator/core/Commodity/Commodity",["require","exports","../Util/Util","../Util/ConstraintUtil"],function(e,t,n,r){"use strict";var i=function(){function e(e,t){this.constraint=undefined,this.config=undefined,this.components=undefined,this.componentProperties=undefined,this.valuesMap=undefined,this.styleMap=undefined,this.componentCodeList=undefined,this.constraint=e.constraints||e.constraint,this.config=e.config,this.components=e.components,this.componentProperties=this.getComponentProperties(),this.transformCommponentsValueList(t)}return e.prototype.getComponentProperties=function(){var e=this.components,t={};for(var r in e)n.Util.merge(t,e[r]);return t},e.prototype.transformCommponentsValueList=function(e){if(!e)throw new Error("'commponentsValueList' is required.");if(!n.Util.isArray(e))throw new Error("'commponentsValueList' must be an array.");var t=this.valuesMap?this.valuesMap:{},r={},i=[];n.Util.forEach(e,function(e){if(!n.Util.isObject(e))throw new Error("commponentsValueList's item must be an object");if(!e.code)throw new Error("commponentsValueList's item must have the key which is 'code'");t[e.code]=e.value,r[e.code]=e.style,i.push(e.code)}),this.valuesMap=t,this.styleMap=r,this.componentCodeList=i},e.prototype.getCollectionFromConstraint=function(e){var t=this.valuesMap;if(!t)return[];var r=[],i=this.constraint[e];return n.Util.forEach(i,function(e,i){i=i.split("|");var s=function(){var e=[];return n.Util.forEach(i,function(n){e.push(t[n])}),e.join("|")}(),o=e[s];o&&r.push(o)}),r},e.prototype.getAllComponentsOptions=function(){var e=this.componentCodeList;if(!e)throw new Error("'componentCodeList' is required. Check if there is no initialization");if(!n.Util.isArray(e))throw new Error("'componentCodeList' must be an array.");var t={},r=this;return n.Util.forEach(e,function(e,i){if(r.styleMap[e]&&r.styleMap[e]=="range"){var s=t[e]=r.getConfig(e);if(!n.Util.isObject(s))return;r.valuesMap[e]=s.min;return}t[e]=r.getOptions(e);var o=t[e],u=o&&o[0]&&o[0].value;r.valuesMap[e]=r.valuesMap[e]?r.valuesMap[e]:u}),t},e.prototype.getDependencyMap=function(){var e={},t=this.constraint,r=this.componentCodeList;if(!t)throw new Error("'constraint' is required. Check if there is no initialization");return n.Util.forEach(r,function(r){var i=t[r];e[r]=[],n.Util.forEach(i,function(t,n){if(!n)return;var i=n.split("|");e[r]=e[r].concat(i)}),e[r]=n.Util.unique(e[r])}),e},e.prototype.addExtraKeyForMap=function(e,t){var n={};for(var r in e)n[r]={},n[r][t]=e[r];return n},e.prototype.getOptions=function(e,t){t===void 0&&(t=null),t&&this.transformCommponentsValueList(t);var i=this.valuesMap,s=this.getCollectionFromConstraint(e),o=n.Util.copy(this.componentProperties[e]);return s&&s.length>0&&n.Util.forEach(s,function(e){e instanceof Array==0&&e instanceof Object==1?e.semantics=="NOT"?o=r.ConstraintUtil.notFilter(o,e.values,"value"):o=r.ConstraintUtil.filter(o,e.values,"value"):o=r.ConstraintUtil.filter(o,e,"value")}),o},e.prototype.getConfig=function(e,t){return t===void 0&&(t=null),this.getRangeConfig(e,t,!1)},e.prototype.getIntersectionConfig=function(e,t){return t===void 0&&(t=null),this.getRangeConfig(e,t,!0)},e.prototype.getRangeConfig=function(e,t,r){t&&this.transformCommponentsValueList(t);var i=this.getCollectionFromConstraint(e),s=n.Util.copy(this.componentProperties[e]);s==undefined&&(s={}),s instanceof Array&&(s=s[0]);if(i&&i.length>0){var o,u;n.Util.forEach(i,function(e){e&&e.values&&e.values[0]?n.Util.merge(s,e.values[0]):n.Util.isArray(e)?n.Util.merge(s,e[0]):n.Util.merge(s,e),s.max!=undefined&&r&&(o==undefined&&(o=s.max),o=Math.min(s.max,o),s.max=o),s.min!=undefined&&r&&(u==undefined&&(u=s.min),u=Math.max(s.min,u),s.min=u)})}return s},e.prototype.getCommponentsRunningInfo=function(e){this.transformCommponentsValueList(e);var t=this.addExtraKeyForMap(this.getDependencyMap(),"dependency"),r=this.addExtraKeyForMap(this.getAllComponentsOptions(),"options"),i=this.addExtraKeyForMap(this.valuesMap,"value");return n.Util.merge(n.Util.merge(r,t),i)},e}();t.Commodity=i}),define("dominator/core/Commodity/CommodityService",["require","exports","./Commodity"],function(e,t,n){"use strict";var r=function(){function e(){}return e.parse=function(e,t,r){r===void 0&&(r=!1);if(!this.commodity||r)this.commodity=new n.Commodity(e,t);return this.commodity.getCommponentsRunningInfo(t)},e.getOptions=function(e,t,n){return t=="range"?this.commodity.getConfig(e,n):t=="intersectionRange"?this.commodity.getIntersectionConfig(e,n):this.commodity.getOptions(e,n)},e}();t.CommodityService=r});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)};define("dominator/core/BuyCore/CommonBuyCore",["require","exports","./BuyCore","../RegisterService/RegisterService","../Parser/ChildFieldParser","../Parser/FieldsParser","../ViewModel/Field/ConstraintField","../ViewModel/CommonViewModel","../Commodity/CommodityService"],function(e,t,n,r,i,s,o,u,a){"use strict";var f=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.init=function(t,n){var f=r.getInstance();f.registerCustomResource("resource.parser.children",i.ChildFieldParser),f.registerCustomResource("resource.parser.fields",s.FieldsParser),f.registerCustomResource("core.ViewModel",u.CommonViewModel),f.registerCustomResource("core.Field",o.ConstraintField),f.registerCustomResource("core.Constraint",a.CommodityService);var l=f.getCustomResource("resource.rawData"),c=!0,h=a.CommodityService.parse(l,n.components,c);return f.registerCustomResource("resource.constraint",h),e.prototype.init.call(this,t,n)},t}(n.BuyCore);t.CommonBuyCore=f});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)};define("dominator/core/BuyCore/BuyCoreWithService",["require","exports","./CommonBuyCore","../RegisterService/RegisterService"],function(e,t,n,r){"use strict";var i=r.getInstance(),s=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.init=function(t,n){var r=e.prototype.init,s=this,o,u,a;try{o=n.constraintService,u=n.constraintService.onBeforeConstraintHandled,a=n.constraintService.getConstraints}catch(f){throw new Error("invalid frameworkSetting")}a!=undefined&&i.registerCustomResource("core.rawDataService",a);var l=i.getCustomResource("core.rawDataService");return l().then(function(e){return u!=undefined&&(e=u(e)),i.registerCustomResource("resource.rawData",e),r.call(s,t,n)})},t}(n.CommonBuyCore);t.BuyCoreWithService=s}),define("dominator/core/core",["require","exports","./BuyCore/BuyCoreWithService","./RegisterService/RegisterService"],function(e,t,n,r){"use strict";var i;(function(e){function t(){s=undefined;var e=new n.BuyCoreWithService;return e}function i(){return r.getInstance()}var s=r.getInstance();e.getBuyCore=t,e.getRegisterService=i})(i=t.core||(t.core={}))}),define("dominator/core/Util/mapBatchProcessing",["require","exports"],function(e,t){"use strict";var n;(function(e){function t(e,t){for(var n in e)try{t.call(this,n,e[n])}catch(r){throw new Error("Batch processing error: "+r)}}e.mapBatchProcessing=t})(n=t.Util||(t.Util={}))}),define("dominator/base/validators/_base",[],function(){}),define("dominator/core/index",["angular","./core","dominator/core/Util/mapBatchProcessing","dominator/base/validators/_base"],function(e,t,n,r){var i=e.module("aliyun.buy.dominator.core",[]),s=t.core,n=n.Util;return i.factory("aliyun.buy.dominator.core.BuyCore",function(){return s.getBuyCore()}),i.factory("aliyun.buy.dominator.core.RegisterService",function(){var e=s.getRegisterService();return n.mapBatchProcessing.call(e,r,e.registerCustomResource),e}),i}),define("dominator/base/helpers/moduleHelper",["angular","jQuery"],function(e,t){"use strict";function n(){var e=parseInt(Math.random()*1e7);return e="auto"+e.toString()+(new Date).getTime().toString(),e}var r={createModel:function(){var e={};for(var t=0,n=arguments.length;t<n;t++)e[arguments[t]]={};return e},parseJsonSafe:function(t){var n;if(t)try{n=e.fromJson(t)}catch(r){}return n},parseQueryString:function(t){if(!t)return null;t=t.replace(/^\?/,"");if(!t)return null;var n={},r=t.split("&");return e.forEach(r,function(e){e=e.split("="),n[e[0]]=e.slice(1,e.length).join("=")}),n},toQueryString:function(t){if(!t||typeof t!="object")return"";var n=[];return e.forEach(t,function(e,t){n.push(t+"="+encodeURIComponent(e))}),n.join("&")},safeParse:function(e,t,n){if(e instanceof Function){if(!t)return;if(n instanceof Array){var r;try{r=e.apply(t,n)}catch(i){}return r}return}return},setDefault:function(e,t){if(!e)return;if(!t)return;for(var n in t)typeof e[n]=="undefined"&&(e[n]=t[n])},require:function(t,r){e.forEach(t,function(e){typeof r[e]=="undefined"&&(r[e]=n())})},config:function(e,n){var i,s;for(var o in n){i=n[o];if(typeof i=="undefined")continue;s=e[o];if(!t.isPlainObject(i)){e[o]=n[o];continue}t.isPlainObject(s)||(e[o]={}),r.config(e[o],i)}return e},getModuleNames:function(t){var n=[];return e.forEach(t,function(e){r.isAngularModule(e)&&n.push(e.name)}),n},isAngularModule:function(e){return e?e._invokeQueue instanceof Array&&e._runBlocks instanceof Array&&typeof e.name=="string"&&e.provider instanceof Function&&e.service instanceof Function&&e.factory instanceof Function&&e.directive instanceof Function&&e.filter instanceof Function?!0:!1:!1},formatPriceRules:function(t){var n=t.order||t.Order,i=t.rules||t.Rules,s=t.priceList||t.PriceList,o=t.flowPrice||t.FlowPrice,u=t.priceUnit||t.PriceUnit,a=t.moneyClass||t.MoneyClass,f=t.name||t.Name,l=t.askTip||t.AskTip,c=t.flowPriceUnit||t.FlowPriceUnit,h=t.basePriceUnit||t.BasePriceUnit,p=e.isUndefined(t.purchaseAvailable)?t.PurchaseAvailable:t.purchaseAvailable,d=e.isUndefined(t.addCartAvailable)?t.AddCartAvailable:t.addCartAvailable,v=t.state||t.State,m;if(s)for(var g in s)m=s[g],s[g]=r.formatPriceRules(m);if(!n)return t;var y={success:!0,origin:e.isUndefined(n.originalAmount)?n.OriginalAmount:n.originalAmount,trade:e.isUndefined(n.tradeAmount)?n.TradeAmount:n.tradeAmount,discount:e.isUndefined(n.discountAmount)?n.DiscountAmount:n.discountAmount,orderLines:n.orderLines||n.OrderLines?n.orderLines||n.OrderLines:{},strategies:this.formatStrategies(n.ruleIds||n.RuleIds,i),resourceId:n.resourceId,spotPrice:n.spotPrice,spotOriginalPrice:n.spotOriginalPrice,priceList:s,flowPrice:o,flowPriceUnit:c,basePriceUnit:h,priceUnit:u,name:f,currency:n.currency,moneyClass:a,askTip:l,addCartAvailable:d,purchaseAvailable:p,state:v,rules:i,activityInfo:n.activityInfo||n.ActivityInfo,coupons:n.coupons};return y},formatStrategies:function(t,n){if(!n||n.length==0||!t||t.length==0)return[];var r=[];return e.forEach(t,function(t){e.forEach(n,function(e){(e.ruleDescId||e.RuleDescId)==t&&r.push(e)})}),r},inArray:function(e,t,n){var r,i=Array.prototype.indexOf;if(t){if(i)return i.call(t,e,n);r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in t&&t[n]===e)return n}return-1},getFullPath:function(e){var n=t("<a></a>");return n.attr("href",e),n[0].href},isExitInAry:function(t,n){if(!!n&&n instanceof Array){var r=!1;return e.forEach(n,function(e){e&&e instanceof Object&&t===e.value?r=!0:e===t&&(r=!0)}),r}return},formateVpc:function(t){return t&&t instanceof Array&&e.forEach(t,function(e){e.version&&(e.vSwitchs=e.version)}),t},getSelectedItem:function(e,t,n){var r;for(var i=0;e&&i<e.length;i++){var s=e[i];if(s&&s.value==t){r=s;break}}return r?r:(n||(r=e&&e[0]),r||{})}};return r}),define("dominator/base/settings",["angular","./helpers/moduleHelper","angular-sanitize"],function(e,t){var n=e.module("aliyun.buy.settings",["ngSanitize"]);return n.config(["$rootScopeProvider",function(e){e.digestTtl(20)}]),n.config(["$compileProvider",function(e){e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|javascript):/)}]),n.config(["$httpProvider",function(e){e.interceptors.push(["$q",function(e){return{request:function(e){var t=e.params||{};return!e.headers||e.headers["Business-Tag"]!="aliyun-buy"?e:e.method!="GET"&&e.method!="JSONP"||!!e.cache?e.method=="POST"?(e.headers["Content-Type"]="application/x-www-form-urlencoded",e):e:(t._timestamp=(new Date).getTime().toString(),e.params=t,e)},requestError:function(t){return e.reject(t)},response:function(t){var n=t.config,r=t.data;return n.headers["Business-Tag"]!="aliyun-buy"?t:r.code=="200"||r.success===!0?t:r.success===!1||r.code&&r.code!=="200"?e.reject(t):t},responseError:function(t){return e.reject(t)}}}])}]),n.config(["$provide",function(e){e.decorator("$q",["$delegate",function(e){var t=e;return t.allSettled=function(e){return t.all(e.map(function(e){return e.then(function(e){return{state:"fulfilled",value:e}},function(e){return{state:"rejected",reason:e}})}))},t}])}]),n}),define("dominator/base/directives/controls/ui.anchor",["angular","jQuery"],function(e,t){var n=e.module("aliyun.buy.ui.anchor",[]);return n.directive("aliyunBuyAnchor",function(){var e=null,n;return{restrict:"A",link:function(e,r,i){var s=i.aliyunBuyAnchor;if(!s)return;e.$on(s,function(i,s){var o=r.offset().top;o-=100,clearTimeout(n),n=setTimeout(function(){e.$emit("aliyunBuyAnchor:anchor",{top:o}),t("html,body").stop().animate({scrollTop:o+"px"},500,function(){})},100)})}}}),n}),define("dominator/base/directives/controls/ui.button",["angular"],function(e){var t=e.module("aliyun.buy.ui.button",[]);return t.directive("aliyunBuyButton",function(){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuyButton.html",replace:!0,scope:{theme:"@",isSelected:"@",isDisabled:"@",iconClass:"@",tip:"@"},transclude:!0,link:function(e,t,n){}}}),t}),define("dominator/base/helpers/constraintHelper",["angular"],function(e){"use strict";var t=e.toJson,n={getCollectionProperty:function(t,n){var r=[];return e.forEach(t,function(e){r.push(e[n])}),r},reverseMap:function(e){if(!e||typeof e!="object")return;var t={};for(var n in e)t[e[n]]=n;return t},mapping:function(t,n){if(!t)return;if(!n||typeof n!="object")return t;var r;return typeof t=="string"?n[t]||t:typeof t=="object"?(r={},e.forEach(t,function(e,t){t=n[t]||t,r[t]=e}),r):t},filter:function(t,n,r){var i=[];return e.forEach(t,function(t){var s=r?t[r]:t,o=!1;e.forEach(n,function(e){if(s===e)return o=!0,!1}),o&&i.push(t)}),i},notFilter:function(t,n,r){var i=[];return e.forEach(t,function(t){var s=r?t[r]:t,o=!1;e.forEach(n,function(e){if(s===e)return o=!0,!1}),o||i.push(t)}),i},contains:function(t,n,r){var i=!1;return e.forEach(t,function(e){var e=r?e[r]:e;if(e==n){i=!0;return}}),i},intersect:function(n,r,i){if(n instanceof Array){if(r instanceof Array){var s={},o=[];return e.forEach(n,function(n,r){var o;i instanceof Array&&n&&typeof n=="object"?(e.forEach(i,function(e,t){o||(o={}),o[e]=n[e]}),s[t(o)]=!0):s[t(n)]=!0}),e.forEach(r,function(n,r){var u,a;i instanceof Array&&n&&typeof n=="object"?(e.forEach(i,function(e,t){a||(a={}),a[e]=n[e]}),u=t(a)):u=t(n),s[u]&&o.push(n)}),o}throw new Error("a must be an Array")}throw new Error("a must be an Array")}};return n}),define("dominator/base/directives/controls/ui.buttontab",["angular","../../helpers/moduleHelper","../../helpers/constraintHelper","../controls/ui.button"],function(e,t,n){var r=e.module("aliyun.buy.ui.buttontab",["aliyun.buy.ui.button"]);return r.directive("aliyunBuyButtontab",function(){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuyButtontab.html",scope:{options:"=",value:"=",spm:"=",required:"@",detail:"="},replace:!0,compile:function(n,r){return t.require(["options","value","detail"],r),{post:function(t,n,r){t.select=function(e){if(e.disabled)return;t.value=e.value,t.detail=e},t.$watch("value",function(n){e.forEach(t.options,function(e){e.value==n&&(t.detail=e)})});var i=r.required;i||(i="true");var s=function(){if(!t.options)return;var n=t.options;if(n.length===0){t.value=undefined;return}var r=!1;for(var i=0,s=n.length;i<s;i++)n[i].value==t.value&&(r=!0,t.detail=n[i]);if(!r){var o=0,u=!1,a=0;e.forEach(n,function(e,t){!e.disabled&&!u?(o=t,u=!0):e.disabled&&!u&&(a+=1)});if(a==n.length)return;t.value=n[o].value}};i=="true"&&(t.$watch("options",s),t.$watch("value",s))}}}}}),r}),define("dominator/base/directives/controls/ui.checkbox",["angular","../../helpers/moduleHelper"],function(e,t){var n=e.module("aliyun.buy.ui.checkbox",t.getModuleNames(arguments));return n.directive("aliyunBuyCheckbox",function(){return{restrice:"EA",templateUrl:"dominator/base/partials/aliyunBuyTool/checkbox.html",scope:{value:"=ngModel",display:"=",readOnly:"=?"},replace:!1,link:function(e){t.setDefault(e,{value:!1,readOnly:!1}),e.toggle=function(){e.readOnly||(e.value=!e.value)}}}}),n}),define("dominator/base/directives/controls/ui.position",["angular"],function(e){return e.module("aliyun.buy.ui.position",[]).factory("$aliyunBuyPosition",["$document","$window",function(t,n){function r(e,t){return e.currentStyle?e.currentStyle[t]:n.getComputedStyle?n.getComputedStyle(e)[t]:e.style[t]}function i(e){return(r(e,"position")||"static")==="static"}var s=function(e){var n=t[0],r=e.offsetParent||n;while(r&&r!==n&&i(r))r=r.offsetParent;return r||n};return{position:function(n){var r=this.offset(n),i={top:0,left:0},o=s(n[0]);o!=t[0]&&(i=this.offset(e.element(o)),i.top+=o.clientTop-o.scrollTop,i.left+=o.clientLeft-o.scrollLeft);var u=n[0].getBoundingClientRect();return{width:u.width||n.prop("offsetWidth"),height:u.height||n.prop("offsetHeight"),top:r.top-i.top,left:r.left-i.left}},offset:function(e){var r=e[0].getBoundingClientRect();return{width:r.width||e.prop("offsetWidth"),height:r.height||e.prop("offsetHeight"),top:r.top+(n.pageYOffset||t[0].documentElement.scrollTop),left:r.left+(n.pageXOffset||t[0].documentElement.scrollLeft)}},positionElements:function(e,t,n,r){var i=n.split("-"),s=i[0],o=i[1]||"center",u,a,f,l;u=r?this.offset(e):this.position(e),a=t.prop("offsetWidth"),f=t.prop("offsetHeight");var c={center:function(){return u.left+u.width/2-a/2},left:function(){return u.left},right:function(){return u.left+u.width}},h={center:function(){return u.top+u.height/2-f/2},top:function(){return u.top},bottom:function(){return u.top+u.height}};switch(s){case"right":l={top:h[o](),left:c[s]()};break;case"left":l={top:h[o](),left:u.left-a};break;case"bottom":l={top:h[s](),left:c[o]()};break;default:l={top:u.top-f,left:c[o]()}}return l}}}])}),define("dominator/base/directives/controls/ui.datepicker",["angular","./ui.position"],function(e){return e.module("aliyun.buy.ui.datepicker",["aliyun.buy.ui.position"]).constant("aliyunBuyDatepickerConfig",{dayFormat:"dd",monthFormat:"MMMM",yearFormat:"yyyy",dayHeaderFormat:"EEE",dayTitleFormat:"MMMM yyyy",monthTitleFormat:"yyyy",showWeeks:!0,startingDay:0,yearRange:20,minDate:null,maxDate:null}).controller("aliyunBuyDatepickerController",["$scope","$attrs","dateFilter","aliyunBuyDatepickerConfig",function(t,n,r,i){function s(n,r){return e.isDefined(n)?t.$parent.$eval(n):r}function o(e,t){return(new Date(e,t,0)).getDate()}function u(e,t){var n=new Array(t),r=e,i=0;while(i<t)n[i++]=new Date(r),r.setDate(r.getDate()+1);return n}function a(e,t,n,i){return{date:e,label:r(e,t),selected:!!n,secondary:!!i}}var f={day:s(n.dayFormat,i.dayFormat),month:s(n.monthFormat,i.monthFormat),year:s(n.yearFormat,i.yearFormat),dayHeader:s(n.dayHeaderFormat,i.dayHeaderFormat),dayTitle:s(n.dayTitleFormat,i.dayTitleFormat),monthTitle:s(n.monthTitleFormat,i.monthTitleFormat)},l=s(n.startingDay,i.startingDay),c=s(n.yearRange,i.yearRange);this.minDate=i.minDate?new Date(i.minDate):null,this.maxDate=i.maxDate?new Date(i.maxDate):null,this.modes=[{name:"day",getVisibleDates:function(e,t){var n=e.getFullYear(),i=e.getMonth(),s=new Date(n,i,1),c=l-s.getDay(),h=c>0?7-c:-c,p=new Date(s),d=0;h>0&&(p.setDate(-h+1),d+=h),d+=o(n,i+1),d+=(7-d%7)%7;var v=u(p,d),m=new Array(7);for(var g=0;g<d;g++){var y=new Date(v[g]);v[g]=a(y,f.day,t&&t.getDate()===y.getDate()&&t.getMonth()===y.getMonth()&&t.getFullYear()===y.getFullYear(),y.getMonth()!==i)}for(var b=0;b<7;b++)m[b]=r(v[b].date,f.dayHeader);return{objects:v,title:r(e,f.dayTitle),labels:m}},compare:function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate())-new Date(t.getFullYear(),t.getMonth(),t.getDate())},split:7,step:{months:1}},{name:"month",getVisibleDates:function(e,t){var n=new Array(12),i=e.getFullYear();for(var s=0;s<12;s++){var o=new Date(i,s,1);n[s]=a(o,f.month,t&&t.getMonth()===s&&t.getFullYear()===i)}return{objects:n,title:r(e,f.monthTitle)}},compare:function(e,t){return new Date(e.getFullYear(),e.getMonth())-new Date(t.getFullYear(),t.getMonth())},split:3,step:{years:1}},{name:"year",getVisibleDates:function(e,t){var n=new Array(c),r=e.getFullYear(),i=parseInt((r-1)/c,10)*c+1;for(var s=0;s<c;s++){var o=new Date(i+s,0,1);n[s]=a(o,f.year,t&&t.getFullYear()===o.getFullYear())}return{objects:n,title:[n[0].label,n[c-1].label].join(" - ")}},compare:function(e,t){return e.getFullYear()-t.getFullYear()},split:5,step:{years:c}}],this.isDisabled=function(e,n){var r=this.modes[n||0];return this.minDate&&r.compare(e,this.minDate)<0||this.maxDate&&r.compare(e,this.maxDate)>0||t.dateDisabled&&t.dateDisabled({date:e,mode:r.name})}}]).directive("aliyunBuyDatepicker",["dateFilter","$parse","aliyunBuyDatepickerConfig","$log",function(t,n,r,i){return{restrict:"EA",replace:!0,templateUrl:"dominator/base/partials/datepicker/datepicker.html",scope:{dateDisabled:"&"},require:["aliyunBuyDatepicker","?^ngModel"],controller:"aliyunBuyDatepickerController",link:function(t,s,o,u){function a(){t.showWeekNumbers=v===0&&g}function f(e,t){var n=[];while(e.length>0)n.push(e.splice(0,t));return n}function l(n){var r=null,s=!0;d.$modelValue&&(r=new Date(d.$modelValue),isNaN(r)?(s=!1,i.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):n&&(m=r)),d.$setValidity("date",s);var o=p.modes[v],u=o.getVisibleDates(m,r);e.forEach(u.objects,function(e){e.disabled=p.isDisabled(e.date,v)}),d.$setValidity("date-disabled",!r||!p.isDisabled(r)),t.rows=f(u.objects,o.split),t.labels=u.labels||[],t.title=u.title}function c(e){v=e,a(),l()}function h(e){var t=new Date(e);t.setDate(t.getDate()+4-(t.getDay()||7));var n=t.getTime();return t.setMonth(0),t.setDate(1),Math.floor(Math.round((n-t)/864e5)/7)+1}var p=u[0],d=u[1];if(!d)return;var v=0,m=new Date,g=r.showWeeks;o.showWeeks?t.$parent.$watch(n(o.showWeeks),function(e){g=!!e,a()}):a(),o.min&&t.$parent.$watch(n(o.min),function(e){p.minDate=e?new Date(e):null,l()}),o.max&&t.$parent.$watch(n(o.max),function(e){p.maxDate=e?new Date(e):null,l()}),d.$render=function(){l(!0)},t.select=function(e){if(v===0){var t=d.$modelValue?new Date(d.$modelValue):new Date(0,0,0,0,0,0,0);t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),d.$setViewValue(t),l(!0)}else m=e,c(v-1)},t.move=function(e){var t=p.modes[v].step;m.setMonth(m.getMonth()+e*(t.months||0)),m.setFullYear(m.getFullYear()+e*(t.years||0)),l()},t.toggleMode=function(){c((v+1)%p.modes.length)},t.getWeekNumber=function(e){return v===0&&t.showWeekNumbers&&e.length===7?h(e[0].date):null}}}}]).constant("aliyunBuyDatepickerPopupConfig",{dateFormat:"yyyy-MM-dd",currentText:"Today",toggleWeeksText:"Weeks",clearText:"Clear",closeText:"Done",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0}).directive("aliyunBuyDatepickerPopup",["$compile","$parse","$document","$aliyunBuyPosition","dateFilter","aliyunBuyDatepickerPopupConfig","aliyunBuyDatepickerConfig",function(t,n,r,i,s,o,u){return{restrict:"EA",require:"ngModel",link:function(a,f,l,c){function h(e){x?x(a,!!e):m.isOpen=!!e}function p(t){if(!t)return c.$setValidity("date",!0),null;if(e.isDate(t))return c.$setValidity("date",!0),t;if(e.isString(t)){var n=new Date(t);return isNaN(n)?(c.$setValidity("date",!1),undefined):(c.$setValidity("date",!0),n)}return c.$setValidity("date",!1),undefined}function d(e,t,r){e&&(a.$watch(n(e),function(e){m[t]=e}),k.attr(r||t,t))}function v(){m.position=b?i.offset(f):i.position(f),m.position.top=m.position.top+f.prop("offsetHeight")}var m=a.$new(),g,y=e.isDefined(l.closeOnDateSelection)?a.$eval(l.closeOnDateSelection):o.closeOnDateSelection,b=e.isDefined(l.datepickerAppendToBody)?a.$eval(l.datepickerAppendToBody):o.appendToBody,w=function(e){return typeof e=="boolean"||["true","false"].indexOf(e)>-1};l.$observe("datepickerPopup",function(e){g=e||o.dateFormat,c.$render()}),l.$observe("showButtonBar",function(e){m.showButtonBar=w(e)?a.$eval(e):o.showButtonBar}),a.$on("$destroy",function(){M.remove(),m.$destroy()});var E=function(t){return e.isDefined(t)&&t!==""};l.$observe("currentText",function(e){m.currentText=E(e)?e:o.currentText}),l.$observe("toggleWeeksText",function(e){m.toggleWeeksText=E(e)?e:o.toggleWeeksText}),l.$observe("clearText",function(e){m.clearText=E(e)?e:o.clearText}),l.$observe("closeText",function(e){m.closeText=E(e)?e:o.closeText});var S,x;l.isOpen&&(S=n(l.isOpen),x=S.assign,a.$watch(S,function(e){m.isOpen=!!e})),m.isOpen=S?S(a):!1;var T=function(e){m.isOpen&&e.target!==f[0]&&m.$apply(function(){h(!1)})},N=function(){m.$apply(function(){h(!0)})},C=e.element("<div aliyun-buy-datepicker-popup-wrap><div aliyun-buy-datepicker></div></div>");C.attr({"ng-model":"date","ng-change":"dateSelection()"});var k=e.element(C.children()[0]),L={};l.datepickerOptions&&(L=a.$eval(l.datepickerOptions),k.attr(e.extend({},L))),c.$parsers.unshift(p),m.dateSelection=function(t){e.isDefined(t)&&(m.date=t),c.$setViewValue(m.date),c.$render(),y&&h(!1)},f.bind("input change keyup",function(){m.$apply(function(){m.date=c.$modelValue})}),c.$render=function(){var e=c.$viewValue?s(c.$viewValue,g):"";f.val(e),m.date=c.$modelValue},d(l.min,"min"),d(l.max,"max"),l.showWeeks?d(l.showWeeks,"showWeeks","show-weeks"):(m.showWeeks="show-weeks"in L?L["show-weeks"]:u.showWeeks,k.attr("show-weeks","showWeeks")),l.dateDisabled&&k.attr("date-disabled",l.dateDisabled);var A=!1,O=!1;m.isSelected=!1,m.$watch("isOpen",function(e){e?(m.isSelected==0&&l.myInitDate&&(m.date=l.myInitDate,m.isSelected=!0),v(),r.bind("click",T),O&&f.unbind("focus",N),f[0].focus(),A=!0):(A&&r.unbind("click",T),f.bind("focus",N),O=!0),x&&x(a,e)}),m.today=function(){m.dateSelection(new Date)},m.clear=function(){m.dateSelection(null)};var M=t(C)(m);b?r.find("body").append(M):f.after(M)}}}]).directive("aliyunBuyDatepickerPopupWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"dominator/base/partials/datepicker/popup.html",link:function(e,t,n){t.bind("click",function(e){e.preventDefault(),e.stopPropagation()})}}})}),define("dominator/base/directives/controls/ui.transition",["angular"],function(e){"use strict";var t=e.module("aliyun.buy.ui.transition",[]).factory("aliyunBuyTransition",["$q","$timeout","$rootScope",function(t,n,r){function i(e){for(var t in e)if(o.style[t]!==undefined)return e[t]}var s=function(i,o,u){u=u||{};var a=t.defer(),f=s[u.animation?"animationEndEventName":"transitionEndEventName"],l=function(e){r.$apply(function(){i.unbind(f,l),a.resolve(i)})};return f&&i.bind(f,l),n(function(){e.isString(o)?i.addClass(o):e.isFunction(o)?o(i):e.isObject(o)&&i.css(o),f||a.resolve(i)}),a.promise.cancel=function(){f&&i.unbind(f,l),a.reject("Transition cancelled")},a.promise},o=document.createElement("trans"),u={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},a={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return s.transitionEndEventName=i(u),s.animationEndEventName=i(a),s}]);return t}),define("dominator/base/directives/controls/ui.dialog",["angular","./ui.transition"],function(e){return e.module("aliyun.buy.ui.dialog",["aliyun.buy.ui.transition"]).factory("aliyunBuyDialogStackedMap",function(){return{createNew:function(){var e=[];return{add:function(t,n){e.push({key:t,value:n})},get:function(t){for(var n=0;n<e.length;n++)if(t==e[n].key)return e[n]},keys:function(){var t=[];for(var n=0;n<e.length;n++)t.push(e[n].key);return t},top:function(){return e[e.length-1]},remove:function(t){var n=-1;for(var r=0;r<e.length;r++)if(t==e[r].key){n=r;break}return e.splice(n,1)[0]},removeTop:function(){return e.splice(e.length-1,1)[0]},length:function(){return e.length}}}}}).directive("aliyunBuyDialogModalBackdrop",["$timeout",function(e){return{restrict:"EA",replace:!0,templateUrl:"dominator/base/partials/aliyunBuyDialog/backdrop.html",link:function(t){t.animate=!1,e(function(){t.animate=!0})}}}]).directive("aliyunBuyDialogModalWindow",["aliyunBuyDialogModalStack","$timeout",function(e,t){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:"dominator/base/partials/aliyunBuyDialog/window.html",link:function(n,r,i){n.windowClass=i.windowClass||"",t(function(){n.animate=!0,r[0].focus()}),n.close=function(t){var n=e.getTop();n&&n.value.backdrop&&n.value.backdrop!="static"&&t.target===t.currentTarget&&(t.preventDefault(),t.stopPropagation(),e.dismiss(n.key,"backdrop click"))}}}}]).factory("aliyunBuyDialogModalStack",["aliyunBuyTransition","$timeout","$document","$compile","$rootScope","aliyunBuyDialogStackedMap",function(t,n,r,i,s,o){function u(){var e=-1,t=d.keys();for(var n=0;n<t.length;n++)d.get(t[n]).value.backdrop&&(e=n);return e}function a(e){var t=r.find("body").eq(0),n=d.get(e).value;d.remove(e),l(n.modalDomEl,n.modalScope,300,f),t.toggleClass(c,d.length()>0)}function f(){if(h&&u()==-1){var e=p;l(h,p,150,function(){e.$destroy(),e=null}),h=undefined,p=undefined}}function l(e,r,i,s){function o(){if(o.done)return;o.done=!0,e.remove(),s&&s()}r.animate=!1;var u=t.transitionEndEventName;if(u){var a=n(o,i);e.bind(u,function(){n.cancel(a),o(),r.$apply()})}else n(o,0)}var c="modal-open",h,p,d=o.createNew(),v={};return s.$watch(u,function(e){p&&(p.index=e)}),r.bind("keydown",function(e){var t;e.which===27&&(t=d.top(),t&&t.value.keyboard&&s.$apply(function(){v.dismiss(t.key)}))}),v.open=function(t,n){d.add(t,{deferred:n.deferred,modalScope:n.scope,backdrop:n.backdrop,keyboard:n.keyboard});var o=r.find("body").eq(0),a=u();a>=0&&!h&&(p=s.$new(!0),p.index=a,h=i("<div aliyun-buy-dialog-modal-backdrop></div>")(p),o.append(h));var f=e.element("<div aliyun-buy-dialog-modal-window></div>");f.attr("window-class",n.windowClass),f.attr("index",d.length()-1),f.attr("animate","animate"),f.html(n.content);var l=i(f)(n.scope);d.top().value.modalDomEl=l,o.append(l),o.addClass(c)},v.close=function(e,t){var n=d.get(e),r=n&&n.value;r&&(r.deferred.resolve(t),a(e))},v.dismiss=function(e,t){var n=d.get(e).value;n&&(n.deferred.reject(t),a(e))},v.dismissAll=function(e){var t=this.getTop();while(t)this.dismiss(t.key,e),t=this.getTop()},v.getTop=function(){return d.top()},v}]).provider("aliyunBuyDialog",function(){var t={defaultClass:"",options:{backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","aliyunBuyDialogModalStack",function(n,r,i,s,o,u,a){function f(e){return e.template?i.when(e.template):s.get(e.templateUrl,{cache:o}).then(function(e){return e.data})}function l(t){var r=[];return e.forEach(t,function(t,s){(e.isFunction(t)||e.isArray(t))&&r.push(i.when(n.invoke(t)))}),r}var c={};return c.open=function(n){var s=i.defer(),o=i.defer(),c={result:s.promise,opened:o.promise,close:function(e){a.close(c,e)},dismiss:function(e){a.dismiss(c,e)}};n=e.extend({},t.options,n),n.resolve=n.resolve||{},n.windowClass=n.windowClass?n.windowClass+" "+t.defaultClass:t.defaultClass;if(!n.template&&!n.templateUrl)throw new Error("One of template or templateUrl options is required.");var h=i.all([f(n)].concat(l(n.resolve)));return h.then(function(t){var i=(n.scope||r).$new();i.$close=c.close,i.$dismiss=c.dismiss;var o,f={},l=1;n.controller&&(f.$scope=i,f.aliyunBuyDialogInstance=c,e.forEach(n.resolve,function(e,n){f[n]=t[l++]}),o=u(n.controller,f)),a.open(c,{scope:i,deferred:s,content:t[0],backdrop:n.backdrop,keyboard:n.keyboard,windowClass:n.windowClass})},function(e){s.reject(e)}),h.then(function(){o.resolve(!0)},function(){o.reject(!1)}),c},c}],setDefaultClass:function(e){this.defaultClass=e}};return t})}),define("dominator/base/directives/controls/ui.floats",["angular","jQuery","../../helpers/moduleHelper"],function(e,t,n){var r=e.module("aliyun.buy.ui.floats",[]);return r.provider("aliyunFloatboxConfig",function(){var t={defaultClass:"",defaultAlign:"left",defaultTheme:"border",themeConfig:{orange:{autoFit:!1,position:"top"},white:{autoFit:!1,position:"bottom"},right:{autoFit:!1,position:"right",align:"middle"}}};return{setDefaultClass:function(e){t.defaultClass=e},setDefaultTheme:function(e){t.defaultTheme=e},setDefaultAlign:function(e){t.defaultAlign=e},extendThemeConfig:function(n,r){var i=t.themeConfig[n]||{};t.themeConfig[n]=e.extend(i,r)},$get:function(){return t}}}),r.directive("aliyunBuyFloatbox",["aliyunFloatboxConfig",function(e){return{restrict:"EA",replace:!0,templateUrl:"dominator/base/partials/aliyunBuyFloats/floatbox.html",transclude:!0,scope:{title:"@",width:"@",height:"@",minWidth:"@",maxWidth:"@",minHeight:"@",maxHeight:"@",theme:"@"},link:function(t,n,r,i,s){var o=t.$parent.$new(),u=e.defaultTheme;t.$watch("theme",function(e){e||(t.theme=u),s(o,function(e){n.find("*[aliyun-buy-floatbox-transclude]").append(e)}),a(),n.trigger("resize")});var a=function(){var e=t.height,r=t.maxHeight,i=t.minHeight,s=n.innerHeight()-n.find("*[aliyun-buy-floatbox-transclude]").height();!e||e=="auto"?t.innerHeight="auto":t.innerHeight=parseInt(e)-s,!r||r=="auto"?t.innerMaxHeight="auto":t.innerMaxHeight=parseInt(r)-s,!i||i=="auto"?t.innerMinHeight="auto":t.innerMinHeight=parseInt(i)-s};t.$watchCollection("[height, maxHeight, minHeight, theme]",a),n.trigger("resize")}}}]),r.directive("aliyunBuyTooltip",["$compile","$templateCache","aliyunFloatboxConfig",function(t,n,r){function i(e,t,n,r){this.target=e,this.scope=n,this.outerScope=r,s.call(this,t),u.call(this)}function s(t){t=t&&typeof t=="object"?t:{content:t};var n=t.theme||r.defaultTheme,i=r.themeConfig[n]||{};this.config=e.extend({},this.defaultConfig,i,t),o.call(this,this.config.handle)}function o(e){if(!e||!this.outerScope)return;var t=this;this.outerScope[e]={close:function(e){g.call(t,e)}}}function u(){var e=this.target;this._documentClickHandler=function(e){d.call(this,e)},this.config.trigger=="hover"?(e.bind("mouseover",$.proxy(c,this)),e.bind("mouseout",$.proxy(h,this))):this.config.trigger=="click"&&(e.bind("click",$.proxy(p,this)),$(document).bind("click",$.proxy(this._documentClickHandler,this))),this.outerScope&&this.outerScope.$on("$destroy",$.proxy(l,this))}function a(){this.ui&&(this.ui.hide(),this.visible=!1)}function f(){this.ui||(this.ui=m(this.config,this.scope),this.config.trigger=="hover"&&(this.ui.bind("mouseover",$.proxy(c,this)),this.ui.bind("mouseout",$.proxy(h,this))),this.ui.bind("resize",$.proxy(function(e){v.call(this)},this))),this.ui.find(".aliyun-buy-floatbox-content").html()&&(this.ui.show(),this.visible=!0)}function l(){this.scope.$destroy(),this.ui&&(this.ui.remove(),this.ui=undefined);var e=this.target;e&&(e.unbind("mouseover",c),e.unbind("mouseout",h),e.unbind("click",p),this.target=undefined),$(document).unbind("click",this._documentClickHandler),this.outerScope&&this.outerScope[this.config.handle]&&(this.outerScope[this.config.handle]=undefined)}function c(){clearTimeout(this.delayTimer);var e=this;this.delayTimer=setTimeout(function(){e.show()},this.config.showDelay),v.call(this)}function h(){clearTimeout(this.delayTimer);var e=this;this.delayTimer=setTimeout(function(){e.hide()},this.config.delay)}function p(e){this.visible?h.call(this):c.call(this)}function d(e){if(!this.target||!this.ui)return;var t=$(e.target);$.inArray(e.target,this.ui[0].getElementsByTagName("*"))==-1&&$.inArray(e.target,this.target[0].getElementsByTagName("*"))==-1&&e.target!==this.ui[0]&&e.target!==this.target[0]&&h.call(this)}function v(e){if(!this.ui)return;if(!this.target)return;var t=$(window),n=this.target,r=this.ui,i=r.outerWidth(!0),s=r.outerHeight(!0),o=n.outerWidth(),u=n.outerHeight(),a=n.offset(),f=t.width(),l=t.height(),c=t.scrollTop(),h=t.scrollLeft(),p,d,m={},g=10,y=this.config,b=this;if(this.ui.text().trim()==""&&e!=1){clearTimeout(this.ui.delayTimer),this.ui.delayTimer=setTimeout(function(){v.call(b,1)},100);return}y.position=="bottom"?d=a.top+u+y.offsetY:y.position=="top"?d=a.top-s-y.offsetY:y.position=="right"?p=a.left+o+y.offsetX+15:y.position=="left"&&(p=a.left-y.offsetX-i-15),y.align=="left"?p=a.left+y.offsetX:y.align=="right"?p=a.left+o-i-y.offsetX:y.align=="center"?(p=a.left+o/2-i/2,m.left=i/2-g):y.align=="middle"&&(d=a.top+u/2-s/2,m.top=s/2-g),y.autoFit&&(p+i>f+h-10&&(p=f+h-10-i),p<10&&(p=10),d+s>l+c-10&&(d=l+c-10-s),d<10&&(d=10)),this.ui.css({left:p,top:d}),r.find(".bk-tip-arrow").css(m)}function m(e,i,s){var o,u=function(e){return typeof e=="undefined"?"":e},a=function(e){return e.indexOf("{{")!==-1||e.indexOf("}}")!==-1||e.indexOf("aliyunBuyText")===-1&&e.indexOf("translate")===-1?'<div class="aliyun-buy-floatbox-content">'+e+"</div>":'<div class="aliyun-buy-floatbox-content" ng-bind-html="'+e+'"></div>'},f=e.templateUrl?n.get(e.templateUrl):"",l=u(f)||u(e.content),c="";l||(c="display:none");var h=r.defaultClass+" "+"floatbox-"+e.position;return h+=" aliyun-buy-floatbox",o=$('<div style="position:absolute; z-index:10000; '+c+'"><div aliyun-buy-floatbox class="'+h+'" theme="'+u(e.theme)+'" data-title="'+u(e.title)+'" data-width="'+u(e.width)+'" data-height="'+u(e.height)+'"  data-max-width="'+u(e.maxWidth)+'" data-max-height="'+u(e.maxHeight)+'" data-min-width="'+u(e.minWidth)+'" data-min-height="'+u(e.minHeight)+'">'+a(u(f)||u(e.content))+"</div></div>"),$(document.body).append(o),t(o.contents())(i),o}function g(e){if(!this)return;e?this.destroy():this.hide()}return i.prototype={defaultConfig:{delay:200,showDelay:0,trigger:"hover",offsetX:0,offsetY:5,maxWidth:350,align:r.defaultAlign,position:"bottom",autoFit:!0,templateUrl:"",content:"",title:"",handle:"",enDisplay:!0},destroy:l,show:f,hide:a},{restrict:"A",link:function(e,t,n,r,s){var o,u;n.$observe("aliyunBuyTooltip",function(n){if(!n)return;u=e.$new(),u.$$$close=function(e){g.call(o,e)};var r;try{r=e.$eval(n)}catch(s){}o&&o.destroy();if(r&&r.enDisplay===!1)return;o=new i(t,r||n,u,e)})}}}]),r}),define("dominator/base/directives/controls/ui.group",["angular","../../helpers/moduleHelper"],function(e,t){var n=e.module("aliyun.buy.ui.group",[]);return n.directive("aliyunBuyGroup",["$timeout","$rootScope","$compile",function(t,n,r){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuyGroup.html",replace:!0,scope:{title:"@",collapsed:"@",collapsable:"@",disabled:"@",groupId:"@",groupIntro:"@",groupTip:"@",async:"@"},transclude:!0,link:function(i,s,o,u,a){function f(){a(c,function(e){s.find("*[aliyun-buy-group-transclude]").append(e)})}function l(e,t){if(t){var n=r("<span>"+t+"</span>")(c),i=s.find(e);i.length>1&&(i=i.first()),i.html(n)}}var c=i.$parent.$new();c.$$$collapsed=i.collapsed=="true"?!0:!1,i.async==="true"?t(f):f(),i.$watch("groupIntro",function(e){l(".bk-group-intro",e)}),i.$watch("groupTip",function(e){l(".bk-group-tip",e)}),i.toggle=function(){var e=i.collapsed=i.collapsed==="true"?"false":"true";o.collapsed=e,c.aliyunBuyGroupCollapsed=e=="true"?!0:!1,s.attr("collapsed",e)};var h=i.groupId,p=n.$on("aliyunBuyGroupDisplay:"+h,function(e,t){t?i.displayGroup=!0:i.displayGroup=!1});i.$on("$destroy",function(){e.isFunction(p)&&p()})}}}]),n.directive("aliyunBuyCollapsable",function(){return{restrict:"A",link:function(e,t,n){t.addClass("bk-group-collapsable")}}}),n}),define("dominator/base/directives/controls/ui.msg",["angular","../../helpers/moduleHelper","./ui.dialog"],function(e,t){var n=e.module("aliyun.buy.ui.msg",["aliyun.buy.ui.dialog"]);return n.provider("aliyunBuyMsg",function(){this.$get=["$templateCache","aliyunBuyDialog",function(e,n){return{dialog:function(e,t,r){var i=n.open({templateUrl:"dominator/base/partials/aliyunBuyMsg.html",backdrop:"static",controller:["$scope",function(n){n.title=e,n.body=t,n.config=r,n.dialog=i}]});return i},alert:function(e,n,r,i){var s=this.dialog(e,n,t.config({buttons:[{text:"",theme:"blue",handler:function(){s.close(),r instanceof Function&&r()}}]},i))}}}]}),n}),define("dominator/base/directives/controls/ui.notice",["angular","../../helpers/moduleHelper"],function(e,t){var n=e.module("aliyun.buy.ui.notice",t.getModuleNames(arguments));return n.directive("aliyunBuyNotice",function(){return{restrice:"EA",templateUrl:"dominator/base/partials/aliyunBuyNotice.html",scope:{text:"@"},replace:!1,link:function(e){}}}),n}),define("dominator/base/directives/controls/ui.numberOnly",["angular"],function(e){return e.module("aliyun.buy.ui.numberOnly",[]).directive("aliyunBuyNumberOnly",["$timeout",function(e){return{require:"ngModel",scope:{supportFloat:"@"},link:function(t,n,r,i){var s={};return n.keydown(function(n){s=e(function(){n.keyCode==38?(i.$setViewValue((parseInt(i.$viewValue)+1).toString()),i.$render(),t.$apply()):n.keyCode==40&&(i.$setViewValue((parseInt(i.$viewValue)-1).toString()),i.$render(),t.$apply())},500)}),n.keyup(function(n){n.keyCode==38?(i.$setViewValue((parseInt(i.$viewValue)+1).toString()),i.$render(),t.$apply()):n.keyCode==40&&(i.$setViewValue((parseInt(i.$viewValue)-1).toString()),i.$render(),t.$apply()),e.cancel(s)}),i.$parsers.push(function(e){var n;if(e===void 0)return;var r=/[^0-9]/g;return t.supportFloat&&(r=/[^0-9\.]/g),n=e.replace(r,""),n!==e&&(i.$setViewValue(n),i.$render()),n})}}}])}),define("dominator/base/directives/controls/ui.numberStepper",["angular","./ui.numberOnly"],function(e){return e.module("aliyun.buy.ui.numberStepper",["aliyun.buy.dominator.base.tpl","aliyun.buy.ui.numberOnly"]).directive("aliyunBuyNumberStepper",["$timeout",function(t){return{restrict:"EA",replace:!0,scope:{value:"=",labelId:"=",min:"=",max:"=",unit:"=",step:"=",supportFloat:"@",formatter:"&",defaultValue:"=",hideControl:"=",isDisabled:"="},templateUrl:"dominator/base/partials/aliyunBuyNumberStepper/numberStepper.html",link:function(n,r,i){function s(t){var r=n.formatter();n._value=e.isFunction(r)?r(t):t,n.value=n._value}n.less=function(){if(n.isDisabled)return;n.step||n.step==0?n._value=n._value-n.step:n._value--,n.blur()},n.plus=function(){if(n.isDisabled)return;n.step||n.step==0?n._value=n._value+n.step:n._value++,n.blur()},n.$watch("value",function(e){n._value=e,n.blur()}),n.blur=function(){var e=n._value;e!=undefined?e<n.min?s(n.min):n.max&&e>n.max?s(n.max):n.max==0&&e>n.max?s(n.min):s(e):n.defaultValue!=undefined?t(function(){s(n.defaultValue)}):t(function(){s(n.min)})},n.$watchCollection("[min, max]",function(e){e[0]!=undefined&&e[1]!=undefined&&n.blur()})}}}])}),define("dominator/base/directives/controls/ui.pagination",["angular"],function(e){return e.module("aliyun.buy.ui.pagination",["aliyun.buy.dominator.base.tpl"]).controller("aliyunBuyPaginationController",["$scope","$attrs","$parse","$interpolate",function(t,n,r,i){var s=this,o={$setViewValue:e.noop},u=n.numPages?r(n.numPages).assign:e.noop;this.init=function(e,i){o=e,o.$render=function(){s.render()},n.itemsPerPage?t.$parent.$watch(r(n.itemsPerPage),function(e){s.itemsPerPage=parseInt(e,10),t.totalPages=s.calculateTotalPages()}):this.itemsPerPage=i},this.noPrevious=function(){return this.page===1},this.noNext=function(){return this.page===t.totalPages},this.isActive=function(e){return this.page===e},this.calculateTotalPages=function(){var e=this.itemsPerPage<1?1:Math.ceil(t.totalItems/this.itemsPerPage);return Math.max(e||0,1)},this.getAttributeValue=function(n,r,s){return e.isDefined(n)?s?i(n)(t.$parent):t.$parent.$eval(n):r},this.render=function(){this.page=parseInt(o.$viewValue,10)||1,this.page>0&&this.page<=t.totalPages&&(t.pages=this.getPages(this.page,t.totalPages))},t.selectPage=function(e){!s.isActive(e)&&e>0&&e<=t.totalPages&&(o.$setViewValue(e),o.$render())},t.$watch("page",function(){s.render()}),t.$watch("totalItems",function(){t.totalPages=s.calculateTotalPages()}),t.$watch("totalPages",function(e){u(t.$parent,e),s.page>e?t.selectPage(e):o.$render()})}]).constant("paginationConfig",{itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0}).directive("aliyunBuyPagination",["$parse","paginationConfig",function(t,n){return{restrict:"EA",scope:{totalItems:"="},require:["aliyunBuyPagination","?ngModel"],controller:"aliyunBuyPaginationController",templateUrl:"dominator/base/partials/angular-bootstrap/pagination/pagination.html",replace:!0,link:function(r,i,s,o){function u(e,t,n,r){return{number:e,text:t,active:n,disabled:r}}var a=o[0],f=o[1];if(!f)return;var l,c=a.getAttributeValue(s.boundaryLinks,n.boundaryLinks),h=a.getAttributeValue(s.directionLinks,n.directionLinks),p=a.getAttributeValue(s.firstText,n.firstText,!0),d=a.getAttributeValue(s.previousText,n.previousText,!0),v=a.getAttributeValue(s.nextText,n.nextText,!0),m=a.getAttributeValue(s.lastText,n.lastText,!0),g=a.getAttributeValue(s.rotate,n.rotate);a.init(f,n.itemsPerPage),s.maxSize&&r.$parent.$watch(t(s.maxSize),function(e){l=parseInt(e,10),a.render()}),a.getPages=function(t,n){var r=[],i=1,s=n,o=e.isDefined(l)&&l<n;o&&(g?(i=Math.max(t-Math.floor(l/2),1),s=i+l-1,s>n&&(s=n,i=s-l+1)):(i=(Math.ceil(t/l)-1)*l+1,s=Math.min(i+l-1,n)));for(var f=i;f<=s;f++){var y=u(f,f,a.isActive(f),!1);r.push(y)}if(o&&!g){if(i>1){var b=u(i-1,"...",!1,!1);r.unshift(b)}if(s<n){var w=u(s+1,"...",!1,!1);r.push(w)}}if(h){var E=u(t-1,d,!1,a.noPrevious());r.unshift(E);var S=u(t+1,v,!1,a.noNext());r.push(S)}if(c){var x=u(1,p,!1,a.noPrevious());r.unshift(x);var T=u(n,m,!1,a.noNext());r.push(T)}return r}}}}]).constant("pagerConfig",{itemsPerPage:10,previousText:" Previous",nextText:"Next ",align:!0}).directive("aliyunBuyPager",["pagerConfig",function(e){return{restrict:"EA",scope:{totalItems:"="},require:["aliyunBuyPager","?ngModel"],controller:"aliyunBuyPaginationController",templateUrl:"dominator/base/partials/angular-bootstrap/pagination/pager.html",replace:!0,link:function(t,n,r,i){function s(e,t,n,r,i){return{number:e,text:t,disabled:n,previous:l&&r,next:l&&i}}var o=i[0],u=i[1];if(!u)return;var a=o.getAttributeValue(r.previousText,e.previousText,!0),f=o.getAttributeValue(r.nextText,e.nextText,!0),l=o.getAttributeValue(r.align,e.align);o.init(u,e.itemsPerPage),o.getPages=function(e){return[s(e-1,a,o.noPrevious(),!0,!1),s(e+1,f,o.noNext(),!1,!0)]}}}}])}),define("dominator/base/directives/controls/ui.placeholder",["angular","../../helpers/moduleHelper"],function(e,t){var n=e.module("aliyun.buy.ui.placeholder",t.getModuleNames(arguments));return n.directive("placeholder",function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){if("placeholder"in document.createElement("input"))return;var i;n.$observe("placeholder",function(e){i=e,s()}),t.on("focus",function(){r.$viewValue||t.val(""),t.css({color:"#000"})});var s=function(){r.$viewValue?(r.$setViewValue(t.val()),t.css({color:"#000"})):(t.css({color:"#AAA"}),t.val(i),r.$setViewValue(""))};t.on("blur",function(){s()}),i=n.placeholder,s()}}}),n}),define("dominator/base/directives/controls/ui.preloader",["angular"],function(e){var t=e.module("aliyun.buy.ui.preloader",[]);return t.directive("aliyunBuyPreloader",["$templateCache","$compile",function(e,t){return{restrict:"A",priority:0,replace:!1,link:function(n,r,i){var s=r.css("position");r.addClass("bk-preloader"),r.append(['<div class="bk-preloader-modal"></div>','<div class="bk-preloader-icon"></div>','<div class="J_msg bk-preloader-msg"></div>'].join(""));var o=i.aliyunBuyPreloader||null,u=i.aliyunBuyPreloaderMsgTrigger||null,a=i.aliyunBuyPreloaderMsg||null,f=i.aliyunBuyPreloaderMsgTpl||null;n.$watchCollection("["+a+","+f+"]",function(i){var s=i[0],o=i[1],u=s||e.get(o),a=r.find(".J_msg");a.empty(),u&&(a.append(u),t(a)(n))}),n.$watchCollection("["+o+","+u+"]",function(e){var t=e[0],n=e[1];t===!0||n===!0?s=="static"&&r.css("position","relative"):(r.addClass("bk-preloader-hide"),r.css("position","")),t===!0?r.removeClass("bk-preloader-hide"):r.addClass("bk-preloader-hide"),n===!0?r.addClass("bk-preloader-notify"):r.removeClass("bk-preloader-notify")})}}}]),t}),define("dominator/base/directives/controls/ui.select",["angular","../../helpers/moduleHelper"],function(e,t){return e.module("aliyun.buy.ui.select",[]).directive("aliyunBuySelectCutString",function(){return{scope:{aliyunBuySelectCutString:"=","long":"=",icon:"@"},link:function(e,t,n){e.$watchCollection("[long,icon,aliyunBuySelectCutString]",function(e){if(e&&e[2]){var n=e[1]?e[0]?15:8:e[0]?18:11;e[2].length>n?(t.attr("title",e[2]),t.html(e[2].substr(0,n)+"...")):t.html(e[2])}})}}}).directive("aliyunBuySelect",["$timeout",function(n){return{restrict:"AE",replace:!0,scope:{placeholder:"@",isLoadingItems:"=?",ngModel:"=",list:"=option",ngDisabled:"=",state:"=",detail:"=",labelId:"=","long":"@","short":"@",moreText:"@",needLogin:"@",spm:"@"},templateUrl:"dominator/base/partials/aliyunBuyTool/select.html",compile:function(r,i){var s={tab:9,enter:13,esc:27,space:32,left:37,up:38,right:39,down:40},o=null;return t.require(["detail"],i),function(t,r,i){function u(e){$.inArray(e.target,r[0].getElementsByTagName("*"))==-1&&e.target!==r[0]&&n(function(){t.open=!1})}e.extend(t,{check:function(e){t.open=!1,t.placeholder=e.text,t.placeholderIcon=e.icon,t.ngModel=e.value,t.detail=e},openSelcet:function(e){n(function(){if(e.type==="keyup"&&e.keyCode!==s.enter)return;if(t.ngDisabled)return;t.open=!t.open,o=e.currentTarget})},closeSelect:function(e,n){if(e.type==="keyup"&&e.keyCode!==s.esc&&e.keyCode!==s.enter)return;if(t.ngDisabled)return;e.keyCode===s.enter&&(n.disabled?"":t.check(n)),t.open=!1,o.focus().attr("aria-expanded",!1)}});var a=e.element(document);a.bind("click",u),t.$on("$destroy",function(){a.unbind("click",u)}),t.$watch("ngModel",function(r,s){if(r&&r!==s){var o=0;e.forEach(t.list,function(e){e.value===r&&(n(function(){t.placeholder=e.text,t.placeholderIcon=e.icon,t.detail=e}),o++)}),o||n(function(){t.placeholder=i.placeholder,t.ngModel=undefined,t.detail=undefined,t.placeholderIcon=undefined})}else n(function(){t.placeholder=i.placeholder,t.detail=undefined,t.placeholderIcon=undefined})}),t.$watch("list",function(r){var s=0;e.forEach(r,function(e){e.value===t.ngModel&&(n(function(){t.placeholder=e.text,t.placeholderIcon=e.icon,t.detail=e}),s++)}),s||(t.placeholder=i.placeholder,t.ngModel=undefined,t.detail=undefined,t.placeholderIcon=undefined),!t.ngModel&&!t.placeholder&&e.isArray(t.list)&&t.list.length>0&&(t.ngModel=t.list[0].value,t.detail=t.list[0])},!0)}}}}])}),define("dominator/base/directives/controls/ui.selectDynamic",["angular","../../helpers/moduleHelper"],function(e,t){return e.module("aliyun.buy.ui.selectDynamic",[]).directive("aliyunBuySelectDynamic",["$timeout","$q",function(n,r){return{restrict:"AE",replace:!0,scope:{placeholder:"@",ngModel:"=",list:"=option",ngDisabled:"=",state:"=",detail:"=","long":"@","short":"@",moreText:"@",needLogin:"@",fetchConfig:"="},templateUrl:"dominator/base/partials/aliyunBuyTool/selectDynamic.html",compile:function(n,r){return t.require(["detail"],r),function(t,n,r){function i(){t.placeholder=r.placeholder,t.ngModel=undefined,t.detail=undefined,t.placeholderIcon=undefined}function s(e){t.placeholder=e.text,t.placeholderIcon=e.icon,t.detail=e}function o(e){if(!e)return;var t=e.initialPageNumber||a;this.setPageNumber(t),this.pageSize=e.pageSize||u,this.fetchData=e.fetchData,this.resultsHandler=e.resultsHandler,this.totalCount=e.totalCount}e.extend(t,{check:function(e){t.open=!1,t.placeholder=e.text,t.placeholderIcon=e.icon,t.ngModel=e.value,t.detail=e},openSelcet:function(e){if(t.ngDisabled)return;t.open=!t.open}});var u=10,a=1;o.prototype={constructor:o,setTotalCount:function(e){this.totalCount=e},setPageNumber:function(e){this.pageNumber=e,this.prevPageNumber=e-1},fetchAndHandleData:function(){var t=this;t.fetchData(t.pageNumber,t.pageSize).then(function(n){var r;e.isFunction(t.resultsHandler)?r=t.resultsHandler(n):r=n;if(!r||!e.isArray(r.items))return;t.appendToList(r.items),t.setTotalCount(r.totalCount),t.setLoadingItemsStatus(!1),t.calculatePageNumber(),t.calculateLastPage()},function(){t.appendToList([])})},beforeToList:function(e){!t.list&&(t.list=[]),t.list=e.concat(t.list)},appendToList:function(e){!t.list&&(t.list=[]),t.list=t.list.concat(e)},needLoading:function(){return this.prevPageNumber*this.pageSize<this.totalCount},calculatePageNumber:function(){if(this.needLoading()){var e=this.pageNumber+1;this.setPageNumber(e)}},calculateLastPage:function(){this.pageNumber>1&&!this.needLoading()?t.isLastPage=!0:t.isLastPage=!1},setLoadingItemsStatus:function(e){t.isLoadingItems=e}};var f=t.fetchConfig,l=new o(f);t.$watch("fetchConfig",function(){if(!t.fetchConfig)return;l=new o(t.fetchConfig)},!0),t.$watch("open",function(){if(e.isUndefined(t.open))return;!t.list&&t.open?(l.setLoadingItemsStatus(!0),l.setPageNumber(1),l.calculateLastPage(),l.fetchAndHandleData()):l.setLoadingItemsStatus(!1)}),function(){function r(e){$.inArray(e.target,n[0].getElementsByTagName("*"))==-1&&e.target!==n[0]&&t.$apply(function(){t.open=!1})}var i=e.element(document);i.bind("click",r),t.$on("$destroy",function(){i.unbind("click",r)})}(),t.$watch("ngModel",function(n,r){if(n&&n!==r){var o=0;e.forEach(t.list,function(e){if(e.value===n){s(e),o++;return}}),o||i()}else i()}),t.$watch("list",function(n){var r=0;e.isArray(t.list)&&t.list.length==0?t.isEmptyOfRemoteData=!0:t.isEmptyOfRemoteData=!1,e.forEach(n,function(e){e.value===t.ngModel&&(s(e),r++)}),r||i()},!0),t.loadMore=function(){l.needLoading()&&!t.isLoadingItems&&t.$apply(function(){l.setLoadingItemsStatus(!0),l.fetchAndHandleData()})},t.$on("$destroy",function(){l=undefined})}}}}]).directive("scrollButtomTrigger",["$parse",function(e){return{link:function(t,n,r){var i=r.callback,s=e(i)(t);n.scroll(function(){function e(){return r+n.height()>=t.scrollHeight}var t=this,n=$(t),r=n.scrollTop();e()&&s()})}}}])}),define("dominator/base/directives/controls/ui.selectTable",["angular","../../helpers/moduleHelper","angular-base64"],function(e,t){var n=e.module("aliyun.buy.ui.selectTable",t.getModuleNames(arguments));return n.directive("aliyunBuySelectTable",["$timeout",function(n){return{restrict:"AE",replace:!0,scope:{value:"=",list:"=options",ngDisabled:"=",detail:"=",config:"="},templateUrl:"dominator/base/partials/aliyunBuySelectTable.html",compile:function(r,i){return t.require(["detail"],i),function(t,r,i){function s(e){$.inArray(e.target,r[0].getElementsByTagName("*"))==-1&&e.target!==r[0]&&n(function(){t.open=!1})}e.extend(t,{check:function(n){t.open=!1,t.placeholder=n,t.value=e.toJson(n),t.detail=e.toJson(n)},openSelcet:function(e){n(function(){if(t.ngDisabled)return;t.open=!t.open})}});var o=e.element(document);o.bind("click",s),t.$on("$destroy",function(){o.unbind("click",s)}),t.$watch("value",function(r,s){if(r&&r!==s){var o=e.fromJson(r);n(function(){t.placeholder=o,t.detail=e.toJson(o)})}else n(function(){t.placeholder=i.placeholder,t.placeholderIcon=undefined})})}}}}]),n}),define("dominator/base/directives/controls/ui.slider",["angular"],function(e){return e.module("aliyun.buy.ui.slider",[]).directive("aliyunBuySlider",["$timeout",function(t){return{restrict:"AE",replace:!0,templateUrl:"dominator/base/partials/aliyunBuyTool/slider.html",scope:{stepOption:"=",maxValue:"=",minValue:"=",step:"=",unit:"=",getFormatter:"&formatter",value:"=",labelId:"=",isDisabled:"=",spm:"@"},link:function(t,n,r){var i=0;n.hasClass("bk-slider-duration")?(i=528,t.isDuration=!0):i=412;var s=function(e){return e=="bk-slider-l2"?198:e=="bk-slider-l1"?103:e=="bk-slider-mm"?40:e=="bk-slider-yy"?56:0},o=function(n){return e.forEach(t._stepOption,function(e){e.step!==1&&n<=e.max&&n>e.min&&n%e.step&&(n=e.step-n%e.step+n)}),n<t.minValue?n=t.minValue:n>t.maxValue&&(n=t.maxValue),n},u=function(n){if(n==0)return 0;if(n==1)return t.maxValue;var r=n*i,o=0,u=0,a=!0,f=0,l=0;return e.forEach(t._stepOption,function(e,n){a&&(u=o+s(e.css),f+=e.max,r>o&&r<=u&&(l=e.min+(e.max-e.min)*(r-o)/s(e.css),t.selectIndex=n,a=!1),o=u,r>u&&n==t._stepOption.length-1&&(l=t.maxValue,a=!1))}),l=Math.ceil(l),l},a=function(n){if(n==0)return-8;if(!n)return i-10;var r=!0,o=0,u=0;return e.forEach(t._stepOption,function(e,i){r&&(n>e.min&&n<=e.max&&(u=(n-e.min)/(e.max-e.min)*s(e.css)+o,t.selectIndex=i,r=!1),o+=s(e.css))}),u>i?i:u};e.extend(t,{unmove:!0,down:function(r){if(t.isDisabled)return;if(r.type==="keydown"&&r.keyCode!==37&&r.keyCode!==39)return;r.keyCode===37?r.pageX=$(r.target).offset().left-i/t._stepOption.length-5:r.keyCode===39&&(r.pageX=$(r.target).offset().left+10);var s=(r.pageX-$(r.currentTarget).offset().left-16)*100/i;s=s>=100?100:s,t.value=u(s/100),t.maskWidth={width:+s+"%"},t.barLeft={left:s+"%"};var o=r;e.element("body").bind("mousemove",function(e){t.$apply(function(){t.unmove=!1;var r=(e.pageX-8-$(o.currentTarget).offset().left)/i;r=r>.99999?1:r,r=r<1e-5?0:r;var s=u(r);s<t.minValue&&(s=t.minValue),s>t.maxValue&&(s=t.maxValue);if(!!s||s==0)t.value=s;t.maskWidth={width:r*i+"px"},t.barLeft={left:r?r*i-(n.hasClass("bk-slider-duration")?0:8):"-8px"}})}),e.element("body").bind("mouseup",function(){if(t.isDisabled)return;t.$apply(function(){e.element("body").unbind("mousemove"),e.element("body").unbind("mouseup");var n=a(t.value);t.maskWidth={width:n+"px"},t.barLeft={left:n+"px"},t.unmove=!0})}),r.preventDefault()}}),t.$watch("value",function(e,n){if(e!=0&&!e)return t.value=n;if(parseInt(e)!=parseInt(n)&&t.unmove){var r=a(e);t.unmove&&(t.value=o(parseInt(e))),t.maskWidth={width:r+"px"},t.barLeft={left:r+"px"}}}),t.$watch("unmove",function(e,n){e&&e!=n&&(t.value=o(parseInt(t.value)))}),t.$watchCollection("[stepOption,minValue,maxValue]",function(n,r){var i=t.maxValue;if(n[0]){if(e.isString(t.stepOption))t._stepOption=[{step:t.step,min:0,max:Math.floor(i/4),css:"bk-slider-l2"},{step:t.step,min:Math.floor(i/4),max:Math.floor(i/2),css:"bk-slider-l1"},{step:t.step,min:Math.floor(i/2),max:t.maxValue,css:"bk-slider-l1"}];else if(e.isNumber(t.stepOption)){if(t.minValue+Math.floor(i/2)<t.stepOption)return t.stepOption="auto";t._stepOption=[{step:t.step,min:0,max:t.stepOption,css:"bk-slider-l2"},{step:t.step,min:t.stepOption,max:Math.floor(i/2),css:"bk-slider-l1"},{step:t.step,min:Math.floor(i/2),max:t.maxValue,css:"bk-slider-l1"}]}else e.isArray(t.stepOption)&&(t._stepOption=t.stepOption);var s=t.getFormatter(),o=t.unit;e.forEach(t._stepOption,function(e){s?e.textLable=s?s(e.max):e.max:o&&(e.textLable=o?e.max+o:e.max)});var u=a(t.value);t.maskWidth={width:u+"px"},t.barLeft={left:u+"px"}}})}}}])}),define("dominator/base/directives/controls/ui.timepicker",["angular"],function(e){return e.module("aliyun.buy.ui.timepicker",[]).constant("aliyunBuyTimepickerConfig",{hourStep:1,minuteStep:1,showMeridian:!0,meridians:null,readonlyInput:!1,mousewheel:!0}).directive("aliyunBuyTimepicker",["$parse","$log","aliyunBuyTimepickerConfig","$locale",function(t,n,r,i){return{restrict:"EA",require:"?^ngModel",replace:!0,scope:{hideIncrementHours:"@",hideIncrementMinutes:"@"},templateUrl:"dominator/base/partials/aliyunBuyTimepicker.html",link:function(s,o,u,a){function f(){if(a.$error.time){var t=l(),n=c();e.isDefined(t)&&e.isDefined(n)&&(b.setHours(t),v())}else g()}function l(){var e=parseInt(s.hours,10),t=s.showMeridian?e>0&&e<13:e>=0&&e<24;return t?(s.showMeridian&&(e===12&&(e=0),s.meridian===w[1]&&(e+=12)),e):undefined}function c(){var e=parseInt(s.minutes,10);return e>=0&&e<60?e:undefined}function h(t){return e.isDefined(t)&&t.toString().length<2?"0"+t:t}function p(){if(s.mousewheel){var e=function(e){e.originalEvent&&(e=e.originalEvent);var t=e.wheelDelta?e.wheelDelta:-e.deltaY;return e.detail||t>0};N.bind("mousewheel wheel",function(t){s.$apply(e(t)?s.incrementHours():s.decrementHours()),t.preventDefault()}),C.bind("mousewheel wheel",function(t){s.$apply(e(t)?s.incrementMinutes():s.decrementMinutes()),t.preventDefault()})}else N.unbind("mousewheel wheel"),C.unbind("mousewheel wheel")}function d(){if(!s.readonlyInput){var t=function(t,n){a.$setViewValue(null),a.$setValidity("time",!1),e.isDefined(t)&&(s.invalidHours=t),e.isDefined(n)&&(s.invalidMinutes=n)};s.updateHours=function(){var n=l();e.isDefined(n)?(b.setHours(n),v("h")):t(!0)},N.bind("blur",function(e){!s.validHours&&s.hours<10&&s.$apply(function(){s.hours=h(s.hours)})}),s.updateMinutes=function(){var n=c();e.isDefined(n)?(b.setMinutes(n),v("m")):t(undefined,!0)},C.bind("blur",function(e){!s.invalidMinutes&&s.minutes<10&&s.$apply(function(){s.minutes=h(s.minutes)})})}else s.updateHours=e.noop,s.updateMinutes=e.noop}function v(e){m(),a.$setViewValue(new Date(b)),g(e)}function m(){a.$setValidity("time",!0),s.invalidHours=!1,s.invalidMinutes=!1}function g(e){var t=b.getHours(),n=b.getMinutes();s.showMeridian&&(t=t===0||t===12?12:t%12),s.hours=e==="h"?t:h(t),s.minutes=e==="m"?n:h(n),s.meridian=b.getHours()<12?w[0]:w[1]}function y(e){var t=new Date(b.getTime()+e*6e4);b.setHours(t.getHours(),t.getMinutes()),v()}if(!a)return;var b=new Date,w=e.isDefined(u.meridians)?s.$parent.$eval(u.meridians):r.meridians||i.DATETIME_FORMATS.AMPMS,E=r.hourStep;u.hourStep&&s.$parent.$watch(t(u.hourStep),function(e){var t=parseInt(e,10);isNaN(t)||(E=t)});var S=r.minuteStep;u.minuteStep&&s.$parent.$watch(t(u.minuteStep),function(e){var t=parseInt(e,10);isNaN(t)||(S=t)});var x=function(e){return typeof e=="boolean"||["true","false"].indexOf(e)>-1};u.$observe("showMeridian",function(e){s.showMeridian=x(e)?s.$eval(e):r.showMeridian,f()});var T=o.find("input"),N=T.eq(0),C=T.eq(1);u.$observe("mousewheel",function(e){s.mousewheel=x(e)?s.$eval(e):r.mousewheel,p()}),u.$observe("readonlyInput",function(e){s.readonlyInput=x(e)?s.$eval(e):r.readonlyInput,d()}),a.$render=function(){var e=a.$modelValue?new Date(a.$modelValue):null;isNaN(e)?(a.$setValidity("time",!1),n.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(e&&(b=e),m(),g())},s.incrementHours=function(){y(E*60)},s.decrementHours=function(){y(-E*60)},s.incrementMinutes=function(){y(S)},s.decrementMinutes=function(){y(-S)},s.toggleMeridian=function(){y(720*(b.getHours()<12?1:-1))}}}}])}),define("dominator/base/directives/controls/ui.tip",["angular","../../helpers/moduleHelper"],function(e,t){return e.module("aliyun.buy.ui.tip",[]).run(["$templateCache",function(e){e.put("alyunBuyOrangeTooltip",['<div class="bk-scope bk-tip-orange" style="">','<span ng-bind-html="aliyunBuyTip"></span>','<span class="bk-tip-arrow" ></span>',"</div>"].join("")),e.put("alyunBuyWhiteTooltip",['<div class="bk-scope bk-tip-white" style="">','<span ng-bind-html="aliyunBuyTip"></span>','<span class="bk-tip-arrow">','<span class="bk-tip-arrow-inner"></span>',"</span>","</div>"].join("")),e.put("alyunBuyPopover",['<div class="bk-scope bk-title" style="margin-top: 10px;">','<div class="bk-title-box">','<div class="bk-title-body" ng-bind-html="aliyunBuyTip">',"</div>","</div>","</div>"].join("")),e.put("alyunBuyRegionPopover",['<div class="bk-scope bk-title" style="margin-top: 10px;min-height: 176px;"  aliyun-buy-preloader="!(_aliyunBuyTip.length > 0)">','<div class="bk-title-box" style="min-height: 176px;">','<div class="bk-title-body" >','<table class="sedi-buy-region-table" style="margin: auto;">',"<thead>","<tr>",'<th ng-repeat="i in _aliyunBuyTip[0]  track by $index">{{_aliyunBuyTip[0][$index]}}</th>',"</tr>","</thead>","<tbody>",'<tr ng-repeat="ii in _aliyunBuyTip" ng-if="$index != 0">','<td  ng-repeat="i in ii track by $index">{{ii[$index]}}</td>',"</tr>","</tbody>","</table>","</div>","</div>","</div>"].join(""))}]).directive("aliyunBuyTip",["$compile","$timeout","$templateCache","$parse",function(n,r,i,s){return{restrict:"AE",scope:{template:"=",trigger:"=",placement:"@",width:"@",height:"@",left:"@",top:"@",aliyunBuyTip:"@",open:"="},compile:function(s,o){t.require(["open"],o);var u=['<div ng-click="click($event)" ng-mouseenter="mouseenter()" ng-mouseleave="mouseleave()" style="z-index:',o.zIndex?o.zIndex:1200,";height:",o.height,"px;width:",o.width?o.width+"px":"auto",';position: absolute;left:" ng-style="style" ng-show="open"><div style="position: relative;">',i.get(o.template?o.template:"alyunBuyOrangeTooltip"),"</div></div>"].join("");return function(t,i,s){function o(){var e=0,n=0;return s.height?"":s.height=20,!s.placement||s.placement=="top"?n=0-parseInt(s.height):s.placement=="bottom"&&(n=5),s.isAppendBody&&(!s.placement||s.placement=="top"?(e=i.offset().left,n=i.offset().top-parseInt(s.height)):s.placement=="bottom"&&(e=i.offset().left,n=i.offset().top+20)),s.left&&(e=parseInt(s.left)),s.top&&(n=parseInt(s.top)),s.right?t.style={right:parseInt(s.right),top:n}:t.style={left:e,top:n}}try{t.$parent.$watch(s.aliyunBuyTip,function(e){t._aliyunBuyTip=e})}catch(a){}s.isAppendBody?e.element("body").append(n(u)(t)):i.append(n(u)(t)).css("position","relative");if(t.trigger==="hover"){var f=!1;t.mouseleave=function(){t.open=!1},t.mouseenter=function(){f=!0},i.bind("mouseover",function(){t.$apply(function(){f=!1,o(),t.open=!0})}),i.bind("mouseleave",function(){r(function(){t.open=f},300)})}else t.trigger==="click"?(i.bind("click",function(n){e.element("body").trigger("click"),t.$apply(function(){o(),t.open=!0}),n.stopPropagation(),e.element("body").bind("click",function(n){t.$apply(function(){t.open=!1}),t.open||e.element("body").unbind("click")})}),t.click=function(e){e.stopPropagation()}):(t.open=t.trigger,t.$watch("trigger",function(e){e&&o(),t.open=e}));t.$on("bodyChangeTip",function(){var e=i.data("time");e&&r.cancel(e),i.data("time",r(function(){o()},50))})}}}}])}),define("dominator/base/directives/controls/ui.filedTips",["angular","../../helpers/moduleHelper"],function(e,t){var n=e.module("aliyun.buy.ui.fieldTips",[]);return n.directive("aliyunBuyFieldTips",function(){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuyFieldTips.html",replace:!0,link:function(){}}}).directive("aliyunBuyFieldRowTip",function(){return{restrict:"EA",template:['<div class="bk-form-row-txt" ',' ng-bind-html="options.tip" ',' ng-show="options.tip"> ',"</div>"].join(""),replace:!0,link:function(){}}}).directive("aliyunBuyLabelInfo",["$compile","$sce",function(e,t){return{restrict:"EA",replace:!0,scope:{value:"="},template:["<span>",'   <span class="bk-form-row-name" ','     ng-show="value"> ',"   </span>","</span>"].join(""),link:function(t,n,r){t.$watch("value",function(r){r&&(n.find(".bk-form-row-name").html(r),e(n.contents())(t))})}}}]),n}),define("dominator/base/directives/controls/ui.utils",["angular","jQuery","angular-animate"],function(e,t){var n=e.module("aliyun.buy.ui.utils",["ngAnimate"]);return n.directive("aliyunBuyDelayDirective",["$compile","$timeout",function(e,t){return{restrict:"A",link:function(n,r,i){var s=i.aliyunBuyDelayDirective;t(function(){r.attr(s,""),r.removeAttr("aliyun-buy-delay-directive"),e(r)(n)})}}}]),n.directive("aliyunBuyDisableNgAnimate",["$animate",function(e){return{restrict:"A",link:function(t,n,r){e.enabled(!1,n)}}}]),n.directive("aliyunBuyLoadingMonitor",[function(){return{restrict:"A",link:function(t,n,r){var i=r.aliyunBuyLoadingMonitor;if(!i)return;e.element(document).ready(function(){n.removeClass(i)})}}}]),n.directive("aliyunBuyDomCache",function(){return{restrict:"A",link:function(n,r,i){var s=i.aliyunBuyDomCache;if(!s)return;var o;try{o=n.$eval(s)}catch(u){}if(!e.isDefined(o))o={id:s};else if(typeof o=="string")o={id:o};else if(!o.id)return;var a=window.localStorage.getItem("aliyun.buy.ui.domCache."+o.id),f;a&&(f=t("<div></div>"),f.append(a),r.addClass("bk-fakehide"),f.insertAfter(r));var l=o.trigger||"aliyunBuyDomCacheTriggerEvent";n.$on(l,function(e,t){f&&f.remove(),r.show(),r.removeClass("bk-fakehide"),window.localStorage.setItem("aliyun.buy.ui.domCache."+o.id,r.html())})}}}),n}),define("dominator/base/directives/controls/ui.buttonWithSelect",["angular","./ui.select"],function(e){var t=e.module("aliyun.buy.ui.buttonWithSelect",[]);return t.directive("aliyunBuyButtonWithSelect",function(){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuyButtonWithSelect.html",replace:!0,scope:{isSelected:"@",parentValue:"=",parentDetail:"=",childValue:"=",childDetail:"=",childOptions:"=",parentIconClass:"@",parentTip:"@"},transclude:!0,link:function(e,t,n){}}}),t}),define("dominator/base/directives/controls/ui.buttontabWithSelect",["angular","./../../helpers/constraintHelper","./../../helpers/moduleHelper","./ui.select"],function(e,t,n){var r=e.module("aliyun.buy.ui.buttontabWithSelect",[]);return r.directive("aliyunBuyButtontabWithSelect",function(){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuyButtontabWithSelect.html",replace:!0,scope:{parentValue:"=",parentDetail:"=",options:"=",value:"=",childValue:"=",childDetail:"="},transclude:!0,link:function(e,r,i){function s(t,n){if(!e.parentValue||n)e.parentValue=t.value}function o(t){e.parentValue=t.value}function u(){if(!e.parentValue||!e.options)return;if(!t.contains(e.options.items,e.parentValue,"value")){var n=a();s(n,!0);return}var r=e.valueMap[e.parentValue];e.childValue=r}function a(){var t=e.options&&e.options.items&&e.options.items[0];if(!t)return;return t}e.valueMap={},e.select=function(e){o(e),u()},e.$watch("options",function(){var e=a();e&&s(e)}),e.$watch("parentValue",function(){u()}),e.$watch("valueMap",function(){u()},!0),e.$watch("childValue",function(){if(!e.childValue||!e.options||!e.options.items)return;var t=e.childValue,r=n.getSelectedItem(e.options.items,e.parentValue,!0),i=r&&r.children&&r.children.items;if(i){var s=n.getSelectedItem(i,t,!0);s&&s.value?e.valueMap[e.parentValue]=e.childValue:e.valueMap[e.parentValue]=e.childValue=i[0].value}})}}}),r}),define("dominator/base/directives/controls/_baseForDominator",["angular","../../helpers/moduleHelper","./ui.anchor","./ui.button","./ui.buttontab","./ui.checkbox","./ui.datepicker","./ui.dialog","./ui.floats","./ui.group","./ui.msg","./ui.notice","./ui.numberOnly","./ui.numberStepper","./ui.pagination","./ui.placeholder","./ui.position","./ui.preloader","./ui.select","./ui.selectDynamic","./ui.selectTable","./ui.slider","./ui.timepicker","./ui.tip","./ui.filedTips","./ui.transition","./ui.utils","./ui.buttonWithSelect","./ui.buttontabWithSelect"],function(e,t){return e.module("aliyun.buy.ui.controls",t.getModuleNames(arguments))}),define("dominator/base/services/service.configurable",["angular"],function(e){var t=e.module("aliyun.buy.service.configurable",[]);return t.factory("aliyunBuyConfigurable",[function(){function t(e){r(e),n(e),i(e)}function n(e){var t=function(){var t=e.config();if(!t)return;var n=e.options;if(!n)return;typeof t.tip=="string"&&(n.tip=t.tip)};e.$watchCollection("[config().tip, options.tip]",t),t()}function r(e){var t=function(){var t=e.config();if(!t)return;var n=e.options;if(!n)return;typeof t.visible=="boolean"&&(n.visible=t.visible)};e.$watchCollection("[config().visible, options.visible]",t),t()}function i(t){var n=function(){var n=t.options;if(!n)return;var r=n.items;if(!r)return;var i=t.config();if(!i)return;var s=i.values,o=i.extras;if(!s&&!o)return;if(o instanceof Array){var u=[];e.forEach(o,function(t,n){var i;e.forEach(r,function(e){e.value==t.value&&(i=!0)}),i||u.push(t)}),r=r.concat(u)}if(s instanceof Array){var a=[];e.forEach(r,function(t,n){var r;e.forEach(s,function(e){t.value==e&&(r=!0)}),r&&a.push(t)}),r=a}t.options.items=r};t.$watchCollection("options.items",n),t.$watch("config()",n,!0),n()}return{apply:t}}]),t}),define("dominator/base/directives/widgets/bricks/ui.selectBrick",["angular","../../../helpers/moduleHelper","../../../services/service.configurable","../../controls/ui.select"],function(e,t){var n=e.module("aliyun.buy.ui.selectBrick",t.getModuleNames(arguments));return n.directive("aliyunBuyBricksSelect",["aliyunBuyConfigurable",function(e){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuyBricks/selects.html",scope:{options:"=",value:"=ngModel",detail:"=",labelId:"@",config:"&"},replace:!0,compile:function(n,r){return t.require(["options","value","detail"],r),function(n,r,i){e.apply(n),t.setDefault(n,{detail:{},options:{},select:{}}),n.options.size=="long"?n.select.long="true":n.select.long="",n.options.size=="short"?n.select.short="true":n.select.short=""}}}}]),n}),define("dominator/base/directives/widgets/bricks/ui.tabsBrick",["angular","../../../helpers/moduleHelper","../../../services/service.configurable","../../controls/ui.buttontab"],function(e,t){var n=e.module("aliyun.buy.ui.tabsBrick",t.getModuleNames(arguments));return n.directive("aliyunBuyBricksTabs",["aliyunBuyConfigurable",function(e){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuyBricks/tabs.html",scope:{options:"=",value:"=ngModel",detail:"=",config:"&"},replace:!0,compile:function(n,r){return t.require(["options","value","detail"],r),{post:function(n,r,i){e.apply(n),t.setDefault(n,{detail:{},options:{}})}}}}}]),n}),define("dominator/base/directives/widgets/bricks/ui.sliderWithNumber",["angular","../../../helpers/moduleHelper","../../controls/ui.slider"],function(e,t){var n=e.module("aliyun.buy.ui.sliderWithNumber",t.getModuleNames(arguments));return n.directive("aliyunBuySliderWithNumber",function(){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuyBricks/sliderWithNumber.html",scope:{options:"=",value:"=ngModel",labelId:"@",config:"&"},replace:!0,link:function(e){t.setDefault(e,{options:{},value:1}),t.setDefault(e.options,{stepOption:"auto",min:0,max:1e3,unit:"GB"}),e.$watchCollection("[options.unit, options.numberUnit]",function(){var t=e.options;if(!t)return;t.numberUnit||(t.numberUnit=t.unit)})}}}),n}),define("dominator/base/directives/widgets/bricks/ui.selectLinkage",["angular","../../../helpers/moduleHelper","../../controls/ui.floats","../../controls/ui.select"],function(e,t){var n=e.module("aliyun.buy.select.linkage",t.getModuleNames(arguments));return n.directive("aliyunBuySelectLinkage",[function(){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuyBricks/selectLinkage.html",scope:{options:"=?",value:"=?ngModel",detail:"=?",rootValue:"=?",childrenValue:"=?",childrenDetail:"=?",labelId:"@",rootDetail:"=?"},replace:!0,compile:function(n,r){return t.require(["options","value","detail"],r),{post:function(t,n,r){t.$watchCollection("[rootValue, options.items]",function(){var n=t.options;if(!n||!e.isArray(n.items)||n.items.length==0){t.childrens=undefined;return}for(var r=0;r<n.items.length;r++){var i=n.items[r],s=i.childrens;if(!s)continue;if(t.rootValue==i.value){t.childrens=s;break}}r>=n.items.length&&(t.childrens=undefined)}),t.$watchCollection("[childrenValue, rootDetail, childrenDetail]",function(){t.value=e.toJson([t.rootValue,t.childrenValue]),t.detail={rootDetail:t.rootDetail,childrenDetail:t.childrenDetail}})}}}}}]),n}),define("dominator/base/directives/controls/ui.newButtonTab",["angular","../../helpers/moduleHelper","../controls/ui.button"],function(e,t){var n=e.module("aliyun.buy.ui.newButtontab",["aliyun.buy.ui.button"]);return n.directive("aliyunNewBuyButtontab",function(){return{templateUrl:"dominator/base/partials/aliyunBuyButton/aliyunNewBuyButtontab.html",scope:{options:"=",detail:"=",config:"=",value:"=ngModel"},transclude:!0,link:function(e,n,r){e.selectItem=function(t){e.updateValue(t.value)},e.updateValue=function(n){var r=e.options||{},i=r.items||[],s=t.getSelectedItem(i,n);e.value=s.value,e.detail={text:s.text,value:s.value}},e.$watch("value",function(t,n){n!=t&&e.updateValue(t)}),e.$watch("options.items",function(t,n){t&&e.updateValue(e.value)})}}}),n}),define("dominator/base/directives/widgets/bricks/ui.newBrickTabs",["angular","../../../helpers/moduleHelper","../../controls/ui.newButtonTab"],function(e,t){function n(){return{templateUrl:"dominator/base/partials/aliyunBuyBricks/newBrickTabs.html",scope:{options:"=",value:"=ngModel",detail:"="},link:function(e,t,n){var r=e.options||{};e.config={theme:r.theme||"bricktab"}}}}function r(){return{templateUrl:"dominator/base/partials/aliyunBuyBricks/newBrickRemarkTabs.html",scope:{options:"=",value:"=ngModel",detail:"="},link:function(e,t,n){var r=e.options||{};e.config={theme:r.theme||"remarkRich",transclude:!0}}}}var i=e.module("aliyun.buy.ui.newBrickTabs",t.getModuleNames(arguments));return i.directive("aliyunBuyNewBrickTabs",n),n.$inject=[],i.directive("aliyunBuyNewBrickRemarkTabs",r),r.$inject=[],i}),define("dominator/base/directives/widgets/ui.amount",["angular","../../helpers/moduleHelper","../../services/service.configurable","../controls/ui.numberStepper"],function(e,t){var n=e.module("aliyun.buy.ui.amount",t.getModuleNames(arguments));return n.directive("aliyunBuyAmount",["aliyunBuyConfigurable","$filter",function(e,n){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuyAmount.html",scope:{options:"=",value:"=ngModel",config:"&"},replace:!0,link:function(r,i,s){e.apply(r),t.setDefault(r,{options:{}}),t.setDefault(r.options,{min:1,max:null,available:null,showLimitMsg:!1,prodName:""}),r.lang=n("aliyunBuyText"),r.$watch("options.min",function(e){var t=parseInt(e);if(isNaN(t))return;var n=parseInt(r.value);r.value=n-t>0?n:t}),r.$watch("value",function(){r.options&&(r.options.state="")})}}}]),n}),define("dominator/base/directives/widgets/ui.orderButton",["angular","../../helpers/moduleHelper"],function(e,t){var n=e.module("aliyun.buy.ui.order.button",t.getModuleNames(arguments));return n.directive("aliyunBuyOrderButton",[function(){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuyOrderButton.html",scope:{config:"=",isDisabled:"=",termsChecked:"="},replace:!0,link:function(e,t){e.pay=function(){if(e.termsChecked!=undefined&&!e.termsChecked||e.isDisabled)return;e.$emit("aliyunBuyOrderButton:payOrder")}}}}]),n}),define("dominator/base/directives/widgets/ui.comboDuration",["angular","../../helpers/moduleHelper","../../services/service.configurable","../controls/ui.select"],function(e,t){var n=e.module("aliyun.buy.ui.comboDuration",t.getModuleNames(arguments));return n.directive("aliyunBuyComboDuration",["aliyunBuyConfigurable","$timeout",function(n,r){function i(r,i,s){function o(e){e=t.parseJsonSafe(e);if(!(e instanceof Array))return;var n=u[e[1]].max;r.unit=e[1],r.duration=e[0]>n?1:e[0]}n.apply(r),t.setDefault(r,{detail:{},options:{},unit:"month",duration:1}),t.setDefault(r.options,{name:""}),r.units=[{text:"",value:"month"},{text:"",value:"year"}];var u={year:{unitText:"",max:3},month:{unitText:"",max:9}};r.$watch("unit",function(e){if(["month","year"].indexOf(e)==-1)return;var t=u[e];r.durations=function(){var e=[];for(var n=0;n<t.max;n++)e.push({text:n+1+t.unitText,value:n+1});return e}(),r.duration=r.duration>t.max?1:r.duration}),r.$watch("duration",function(e,t){!e&&t&&(r.duration=t)}),r.$watchCollection("[unit,duration]",function(){if(!r.unit||typeof r.duration!="number")return;r.value=e.toJson([r.duration,r.unit],!0)}),r.$watch("value",o),o(r.value)}var s={restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuyComboDuration.html",scope:{options:"=",value:"=",detail:"=",config:"&"},replace:!0,compile:function(e,n){return t.require(["options","value","detail"],n),{post:i}}};return s}]),n}),define("dominator/base/directives/widgets/ui.datepick",["angular","../../helpers/moduleHelper","../controls/ui.slider"],function(e,t){var n=e.module("aliyun.buy.ui.datepick",t.getModuleNames(arguments));return n.directive("aliyunBuyDatepick",["$filter",function(e){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuyDatepick.html",scope:{options:"=",value:"=",config:"&"},replace:!0,link:function(n){function r(e){return e<10?"0"+e:e}t.setDefault(n,{options:{},pickHours:0}),t.setDefault(n.options,{name:"",stepOption:"auto",min:0,max:23,unit:"",formatter:function(e){return e+"M"}}),n.date={},n.$watchCollection("[date.pickDate, pickHours]",function(t){if(!t[0])return;var i=new Date(t[0]),s=i.getFullYear()+"-"+r(i.getMonth()+1)+"-"+r(i.getDate());n.value=e("json")([s,r(t[1])]),n.options.state=""},!0),n.$watch("date.pickDate",function(e){if(!e||!n.options.restartDateTime)return;n.formatDate("yyyy-MM-dd",e)==n.formatDate("yyyy-MM-dd",new Date(n.options.restartDateTime))?n.options.min=(new Date(n.options.restartDateTime)).getHours():n.options.min=0;var t=new Date;n.formatDate("yyyy-MM-dd",e)==n.formatDate("yyyy-MM-dd",t)&&(t.getMinutes()>0?n.options.min=(new Date).getHours()+2:n.options.min=(new Date).getHours()+1),n.pickHours<n.options.min&&(n.pickHours=n.options.min)}),n.formatDate=function(e,t){var n={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in n)(new RegExp("("+r+")")).test(e)&&(e=e.replace(RegExp.$1,RegExp.$1.length==1?n[r]:("00"+n[r]).substr((""+n[r]).length)));return e}}}}]),n}),define("dominator/base/directives/widgets/ui.duration",["angular","../../helpers/moduleHelper","../controls/ui.buttontab","../controls/ui.tip","../../services/service.configurable"],function(e,t){var n=e.module("aliyun.buy.ui.duration",t.getModuleNames(arguments));return n.directive("aliyunBuyDuration",["$filter","aliyunBuyConfigurable",function(n,r){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuyDuration.html",scope:{value:"=ngModel",detail:"=",options:"=",config:"&",defaultValue:"@"},replace:!0,link:function(i){r.apply(i),!i.options&&(i.options={}),i.defaultValue=i.defaultValue||i.options.defaultValue,t.setDefault(i,{_value:i.defaultValue||i.defaultValue==0?i.defaultValue:1}),t.setDefault(i.options,{min:"1",max:"36",unit:"",stepOption:[{step:1,min:0,max:1,css:"bk-slider-mm"},{step:1,min:1,max:2,css:"bk-slider-mm"},{step:1,min:2,max:3,css:"bk-slider-mm"},{step:1,min:3,max:4,css:"bk-slider-mm"},{step:1,min:4,max:5,css:"bk-slider-mm"},{step:1,min:5,max:6,css:"bk-slider-mm"},{step:1,min:6,max:7,css:"bk-slider-mm"},{step:1,min:7,max:8,css:"bk-slider-mm"},{step:1,min:8,max:9,css:"bk-slider-mm"},{step:3,min:9,max:12,css:"bk-slider-yy"},{step:12,min:12,max:24,css:"bk-slider-yy"},{step:12,min:24,max:36,css:"bk-slider-yy"}],formatter:function(e){return 12==e?"1":24==e?"2":36==e?"3":e}});var s=function(e){var t=e,n="Month";return e>=10&&e<=12?(t=1,n="Year"):e>=13&&e<=24?(t=2,n="Year"):e>=25&&e<=36&&(t=3,n="Year"),[t,n]};i.$watch("_value",function(e,t){if(e<=9||e==12||e==24||e==36){var r=s(e);i.value=n("json")(r);var o={month:"",year:""};i.detail={text:r[0]+o[r[1]]}}});var o=function(t){var n=t?e.fromJson(t):null,r;return n&&n.length>0&&(n[1]=="Month"?r=parseInt(n[0]):n[1]=="Year"&&(n[0]==1?r=12:n[0]==2?r=24:n[0]==3&&(r=36))),r};i.$watch("value",function(e){i._value=o(e)}),i.$watch("autoRenew",function(t){var r=e.fromJson(i.value);r&&(r[2]=t),i.value=n("json")(r)})}}}]),n}),define("dominator/base/directives/widgets/ui.info",["angular","../../helpers/moduleHelper"],function(e,t){var n=e.module("aliyun.buy.ui.info",t.getModuleNames(arguments));return n.directive("aliyunBuyInfo",["aliyunBuyConfigurable",function(e){return{restrice:"EA",templateUrl:"dominator/base/partials/aliyunBuyInfo.html",scope:{options:"=",value:"=",detail:"=",config:"&"},replace:!1,link:function(n){e.apply(n),t.setDefault(n.options,{name:""})}}}]),n}),define("dominator/base/helpers/jQuery.fixer",["jQuery"],function(e){if(typeof e=="undefined")return new Function;var t=e,n={getTopWhenFeetHurt:function(e){return e.bodyHeight-e.bodyScrollTop-e.dollHeight-e.footerHeight}},r=function(e){this.fixer=e},i=function(e){this.fixer=e},s=function(e){this.fixer=e};r.prototype={scroll:function(e,t){var n=this;n.fixer.doll.recovery()}},i.prototype={scroll:function(e,t){var r=this,i=0;r.fixer.doll.isFixed()?e.direction=="up"&&t.dollHeightToTop<t.bodyScrollTop&&(i=r.fixer.doll.currentTop()+e.step,i>0&&(i=0)):t.dollFeetHurt&&(i=n.getTopWhenFeetHurt(t)),r.fixer.doll.fix(i,t.dollLeftOffset)}},s.prototype={scroll:function(e,t){var r=this,i=0;r.fixer.doll.isFixed()?t.dollFeetHurt?i=n.getTopWhenFeetHurt(t):e.direction=="down"&&t.hideFeetHeight>0?(i=r.fixer.doll.currentTop()-e.step,i<t.windowHeight-t.dollHeight&&(i=t.windowHeight-t.dollHeight)):e.direction=="up"&&t.dollHeightToTop<=t.bodyScrollTop?(i=r.fixer.doll.currentTop()+e.step,i>0&&(i=0)):i=r.fixer.doll.currentTop():t.dollFeetHurt&&(i=n.getTopWhenFeetHurt(t)),r.fixer.doll.fix(i,t.dollLeftOffset)}};var o=function(e){this.dom=t(e),this.initToTop=this.dom.offset().top,this.init()};o.prototype={init:function(){var e=this;e._bindEvent()},_bindEvent:function(){var e=this},getHeightToTop:function(){var e=this;return e.dom.offset().top},getHeightToBottom:function(){var e=this;return t(document.body).height-(e.dom.offset().top+e.getHeight())},getHeight:function(){var e=this;return e.dom.height()},recovery:function(){var e=this;e.dom.removeAttr("style")},currentTop:function(){var e=this;return parseInt(e.dom.css("top"),10)},isFixed:function(){var e=this;return e.dom.css("position")=="fixed"},fix:function(e,t){var n=this;n.dom.css({position:"fixed",top:e,left:t})}};var u=function(e){var n=this;n.state=undefined,n.lastWindowScrollTop=0,n.fixDouble=t("<div></div>"),n.fixDouble.attr("class",t(e).attr("class")),t(e).parent().prepend(n.fixDouble),n.parentBox=t(e).parent(),n.doll=new o(e),n.init()};return u.prototype={init:function(){var e=this;e._initState(),e.state=e.puppets,e._bindEvent()},_initState:function(){var e=this;e.puppets=new r(e),e.headClown=new i(e),e.feetClown=new s(e)},rerender:function(){var e=this,t=e._getContextInfo();e.scroll({direction:"up",step:1},t),e.scroll({direction:"down",step:1},t)},_isState:function(e){return this.state==e},_getScrollYInfo:function(){var e=this,n=t(document).scrollTop(),r=e.lastWindowScrollTop;e.lastWindowScrollTop=n;var i={direction:undefined,step:undefined};return r>n?(i.direction="up",i.step=r-n):r<n?(i.direction="down",i.step=n-r):(i.direction="sleep",i.step=0),i},_getContextInfo:function(){var e=this,n=t(window).height(),r=t(document).scrollTop(),i=t(document.body).height(),s=e.doll.getHeightToTop(),o=e.doll.getHeight(),u=i-e.parentBox.offset().top-e.parentBox.height(),a=e.fixDouble.height()+e.fixDouble.offset().top,f=o+s-(n+r),l=r>=a,c=s<a,h=i<r+n,p=o+s-(i-u)>=0,d=n<=o,v=e.fixDouble.offset().left,m={windowHeight:n,bodyScrollTop:r,bodyHeight:i,dollHeightToTop:s,dollHeight:o,dollLeftOffset:v,footerHeight:u,headerHeight:a,hideFeetHeight:f,dollAction:l,dollHeadache:c,dollFeetHurt:p,dollTooHigh:d,scrollBottom:h};return m},changeState:function(e,t){var n=this;t.dollAction?t.dollFeetHurt?n._isState(n.feetClown)||(n.state=n.feetClown):t.dollHeadache?n._isState(n.headClown)||(n.state=n.headClown):!t.dollFeetHurt&&!t.dollTooHigh&&!t.scrollBottom?n._isState(n.headClown)||(n.state=n.headClown):!t.dollFeetHurt&&t.dollTooHigh&&e.direction=="down"?n._isState(n.feetClown)||(n.state=n.feetClown):!t.dollFeetHurt&&t.dollTooHigh&&e.direction=="up"&&!t.scrollBottom&&(n._isState(n.headClown)||(n.state=n.headClown)):n._isState(n.puppets)||(n.state=n.puppets)},scroll:function(e,t){var n=this;n.state.scroll(e,t)},invoke:function(){var e=this._getScrollYInfo();if(e.direction=="sleep")return;var t=this._getContextInfo();this.changeState(e,t),this.scroll(e,t)},_bindEvent:function(){var n=this;t(window).on("scroll",e.proxy(n.invoke,this)),t(window).on("resize",function(){n.rerender()})}},u}),define("dominator/base/directives/widgets/ui.orderRoll",["angular","../../helpers/moduleHelper","../../helpers/jQuery.fixer"],function(e,t,n){var r=e.module("aliyun.buy.ui.orderRoll",t.getModuleNames(arguments));return r.directive("aliyunBuyOrderRoll",["$timeout",function(e){return{restrict:"A",link:function(e,t,r){var i=r.aliyunBuyOrderRoll;i?e.$on(i,function(){var e=new n(t);e.invoke()}):new n(t)}}}]),r}),define("dominator/base/directives/widgets/ui.yundun",["angular","../../helpers/moduleHelper","../../services/service.configurable"],function(e,t){var n=e.module("aliyun.buy.ui.yundun",t.getModuleNames(arguments));return n.directive("aliyunBuyYundun",["aliyunBuyConfigurable",function(e){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuyYundun.html",scope:{options:"=",value:"=",config:"&"},replace:!0,link:function(n,r,i){e.apply(n),t.setDefault(n,{options:{}})}}}]),n}),define("dominator/base/helpers/templateHelper",[],function(){return{render:function(e,t){var n=/\{[^}]*\}/gi;return typeof e=="string"?e.replace(n,function(e){return t[e.slice(1,e.length-1)]}):e}}}),define("dominator/base/helpers/paramsHelper",["./templateHelper"],function(e){return{paramsHanlder:function(t,n){var r={},i=/\{[^}]*\}/gi;return Object.keys(t).forEach(function(i){r[i]=e.render(t[i],n)}),r}}}),define("dominator/base/constants/aliyunConsResourceGroup",[],function(){return{requests:{listDirectories:{dataType:"jsonp",url:"//home.console.aliyun.com/nav/resource/listDirectories.js",params:{Type:"joined",timestamp:(new Date).getTime()}},listResourceGroups:{dataType:"jsonp",url:"//home.console.aliyun.com/nav/resource/listResourceGroups.js",params:{Status:"OK",AccountId:"{AccountId}",timestamp:(new Date).getTime()}}}}}),define("dominator/base/directives/widgets/ui.resourceGroup",["angular","../../helpers/moduleHelper","../../helpers/paramsHelper","common/helper/i18nHelper","../../constants/aliyunConsResourceGroup"],function(e,t,n,r,i){var s=e.module("aliyun.buy.ui.region",t.getModuleNames(arguments));return s.directive("aliyunBuyResourceGroup",["$rootScope","$http","$timeout","$q","viewFrameworkSetting","aliyunDialog","$filter",function(t,r,s,o,u,a,f){return{restrict:"A",replace:!1,value:"=ngModel",fieldId:"=",templateUrl:"dominator/base/partials/aliyunBuyResourceGroup.html",link:function(t,s,u){if(!t.$parent.vm)return;var l=jQuery,c={scope:t,requests:i.requests,listDirectories:function(){var t=this,n=t.scope,i=t.requests,s=o.defer(),u=i.listDirectories,a={},l=["Owned","Joined"];return e.forEach(l,function(t){a[t]=r({method:u.dataType,url:u.url,withCredentials:!0,params:e.extend({},u.params,{callback:"JSON_CALLBACK",Type:t})})}),o.all(a).then(function(t){var r=[],i=t.Owned.data.data.Directories,o=t.Joined.data.data.Directories;t.Owned.data.code!=="200"&&s.reject(t.Owned.data),e.forEach(i,function(e){r.push({text:e.DisplayName+" ("+f("aliyunBuyText")("resouceGroup.type.selfSupport")+")",value:e.OwnerId})}),e.forEach(o,function(e){r.push({text:e.DisplayName+" ("+f("aliyunBuyText")("resouceGroup.type.agent")+")",value:e.OwnerId})}),n.directories=r,n.directories.unshift({text:f("aliyunBuyText")("directories.defaultName"),isOwned:!1,value:"default"}),s.resolve(n)},function(){n.directories=[],s.reject(n)}),s.promise},listResourceGroups:function(t){var i=this,s=i.scope,u=i.requests,l=u.listResourceGroups,c=o.defer(),h={AccountId:t!=="default"?t:""};return s.loading=!0,r({method:l.dataType,url:l.url,withCredentials:!0,params:e.extend({},n.paramsHanlder(l.params,h),{callback:"JSON_CALLBACK"})}).then(function(t){var n=t.data.data;t.data.code!=="200"&&a.showMessageDialogSimple(f("aliyunBuyText")("resouceGroup.data.tip"),(t.data.code?t.data.code+":":f("aliyunBuyText")("resouceGroup.request.redirect"))+f("aliyunBuyText")("resouceGroup.request.resourceGroup.failed"));var r=[],i=n&&n.ResourceGroups&&n.ResourceGroups.ResourceGroup||[];e.forEach(i,function(e){r.push({isOwned:!1,text:e.DisplayName,value:e.Id})}),r.length==0&&r.unshift({text:f("aliyunBuyText")("resouceGroup.defaultName"),value:"default"}),s.resourceGroups=r,c.resolve(s)},function(){s.resourceGroups=[],c.reject(),s.loading=!1}),c.promise},render:function(){var t=this,n=t.scope;n.resourceOwnerId="",n.resourceGroupId=-1,n.currentSelectResourceGroup=f("aliyunBuyText")("resouceGroup.currentSelectResourceGroup"),n.noData=f("aliyunBuyText")("resouceGroup.noData"),n.resourceGroupChange=e.bind(t,t.resourceGroupChange),n.toggleResourceGroup=e.bind(t,t.toggleResourceGroup),n.listResourceGroups=e.bind(t,t.listResourceGroups),t.listDirectories().then(function(e){var r=n.directories=e.directories,i=r&&r.length>0&&r[0].value||"";t.listResourceGroups(i),n.$watch("directory",function(e,n){if(!n||!e)return;t.listResourceGroups(e)})},function(e){a.showMessageDialogSimple(f("aliyunBuyText")("resouceGroup.data.tip"),(e.code?e.code+":":f("aliyunBuyText")("resouceGroup.request.redirect"))+f("aliyunBuyText")("resouceGroup.request.directory.failed"))})}};c.render(),t.$watchCollection("[directory, resourceGroup]",function(n,r){n!=r&&(t.value=t.$parent.rawData[t.fieldId]=e.toJson(n))})}}}]),s}),define("dominator/base/directives/widgets/_base",["angular","../../helpers/moduleHelper","./bricks/ui.selectBrick","./bricks/ui.tabsBrick","./bricks/ui.sliderWithNumber","./bricks/ui.selectLinkage","./bricks/ui.newBrickTabs","./ui.amount","./ui.orderButton","./ui.comboDuration","./ui.datepick","./ui.duration","./ui.info","./ui.orderRoll","./ui.yundun","./ui.resourceGroup"],function(e,t){return e.module("aliyun.buy.ui.widgets",t.getModuleNames(arguments))}),define("dominator/base/directives/base/ui.tips",["angular","../../helpers/moduleHelper"],function(e,t){function n(){return{templateUrl:"dominator/base/partials/aliyunBuyBase/aliyunRemarkItem.html"}}function r(){return{templateUrl:"dominator/base/partials/aliyunBuyBase/aliyunBuyInlineSelect.html"}}function i(){return{replace:!0,templateUrl:"dominator/base/partials/aliyunBuyBase/aliyunBuyInlineTips.html"}}function s(){return{replace:!0,templateUrl:"dominator/base/partials/aliyunBuyBase/aliyunBuyBlockTips.html"}}var o=e.module("aliyun.buy.ui.tips",t.getModuleNames(arguments));return o.directive("aliyunRemarkItem",n),o.directive("aliyunBuyInlineSelect",r),o.directive("aliyunBuyInlineTips",i),o.directive("aliyunBuyBlockTips",s),o}),define("dominator/base/directives/base/_base",["angular","../../helpers/moduleHelper","./ui.tips"],function(e,t){return e.module("aliyun.buy.ui.base",t.getModuleNames(arguments))}),define("dominator/base/constants/cons",["angular"],function(e){"use strict";}),define("dominator/base/lang/zh",[],function(){return{COMMON_REGION_TIP:"&nbsp;<a href='http://help.aliyun.com/view/13433645.html' target='_blank' class='bk-lnk'>&gt;&gt;</a>",COMMON_REGION_VIEW_MY_PRODUCT_REGION:"",COMMON_REGION:"",COMMON_DURATION_TIP1:"1012",COMMON_DURATION_TIP2:"2024",COMMON_DURATION_TIP3:"3036",COMMON_AMOUNT:"",COMMON_AUTORENEW:"",COMMON_PRICE_ORIGIN:"",COMMON_PRICE_SAVE:"",COMMON_PRICE_TOTAL:"",COMMON_AMOUNT_LIMIT_TIP:" {1} {0} {2} {3} {0}",COMMON_SUBTOTAL_TITLE:"",COMMON_SUBTOTAL_CALCULATING_PRICE:"...",COMMON_SUBTOTAL_CALCULATING_PRICE_FAILED:"",COMMON_SUBTOTAL_BASE_PRICE:"",COMMON_SUBTOTAL_FLOW_PRICE:"",COMMON_SUBTOTAL_FLOW_PRICE_TIP:"<br/>16.51GB6.51GB*0.8/=5.20",COMMON_SUBTOTAL_BUTTON_BUY_NOW:"",COMMON_SUBTOTAL_BUTTON_ADD_TO_CART:"",COMMON_YUNDUN_TIP:"",COMMON_YUNDUN_TEXT:"",COMMON_NETWORKTYPE_LINK:"<a href=\"http://help.aliyun.com/view/13748516.html\" target='_blank' class='bk-lnk bk-ml1' hidefocus=''>&gt;&gt;</a>",COMMON_NETWORKTYPE_TIP:"<span class='bk-black'></span>BGP<div class=\"bk-hr\"></div><span class='bk-black'></span>IP<div class=\"bk-hr\"></div><span class='bk-black'></span>IP",COMMON_CART_TITLE:"",COMMON_CART_CALCULATING:"...",COMMON_CART_CALCULATING_PRICE_FAILED:"",COMMON_CART_BATCH_PURCHASE:"",COMMON_CART_VIEW_DETAIL:"",COMMON_FLOW_PRICE_TIP:"<br/> 1  6.51GB 6.51GB * 0.8  /  = 5.20 ","resouceGroup.defaultName":"","resouceGroup.currentSelectResourceGroup":"","resouceGroup.type.agent":"","resouceGroup.type.selfSupport":"","directories.defaultName":"","resouceGroup.noData":"","resouceGroup.data.tip":"","resouceGroup.request.redirect":"","resouceGroup.request.resourceGroup.failed":"","resouceGroup.request.directory.failed":""}}),define("dominator/base/lang/en",[],function(){return{COMMON_REGION_TIP:"CAUTION:Services in different regions cannot access each other. And it is not available to modify the region of your service after you purchase the service.",COMMON_REGION_VIEW_MY_PRODUCT_REGION:"View My Regions",COMMON_REGION:"Region",COMMON_DURATION_TIP1:"Pay 10 months to get 12 months' service!",COMMON_DURATION_TIP2:"Pay 20 months to get 24 months' service!",COMMON_DURATION_TIP3:"Pay 30 months to get 36 months' service!",COMMON_AUTORENEW:"Auto renew",COMMON_AMOUNT:"Amount",COMMON_AMOUNT_LIMIT_TIP:"You can totally buy {1}{0} {2}, currently you have already bought {3}{0}",COMMON_SUBTOTAL_TITLE:"Current Selected",COMMON_SUBTOTAL_CALCULATING_PRICE:"Calculating...",COMMON_SUBTOTAL_CALCULATING_PRICE_FAILED:"Pricing Failed",COMMON_SUBTOTAL_BASE_PRICE:"Base Price",COMMON_SUBTOTAL_FLOW_PRICE:"Network Flow Price",COMMON_SUBTOTAL_BUTTON_BUY_NOW:"Buy Now",COMMON_SUBTOTAL_BUTTON_ADD_TO_CART:"Add To List",COMMON_NETWORKTYPE_LINK:"<a href=\"http://help.aliyun.com/view/13748516.html\" target='_blank' class='bk-lnk bk-ml1' hidefocus=''>&gt;&gt;</a>",COMMON_NETWORKTYPE_TIP:"<span class='bk-black'></span>ECSBGP<div class=\"bk-hr\"></div><span class='bk-black'></span>IPECS<div class=\"bk-hr\"></div><span class='bk-black'></span>IP",COMMON_CART_TITLE:"Purchase List",COMMON_CART_CALCULATING:"Calculating...",COMMON_CART_CALCULATING_PRICE_FAILED:"Pricing Failed",COMMON_CART_BATCH_PURCHASE:"Batch Purchase",COMMON_CART_VIEW_DETAIL:"View Detail","resouceGroup.defaultName":"all","resouceGroup.currentSelectResourceGroup":"resourceGroup","resouceGroup.type.agent":"agent","resouceGroup.type.selfSupport":"self-support","directories.defaultName":"all","resouceGroup.noData":"No data","resouceGroup.data.tip":"Tip","resouceGroup.request.redirect":"Request Redirect Cause","resouceGroup.request.resourceGroup.failed":"Describe ResourceGroup Failed","resouceGroup.request.directory.failed":"Describe Directory Failed"}}),define("dominator/base/helpers/logger",["angular"],function(e){"use strict";var t=function(){var e="",t=new Date,n=t.getHours(),r=t.getMinutes(),i=t.getSeconds(),s=t.getMilliseconds();e+=n>9?n:"0"+n,e+=":",e+=r>9?r:"0"+r,e+=":",e+=i>9?i:"0"+i,e+=".",e+=s<10?"00"+s:s<100?"0"+s:s,window.console&&console.log&&console.log.apply&&arguments.length>0&&(arguments[0]="["+e+"] "+arguments[0],console.log.apply(console,arguments))},n={log:t,request:function(e,n){t("Mock Request:["+e+"] sending"+(n.length>0?" with args:":""),n.length>0?n:"")},response:function(e,n){t("Mock Request:["+e+"] responsed"+(n?" with data:":""),n||"")}};return n}),define("dominator/base/services/service.local",["angular","../helpers/logger","../helpers/moduleHelper","angular-base64"],function(e,t,n){var r=e.module("aliyun.buy.service.local",["ab-base64"]),i={};return e.injector(["ng","ab-base64"]).invoke(["$http","base64","$cacheFactory",function(t,r,s){i={getSavedOptions:function(e){if(!e)return;var t=window.sessionStorage,r=n.parseJsonSafe(t.getItem("aliyun.buy."+e+".options"));return r},clearOptions:function(e){var t=window.sessionStorage;t.removeItem("aliyun.buy."+e+".options")},saveOptions:function(t,n){if(!t||!n)return;var r=window.sessionStorage;r.setItem("aliyun.buy."+t+".options",e.toJson(n))},updateCartItems:function(t,n){if(!t||!n)return;var r=window.sessionStorage;r.setItem("aliyun.buy."+t+".cart",e.toJson(n))},getCartItems:function(e){if(!e)return;var t=window.sessionStorage;return n.parseJsonSafe(t.getItem("aliyun.buy."+e+".cart"))},updateCommonText:function(t,n){if(!t)return;n||(n=t,t="");var r=window.localStorage;r.setItem("aliyun.buy.common.text"+(t?"."+t:""),e.toJson(n))},getCommonText:function(e){e||(e="");var t=window.localStorage;return n.parseJsonSafe(t.getItem("aliyun.buy.common.text"+(e?"."+e:"")))},updateSubheaderData:function(t){if(!t)return;var n=window.localStorage;n.setItem("aliyun.buy.common.subheader",e.toJson(t))},getSubheaderData:function(e){var t=window.localStorage,r=n.parseJsonSafe(t.getItem("aliyun.buy.common.subheader"));return r?r[e]:undefined},updateBannerData:function(t){if(!t)return;var n=window.localStorage;n.setItem("aliyun.buy.common.banner",e.toJson(t))},getBannerData:function(e){var t=window.localStorage,r=n.parseJsonSafe(t.getItem("aliyun.buy.common.banner"));return r?r[e]:undefined}}}]),r.provider("aliyunBuyLocal",function(){var e=this;e.methods={},e.$get=[function(){function t(t){var n=e.methods;return n[t]instanceof Function?n[t]:i[t]}return{getSavedOptions:t("getSavedOptions"),saveOptions:t("saveOptions"),clearOptions:t("clearOptions"),updateCartItems:t("updateCartItems"),getCartItems:t("getCartItems"),updateCommonText:t("updateCommonText"),getCommonText:t("getCommonText"),updateSubheaderData:t("updateSubheaderData"),getSubheaderData:t("getSubheaderData"),updateBannerData:t("updateBannerData"),getBannerData:t("getBannerData")}}]}),r}),define("dominator/base/services/service.dict",["angular","angular-sanitize","../constants/cons","../helpers/moduleHelper","../lang/zh","../lang/en","../services/service.local"],function(e,t,n,r,i,s){var o=e.module("aliyun.buy.service.dict",["aliyun.buy.service.local","ngSanitize"]);return o.value("aliyunBuyTextServices",[]).value("aliyunBuyLang","zh").filter("aliyunBuyText",["aliyunBuyLocal","aliyunBuyTextServices","aliyunBuyLang","$sce",function(t,n,r,o){function u(e){if(!e)return"";var t=f?f[e]:undefined;return typeof t=="undefined"&&(t=e),t}function a(t,n){return t?n instanceof Array&&n.length!=0?(e.forEach(n,function(e,n){var r=new RegExp("\\{"+n+"\\}","g");t=t.replace(r,e)}),t):t:""}var f={};return r=="en"?f=s:f=i,function(t){if(!t)return"";var n=Array.prototype.slice.apply(arguments,[1,arguments.length]),r,i=t.match(/\@\{[^\}]*\}/g);return i?(e.forEach(i,function(e){var n=e.match(/\@\{()\}/),r=e.substring(2,e.length-1);t=t.replace(new RegExp(e,"g"),u(r))}),r=t):r=u(t),a(r,n)}}]),o.value("aliyunBuyPriceUnitMap",{}).filter("aliyunBuyPriceUnit",["aliyunBuyPriceUnitMap",function(e){return function(t){var r=n.UNITS.price;return r[t]||e[t]||""}}]),o.filter("aliyunBuyAccy",function(){return function(t,n){if(n=="cpu")return t+"";if(n=="memory")return parseInt(t)<1024?t+"MB":parseInt(t)/1024+"GB";if(n=="disk")return parseInt(t)/1024+"Mbps";if(n=="bandwidth")return parseInt(t)/1024+"Mbps";if(n=="duration"){var r=t;r=t?e.fromJson(r):null;if(r&&r.length>0){if(r[1]==="Month")return r[0]+"";if(r[1]==="Year")return r[0]+""}}else if(n=="pricing_cycle"||n=="pricingCycle"){if(t=="Month")return"";if(t=="Year")return""}else{if(n=="amount")return t+"";if(n=="ddosAmount")return t+"";if(n=="yundiskAmount")return t+"";if(n=="capacity")return parseInt(t)<1024?t+"MB":parseInt(t)/1024+"GB"}}}),o.filter("aliyunBuyToTrusted",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]),o.filter("aliyunBuyUnderline",function(){return function(e){return!e&&typeof e!="number"?" - ":e}}),o.filter("aliyunBuyRenewTimeFormat",function(){var e=function(e){var t=e-0;return t<10?"0"+t:t};return function(t){return t?t.getFullYear?t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())+" "+e(t.getHours())+":"+e(t.getMinutes()):"":""}}),o.filter("aliyunBuyMessage",["$sce",function(e){var t=function(){var t=arguments,n;arguments.length>0&&(n=t[0]);var r=/\[(\d+)\]/g,i=undefined;i=r.exec(n);while(i!=null){if(i.length>=2){var s=parseInt(i[1],10);t[s+1]!=undefined&&(n=n.replace("["+s+"]",t[s+1]))}i=r.exec(n)}return e.trustAsHtml(n)};return t}]),o.filter("aliyunBuyInstStatus",function(){return function(e){return e?n.INST_STATUS[e]:" - "}}),o}),define("dominator/base/services/service.price",["angular","../constants/cons","../helpers/moduleHelper"],function(e,t,n){var r=e.module("aliyun.buy.service.price",n.getModuleNames(arguments));r.factory("aliyunBuyPriceQuerier",["$q",function(e){var t=function(t){this.lastQuery=null,this.querying=!1,this.deferred=e.defer(),this.promise=this.deferred.promise,this.buffer=null,this.service=t};return t.prototype={query:function(e){var t=this;this.deferred.notify({pending:!0}),clearTimeout(this.buffer),this.buffer=setTimeout(function(){t.lastQuery=e,t.updateState()},100)},updateState:function(){if(this.querying||!this.lastQuery)return;var e=this;this.querying=!0;var t=this.lastQuery;this.lastQuery=null,this.service(t).then(function(t){e.querying=!1,e.lastQuery?e.updateState():e.deferred.notify({pending:!1,data:t,success:!0})},function(t){e.querying=!1,e.lastQuery?e.updateState():e.deferred.notify({pending:!1,success:!1,message:t?t.message:undefined,code:t?t.code:undefined,messageType:t?t.message_type:undefined})})}},t}]);var i=function(t,n){if(!e.isNumber(t))return t;t=parseFloat(t);if(isNaN(t))return"";var r=t.toString().split(".");return r.length==1?t=t.toString()+".00":r[1].length>1?t=t.toString():t=t.toString()+"0",t};return r.filter("aliyunBuyPriceValue",function(){return i}),r.filter("aliyunBuyPriceCurrency",["$filter",function(e){return function(e){return e=="USD"?"$":""}}]),r.filter("aliyunBuyPriceCurrencyText",["$filter",function(e){return function(e){return e=="CNY"?"":e}}]),r.factory("aliyunBuyPriceUpdater",["aliyunBuyPriceQuerier",function(t){function r(r,i){function s(t){var n=r.handle,i=r.options,s=i?i.global:null,o=s&&s.batchMode?n.batchOrder(!0)||n.batchOrder():[n.order(!0)||n.order()];if(e.equals(u,o))return;u=o,o&&o[0]&&a.query(o)}function o(e){var t=r.handle,n=t.order(!0)||t.order();n&&a.query([n])}var u,a=new t(i);return r.price||(r.price={}),a.promise.then(null,null,function(e){if(e.pending)r.price.calculating=!0;else{n.config(r.price,{calculating:!1,success:e.success,code:e.code||null,message:e.message?e.message:null,status:e.messageType?e.messageType:null});var t={},i=e.data;t.flow=r.price.data?r.price.data.flow:null,e.success&&i?(t.success=!0,t.origin=i.origin,t.trade=i.trade,t.discount=i.discount,t.orderLines=i.orderLines||{},t.strategies=i.strategies,t.children=i.children,t.rules=i.rules):(t.success=!1,t.code=e.code,t.message=e.message),r.price.data=t}}),r.$watch("value",s,!0),{trigger:function(){o(r.value)}}}return{apply:r}}]),r.filter("aliyunBuySavedPrice",function(){return function(e,t,n){var r=i(e,n),s=i(t,n);if(!r||!s)return"";var o=parseFloat((parseFloat(s)*1e6-parseFloat(r)*1e6)/1e6);return i(o,n)}}),r.filter("aliyunBuyFullPrice",["$filter",function(e){var t=e("aliyunBuyPriceUnit");return function(e,n){return'<span class="bk-cny">&yen;</span><span class="bk-orders-item-money">'+i(e,n)+t(n)+"</span>"}}]),r}),define("dominator/base/directives/ui.cart",["angular","../helpers/moduleHelper","../constants/cons","../services/service.dict","../services/service.price","../services/service.local"],function(e,t,n){var r=e.module("aliyun.buy.ui.cart",t.getModuleNames(arguments));return r.directive("aliyunBuyCart",["$filter","$timeout","aliyunBuyLocal","aliyunBuyPriceQuerier","$rootScope",function(n,r,i,s,o){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuyCart.html",replace:!0,scope:{config:"&",priceService:"=",viewData:"=",detail:"="},compile:function(n,r){return{pre:function(e){},post:function(n,r,i){var u,a;n.$watch("priceService",function(){var r=n.priceService;if(!r)return;var i=function(t){var n=r.getPrice;if(!e.isFunction(n))return;return n.apply(r,a)};u=new s(i),u.promise.then(null,null,function(e){e.pending?n.calculating=!0:(n.calculating=!1,n.price=e.data?t.formatPriceRules(e.data):null)})});var f=o.$on("aliyunBuyCart:queryPrice",function(e,t,n){a=Array.prototype.slice.call(arguments,1),u.query.apply(u,a)});n.$on("$destroy",function(){e.isFunction(f)&&f()}),n.purchase=function(){var e=n.calculating&&n.config().priceShow||n.price==null;if(e===!0)return;n.$emit("aliyunBuyCart:purchase")},n.$watch("viewData.totalAmount",function(e){e==0&&(n.showOrders=!1)}),n.closeCartDialog=function(){n.showOrders=!1}}}}}}]),r.directive("aliyunBuyCartItem",[function(){return{restrict:"EA",replace:!0,templateUrl:"dominator/base/partials/aliyunBuyCartItem.html",scope:{viewOrders:"=",config:"&"},compile:function(e,t){return{pre:function(e,t,n){},post:function(e,t,n){e.remove=function(t){e.$emit("aliyunBuyCart:removeItem",t)}}}}}}]),r}),define("dominator/base/directives/ui.cartFixed",["angular","../helpers/moduleHelper","../constants/cons","../services/service.dict","../services/service.price","../services/service.local"],function(e,t,n){var r=e.module("aliyun.buy.ui.cart.fixed",t.getModuleNames(arguments));return r.directive("aliyunBuyCartFixed",["$filter","$timeout","aliyunBuyLocal","aliyunBuyPriceQuerier","$rootScope",function(n,r,i,s,o){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuyCartFixed.html",replace:!0,scope:{config:"&",priceService:"=",viewData:"=",detail:"="},compile:function(n,r){return{pre:function(e){},post:function(n,r,i){var u,a;n.$watch("priceService",function(){var r=n.priceService;if(!r)return;var i=function(t){var n=r.getPrice;if(!e.isFunction(n))return;return n.apply(r,a)};u=new s(i),u.promise.then(null,null,function(e){e.pending?n.calculating=!0:(n.calculating=!1,n.price=e.data?t.formatPriceRules(e.data):null)})});var f=o.$on("aliyunBuyCart:queryPrice",function(e,t,n){a=Array.prototype.slice.call(arguments,1),u.query.apply(u,a)});n.$on("$destroy",function(){e.isFunction(f)&&f()}),n.purchase=function(){var e=n.calculating&&n.config().priceShow;if(e===!0)return;n.$emit("aliyunBuyCart:purchase")},n.$watch("viewData.totalAmount",function(e){e==0&&(n.showOrders=!1)}),n.closeCartDialog=function(){n.showOrders=!1}}}}}}]),r.directive("aliyunBuyCartFixedItem",[function(){return{restrict:"EA",replace:!0,templateUrl:"dominator/base/partials/aliyunBuyCartFixedItem.html",scope:{viewOrders:"=",config:"&"},compile:function(e,t){return{pre:function(e,t,n){},post:function(e,t,n){e.remove=function(t){e.$emit("aliyunBuyCart:removeItem",t)}}}}}}]),r}),LazyLoad=function(e){function t(t,n){var r=e.createElement(t),i;for(i in n)n.hasOwnProperty(i)&&r.setAttribute(i,n[i]);return r}function n(e){var t=f[e],n,r;t&&(n=t.callback,r=t.urls,r.shift(),l=0,r.length||(n&&n.call(t.context,t.obj),f[e]=null,c[e].length&&i(e)))}function r(){var t=navigator.userAgent;u={async:e.createElement("script").async===!0},(u.webkit=/AppleWebKit\//.test(t))||(u.ie=/MSIE/.test(t))||(u.opera=/Opera/.test(t))||(u.gecko=/Gecko\//.test(t))||(u.unknown=!0)}function i(i,l,h,p,d){var v=function(){n(i)},m=i==="css",g=[],y,b,w,E;u||r();if(l)if(l=typeof l=="string"?[l]:l.concat(),m||u.async||u.gecko||u.opera)c[i].push({urls:l,callback:h,obj:p,context:d});else{y=0;for(b=l.length;y<b;++y)c[i].push({urls:[l[y]],callback:y===b-1?h:null,obj:p,context:d})}if(!f[i]&&(E=f[i]=c[i].shift())){a||(a=e.head||e.getElementsByTagName("head")[0]),l=E.urls,y=0;for(b=l.length;y<b;++y)h=l[y],m?w=u.gecko?t("style"):t("link",{href:h,rel:"stylesheet"}):(w=t("script",{src:h}),w.async=!1),w.className="lazyload",w.setAttribute("charset","utf-8"),u.ie&&!m?w.onreadystatechange=function(){/loaded|complete/.test(w.readyState)&&(w.onreadystatechange=null,v())}:m&&(u.gecko||u.webkit)?u.webkit?(E.urls[y]=w.href,o()):(w.innerHTML='@import "'+h+'";',s(w)):w.onload=w.onerror=v,g.push(w);y=0;for(b=g.length;y<b;++y)a.appendChild(g[y])}}function s(e){var t;try{t=!!e.sheet.cssRules}catch(r){l+=1,l<200?setTimeout(function(){s(e)},50):t&&n("css");return}n("css")}function o(){var e=f.css,t;if(e){for(t=h.length;--t>=0;)if(h[t].href===e.urls[0]){n("css");break}l+=1,e&&(l<200?setTimeout(o,50):n("css"))}}var u,a,f={},l=0,c={css:[],js:[]},h=e.styleSheets;return{css:function(e,t,n,r){i("css",e,t,n,r)},js:function(e,t,n,r){i("js",e,t,n,r)}}}(this.document),define("lazyload",function(e){return function(){var t,n;return t||e.LazyLoad}}(this)),define("dominator/base/directives/ui.icons",["angular","lazyload"],function(e,t){var n=e.module("aliyun.buy.ui.icons",[]).run(function(){t.css("//g.alicdn.com/aliyun/iconfont/0.0.6/css/iconfont.css")});return n}),define("dominator/base/directives/ui.priceView",["angular","../helpers/moduleHelper","../services/service.price"],function(e,t){var n=e.module("aliyun.buy.ui.price.view",t.getModuleNames(arguments));return n.directive("aliyunBuyPriceView",["aliyunBuyPriceQuerier",function(n){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuyPriceView.html",scope:{priceResult:"=",config:"="},replace:!0,link:function(r,i){var s=r.config;if(!e.isObject(r.config)||!e.isObject(s.priceService))throw new Error(" 'config' or 'config.priceService' must be an Object");var o=s.priceService,u=function(e){return o.getPrice(e)},a=new n(u);!r.priceResult&&(r.priceResult={empty:!0}),a.promise.then(null,null,function(e){r.priceResult.empty=!1,e.pending?r.priceResult.calculating=!0:(r.priceResult.calculating=!1,e.code=="200"||e.success?r.priceResult=t.formatPriceRules(e.data):r.priceResult=e)}),r.$on("aliyunBuyPriceView:queryPrice",function(e,t){a.query(t)})}}}]),n}),define("dominator/base/directives/ui.subtotal",["angular","../helpers/moduleHelper","../services/service.price","./controls/ui.button"],function(e,t,n){var r=e.module("aliyun.buy.ui.subtotal",t.getModuleNames(arguments));return r.directive("aliyunBuySubtotal",["$filter","aliyunBuyPriceQuerier","$rootScope",function(n,r,i){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuySubtotal.html",replace:!0,scope:{priceService:"=",viewData:"=",priceResult:"=",handle:"=",config:"="},link:function(n){var s,o=0,u;n.vm={priceServiceConfiged:!0},n.$watch("priceService",function(){var i=n.priceService;if(!i){n.vm.priceServiceConfiged=!1;return}n.vm.priceServiceConfiged=!0;var o=function(t){var n=i.getPrice;if(!e.isFunction(n))return;return n.apply(i,u)};s=new r(o),s.promise.then(null,null,function(e){n.priceResult||(n.priceResult={}),e.pending?n.priceResult.calculating=!0:(n.priceResult.calculating=!1,n.priceResult.data=e.data?t.formatPriceRules(e.data):null)})});var a=i.$on("aliyunBuySubtotal:queryPrice",function(e,t,r){u=Array.prototype.slice.call(arguments,1),s?(n.priceServiceConfiged=!0,s.query.apply(s,u)):n.priceServiceConfiged=!1});n.$on("$destroy",function(){e.isFunction(a)&&a()}),n.isDisableButton=function(e){if(n.vm.priceServiceConfiged){var t=n.config.purchaseAvailable,r=!e||!e.data||t==0||e.data.calculating||!e.data.trade&&e.data.trade!==0&&!e.data.priceList;return r}return n.config.purchaseAvailable==0?!0:!1},n.addToCart=function(){var e=n.priceResult,t=n.config,r=n.isDisableButton(e)||t.addCartAvailable===!1;if(r===!0)return;n.$emit("aliyunBuySubtotal:addToCart")},n.purchase=function(){var e=n.priceResult,t=n.config,r=n.isDisableButton(e);if(r===!0)return;n.$emit("aliyunBuySubtotal:purchase")}}}}]),r.directive("aliyunBuySubtotalModel",["$filter","$timeout","$compile","$templateCache",function(t,n,r,i){return{restrict:"EA",replace:!0,template:'<div class="bk-items-list"><ul class="bk-items-list-ul"></ul></div>',scope:{viewData:"=",handle:"="},link:function(t,i,s){function o(){var e=i.clone();e.addClass("bk-subtotal-show-init"),i.before(e),n(function(){e.addClass("bk-subtotal-show-open"),n(function(){e.remove()},500)},300)}t.$watch("viewData",function(){if(!t.viewData)return;var n=[],s;e.forEach(t.viewData,function(e){e.type&&e.type=="staticText"&&(n=n.concat(['<span class="bk-items-item">','<span class="bk-items-item-name '+(e.labelCss?e.labelCss:"")+'">',e.label,"</span>",'<span class="bk-items-item-value '+(e.textCss?e.textCss:"")+'">',e.text,"</span>","</span>"]));if(e.type&&e.type=="directive"){s=e.bindScope;var t=r(e.fieldDirective)(s);n.push(t[0].outerHTML)}}),i.find(".bk-items-list-ul").html(n.join("")),r(i.contents())(s?s:t)}),t.handle={showAddToCartAnimation:o}}}}]),r}),define("dominator/base/directives/ui.subtotalFixed",["angular","../helpers/moduleHelper","../services/service.price","./controls/ui.button"],function(e,t,n){function r(e,t){var n=t.get(e);return n||(n=t(e)),n}function i(e){return"__dynamicDirective_"+e}function s(e){return"__render_"+e}var o=e.module("aliyun.buy.ui.subtotal.fixed",t.getModuleNames(arguments));return o.directive("aliyunDynamicTooltip",["$cacheFactory",function(e){return{scope:{strategies:"=",id:"@"},template:"<span aliyun-buy-tooltip=\"{content:'{{tip}}', theme:'white', trigger:'hover', offsetX: 20, enDisplay: !!tip}\"></span>",link:function(t,n){var o=r(i(t.id),e),u=s(t.id);t.$watch("strategies",function(e){e&&(o.put("scope",{strategies:e}),t.$broadcast(u,e))}),t.tip='<span aliyun-dynamic-directive id="{{id}}"></span>'}}}]),o.run(["$cacheFactory",function(e){var t='<span ng-repeat="strategy in strategies" class="bk-ploy"title="{{strategy.title}}">{{strategy.name|aliyunBuyText}}</span>',n=r(i("priceTagStrategies"),e);n.put("template",t);var s=r(i("priceResultStrategies"),e);s.put("template",t)}]),o.directive("aliyunDynamicDirective",["$compile","$cacheFactory",function(t,n){return{scope:{id:"@"},template:"<span></span>",link:function(o,u){function a(){var n=f.get("scope"),r=f.get("template");e.extend(o,n);if(c)return;c=!0,u.append(r),t(u.contents())(o)}var f=r(i(o.id),n),l=s(o.id);o.$on(l,function(e,t){a()});var c=!1;a()}}}]),o.directive("aliyunBuySubtotalFixed",["$filter","aliyunBuyPriceQuerier","$rootScope","$timeout",function(n,r,i,s){return{restrict:"EA",templateUrl:"dominator/base/partials/aliyunBuySubtotalFixed.html",replace:!0,scope:{priceService:"=",viewData:"=",priceResult:"=",handle:"=",config:"="},link:function(n,o){function u(t,n){var r=e.element("<span class='bk-addtocart-animation-box'></span>");r.addClass("bk-subtotal-show-init"),r.css({position:"absolute",right:$(window).width()-n.clientX,top:n.clientY-40}),e.element("body").after(r),s(function(){r.addClass("bk-subtotal-show-open"),s(function(){r.remove()},500)},300)}var a,f=0,l;n.vm={priceServiceConfiged:!0},n.$watch("priceService",function(){var i=n.priceService;if(!i){n.vm.priceServiceConfiged=!1;return}n.vm.priceServiceConfiged=!0;var s=function(t){var n=i.getPrice;if(!e.isFunction(n))return;return n.apply(i,l)};a=new r(s),!n.priceResult&&(n.priceResult={empty:!0}),a.promise.then(null,null,function(e){n.priceResult.empty=!1,e.pending?n.priceResult.calculating=!0:(n.priceResult.calculating=!1,n.priceResult.data=e.data?t.formatPriceRules(e.data):null)})});var c=n.config.scrollElementClassName,h=c?jQuery("."+c):jQuery(window);h.scroll(function(){var e=o.find(".bk-subtotal-footer");if(!e)return;var t=50;o.css({paddingBottom:e.height()+t}),e.css({position:"fixed"});var n=this,r=o.offset().top,i=e.offset().top;i>r+e.height()+t+20?jQuery(".bk-subtotal-footer").css({position:"absolute"}):jQuery(".bk-subtotal-footer").css({position:"fixed"})});var p=i.$on("aliyunBuySubtotal:queryPrice",function(e,t,r){l=Array.prototype.slice.call(arguments,1),a?(n.priceServiceConfiged=!0,a.query.apply(a,l)):n.priceServiceConfiged=!1});n.$on("$destroy",function(){e.isFunction(p)&&p()}),n.isDisableButton=function(e){if(n.vm.priceServiceConfiged){var t=n.config.purchaseAvailable,r=t==0||e&&e.data&&(e.data.calculating||e.calculating);return r}return n.config.purchaseAvailable==0?!0:!1},n.addToCart=function(e){var t=n.priceResult,r=n.config,i=n.isDisableButton(t)||r.addCartAvailable===!1;if(i===!0)return;n.$emit("aliyunBuySubtotal:addToCart",e)},n.purchase=function(e){var t=n.priceResult,r=n.config,i=n.isDisableButton(t);if(i===!0)return;n.$emit("aliyunBuySubtotal:purchase",e)},n.handle={showAddToCartAnimation:u}}}}]),o.directive("aliyunBuySubtotalFixedModel",["$filter","$timeout","$compile","$templateCache",function(t,n,r,i){return{restrict:"EA",replace:!0,template:'<div class="bk-items-list"><ul class="bk-items-list-ul"></ul></div>',scope:{viewData:"="},link:function(t,n,i){t.$watch("viewData",function(){if(!t.viewData)return;var i=[],s;e.forEach(t.viewData,function(e){e.type&&e.type=="staticText"&&(!e.text||(i=i.concat(['<span class="bk-items-item">','<span class="bk-items-item-name '+(e.labelCss?e.labelCss:"")+'">',e.label,"</span>",'<span class="bk-items-item-value '+(e.textCss?e.textCss:"")+'">',e.text,"</span>","</span>"])));if(e.type&&e.type=="directive"){s=e.bindScope;var t=r(e.fieldDirective)(s);i.push(t[0].outerHTML)}}),n.find(".bk-items-list-ul").html(i.join("")),r(n.contents())(s?s:t)})}}}]),o}),define("dominator/base/directives/ui.theme",["angular","jQuery"],function(e,t){function n(e){t(document.body).addClass("bk-theme-"+e)}return e.module("aliyun.buy.ui.theme",[]).constant("aliyunBuyTheme","default").run(["aliyunBuyTheme",function(t){try{n(t)}catch(r){e.element(document).ready(function(){n(t)})}}])}),define("dominator/base/directives/_base",["angular","../helpers/moduleHelper","./controls/_baseForDominator","./widgets/_base","./base/_base","./ui.cart","./ui.cartFixed","./ui.icons","./ui.priceView","./ui.subtotal","./ui.subtotalFixed","./ui.theme"],function(e,t){return e.module("aliyun.buy.ui",t.getModuleNames(arguments))}),define("dominator/base/helpers/arrayHelper",[],function(){var e=function(e){if(e==null)throw new TypeError("can't convert "+e+" to object");return Object(e)},t=Object("a"),n=t[0]!=="a"||!(0 in t),r=function(e){return Object.prototype.toString.call(e)==="[object Function]"},i=function(e){return Object.prototype.toString.call(e)==="[object String]"};Array.prototype.forEach||(Array.prototype.forEach=function(t){var s=e(this),o=n&&i(this)?this.split(""):s,u=arguments[1],a=-1,f=o.length>>>0;if(!r(t))throw new TypeError;while(++a<f)a in o&&t.call(u,o[a],a,s)}),Array.prototype.filter||(Array.prototype.filter=function(t){var s=e(this),o=n&&i(this)?this.split(""):s,u=o.length>>>0,a=Array(u),f=arguments[1];if(!r(t))throw new TypeError(t+" is not a function");for(var l=0;l<u;l++)l in o&&(a[l]=t.call(f,o[l],l,s));return a}),Array.prototype.every||(Array.prototype.every=function(t){var s=e(this),o=n&&i(this)?this.split(""):s,u=o.length>>>0,a=arguments[1];if(!r(t))throw new TypeError(t+" is not a function");for(var f=0;f<u;f++)if(f in o&&!t.call(a,o[f],f,s))return!1;return!0}),Array.prototype.every||(Array.prototype.some=function(t){var s=e(this),o=n&&i(this)?this.split(""):s,u=o.length>>>0,a=arguments[1];if(!r(t))throw new TypeError(t+" is not a function");for(var f=0;f<u;f++)if(f in o&&t.call(a,o[f],f,s))return!0;return!1}),Array.prototype.map||(Array.prototype.map=function(t){var s=e(this),o=n&&i(this)?this.split(""):s,u=o.length>>>0,a=Array(u),f=arguments[1];if(!r(t))throw new TypeError(t+" is not a function");for(var l=0;l<u;l++)l in o&&(a[l]=t.call(f,o[l],l,s));return a})}),define("dominator/base/helpers/_base",["./arrayHelper","./moduleHelper","./constraintHelper","./paramsHelper","./templateHelper"],function(){}),angular.module("aliyun.buy.dominator.base.tpl",["dominator/base/partials/aliyunBuyAmount.html","dominator/base/partials/aliyunBuyBase/aliyunBuyBlockTips.html","dominator/base/partials/aliyunBuyBase/aliyunBuyInlineSelect.html","dominator/base/partials/aliyunBuyBase/aliyunBuyInlineTips.html","dominator/base/partials/aliyunBuyBase/aliyunRemarkItem.html","dominator/base/partials/aliyunBuyBricks/newBrickRemarkTabs.html","dominator/base/partials/aliyunBuyBricks/newBrickTabs.html","dominator/base/partials/aliyunBuyBricks/selectLinkage.html","dominator/base/partials/aliyunBuyBricks/selects.html","dominator/base/partials/aliyunBuyBricks/sliderWithNumber.html","dominator/base/partials/aliyunBuyBricks/tabs.html","dominator/base/partials/aliyunBuyButton.html","dominator/base/partials/aliyunBuyButton/aliyunNewBuyButtontab.html","dominator/base/partials/aliyunBuyButtonWithSelect.html","dominator/base/partials/aliyunBuyButtontab.html","dominator/base/partials/aliyunBuyButtontabWithSelect.html","dominator/base/partials/aliyunBuyCart.html","dominator/base/partials/aliyunBuyCartFixed.html","dominator/base/partials/aliyunBuyCartFixedItem.html","dominator/base/partials/aliyunBuyCartGivingTip.html","dominator/base/partials/aliyunBuyCartItem.html","dominator/base/partials/aliyunBuyComboDuration.html","dominator/base/partials/aliyunBuyDatepick.html","dominator/base/partials/aliyunBuyDialog/backdrop.html","dominator/base/partials/aliyunBuyDialog/window.html","dominator/base/partials/aliyunBuyDuration.html","dominator/base/partials/aliyunBuyFieldTips.html","dominator/base/partials/aliyunBuyFloats/floatbox.html","dominator/base/partials/aliyunBuyGroup.html","dominator/base/partials/aliyunBuyInfo.html","dominator/base/partials/aliyunBuyMsg.html","dominator/base/partials/aliyunBuyNotice.html","dominator/base/partials/aliyunBuyNumberStepper/numberStepper.html","dominator/base/partials/aliyunBuyOrderButton.html","dominator/base/partials/aliyunBuyPopover/yundun.html","dominator/base/partials/aliyunBuyPriceView.html","dominator/base/partials/aliyunBuyResourceGroup.html","dominator/base/partials/aliyunBuySelectTable.html","dominator/base/partials/aliyunBuySlider/popover.html","dominator/base/partials/aliyunBuySlider/slider.html","dominator/base/partials/aliyunBuySubtotal.html","dominator/base/partials/aliyunBuySubtotalFixed.html","dominator/base/partials/aliyunBuyTimepicker.html","dominator/base/partials/aliyunBuyTool/checkbox.html","dominator/base/partials/aliyunBuyTool/password.html","dominator/base/partials/aliyunBuyTool/select.html","dominator/base/partials/aliyunBuyTool/selectDynamic.html","dominator/base/partials/aliyunBuyTool/slider.html","dominator/base/partials/aliyunBuyYundun.html","dominator/base/partials/angular-bootstrap/pagination/pager.html","dominator/base/partials/angular-bootstrap/pagination/pagination.html","dominator/base/partials/datepicker/datepicker.html","dominator/base/partials/datepicker/popup.html","dominator/base/styles/kill-bootstrap/demo.html","dominator/base/tempCode/test.html"]),angular.module("dominator/base/partials/aliyunBuyAmount.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyAmount.html",'<div ng-hide="options.visible===false"><div class="bk-form-row-cell"><div class="bk-form-row-li"><div aliyun-buy-number-stepper formatter="options.formatter" value="value" support-float="{{options.supportFloat}}" min="options.min" max="options.max" step="options.step" unit="options.unit|aliyunBuyText" hide-control="options.hideControl"></div></div><div class="bk-form-row-txt" ng-show="options.showLimitMsg">{{\'COMMON_AMOUNT_LIMIT_TIP\'|aliyunBuyText:lang(options.unit):options.allowMax:options.prodName:options.has||0}}</div><div class="bk-form-row-txt" ng-show="options.state==\'error\'"><span class="bk-form-status bk-form-error"><i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message" ng-if="options.errorTip" ng-bind-html="options.errorTip"></span><span class="bk-form-status-message" role="alert" ng-if="!options.errorTip" ng-bind-html="options.stateMessage"></span></span></div><div class="bk-form-row-txt" ng-show="options.tip"><div ng-bind-html="options.tip|aliyunBuyText"></div></div></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyBase/aliyunBuyBlockTips.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyBase/aliyunBuyBlockTips.html",'<div class="bk-form-row-txt" ng-bind-html="options.tip | aliyunBuyText" ng-show="options.tip"></div>')}]),angular.module("dominator/base/partials/aliyunBuyBase/aliyunBuyInlineSelect.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyBase/aliyunBuyInlineSelect.html",'<span ng-if="options.select"><label class="bk-ml5 bk-input-checkbox"><input class="bk-mr1" ng-model="value.selectValue" type="checkbox"> {{options.select.text}}</label><span class="aliyun-inline-select-tips" ng-bind-html="options.select.tip | aliyunBuyText" ng-show="options.select.tip"></span></span>')}]),angular.module("dominator/base/partials/aliyunBuyBase/aliyunBuyInlineTips.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyBase/aliyunBuyInlineTips.html",'<span><div ng-if="options.textTip" class="aliyun-inline-tips"><a class="bk-lnk {{ options.textTip.class}}" target="{{options.textTip.target || \'_self\'}}" href="{{options.textTip.href || \'javascript:;\'}}" data-spm-click="gostr=/aliyun;locaid={{options.textTip.spm}}" aliyun-buy-tooltip="{{options.textTip.tooltip}}" ng-bind-html="options.textTip.text"></a></div><div ng-if="options.askTip" class="aliyun-inline-tips"><a class="bk-lnk {{ options.askTip.class}}" href="{{options.askTip.href || \'javascript:;\'}}" data-spm-click="gostr=/aliyun;locaid={{options.askTip.spm}}" aliyun-buy-tooltip="{{options.askTip.tooltip}}" target="{{options.askTip.target || \'_self\'}}"><i class="aliyun-icon-help"></i></a></div></span>')}]),angular.module("dominator/base/partials/aliyunBuyBase/aliyunRemarkItem.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyBase/aliyunRemarkItem.html",'<div class="aliyun-remark-brick"><div class="aliyun-remark-brick-text">{{item.text}}</div><div class="aliyun-remark-brick-remark">{{item.remark}}</div></div>')}]),angular.module("dominator/base/partials/aliyunBuyBricks/newBrickRemarkTabs.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyBricks/newBrickRemarkTabs.html",'<div class="bk-form-row-{{config.theme || \'primary\'}}"><div aliyun-new-buy-buttontab class="inline-display" config="config" detail="detail" ng-model="value" options="options"><div aliyun-remark-item item="item"></div></div><span aliyun-buy-inline-tips></span><!-- <span aliyun-buy-inline-select></span> --><div aliyun-buy-block-tips></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyBricks/newBrickTabs.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyBricks/newBrickTabs.html",'<div class="bk-form-row-{{config.theme || \'primary\'}}"><div aliyun-new-buy-buttontab class="inline-display" config="config" detail="detail" ng-model="value" options="options"></div><span aliyun-buy-inline-tips></span> <span aliyun-buy-inline-select></span><div aliyun-buy-block-tips></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyBricks/selectLinkage.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyBricks/selectLinkage.html",'<div ng-hide="options.visible===false"><div class="bk-form-row-cell bk-select-linkage"><div class="bk-form-row-li"><div aliyun-buy-select class="bk-select-1" placeholder="{{options.placeholder}}" ng-model="rootValue" detail="rootDetail" option="options.items" state="options.state" long="{{options.long}}" short="{{options.short}}" label-id="labelId" need-login="{{options.needLogin? options.needLoginText :\'\'}}"></div><div aliyun-buy-select class="bk-select-2" placeholder="{{childrens.placeholder ? childrens.placeholder : options.childrenPlaceholder}}" ng-model="childrenValue" detail="childrenDetail" option="childrens.items" state="options.state" spm="{{rootValue + \';attr=\'}}" long="{{options.childrensLong}}" short="{{options.childrensShort}}" label-id="labelId" need-login="{{options.needLogin? options.needLoginText :\'\'}}"></div><a class="bk-lnk {{options.textTip.class}}" target="{{options.textTip.target || \'_self\'}}" ng-if="options.textTip" ng-href="{{ options.textTip.href || \'javascript:;\'}}" data-spm-click="gostr=/aliyun;locaid={{options.textTip.spm}}" aliyun-buy-tooltip="{{options.textTip.tooltip}}" ng-bind-html="options.textTip.text"></a> <a class="bk-lnk {{options.askTip.class}}" ng-if="options.askTip" ng-href="{{options.askTip.href || \'javascript:;\'}}" data-spm-click="gostr=/aliyun;locaid={{options.askTip.spm}}" aliyun-buy-tooltip="{{options.askTip.tooltip}}" target="{{options.askTip.target || \'_self\'}}"><i class="aliyun-icon-help"></i></a></div><div class="bk-form-row-txt" ng-bind-html="options.tip" ng-show="options.tip"></div><div class="bk-form-status bk-form-error bk-form-row-txt" ng-if="options.state===\'error\' && options.stateMessage"><i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message" ng-bind-html="options.stateMessage"></span></div></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyBricks/selects.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyBricks/selects.html",'<div class="bk-form-row-cell" ng-hide="options.visible===false"><div class="bk-form-row-li"><div aliyun-buy-select is-loading-items="options.isLoadingItems" placeholder="{{options.placeholder}}" ng-model="value" detail="detail" option="options.items" state="options.state" long="{{options.long}}" short="{{options.short}}" label-id="labelId" need-login="{{options.needLogin?\',\':\'\'}}"></div><a class="bk-lnk {{options.textTip.class}}" target="{{options.textTip.target || \'_self\'}}" ng-if="options.textTip" ng-href="{{ options.textTip.href || \'javascript:;\'}}" data-spm-click="gostr=/aliyun;locaid={{options.textTip.spm}}" aliyun-buy-tooltip="{{options.textTip.tooltip}}" ng-bind-html="options.textTip.text"></a> <a class="bk-lnk {{options.askTip.class}}" ng-if="options.askTip" ng-href="{{options.askTip.href || \'javascript:;\'}}" data-spm-click="gostr=/aliyun;locaid={{options.askTip.spm}}" aliyun-buy-tooltip="{{options.askTip.tooltip}}" target="{{options.askTip.target || \'_self\'}}"><i class="aliyun-icon-help"></i></a></div><div class="bk-form-row-txt" ng-bind-html="options.tip" ng-show="options.tip"></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyBricks/sliderWithNumber.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyBricks/sliderWithNumber.html",'<div ng-show="options.visible!==false"><div class="bk-form-row-cell"><div class="bk-form-row-li bk-slider-with-number"><div aliyun-buy-slider class="bk-slider" step-option="options.stepOption" value="value" label-id="labelId" max-value="options.max" min-value="options.min" step="options.step" unit="options.unit" spm="{{options.spm}}" is-disabled="options.isDisabled"></div><div aliyun-buy-number-stepper class="bk-number bk-ml2" value="value" label-id="labelId" min="options.min" max="options.max" step="options.step" unit="options.numberUnit" ng-show="options.visible!==false" is-disabled="options.isDisabled"></div><a class="bk-lnk {{options.textTip.class}}" target="{{options.textTip.target || \'_self\'}}" ng-if="options.textTip" ng-href="{{ options.textTip.href || \'javascript:;\'}}" data-spm-click="gostr=/aliyun;locaid={{options.textTip.spm}}" aliyun-buy-tooltip="{{options.textTip.tooltip}}" ng-bind-html="options.textTip.text"></a> <a class="bk-lnk {{options.askTip.class}}" ng-if="options.askTip" ng-href="{{options.askTip.href || \'javascript:;\'}}" data-spm-click="gostr=/aliyun;locaid={{options.askTip.spm}}" aliyun-buy-tooltip="{{options.askTip.tooltip}}" target="{{options.askTip.target || \'_self\'}}"><i class="aliyun-icon-help"></i></a></div><div class="bk-form-row-txt" ng-bind-html="options.tip" ng-show="options.tip"></div></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyBricks/tabs.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyBricks/tabs.html",'<div class="bk-form-row-cell" ng-hide="options.visible===false"><div class="bk-form-row-li"><div aliyun-buy-buttontab options="options.items" spm="options.spm" value="value" detail="detail"></div><a class="bk-lnk {{ options.textTip.class}}" target="{{options.textTip.target || \'_self\'}}" ng-if="options.textTip" href="{{options.textTip.href || \'javascript:;\'}}" data-spm-click="gostr=/aliyun;locaid={{options.textTip.spm}}" aliyun-buy-tooltip="{{options.textTip.tooltip}}" ng-bind-html="options.textTip.text"></a> <a class="bk-lnk {{ options.askTip.class}}" ng-if="options.askTip" href="{{options.askTip.href || \'javascript:;\'}}" data-spm-click="gostr=/aliyun;locaid={{options.askTip.spm}}" aliyun-buy-tooltip="options.askTip.tooltip" target="{{options.askTip.target || \'_self\'}}"><i class="aliyun-icon-help"></i></a></div><div class="bk-form-row-txt" ng-bind-html="options.tip | aliyunBuyText" ng-show="options.tip"></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyButton.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyButton.html","<span class=\"bk-button bk-button-{{theme||'primary'}} {{isSelected=='true'?'bk-button-current':''}} {{isDisabled=='true'?'bk-button-disabled':''}} {{iconClass?'bk-button-relative':''}}\" ng-disabled=\"isDisabled=='true'\" role=\"button\" tabindex=\"0\" aliyun-buy-tooltip=\"{content:'{{tip}}', theme:'white', trigger:'hover', offsetX: 20, enDisplay: !!tip}\"><i class=\"{{iconClass}}\"></i><div class=\"bk-button-text\" role=\"button\" tabindex=\"0\" ng-transclude></div></span>")}]),angular.module("dominator/base/partials/aliyunBuyButton/aliyunNewBuyButtontab.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyButton/aliyunNewBuyButtontab.html",'<div class="new-button-tab" ng-repeat="item in options.items track by $index" ng-click="selectItem(item)" data-spm-click="gostr=/aliyun;locaid={{item.spm || (options.spm + item.value)}}" aliyun-buy-button theme="{{config.theme}}" tip="{{item.tip}}" is-selected="{{item.value == value}}" icon-class="bk-button-icon {{item.iconClass}}"><div ng-if="!config.transclude">{{item.text}}</div><div ng-if="config.transclude" ng-transclude></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyButtonWithSelect.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyButtonWithSelect.html",'<span class="bk-button-with-select {{isSelected ==\'true\' ? \'bk-button-with-select-current\' : \'\'}}"><button aliyun-buy-button icon-class="bk-button-with-select-icon {{parentIconClass}}" tip="{{parentTip}}" data-spm-click="gostr=/aliyun;locaid={{parentDetail.spm || (spm + parentDetail.value)}}" ng-click="select(option)">{{parentDetail.text | aliyunBuyText}}</button> <span aliyun-buy-select placeholder="{{childOptions.placeholder}}" ng-model="childValue" spm="{{parentDetail.value + \';attr=\'}}" detail="childDetail" option="childOptions.items"></span></span>')}]),angular.module("dominator/base/partials/aliyunBuyButtontab.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyButtontab.html",'<div class="bk-buttontab"><button aliyun-buy-button ng-repeat="option in options track by $index" ng-click="select(option)" tip="{{option.tip}}" data-spm-click="gostr=/aliyun;locaid={{spm}}-{{option.value}}" icon-class="{{option.iconClass}}" is-selected="{{value==option.value}}" is-disabled="{{option.disabled==true}}">{{option.text | aliyunBuyText}}</button></div>')}]),angular.module("dominator/base/partials/aliyunBuyButtontabWithSelect.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyButtontabWithSelect.html",'<div class="bk-buttontab-with-select"><span ng-repeat="item in options.items"><span aliyun-buy-button-with-select is-selected="{{parentValue == item.value}}" ng-click="select(item)" parent-detail="item" parent-tip="{{item.tip}}" parent-icon-class="{{item.iconClass}}" child-value="valueMap[item.value]" child-detail="item.childDetail" child-options="item.children"></span></span> <span aliyun-buy-inline-tips></span></div>')}]),angular.module("dominator/base/partials/aliyunBuyCart.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyCart.html",'<div class="bk-scope bk-orders-wrap bk-cart" aliyun-buy-disable-ng-animate><div ng-show="viewData.totalAmount>0" class="bk-items bk-mb4 bk-items-cart"><div class="bk-items-title bk-clearfix" style="cursor:pointer" ng-click="showOrders=true">{{config().texts.purchaseCart || \'COMMON_CART_TITLE\' | aliyunBuyText}}<!----><span class="bk-items-title-quantity bk-orange bk-ml3">{{config().amountUnit != undefined ? (viewData.totalAmount + config().amountUnit):(viewData.totalAmount | aliyunBuyAccy:\'amount\')}}</span><div class="bk-items-price bk-mt1" style="float:right;padding:0"><div ng-if="config().priceShow"><div class="bk-items-price-title"><span ng-show="calculating" class="bk-orange">{{config().texts.calculatingPrice || \'COMMON_CART_CALCULATING\' | aliyunBuyText}}</span><!----><div ng-show="!calculating && price==null" class="bk-orange">{{config().texts.calculatingPriceFailed ||\'COMMON_CART_CALCULATING_PRICE_FAILED\' | aliyunBuyText}}</div><!----><span ng-show="!calculating && price!=null" class="bk-orange"><span class="bk-cny" ng-bind-html="config().currency || \'&yen;\'"></span><span class="bk-items-price-money">{{price.trade | aliyunBuyPriceValue}}</span> <span class="bk-items-price-unit">{{priceUnit|aliyunBuyText}}</span></span></div></div></div></div><div class="bk-items-footer bk-clearfix bk-pb3"><div style="float:left" class="bk-pt2 bk-pr3 bk-ml4"><div aliyun-buy-button class="bk-button-s" ng-click="purchase()" data-spm-click="gostr=/aliyun;locaid=batchpurchasetopbar" is-disabled="{{(calculating&&config().priceShow) || price==null}}">{{config().batchPurchaseButtonText ? config().batchPurchaseButtonText : \'COMMON_CART_BATCH_PURCHASE\' | aliyunBuyText}}</div><!-- --><div aliyun-buy-button theme="default" class="bk-button-s bk-ml2" data-spm-click="gostr=/aliyun;locaid=showdetailtopbar" ng-click="showOrders=true">{{config().viewCartButtonText ? config().viewCartButtonText : \'COMMON_CART_VIEW_DETAIL\' | aliyunBuyText}}</div></div></div></div><div ng-show="viewData.totalAmount==0" class="bk-orders-menu bk-orders-menu-no-hover bk-mb4"><span class="bk-orders-menu-name">{{config().texts.purchaseCart ||\'COMMON_CART_TITLE\' | aliyunBuyText}}<!----></span> <span class="bk-orders-menu-quantity bk-pale">{{config().amountUnit != undefined ? (viewData.totalAmount + config().amountUnit):(viewData.totalAmount | aliyunBuyAccy:\'amount\')}}</span></div><div class="bk-orders" ng-init="showOrders=false" ng-if="showOrders==true"><div class="bk-orders-title"><span class="bk-orders-title-txt">{{config().texts.purchaseCart ||\'COMMON_CART_TITLE\' | aliyunBuyText}}<!-- -->{{config().amountUnit != undefined ? (viewData.totalAmount + config().amountUnit):(viewData.totalAmount | aliyunBuyAccy:\'amount\')}}</span> <span class="bk-orders-title-close" role="button" tabindex="0" ng-click="closeCartDialog()" data-spm-click="gostr=/aliyun;locaid=closecart"><i class="aliyun-icon-wrong-thin" style="color: #666"></i></span></div><!--viewOrders--><div class="bk-orders-list"><div aliyun-buy-cart-item config="config()" view-orders="viewData.viewOrders"></div></div><div ng-show="viewData.viewOrders.length>0"><div class="bk-items-price"><div ng-if="config().showTotalPrice"><div class="bk-items-price-title">{{config().texts.priceTotal || (\'COMMON_PRICE_TOTAL\' | aliyunBuyText) + \'\'}}<!----></div><div class="bk-items-price-settle"><div ng-show="calculating" class="bk-items-price-calculating">{{config().texts.calculatingPrice || \'COMMON_CART_CALCULATING\' | aliyunBuyText}}<!--..--></div><div ng-show="!calculating && price==null" class="bk-items-price-calculating">{{config().texts.calculatingPriceFailed ||\'COMMON_CART_CALCULATING_PRICE_FAILED\' | aliyunBuyText}}<!----></div><span ng-show="!calculating && price!=null"><span class="bk-cny" ng-bind-html="config().currency || \'&yen;\'"></span><span class="bk-items-price-money">{{price.trade | aliyunBuyPriceValue}}</span> <span class="bk-items-price-unit">{{priceUnit|aliyunBuyText}}</span></span></div><div class="bk-items-price-offer" ng-if="price.trade < price.origin"><!--<span class="sedi-buy-cart-submit-cost">--><!--{{config().texts.priceOriginal || \'COMMON_PRICE_ORIGIN\' | aliyunBuyText}}&lt;!&ndash;&ndash;&gt;--><!--<span class="bk-cny" ng-bind-html="config().currency || \'&yen;\'"></span><span>{{price.origin | aliyunBuyPriceValue}}</span>--><!--<span>{{priceUnit|aliyunBuyText}}</span>--><!--</span>--><span class="bk-items-price-rebate">{{config().texts.priceSave || \'COMMON_PRICE_SAVE\' | aliyunBuyText}}<!----><span class="bk-cny" ng-bind-html="config().currency || \'&yen;\'"></span><span>{{price.discount | aliyunBuyPriceValue}}</span> <span>{{priceUnit|aliyunBuyText}}</span></span></div></div></div><div class="bk-orders-control"><form class="" target="_self"><input name="" type="hidden" class="orders-data" value=""><div aliyun-buy-button data-spm-click="gostr=/aliyun;locaid=batchpurchase" ng-click="purchase()" is-disabled="{{(calculating&&config().priceShow) || price==null}}">{{config().batchPurchaseButtonText || \'COMMON_CART_BATCH_PURCHASE\' | aliyunBuyText}}<!----></div></form></div></div></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyCartFixed.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyCartFixed.html",'<div class="bk-scope bk-orders-wrap bk-cart" aliyun-buy-disable-ng-animate><div ng-show="viewData.totalAmount>0" class="bk-cart-bar bk-items bk-mb4 bk-items-cart"><div class="bk-items-title bk-clearfix" style="cursor:pointer" ng-click="showOrders=true"><i class="glyphicon glyphicon-shopping-cart"></i><div class="vertical-area"><!----><p class="vertical-area-text">{{config().texts.purchaseCart || \'COMMON_CART_TITLE\' | aliyunBuyText}}</p></div><span class="bk-items-title-quantity bk-orange bk-ml3">{{viewData.totalAmount}}</span></div></div><div ng-show="viewData.totalAmount==0" class="bk-cart-bar bk-orders-menu bk-orders-menu-no-hover bk-mb4"><span class="bk-orders-menu-name"><i class="glyphicon glyphicon-shopping-cart"></i><div class="vertical-area"><!----><p class="vertical-area-text">{{config().texts.purchaseCart || \'COMMON_CART_TITLE\' | aliyunBuyText}}</p></div></span> <span class="bk-orders-menu-quantity bk-pale">{{viewData.totalAmount}}</span></div><div class="bk-orders" ng-init="showOrders=false" ng-if="showOrders==true"><style>.viewFramework-topbar {\n      z-index: 10\n    }</style><div class="bk-cart-backdrop" ng-click="closeCartDialog()"></div><div class="bk-orders-content"><div class="bk-orders-content-bar" role="button" tabindex="0" ng-click="closeCartDialog()" data-spm-click="gostr=/aliyun;locaid=closecart"><div class="bk-items-title bk-clearfix" style="cursor:pointer" ng-click="closeCartDialog()"><i class="glyphicon glyphicon-shopping-cart"></i><div class="vertical-area"><!----><p class="vertical-area-text">{{config().texts.purchaseCart || \'COMMON_CART_TITLE\' | aliyunBuyText}}</p></div><span class="bk-items-title-quantity bk-orange bk-ml3">{{viewData.totalAmount}}</span></div></div><div class="bk-orders-title"><span class="bk-orders-title-txt">{{config().texts.purchaseCart ||\'COMMON_CART_TITLE\' | aliyunBuyText}}</span><!-- --></div><!--viewOrders--><div class="bk-orders-list"><div aliyun-buy-cart-fixed-item config="config()" view-orders="viewData.viewOrders"></div></div><div ng-show="viewData.viewOrders.length>0" class="bk-orders-price"><div class="bk-items-price"><div ng-if="config().showTotalPrice"><div class="bk-items-price-title">{{config().texts.priceTotal || (\'COMMON_PRICE_TOTAL\' | aliyunBuyText) + \'\'}}<!----></div><div class="bk-items-price-settle"><div ng-show="calculating" class="bk-items-price-calculating">{{config().texts.calculatingPrice || \'COMMON_CART_CALCULATING\' | aliyunBuyText}}<!--..--></div><div ng-show="!calculating && price==null" class="bk-items-price-calculating">{{config().texts.calculatingPriceFailed ||\'COMMON_CART_CALCULATING_PRICE_FAILED\' | aliyunBuyText}}<!----></div><span ng-show="!calculating && price!=null"><span class="bk-cny" ng-bind-html="config().currency || \'&yen;\'"></span><span class="bk-items-price-money">{{price.trade | aliyunBuyPriceValue}}</span> <span class="bk-items-price-unit">{{priceUnit|aliyunBuyText}}</span></span></div><div class="bk-items-price-offer" ng-if="price.trade < price.origin"><!--<span class="sedi-buy-cart-submit-cost">--><!--{{config().texts.priceOriginal || \'COMMON_PRICE_ORIGIN\' | aliyunBuyText}}&lt;!&ndash;&ndash;&gt;--><!--<span class="bk-cny" ng-bind-html="config().currency || \'&yen;\'"></span><span>{{price.origin | aliyunBuyPriceValue}}</span>--><!--<span>{{priceUnit|aliyunBuyText}}</span>--><!--</span>--><span class="bk-items-price-rebate">{{config().texts.priceSave || \'COMMON_PRICE_SAVE\' | aliyunBuyText}}<!----><span class="bk-cny" ng-bind-html="config().currency || \'&yen;\'"></span><span>{{price.discount | aliyunBuyPriceValue}}</span> <span>{{priceUnit|aliyunBuyText}}</span></span></div></div></div><div class="bk-orders-control"><form class="" target="_self"><input name="" type="hidden" class="orders-data" value=""><div aliyun-buy-button theme="orange-long" data-spm-click="gostr=/aliyun;locaid=batchpurchase" ng-click="purchase()" is-disabled="{{(calculating&&config().priceShow) || price==null}}">{{config().batchPurchaseButtonText || \'COMMON_CART_BATCH_PURCHASE\' | aliyunBuyText}}<!----></div></form></div></div></div></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyCartFixedItem.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyCartFixedItem.html",'<div class="bk-orders-items-wrapper"><div ng-repeat="viewOrder in viewOrders track by $index" class="bk-orders-item"><div class="bk-orders-item-title"><span class="bk-orders-item-name">{{config().productName}}</span> <span class="bk-orders-item-delete" ng-click="remove($index)" data-spm-click="gostr=/aliyun;locaid=reomvecartitem"><i class="aliyun-icon-wrong-thin"></i></span> <span class="bk-orders-item-quantity">{{viewOrder.amount}}{{config().amountUnit}}</span></div><div class="bk-orders-item-items"><ul class="bk-orders-item-ul"><li ng-repeat="item in viewOrder.items"><div ng-if="item.type"><span class="{{item.labelCss}}" ng-bind-html="item.label"></span><span class="{{item.textCss}}" ng-bind-html="item.text"></span></div></li></ul></div></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyCartGivingTip.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyCartGivingTip.html",'<span><span ng-bind-html="item.price.origin | aliyunBuyPriceValue | aliyunBuyFullPrice:productId"></span><span></span> <span ng-bind-html="(item.price.discount | aliyunBuyPriceValue | aliyunBuyFullPrice:productId )"></span><span></span></span>')}]),angular.module("dominator/base/partials/aliyunBuyCartItem.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyCartItem.html",'<div ng-style="{\'height\':viewOrders.length>2?\'332px\':\'auto\',\'overflow\':\'auto\'}"><div ng-repeat="viewOrder in viewOrders track by $index" class="bk-orders-item"><div class="bk-orders-item-title"><span class="bk-orders-item-name">{{config().productName}}</span> <span class="bk-orders-item-delete" ng-click="remove($index)" data-spm-click="gostr=/aliyun;locaid=reomvecartitem"><i class="aliyun-icon-wrong-thin"></i></span> <span class="bk-orders-item-quantity">{{viewOrder.amount}}{{config().amountUnit}}</span></div><div class="bk-orders-item-items"><ul class="bk-orders-item-ul"><li ng-repeat="item in viewOrder.items"><div ng-if="item.label"><span class="{{item.labelCss}}">{{item.label}}</span><span class="{{item.textCss}}">{{item.text}}</span></div></li></ul></div></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyComboDuration.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyComboDuration.html",'<div class="bk-scope" aliyun-buy-anchor="validate,options.state===\'error\'" ng-class="{\'bk-form-row\':!options.minimized}" ng-hide="options.visible===false"><label class="bk-form-row-name" ng-hide="options.minimized">{{options.name}}</label><div ng-class="{\'bk-form-row-cell\':!options.minimized}"><div ng-class="{\'bk-form-row-li\':!options.minimized}"><div aliyun-buy-select ng-disabled="options.disabled" short="true" ng-model="unit" placeholder="" option="units"></div><div aliyun-buy-select ng-disabled="options.disabled" short="true" ng-model="duration" placeholder="" option="durations" detail="detail"></div></div><div ng-show="options.tip" class="bk-form-row-txt" ng-bind-html="options.tip|aliyunBuyText"></div></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyDatepick.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyDatepick.html",'<div class="bk-form-row" aliyun-buy-anchor="validate,options.state===\'error\'" ng-show="options.visible!==false"><label class="bk-form-row-name">{{options.name}}</label><div class="bk-form-row-cell"><div class="bk-form-row-li" style="height: 38px"><span class="bk-number"><input type="text" readonly="readonly" class="bk-number-input" ng-class="{\'bk-form-input-error\':(options.state===\'error\')}" style="width:110px; padding:0 20px 0 0; font-size:12px;line-height:36px;height:36px" min="options.minDate" max="options.maxDate" my-init-date="{{options.minDate}}" show-weeks="false" show-button-bar="false" toggle-weeks-text="" datepicker-mode current-text="" clear-text="" close-text="" aliyun-buy-datepicker-popup="yyyy-MM-dd" placeholder="" ng-model="date.pickDate"> <span class="bk-number-unit" style="left:100px; line-height: 38px"><span class="aliyun-icon-calendar"></span></span></span><div aliyun-buy-number-stepper class="bk-number bk-ml2" value="pickHours" min="options.min" max="options.max" unit="options.unit"></div><span class="bk-form-row-txt bk-ml1" style="line-height:36px"><span>00</span></span></div><div class="bk-form-row-txt" ng-show="options.state==\'error\'"><span class="bk-form-status bk-form-error"><i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message"></span></span></div><div class="bk-form-row-txt" ng-show="options.canNotRestartInstance==\'yes\'"><span class="bk-form-status bk-form-error"><i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message">12:0012:00</span></span></div><div class="bk-form-row-txt" ng-hide="!options.tip"><div ng-bind-html="options.tip | aliyunBuyText"></div></div></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyDialog/backdrop.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyDialog/backdrop.html",'<span class="bk-scope"><div class="bk-modal-backdrop fade" ng-class="{in: animate}" ng-style="{\'z-index\': 1040 + index*10}"></div></span>')}]),angular.module("dominator/base/partials/aliyunBuyDialog/window.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyDialog/window.html",'<span class="bk-scope" aliyun-buy-disable-ng-animate><div tabindex="-1" class="bk-dialog fade {{ windowClass }}" ng-class="{in: animate}" ng-style="{\'z-index\': 1050 + index*10, display: \'block\'}" ng-click="close($event)"><div class="bk-dialog-box"><div class="bk-modal-content" ng-transclude></div></div></div></span>')}]),angular.module("dominator/base/partials/aliyunBuyDuration.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyDuration.html",'<div class="bk-form-row-cell" style="position: relative" ng-show="options.visible!==false"><div class="bk-form-row-li"><div ng-show="options.discountTip1 != \'\'" aliyun-buy-tip="{{options.discountTip1 ? options.discountTip1:\'COMMON_DURATION_TIP1\' | aliyunBuyText}}" trigger="_value >= 9 && _value <= 12" left="373" top="-22" z-index="98"></div><div ng-show="options.discountTip2 != \'\'" aliyun-buy-tip="{{options.discountTip2 ? options.discountTip2:\'COMMON_DURATION_TIP2\' | aliyunBuyText}}" trigger="_value > 12 && _value <= 24" left="428" top="-22" z-index="98"></div><div ng-show="options.discountTip3 != \'\'" aliyun-buy-tip="{{options.discountTip3 ? options.discountTip3:\'COMMON_DURATION_TIP3\' | aliyunBuyText}}" trigger="_value > 24" left="483" top="-22" z-index="98"></div><div aliyun-buy-slider class="bk-slider bk-slider-duration" step-option="options.stepOption" value="_value" max-value="options.max" min-value="options.min" unit="options.unit" formatter="options.formatter"></div><span ng-show="options.showAutoRenew"><label class="bk-ml5 bk-input-checkbox"><input class="bk-mr1" type="checkbox" ng-model="autoRenew">{{\'COMMON_AUTORENEW\' | aliyunBuyText}}</label></span><a ng-show="options.autoRenewAskTip" aliyun-buy-tooltip="{{options.autoRenewAskTip | aliyunBuyText}}" ng-href="javascript:;" class="bk-ml2" data-spm-click="gostr=/aliyun;locaid=autoRenew"><i class="aliyun-icon-help"></i></a></div><div class="bk-form-row-txt" ng-hide="!options.tip"><div ng-bind-html="options.tip"></div></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyFieldTips.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyFieldTips.html",'<span><a class="bk-lnk {{options.textTip.class}}" target="{{options.textTip.target || \'_self\'}}" ng-if="options.textTip" ng-href="{{ options.textTip.href || \'javascript:;\'}}" data-spm-click="gostr=/aliyun;locaid={{options.textTip.spm}}" aliyun-buy-tooltip="{{options.textTip.tooltip}}" ng-bind-html="options.textTip.text"></a> <a class="bk-lnk {{options.askTip.class}}" ng-if="options.askTip" ng-href="{{options.askTip.href || \'javascript:;\'}}" data-spm-click="gostr=/aliyun;locaid={{options.askTip.spm}}" aliyun-buy-tooltip="{{options.askTip.tooltip}}" target="{{options.askTip.target || \'_self\'}}"><i class="aliyun-icon-help"></i></a></span>')}]),angular.module("dominator/base/partials/aliyunBuyFloats/floatbox.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyFloats/floatbox.html",'<div ng-style="{width:width?width + \'px\':\'auto\',\'max-width\': maxWidth? maxWidth + \'px\' : \'auto\', \'min-width\': minWidth? minWidth + \'px\' : \'auto\'}" class="bk-scope"><div class="bk-tip-white" style="position:relative" ng-if="theme==\'white\' || theme==\'right\'"><span aliyun-buy-floatbox-transclude ng-style="{height: innerHeight}"></span> <span class="bk-tip-arrow"><span class="bk-tip-arrow-inner"></span></span><!--hovertip--><!-- <span class="bk-tip-arrow-patch-box">\n    </span> --></div><div class="bk-tip-orange" style="position:relative" ng-if="theme==\'orange\'"><span aliyun-buy-floatbox-transclude ng-style="{height: innerHeight}"></span> <i class="bk-tip-arrow"></i></div><div class="bk-title" style="width:auto" ng-if="theme==\'border\'"><div class="bk-title-box"><div class="bk-title-head" ng-if="title">{{title}}</div><div class="bk-title-body" aliyun-buy-floatbox-transclude style="overflow:auto; overflow-x:hidden" ng-style="{height: innerHeight, \'max-height\':innerMaxHeight, \'min-height\': innerMinHeight}"></div></div></div><div class="bk-title" style="width:auto" ng-if="theme==\'blank\'"><div class="bk-title-box" style="padding:0"><div class="bk-title-body" style="padding:0" aliyun-buy-floatbox-transclude style="overflow:auto; overflow-x:hidden" ng-style="{height: innerHeight, \'max-height\':innerMaxHeight, \'min-height\': innerMinHeight}"></div></div></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyGroup.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyGroup.html",'<dl class="bk-group" ng-class="{\'bk-group-collapsed\':collapsed==\'true\'&&disabled!=\'false\', \'bk-group-disabled\':disabled==\'true\'}" ng-hide="displayGroup==false"><dt class="bk-group-title"><span ng-bind-html="title"></span><div class="bk-group-tip" ng-show="groupTip"></div></dt><dd class="bk-group-detail"><div class="bk-group-control"><span ng-show="collapsable===\'true\'||collapsable===true" class="bk-group-switch" ng-click="toggle()">{{collapsed===\'true\'||collapsed===true?\'\':\'\'}} <span class="bk-group-switch-icon"><i class="bk-group-switch-arrow"></i></span></span></div><div aliyun-buy-group-transclude></div><div class="bk-group-intro" ng-show="groupIntro"></div></dd></dl>')}]),angular.module("dominator/base/partials/aliyunBuyInfo.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyInfo.html",'<div class="bk-info"><div class="title">{{options.name}}</div><div class="conent"><table><tr><td><span class="bk-pale">ID:</span>{{options.instanceId}}</td><td><span class="bk-pale">:</span>{{options.instanceName}}</td><td><span class="bk-pale">:</span>{{options.rds_region_name}}</td><td style="width: 240px; display: block" ng-hide="!options.rds_iz_name&&options.rds_iz_name!=0"><span class="bk-pale">:</span>{{options.rds_iz_name}}</td></tr><tr><td><span class="bk-pale">:</span>{{options.rds_dbtype}}</td><td><span class="bk-pale">:</span>{{options.rds_dbversion}}</td><td><span class="bk-pale">:</span>{{options.rds_storage}}GB</td><td><span class="bk-pale">:</span>{{options.rds_ram}}</td></tr></table></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyMsg.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyMsg.html",'<div class="bk-dialog-head"><span class="bk-dialog-close" ng-click="$close()"><span class="aliyun-icon-wrong"></span></span><h5 class="bk-dialog-title">{{title}}</h5></div><div class="bk-dialog-body" ng-bind-html="body"></div><div class="bk-dialog-foot" ng-if="!(!config||!config.buttons)"><button aliyun-buy-button ng-repeat="button in config.buttons track by $index" theme="{{button.theme}}" ng-click="button.handler.call(dialog)">{{button.text}}</button></div>')}]),angular.module("dominator/base/partials/aliyunBuyNotice.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyNotice.html",'<div class="bk-message-row bk-message-row-normal bk-mb4" ng-show="text | aliyunBuyText"><div class="bk-message-row-icon"><i class="aliyun-icon-info"></i></div><div class="bk-message-row-message" ng-bind-html="text | aliyunBuyText"></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyNumberStepper/numberStepper.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyNumberStepper/numberStepper.html",'<span class="bk-number"><input type="text" aria-labelledby="{{labelId}}" aria-valuemax="{{max}}" aria-valuemin="{{min}}" class="bk-number-input" aliyun-buy-number-only support-float="{{supportFloat}}" ng-model="_value" ng-blur="blur()" data-spm-click="gostr=/aliyun;locaid=number;attr={{value}}" ng-disabled="isDisabled"> <span class="bk-number-unit" ng-show="unit">{{unit}}</span> <span class="bk-number-control" ng-hide="hideControl"><span class="bk-number-up bk-number-disabled" ng-class="{\'bk-number-disabled\': isDisabled}" data-spm-click="gostr=/aliyun;locaid=numberplus;attr={{value}}" ng-show="max && value >= max"><i class="bk-number-arrow"></i></span> <span class="bk-number-up" ng-click="plus()" ng-class="{\'bk-number-disabled\': isDisabled}" data-spm-click="gostr=/aliyun;locaid=numberplus;attr={{value}}" ng-hide="max && value >= max"><i class="bk-number-arrow"></i></span> <span class="bk-number-down bk-number-disabled" ng-class="{\'bk-number-disabled\': isDisabled}" data-spm-click="gostr=/aliyun;locaid=numberminus;attr={{value}}" ng-show="value <= min"><i class="bk-number-arrow"></i></span> <span class="bk-number-down" ng-click="less()" ng-class="{\'bk-number-disabled\': isDisabled}" data-spm-click="gostr=/aliyun;locaid=numberminus;attr={{value}}" ng-hide="value <= min"><i class="bk-number-arrow"></i></span></span></span>')}]),angular.module("dominator/base/partials/aliyunBuyOrderButton.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyOrderButton.html",'<div><div class="bk-order-pact" ng-show="config.agreement"><a href="javascript:;" class="bk-order-pact-box" ng-click="termsChecked=!termsChecked" ng-class="{\'bk-order-pact-box-select\':termsChecked, \'\':!termsChecked}"><span class="dis-inline-block" ng-class="{\'aliyun-icon-yes2\':termsChecked, \'\':!termsChecked}"></span></a> <a class="bk-order-pact-link" href="{{config.agreement.link}}" target="_blank">{{config.agreement.text}}</a></div><div class="bk-items-price-control bk-order-price-control bk-order-price-wrap"><div aliyun-buy-button ng-click="pay()" data-spm-click="gostr=/aliyun;locaid={{config.spm || \'buyButton\'}}" is-disabled="{{(termsChecked!=undefined &&!termsChecked) || isDisabled}}">{{config.payText}}</div></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyPopover/yundun.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyPopover/yundun.html","<div ng-bind-html=\"'ECS_YUNDUN_TIP'|aliyunBuyText\"></div>")}]),angular.module("dominator/base/partials/aliyunBuyPriceView.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyPriceView.html",'<div class="bk-order-price-wrap price-theme-1 {{config.priceWrapCss}}"><div class="bk-scope bk-items-price-settle" style="font-size: 16px;color:#000" ng-show="priceResult.state === \'currentConfiguration\' ">{{config.texts.currentConfiguration || \'\'}}</div><div class="bk-scope bk-items-price-settle" style="font-size: 16px" ng-show="priceResult.state === \'error\'">{{config.texts.calculatingPriceFailed || \'\'}}</div><div class="bk-scope" ng-show="!priceResult.state && !priceResult.empty"><!--priceList --><div ng-if="priceResult.priceList"><div class="bk-mb3 bk-items-price-item" ng-repeat="priceItem in priceResult.priceList track by $index"><div class="bk-items-price-title bk-pale inline-block" style="margin-top: 10px"><span style="font-size: 16px;color: #000" class="bk-mr2">{{priceItem.name}}</span> <a class="bk-lnk bk-ml1" ng-show="priceItem.askTip" href="javascript:;" data-spm-click="gostr=/aliyun;locaid={{$index}}Pricehelp" aliyun-buy-tooltip="{{priceItem.askTip}}"><i class="aliyun-icon-help"></i></a></div><!--  + --><div class="bk-items-price-settle inline-block bk-ml2"><div ng-if="priceResult.calculating" class="bk-items-price-calculating">{{config.texts.calculatingPrice || \'...\'}}<!--...--></div><div ng-if="priceResult && priceResult.calculating != undefined && !priceResult.calculating && priceItem.trade !== 0 && !priceItem.trade" class="bk-items-price-calculating">{{config.texts.calculatingPriceFailed || \'\'}}<!----></div><div ng-if="priceResult && !priceResult.calculating && (priceItem.trade || priceItem.trade === 0)"><span class="bk-cny" ng-bind-html="config.currency || (priceItem.currency|aliyunBuyPriceCurrency) ||  \'&yen;\'"></span> <span class="bk-items-price-money">{{priceItem.trade | aliyunBuyPriceValue}}{{priceItem.currency |aliyunBuyPriceCurrencyText}}</span> <span class="bk-items-price-unit">{{priceItem.priceUnit}}&nbsp;</span></div></div><!-- --><div class="bk-items-price-offer" ng-if="priceItem.trade < priceItem.origin"><span class="bk-items-price-rebate">{{config.texts.priceSave || \'\'}}<!----><span class="bk-cny" ng-bind-html="config.currency || (priceItem.currency|aliyunBuyPriceCurrency) || \'&yen;\'"></span>{{priceItem.discount | aliyunBuyPriceValue}}{{priceItem.currency |aliyunBuyPriceCurrencyText}}{{priceItem.priceUnit}}</span></div><!-- --><div class="bk-items-price-tag" ng-if="priceItem.strategies.length > 0"><i class="bk-items-price-tag-title aliyun-icon-giving"></i><div class="bk-items-price-tag-list"><span ng-repeat="strategy in priceItem.strategies" class="bk-ploy" title="{{strategy.title}}">{{strategy.name}}</span></div></div></div></div><!--priceList --><div ng-hide="priceResult.priceList"><!--  + +--><div class="bk-items-price-settle"><div ng-if="priceResult.calculating" class="bk-items-price-calculating">{{config.texts.calculatingPrice || \'...\'}}<!--...--></div><div ng-if="!priceResult.calculating && (!priceResult.success || (priceResult.trade !== 0 && !priceResult.trade)) " class="bk-items-price-calculating"><span ng-bind-html="(priceResult.message || config.texts.calculatingPriceFailed ||\n                  \'\')"></span></div><div ng-if="!priceResult.calculating  && priceResult.success && priceResult.trade!==null"><span ng-show="priceResult.flowPrice!=undefined"><span ng-show="priceResult.flowPrice!=undefined" style="font-size: 16px;color:#000" class="bk-mr2">{{config.texts.flowPrice || \'\' + \'\'}}</span><span class="bk-cny" ng-bind-html="config.currency ||(priceResult.currency|aliyunBuyPriceCurrency) ||\'&yen;\'"></span><span class="bk-items-price-money">{{priceResult.flowPrice | aliyunBuyPriceValue}}{{priceResult.currency |aliyunBuyPriceCurrencyText}}</span><span class="bk-items-price-unit">{{priceResult.flowPriceUnit}}</span></span> <span style="font-size: 16px;color:#000" class="bk-mr2">{{config.texts.payment || \'\'}}</span><span class="bk-cny" ng-bind-html="config.currency ||(priceResult.currency|aliyunBuyPriceCurrency) || \'&yen;\'"></span> <span class="bk-items-price-money">{{priceResult.trade | aliyunBuyPriceValue}}{{priceResult.currency |aliyunBuyPriceCurrencyText}}</span> <span class="bk-items-price-unit">{{config.priceUnit || priceResult.basePriceUnit}}</span></div></div><!-- --><div class="bk-items-price-offer" ng-if="priceResult.trade < priceResult.origin "><span class="bk-items-price-rebate">{{config.texts.priceSave || \'\'}}<!----><span class="bk-cny" ng-bind-html="config.currency ||(priceResult.currency|aliyunBuyPriceCurrency) || \'&yen;\'"></span> {{priceResult.discount | aliyunBuyPriceValue}} {{priceResult.currency |aliyunBuyPriceCurrencyText}} {{ config.priceUnit || priceResult.basePriceUnit}}</span><div class="y-mt3"></div></div><!-- --><div class="bk-items-price-tag bk-order-price-tag" ng-if="priceResult.trade!==null && priceResult.strategies.length > 0"><div class="bk-items-price-tag-list"><i class="bk-order-price-tag-title aliyun-icon-giving"></i> <span ng-repeat="strategy in priceResult.strategies" class="bk-order-ploy" title="{{strategy.title}}">{{strategy.name}}</span></div></div><div class="bk-items-price-tag bk-order-price-tag" ng-if="priceResult.trade!==null && priceResult.strategies.length == 0 && priceResult.children[0].strategies.length > 0"><div class="bk-items-price-tag-list"><i class="bk-order-price-tag-title aliyun-icon-giving"></i> <span ng-repeat="strategy in priceResult.children[0].strategies" class="bk-order-ploy" title="{{strategy.title}}">{{strategy.name}}</span></div></div></div></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyResourceGroup.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyResourceGroup.html",'<div class="bk-form-row-li"><div aliyun-buy-select class="bk-select-1" placeholder="{{directories.placeholder}}" ng-model="directory" option="directories" label-id="labelId"></div><div aliyun-buy-select class="bk-select-2" placeholder="{{resourceGroups.placeholder}}" ng-model="resourceGroup" option="resourceGroups" label-id="labelId"></div><!--<a class="bk-lnk {{options.textTip.class}}"--><!--target="{{options.textTip.target || \'_blank\'}}"--><!--ng-if="options.textTip"--><!--ng-href="{{ options.textTip.href || \'javascript:;\'}}"--><!--data-spm-click="gostr=/aliyun;locaid={{options.textTip.spm}}"--><!--aliyun-buy-tooltip="{{options.textTip.tooltip}}"--><!--title="{{options.textTip.text}}"--><!--ng-bind-html="options.textTip.text"></a>--><!--<a class="bk-lnk {{options.askTip.class}}"--><!--ng-if="options.askTip"--><!--ng-href="{{options.askTip.href || \'javascript:;\'}}"--><!--data-spm-click="gostr=/aliyun;locaid={{options.askTip.spm}}"--><!--title="{{options.askTip.tooltip}}"--><!--aliyun-buy-tooltip="{{options.askTip.tooltip}}"--><!--target="{{options.askTip.target || \'_blank\'}}">--><!--<i class="aliyun-icon-help"></i></a>--></div><!--<div class="bk-form-row-txt"--><!--ng-bind-html="options.tip"--><!--ng-show="options.tip"></div>--><!--<div class="topbar-resourcegroup inline-block" ng-if="supportCurrentProduct && showResourceGroup" ng-class="{\'open\': isResourceGroupOpen}">--><!--<div class="topbar-btn topbar-resourcegroup-btn" ng-click="toggleResourceGroup($event)">--><!--<span>{{currentSelectResourceGroup}}</span>--><!--<span class="icon-arrow-down"></span>--><!--</div>--><!--<div class="topbar-resourcegroup-dropdown" ng-class="{\'topbar-show\': isResourceGroupOpen}">--><!--<div class="topbar-resourcegroup-container">--><!--<div class="topbar-category-list" ng-if="directories.length > 1">--><!--<ul>--><!--<li ng-repeat="item in directories track by $index" ng-class="{\'selected\': item.OwnerId == resourceOwnerId }" ng-click="listResourceGroups(item.OwnerId)">--><!--{{item.DisplayName}}--><!--<span class="topbar-resourcegroup-type" ng-if="item.OwnerId">{{item.isOwned ? i18nMessage[\'resouceGroup.type.selfSupport\'] : i18nMessage[\'resouceGroup.type.agent\']}}</span>--><!--</li>--><!--</ul>--><!--</div>--><!--<div class="topbar-resourcegroup-list" ng-class="{\'loading\': loading}">--><!--<div class="topbar-resourcegroup-list-wrapper">--><!--<ul ng-if="resourceGroups.length > 0">--><!--<li ng-repeat="item in resourceGroups" ng-click="resourceGroupChange(item.Id, item.DisplayName)" ng-class="{\'selected\': item.Id == resourceGroupId }">{{item.DisplayName}}</li>--><!--</ul>--><!--<div ng-if="resourceGroups.length == 0" class="noData">{{noData}}</div>--><!--</div>--><!--</div>--><!--</div>--><!--</div>--><!--</div>-->')}]),angular.module("dominator/base/partials/aliyunBuySelectTable.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuySelectTable.html",'<div class="bk-form-row" ng-hide="options.visible===false"><label class="bk-form-row-name">{{config.selectName}}</label><div class="bk-form-row-cell"><div class="bk-form-row-li"><span><span class="bk-select bk-select-l3" ng-class="{\'bk-select-disabled\':ngDisabled,\'bk-select-error\':state,\'bk-select-focus\':open}"><span class="bk-select-button" ng-click="openSelcet($event)" ng-class="{\'bk-select-current\':value}"><span class="bk-select-txt" ng-bind="placeholder[0].text"></span> <span class="bk-select-txt" ng-if="!placeholder[0].text">{{config.placeholder}}</span> <span class="bk-select-arrow" ng-class="{\'bk-select-arrow-rotate\':open}"></span></span><div class="bk-select-option-title" ng-if="open && list.length"><span class="bk-select-option-title-txt" ng-bind="config.ramName"></span> <span class="bk-select-option-title-txt" ng-bind="config.networkthroughputName"></span> <span class="bk-select-option-title-txt" ng-bind="config.qpsName"></span></div><ul class="bk-select-options" style="top:60px" ng-if="open && list.length"><li class="bk-select-option" ng-repeat="i in list" ng-click="check(i)"><span class="bk-select-option-txt" style="width:90px;display: inline-block" title="{{i[0].text}}" ng-bind="i[0].text"></span> <span class="bk-select-option-txt" style="width:90px;color:#999;display: inline-block" title="{{i[1].text}}" ng-bind="i[1].text"></span> <span class="bk-select-option-txt" style="width:90px;color:#999;display: inline-block" title="{{i[2].text}}" ng-bind="i[2].text"></span></li></ul><ul class="bk-select-options" ng-if="!list.length"><li class="bk-select-option"><span class="bk-select-option-txt"></span></li></ul></span> <span class="bk-select-follow-tip"><span ng-bind="placeholder[1].text"></span> QPS<span ng-bind="placeholder[2].text"></span></span></span></div><div class="bk-form-row-txt" ng-bind-html="options.tip" ng-show="options.tip"></div></div></div>')}]),angular.module("dominator/base/partials/aliyunBuySlider/popover.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuySlider/popover.html",'<div style="background: #eee;background: rgba(0,0,0,.2);padding: 4px;position: absolute;z-index: 1070"><div style="padding: 5px 20px 17px;background: #fff;line-height: 1.5;color: #333"><div ng-if="title" ng-bind="title" style="padding: 7px 0 0;line-height: 2;font-size: 16px;font-weight: 700;border-bottom: solid 1px #dedede"></div><div ng-if="!title" style="height: 12px"></div><div class="content"></div></div></div>')}]),angular.module("dominator/base/partials/aliyunBuySlider/slider.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuySlider/slider.html",'<span class="sedi-uc-slider" style="width: 100%"><div class="sedi-range"><span class="sedi-block" ng-repeat="i in _stepOption" ng-style="i.css"><div ng-class="{\'sedi-last\':_stepOption.length - 1 == $index}"><span ng-class="{\'sedi-last\':_stepOption.length - 1 == $index}">{{textLable[$index]}}{{i.width}}</span></div></span><div ng-class="{\'sedi-uc-slide-animation\':!ismousedown}" class="sedi-container" ng-style="{\'width\':barWidth+\'px\'}"><div class="sedi-current"><span class="sedi-unit" ng-repeat="i in _stepOption"><div ng-class="{\'sedi-uc-slide-month\': i.max == value && value < 12 && isDuration}"><span ng-class="{\'sedi-last\':_stepOption.length - 1 == $index}">{{textLable[$index]}}</span></div></span></div></div><div class="sedi-bar"></div><a href="javascript:;" rel="nofollow" ng-class="{\'sedi-uc-slide-animation\':!ismousedown}" class="sedi-drag" target="_self" ng-style="{\'left\':barLeft+\'px\'}" style="width: 15px;height: 30px" hidefocus><i></i> <i></i> <i></i></a></div></span>')}]),angular.module("dominator/base/partials/aliyunBuySubtotal.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuySubtotal.html",'<div ng-hide="config.visible===false" class="bk-scope bk-items bk-subtotal"><div class="bk-items-title">{{config.texts.currentConfig || (\'COMMON_SUBTOTAL_TITLE\' | aliyunBuyText)}}<!----></div><div aliyun-buy-subtotal-model view-data="viewData" handle="handle"></div><div ng-if="vm.priceServiceConfiged" class="bk-items-price" style="padding-top: 0"><div ng-if="priceResult.data.priceList"><div class="bk-mb3 bk-items-price-item" ng-repeat="priceItem in priceResult.data.priceList track by $index"><div class="bk-items-price-title bk-pale">{{priceItem.name}} <a class="bk-lnk bk-ml1" ng-show="priceItem.askTip" href="javascript:;" data-spm-click="gostr=/aliyun;locaid={{$index}}Pricehelp" aliyun-buy-tooltip="{{priceItem.askTip}}"><i class="aliyun-icon-help"></i></a></div><div class="bk-items-price-settle {{priceItem.moneyClass}}"><div ng-if="priceResult.calculating" class="bk-items-price-calculating">{{config.texts.calculatingPrice || (\'COMMON_SUBTOTAL_CALCULATING_PRICE\' | aliyunBuyText)}}<!--...--></div><div ng-if="priceResult && priceResult.calculating != undefined && !priceResult.calculating && priceItem.trade !== 0 && !priceItem.trade" class="bk-items-price-calculating">{{config.texts.calculatingPriceFailed || (\'COMMON_SUBTOTAL_CALCULATING_PRICE_FAILED\' | aliyunBuyText)}}<!----></div><div ng-if="priceResult && !priceResult.calculating && (priceItem.trade || priceItem.trade === 0)"><span class="bk-cny" ng-bind-html="config.currency || \'&yen;\'"></span><span class="bk-items-price-money">{{priceItem.trade | aliyunBuyPriceValue}}</span><span class="bk-items-price-unit">{{priceItem.priceUnit}}</span></div></div><div class="bk-items-price-offer" ng-if="priceItem.trade < priceItem.origin"><!--<span class="bk-items-price-cost bk-mr1">--><!--{{config.texts.priceOriginal || \'COMMON_PRICE_ORIGIN\' | aliyunBuyText}}&lt;!&ndash;&ndash;&gt;<span class="bk-cny" ng-bind-html="config.currency || \'&yen;\'"></span>{{priceItem.origin | aliyunBuyPriceValue}}{{priceItem.priceUnit | aliyunBuyText}}--><!--</span>--><span class="bk-items-price-rebate">{{config.texts.priceSave || (\'COMMON_PRICE_SAVE\' | aliyunBuyText)}}<!----><span class="bk-cny" ng-bind-html="config.currency || \'&yen;\'"></span>{{priceItem.discount | aliyunBuyPriceValue}}{{priceItem.priceUnit|aliyunBuyText}}</span></div><div class="bk-items-price-tag" ng-if="priceItem.strategies.length > 0"><i class="bk-items-price-tag-title aliyun-icon-giving"></i><div class="bk-items-price-tag-list"><span ng-repeat="strategy in priceItem.strategies" class="bk-ploy" title="{{strategy.title}}">{{strategy.name|aliyunBuyText}}</span></div></div></div></div><div ng-hide="!priceResult.data.trade && priceResult.data.trade !== 0 && priceResult.data.priceList"><div class="bk-items-price-title bk-pale">{{config.texts.basePrice || (\'COMMON_SUBTOTAL_BASE_PRICE\' |aliyunBuyText) + \'\'}}<!----></div><div class="bk-items-price-settle"><div ng-if="priceResult.calculating" class="bk-items-price-calculating">{{config.texts.calculatingPrice || (\'COMMON_SUBTOTAL_CALCULATING_PRICE\' | aliyunBuyText)}}<!--...--></div><div ng-if="priceResult && priceResult.calculating != undefined && !priceResult.calculating && priceResult.data.trade !== 0 && !priceResult.data.trade" class="bk-items-price-calculating">{{config.texts.calculatingPriceFailed || (\'COMMON_SUBTOTAL_CALCULATING_PRICE_FAILED\' | aliyunBuyText)}}<!----></div><div ng-if="priceResult && !priceResult.calculating && (priceResult.data.trade || priceResult.data.trade === 0)"><span class="bk-cny" ng-bind-html="config.currency || \'&yen;\'"></span><span class="bk-items-price-money">{{priceResult.data.trade | aliyunBuyPriceValue}}</span><span class="bk-items-price-unit">{{config.priceUnit || (priceResult.data.basePriceUnit|aliyunBuyText)}}</span></div></div><div class="bk-items-price-offer" ng-if="priceResult.data.trade < priceResult.data.origin"><!--<span class="bk-items-price-cost bk-mr1">--><!--{{config.texts.priceOriginal || \'COMMON_PRICE_ORIGIN\' | aliyunBuyText}}&lt;!&ndash;&ndash;&gt;<span class="bk-cny" ng-bind-html="config.currency || \'&yen;\'"></span>{{priceResult.data.origin | aliyunBuyPriceValue}}{{config.priceUnit ? config.priceUnit : priceResult.data.basePriceUnit|aliyunBuyText}}--><!--</span>--><span class="bk-items-price-rebate">{{config.texts.priceSave || (\'COMMON_PRICE_SAVE\' | aliyunBuyText)}}<!----><span class="bk-cny" ng-bind-html="config.currency || \'&yen;\'"></span>{{priceResult.data.discount | aliyunBuyPriceValue}}{{ config.priceUnit || (priceResult.data.basePriceUnit|aliyunBuyText)}}</span></div><div class="bk-items-price-tag" ng-if="priceResult.data.strategies.length > 0"><i class="bk-items-price-tag-title aliyun-icon-giving"></i><div class="bk-items-price-tag-list"><span ng-repeat="strategy in priceResult.data.strategies" class="bk-ploy" title="{{strategy.title}}">{{strategy.name|aliyunBuyText}}</span></div></div></div></div><div class="bk-items-price" ng-if="priceResult.data.flowPrice != undefined"><div class="bk-items-price-title bk-pale">{{config.texts.flowPrice || (\'COMMON_SUBTOTAL_FLOW_PRICE\' | aliyunBuyText) + \'\'}}<!----><a class="bk-lnk bk-ml1" href="javascript:;" data-spm-click="gostr=/aliyun;locaid=flowPricehelp" aliyun-buy-tooltip="{{config.texts.flowPriceTip || (\'COMMON_FLOW_PRICE_TIP\' | aliyunBuyText)}}" title="{{\'COMMON_FLOW_PRICE_TIP\' | aliyunBuyText}}"><i class="aliyun-icon-help"></i></a></div><div class="bk-items-price-settle"><span class="bk-cny" ng-bind-html="config.currency || \'&yen;\'"></span><span class="bk-items-price-money">{{priceResult.data.flowPrice | aliyunBuyPriceValue:\'flow\'}}</span><span class="bk-items-price-unit">{{config.flowPriceUnit || priceResult.data.flowPriceUnit}}</span></div></div><div class="bk-items-price-control"><span class="bk-button-purchase-wrapper"><div aliyun-buy-button ng-click="purchase()" is-disabled="{{isDisableButton(priceResult)}}" data-spm-click="gostr=/aliyun;locaid=purchase">{{config.purchaseButtonText || (\'COMMON_SUBTOTAL_BUTTON_BUY_NOW\' | aliyunBuyText)}}<!----></div></span> <span ng-if="config.displayCart !== \'none\' " class="bk-button-addtocart-wrapper"><div aliyun-buy-button ng-click="addToCart()" is-disabled="{{isDisableButton(priceResult) || config.addCartAvailable === false}}" theme="default" tip="{{config.addCartTip}}" data-spm-click="gostr=/aliyun;locaid=addtocart">{{config.addToCartButtonText || (\'COMMON_SUBTOTAL_BUTTON_ADD_TO_CART\' | aliyunBuyText)}}<!----></div></span><div ng-if="config.purchaseTip|aliyunBuyText" class="bk-items-price-info" style="color: #ee0000" ng-bind-html="config.purchaseTip|aliyunBuyText"></div><div ng-if="config.priceTip|aliyunBuyText" class="bk-items-price-info bk-pale" ng-bind-html="config.priceTip|aliyunBuyText"></div></div><div class="bk-pb4"></div></div>')}]),angular.module("dominator/base/partials/aliyunBuySubtotalFixed.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuySubtotalFixed.html",'<div ng-hide="config.visible===false" class="bk-scope bk-items bk-subtotal"><div class="bk-items-title"><i class="icon-setup"></i>{{config.texts.currentConfig || \'\'}}<!----></div><div class="bk-items-right-tip" ng-if="config.texts.rightTip"><span ng-bind-html="config.texts.rightTip"></span></div><!-- --><div aliyun-buy-subtotal-fixed-model view-data="viewData"></div><!--subtotalfixed  --><div ng-if="vm.priceServiceConfiged" class="bk-items-price bk-subtotal-footer"><div class="bk-items-price-wrapper" ng-show="!priceResult.empty"><!--priceList --><div ng-show="priceResult.data.priceList"><div class="bk-mb3 bk-items-price-item" ng-repeat="priceItem in priceResult.data.priceList track by $index"><div class="bk-items-price-title bk-pale" style="vertical-align: baseline">{{priceItem.name}} <a class="bk-lnk bk-ml1" ng-show="priceItem.askTip" href="javascript:;" data-spm-click="gostr=/aliyun;locaid={{$index}}Pricehelp" aliyun-buy-tooltip="{{priceItem.askTip}}"><i class="aliyun-icon-help"></i></a></div><div style="display: inline-block;vertical-align: baseline"><div ng-show="priceResult.calculating"><div class="bk-items-price-settle"><div class="bk-items-price-calculating">{{config.texts.calculatingPrice || \'...\'}}<!--...--></div></div></div></div><div style="display: inline-block;vertical-align: baseline"><div ng-hide="priceResult.calculating || priceResult.calculating == undefined"><div ng-if="priceItem.trade !== 0 && !priceItem.trade"><div class="bk-items-price-settle"><div class="bk-items-price-calculating">{{config.texts.calculatingPriceFailed || \'\'}}<!----></div></div></div><div ng-if="priceItem.trade || priceItem.trade === 0"><!-- --><div class="bk-items-price-settle {{priceItem.moneyClass}}"><span class="bk-cny" ng-bind-html="config.currency || (priceItem.currency|aliyunBuyPriceCurrency) ||  \'&yen;\'"></span> <span class="bk-items-price-money" style="margin-left: -10px">{{priceItem.trade | aliyunBuyPriceValue}}{{priceItem.currency |aliyunBuyPriceCurrencyText}}</span> <span class="bk-items-price-unit">{{priceItem.priceUnit}}&nbsp;</span></div><!-- --><div class="bk-items-price-offer" ng-if="priceItem.trade < priceItem.origin"><span class="bk-items-price-rebate">{{config.texts.priceSave || \'\'}}<!----><span class="bk-cny" ng-bind-html="config.currency || (priceItem.currency|aliyunBuyPriceCurrency) || \'&yen;\'"></span> <span style="margin-left: -5px">{{priceItem.discount | aliyunBuyPriceValue}}</span> {{priceItem.currency |aliyunBuyPriceCurrencyText}}{{priceItem.priceUnit}}</span></div><!-- --><div class="bk-items-price-tag" ng-if="priceItem.strategies.length > 0"><i class="bk-items-price-tag-title aliyun-icon-giving"></i><div class="bk-items-price-tag-list"><span ng-if="priceItem.strategies.length >= 3" aliyun-dynamic-tooltip id="priceTagStrategies" class="bk-ploy-more" strategies="priceItem.strategies"></span> <span ng-if="priceItem.strategies.length < 3" ng-repeat="strategy in priceItem.strategies" class="bk-ploy" title="{{strategy.title}}">{{strategy.name}}</span></div></div></div></div></div></div></div><!--priceList --><div ng-hide="priceResult.data.priceList"><div class="bk-items-price-title bk-pale" style="vertical-align: baseline">{{config.texts.basePrice || priceResult.data.name || \'\' + \'\'}}<!----></div><div style="display: inline-block;vertical-align: baseline"><div ng-show="priceResult.calculating" class="bk-items-price-settle"><div class="bk-items-price-calculating">{{config.texts.calculatingPrice ||\'...\'}}<!--...--></div></div></div><div style="display: inline-block;vertical-align: baseline"><div ng-hide="priceResult.calculating || priceResult.calculating == undefined"><div ng-if="priceResult.data.trade !== 0 && !priceResult.data.trade"><div class="bk-items-price-settle"><div class="bk-items-price-calculating">{{config.texts.calculatingPriceFailed || \'\'}}<!----></div></div></div><div ng-if="priceResult.data.trade || priceResult.data.trade === 0"><!-- --><div class="bk-items-price-settle"><span class="bk-cny" ng-bind-html="config.currency || (priceResult.data.currency|aliyunBuyPriceCurrency) || \'&yen;\'"></span> <span class="bk-items-price-money" style="margin-left: -10px">{{priceResult.data.trade | aliyunBuyPriceValue}}{{priceResult.data.currency |aliyunBuyPriceCurrencyText}}</span> <span class="bk-items-price-unit">{{config.priceUnit || priceResult.data.priceUnit || priceResult.data.basePriceUnit}}&nbsp;</span></div><!-- --><div class="bk-items-price-offer" ng-if="priceResult.data.trade < priceResult.data.origin"><span class="bk-items-price-rebate">{{config.texts.priceSave || \'\'}}<!----><span class="bk-cny" ng-bind-html="config.currency || (priceResult.data.currency|aliyunBuyPriceCurrency) || \'&yen;\'"></span> <span style="margin-left: -5px">{{priceResult.data.discount | aliyunBuyPriceValue}}</span> {{priceResult.data.currency |aliyunBuyPriceCurrencyText}} {{config.priceUnit||priceResult.data.priceUnit|| priceResult.data.basePriceUnit}}</span></div><!-- --><div class="bk-items-price-tag" ng-if="priceResult.data.strategies.length > 0"><i class="bk-items-price-tag-title aliyun-icon-giving"></i><div class="bk-items-price-tag-list"><span ng-if="priceResult.data.strategies.length >= 3" aliyun-dynamic-tooltip class="bk-ploy-more" id="priceResultStrategies" strategies="priceResult.data.strategies"></span> <span ng-if="priceResult.data.strategies.length < 3" ng-repeat="strategy in priceResult.data.strategies" class="bk-ploy" title="{{strategy.title}}">{{strategy.name}}</span></div></div><div class="bk-items-price-tag" ng-if="priceResult.data.strategies.length == 0 && priceResult.data.children[0].strategies.length > 0"><i class="bk-items-price-tag-title aliyun-icon-giving"></i><div class="bk-items-price-tag-list"><span ng-if="priceResult.data.children[0].strategies.length >= 3" aliyun-dynamic-tooltip class="bk-ploy-more" id="priceResultStrategies" strategies="priceResult.data.children[0].strategies"></span> <span ng-if="priceResult.data.children[0].strategies.length < 3" ng-repeat="strategy in priceResult.data.children[0].strategies" class="bk-ploy" title="{{strategy.title}}">{{strategy.name}}</span></div></div></div></div></div></div></div><!--subtotal--><div class="bk-items-price-control"><span ng-if="config.displayCart !== \'none\' " class="bk-button-addtocart-wrapper"><span class="bk-addtocart-"></span><div aliyun-buy-button ng-click="addToCart($event)" is-disabled="{{isDisableButton(priceResult) || config.addCartAvailable === false}}" theme="orange-transparent" tip="{{config.addCartTip}}" data-spm-click="gostr=/aliyun;locaid=addtocart">{{config.addToCartButtonText || \'\'}}<!----></div></span> <span class="bk-button-purchase-wrapper"><div aliyun-buy-button theme="orange" ng-click="purchase()" is-disabled="{{isDisableButton(priceResult)}}" data-spm-click="gostr=/aliyun;locaid=purchase">{{config.purchaseButtonText || \'\'}}<!----></div></span><div ng-if="config.purchaseTip|aliyunBuyText" class="bk-items-price-info" style="color: #ee0000" ng-bind-html="config.purchaseTip|aliyunBuyText"></div><div ng-if="config.priceTip|aliyunBuyText" class="bk-items-price-info bk-pale" ng-bind-html="config.priceTip|aliyunBuyText"></div></div></div><!--priceList--><div class="bk-items-price" ng-if="priceResult.data.flowPrice != undefined"><div class="bk-items-price-title bk-pale">{{config.texts.flowPrice || \'\' + \'\'}}<!----><a class="bk-lnk bk-ml1" href="javascript:;" data-spm-click="gostr=/aliyun;locaid=flowPricehelp" aliyun-buy-tooltip="{{config.texts.flowPriceTip || \'COMMON_FLOW_PRICE_TIP\' | aliyunBuyText}}" title="{{\'COMMON_FLOW_PRICE_TIP\' | aliyunBuyText}}"><i class="aliyun-icon-help"></i></a></div><div class="bk-items-price-settle"><span class="bk-cny" ng-bind-html="config.currency || (priceResult.data.currency |aliyunBuyPriceCurrency) || \'&yen;\'"></span> <span class="bk-items-price-money" style="margin-left: -10px">{{priceResult.data.flowPrice | aliyunBuyPriceValue:\'flow\'}}{{priceResult.data.currency |aliyunBuyPriceCurrencyText}}</span> <span class="bk-items-price-unit">{{config.flowPriceUnit ? config.flowPriceUnit :priceResult.data.flowPriceUnit}}&nbsp;</span></div></div><div class="bk-pb4"></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyTimepicker.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyTimepicker.html",'<div class="bk-timepicker" style="display:inline-block"><table><tbody><tr><td style="width:40px" class="form-group" ng-class="{\'has-error\': invalidHours}"><input type="text" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2"></td><td class="bk-number" ng-hide="hideIncrementHours"><span class="bk-number-control"><span class="bk-number-up" ng-click="incrementHours()"><i class="bk-number-arrow"></i></span> <span class="bk-number-down" ng-click="decrementHours()"><i class="bk-number-arrow"></i></span></span></td><td style="width: 10px;text-align: center">:</td><td style="width:40px" class="form-group" ng-class="{\'has-error\': invalidMinutes}"><input type="text" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2"></td><td class="bk-number" ng-hide="hideIncrementMinutes"><span class="bk-number-control"><span class="bk-number-up" ng-click="incrementMinutes()"><i class="bk-number-arrow"></i></span> <span class="bk-number-down" ng-click="decrementMinutes()"><i class="bk-number-arrow"></i></span></span></td><td ng-show="showMeridian"><button type="button" class="btn btn-default text-center" ng-click="toggleMeridian()">{{meridian}}</button></td></tr></tbody></table></div>')}]),angular.module("dominator/base/partials/aliyunBuyTool/checkbox.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyTool/checkbox.html",'<span ng-click="toggle()" class="bk-checkbox"><a ng-hide="readOnly" href="javascript:" class="bk-order-pact-box" ng-class="{\'bk-order-pact-box-select\':value, \'\':!value}"><span class="dis-inline-block" ng-class="{\'aliyun-icon-yes2\':value, \'\':!value}"></span></a> <span ng-bind-html="display" class="bk-font-14"></span></span>')}]),angular.module("dominator/base/partials/aliyunBuyTool/password.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyTool/password.html",'<div><div class="bk-form-row-li"><span ng-hide="needLogin"><input ng-class="{\'bk-form-input-error\':error || _error}" class="bk-form-input bk-form-input-l2" ng-model="ngModel" type="password" ng-blur="blur()" ng-focus="_error=false" ng-trim="false"></span> <span aliyun-buy-tooltip="{content:\'<a ng-click=\\\'login()\\\'></a>\', theme:\'white\'}" ng-if="needLogin" class="bk-form-input bk-form-input-l2" style="background: #fff;cursor:text;display: inline-block"></span> <span class="bk-form-row-li-info bk-ml2" ng-if="tip" ng-bind-html="tip"></span></div><div class="bk-form-status bk-form-error bk-form-row-txt" ng-if="_error"><i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message" ng-bind="_error"></span></div></div>')}]),angular.module("dominator/base/partials/aliyunBuyTool/select.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyTool/select.html",'<span><span class="ng-hide" id="{{labelId}}-select-aria">entertabesc</span><span class="bk-select" role="select" aria-haspopup="true" ng-class="{\'bk-select-l2\':!long && !short,\'bk-select-l3\':long,\'bk-select-l1\':short,\'bk-select-disabled\':ngDisabled,\'bk-select-error\':state,\'bk-select-focus\':open}"><span class="bk-select-button" ng-class="{\'bk-select-current\':ngModel}" role="select" tabindex="0" aria-expanded="{{open}}" aria-label="" ng-click="openSelcet($event)" ng-keyup="openSelcet($event)" aria-labelledby="{{labelId}} {{labelId}}-select-aria"><div class="bk-select-group bk-select-group-arrow"><span class="bk-select-icon-box" ng-if="placeholderIcon"><i class="bk-select-option-icon" ng-class="placeholderIcon"></i></span> <span class="bk-select-txt" ng-bind-html="placeholder"></span></div><span class="icon-buy-down" ng-class="{\'bk-select-arrow-rotate\':open}"></span> <span class="bk-select-arrow" ng-class="{\'bk-select-arrow-rotate\':open}"><span class="bk-select-arrow-1"></span><span class="bk-select-arrow-2"></span></span></span> <span ng-show="open" class="bk-select-options-arrow"><span class="bk-select-arrow-1"></span><span class="bk-select-arrow-2"></span></span><ul class="bk-select-options listbox" ng-if="open && list.length" aria-expanded="{{open}}" role="listbox"><li class="bk-select-option" ng-class="{\'bk-select-option-disabled\':i.disabled}" ng-repeat="i in list" title="{{i.title}}" ng-click="!i.disabled?check(i):\'\'" data-spm-click="gostr=/aliyun;locaid={{i.spm || (spm + i.value)}}" role="option" tabindex="0" ng-keyup="closeSelect($event,i)"><div class="bk-select-group"><span class="bk-select-icon-box" ng-if="i.icon"><i class="bk-select-option-icon" ng-class="i.icon"></i></span> <span class="bk-select-option-txt" ng-bind-html="i.text"></span></div></li><li class="bk-select-option" ng-show="isLoadingItems == true"><div class="bk-select-group"><span class="bk-select-option-txt"><span class="aliyun-icon-loading loading-icon bk-mr1"></span> ...</span></div></li></ul><ul class="bk-select-options" ng-if="!list.length"><li class="bk-select-option"><span class="bk-select-option-txt">{{needLogin?needLogin:\'\'}}</span></li></ul></span></span>')}]),angular.module("dominator/base/partials/aliyunBuyTool/selectDynamic.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyTool/selectDynamic.html",'<span><span class="bk-select" ng-class="{\'bk-select-l2\':!long && !short,\'bk-select-l3\':long,\'bk-select-l1\':short,\'bk-select-disabled\':ngDisabled,\'bk-select-error\':state,\'bk-select-focus\':open}"><span class="bk-select-button" ng-class="{\'bk-select-current\':ngModel}" ng-click="openSelcet($event)"><div class="bk-select-group bk-select-group-arrow"><span class="bk-select-icon-box" ng-if="placeholderIcon"><i class="bk-select-icon" ng-class="placeholderIcon"></i></span> <span class="bk-select-txt" ng-bind-html="placeholder"></span></div><span class="icon-buy-down" ng-class="{\'bk-select-arrow-rotate\':open}"></span> <span class="bk-select-arrow" ng-class="{\'bk-select-arrow-rotate\':open}"><span class="bk-select-arrow-1"></span><span class="bk-select-arrow-2"></span></span></span> <span ng-show="open" class="bk-select-options-arrow"><span class="bk-select-arrow-1"></span><span class="bk-select-arrow-2"></span></span><ul class="bk-select-options bk-select-scroll-wrap" ng-if="open" scroll-buttom-trigger callback="loadMore"><li class="bk-select-option" ng-class="{\'bk-select-option-disabled\':i.disabled}" ng-repeat="i in list track by $index" title="{{i.title}}" ng-click="!i.disabled?check(i):\'\'"><div class="bk-select-group"><span class="bk-select-icon-box" ng-if="i.icon"><i class="bk-select-option-icon" ng-class="i.icon"></i></span> <span class="bk-select-option-txt" ng-bind-html="i.text"></span></div></li><li class="bk-select-option" ng-show="isLoadingItems"><div class="bk-select-group"><span class="bk-select-option-txt"><span class="aliyun-icon-loading loading-icon bk-mr1"></span>...</span></div></li><!-- <li class="bk-select-option" ng-show="isLastPage">\n            <div class="bk-select-group">\n                <span class="bk-select-option-txt">---  ---</span>\n            </div>\n          </li> --></ul><ul class="bk-select-options" ng-show="isEmptyOfRemoteData"><li class="bk-select-option"><span class="bk-select-option-txt">{{needLogin?needLogin:\'\'}}</span></li></ul></span></span>')}]),angular.module("dominator/base/partials/aliyunBuyTool/slider.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyTool/slider.html",'<div class="bk-slider" ng-mousedown="down($event)" ng-keydown="down($event)" data-spm-click="gostr=/aliyun;locaid={{spm || \'slider\'}};attr={{value}}" ng-class="{\'bk-slider-duration\':bk-slider-duration,\'bk-slider-disabled\':isDisabled}"><span class="bk-slider-range"><span ng-repeat="i in _stepOption" ng-style="i.css" class="bk-slider-block" ng-class="i.css"><span class="bk-slider-block-box" ng-class="{\'bk-slider-block-box-last\':$last,\'bk-select-action\':$index==selectIndex}"><span class="bk-slider-txt" ng-bind="i.textLable"></span></span></span> <span class="bk-slider-container" ng-style="maskWidth" ng-class="{\'bk-slider-transition\':unmove}"><span class="bk-slider-current"><span class="bk-slider-unit" ng-repeat="i in _stepOption" ng-class="i.css"><span class="bk-slider-unit-box" ng-class="{\'bk-slider-unit-box-last\':$last,\'bk-select-action\':$index==selectIndex}"><span class="bk-slider-txt" ng-bind="i.textLable"></span></span></span></span></span> <span tabindex="0" role="slider" aria-valuemax="{{maxValue}}" aria-valuemin="{{minValue}}" aria-valuenow="{{value}}" aria-valuetext="{{value}}{{unit}}" aria-labelledby="{{labelId}}" class="bk-slider-drag" ng-style="barLeft" ng-class="{\'bk-slider-transition\':unmove}"><i></i> <i></i><div style="position: relative" ng-if="!isDuration"><div class="bk-tip-gray" style="top: -38px;left: -15px" ng-hide="unmove"><span>{{value}}</span> <span class="bk-tip-arrow"></span></div></div></span></span></div>')}]),angular.module("dominator/base/partials/aliyunBuyYundun.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/aliyunBuyYundun.html",'<div class="bk-items-yundun bk-mt2"><div>{{value}}</div><i class="aliyun-icon-yundun"></i><!--<span></span>--> <span>{{\'COMMON_YUNDUN_TEXT\' | aliyunBuyText}}</span> <a class="aliyun-icon-help" data-spm-click="gostr=/aliyun;locaid=yundunhelp" title="{{\'COMMON_YUNDUN_TIP\'|aliyunBuyText}}" aliyun-buy-tooltip="{content:\'\\{\\{\\\'COMMON_YUNDUN_TIP\\\'|aliyunBuyText\\}\\}\', maxWidth:300}"></a></div>')}]),angular.module("dominator/base/partials/angular-bootstrap/pagination/pager.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/angular-bootstrap/pagination/pager.html",'<ul class="sedi-pager"><li ng-repeat="page in pages" ng-class="{\'sedi-disabled\': page.disabled, \'sedi-previous\': page.previous, \'sedi-next\': page.next}"><a ng-click="selectPage(page.number)">{{page.text}}</a></li></ul>')}]),angular.module("dominator/base/partials/angular-bootstrap/pagination/pagination.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/angular-bootstrap/pagination/pagination.html",'<span class="bk-paging bk-paging-rn"><span class="bk-paging-list"><span ng-click="selectPage(page.number)" style="margin-right: 2px" ng-repeat="page in pages" ng-class="{\'bk-paging-prev\':$first,\'bk-paging-page\':$middle,\'bk-paging-next\':$last,\'bk-paging-current\': page.active, \'bk-paging-disabled\': page.disabled}">{{page.text}}</span></span></span>')}]),angular.module("dominator/base/partials/datepicker/datepicker.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/datepicker/datepicker.html",'<div style="padding: 8px" class="bk-scope bk-datepicker"><table><thead><tr><th><button type="button" class="bk-btn bk-btn-link bk-no-underline bk-btn-sm bk-pull-left" ng-click="move(-1)"><i class="aliyun-icon-arrow-left"></i></button></th><th colspan="{{rows[0].length - 2 + showWeekNumbers}}"><button type="button" class="bk-btn bk-btn-default bk-btn-sm bk-btn-block" ng-click="toggleMode()"><strong>{{title}}</strong></button></th><th><button type="button" class="bk-btn bk-btn-link bk-no-underline bk-btn-sm bk-pull-right" ng-click="move(1)"><i class="aliyun-icon-arrow-right"></i></button></th></tr><tr ng-show="labels.length > 0" class="bk-h6"><th ng-show="showWeekNumbers" class="bk-text-center">#</th><th ng-repeat="label in labels" class="bk-text-center">{{label}}</th></tr></thead><tbody><tr ng-repeat="row in rows"><td ng-show="showWeekNumbers" class="bk-text-center"><em>{{ getWeekNumber(row) }}</em></td><td ng-repeat="dt in row" class="bk-text-center"><button type="button" style="width:100%" class="bk-btn bk-btn-default bk-btn-sm" ng-class="{\'bk-active\': dt.selected}" ng-click="select(dt.date)" ng-disabled="dt.disabled"><span style="display: inline-block" ng-class="{\'bk-text-muted\': dt.secondary}">{{dt.label}}</span></button></td></tr></tbody></table></div>')}]),angular.module("dominator/base/partials/datepicker/popup.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/partials/datepicker/popup.html",'<div class="bk-scope" ng-style="{display: (isOpen && \'block\') || \'none\'}" style="float:left"><ul class="bk-dropdown-menu" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', left: position.left+\'px\'}"><li ng-transclude></li><li ng-show="showButtonBar" style="padding:10px 9px 2px"><span class="bk-btn-group"><button type="button" class="bk-btn bk-btn-sm bk-btn-info" ng-click="today()">{{currentText}}</button> <button type="button" class="bk-btn bk-btn-sm bk-btn-default" ng-click="showWeeks = ! showWeeks" ng-class="{\'bk-active\': showWeeks}">{{toggleWeeksText}}</button> <button type="button" class="bk-btn bk-btn-sm bk-btn-danger" ng-click="clear()">{{clearText}}</button></span> <button type="button" class="bk-btn bk-btn-sm bk-btn-success pull-right" ng-click="isOpen = false">{{closeText}}</button></li></ul></div>')}]),angular.module("dominator/base/styles/kill-bootstrap/demo.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/styles/kill-bootstrap/demo.html",'<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><title></title><meta name="description" content=""><meta name="keywords" content=""><link rel="stylesheet" href="http://g.alicdn.com/aliyun/www-dpl/0.1.10/knight/css/global.css"><link rel="stylesheet" href="http://g.tbcdn.cn/aliyun/www-dpl/0.1.10/knight/css/iconfont.css"><link rel="stylesheet" href="http://g.alicdn.com/aliyun/iconfont/0.0.5/css/iconfont.css"><style>.y-row{min-width:1000px;max-width:1200px;margin-left:auto;margin-right:auto;zoom:1;*width:1000px}.y-row:after{visibility:hidden;display:block;font-size:0;content:" ";clear:both;height:0}.y-row .y-span1,.y-row .y-span2,.y-row .y-span3,.y-row .y-span4,.y-row .y-span5,.y-row .y-span6,.y-row .y-span7,.y-row .y-span8,.y-row .y-span9,.y-row .y-span10,.y-row .y-span11,.y-row .y-span12{float:left;display:inline;margin-right:2%;*margin-right:20px}.y-row .y-span1{width:6.5%;*width:65px}.y-row .y-span2{width:15%;*width:150px}.y-row .y-span3{width:23.5%;*width:235px}.y-row .y-span4{width:32%;*width:320px}.y-row .y-span5{width:40.5%;*width:405px}.y-row .y-span6{width:49%;*width:490px}.y-row .y-span7{width:57.5%;*width:575px}.y-row .y-span8{width:66%;*width:660px}.y-row .y-span9{width:74.5%;*width:745px}.y-row .y-span10{width:83%;*width:830px}.y-row .y-span11{width:91.5%;*width:915px}.y-row .y-span12{width:100%;*width:1000px}.y-row .y-last{margin-right:0!important}</style><link rel="stylesheet" type="text/css" href="./css/modules/global.css"><link rel="stylesheet" type="text/css" href="./css/modules/reset.css"><link rel="stylesheet" type="text/css" href="./css/modules/os.css"><link rel="stylesheet" type="text/css" href="./css/modules/group.css"><link rel="stylesheet" type="text/css" href="./css/modules/formrow.css"><link rel="stylesheet" type="text/css" href="./css/modules/button.css"><link rel="stylesheet" type="text/css" href="./css/modules/buttontab.css"><link rel="stylesheet" type="text/css" href="./css/modules/select.css"><link rel="stylesheet" type="text/css" href="./css/modules/slider.css"><link rel="stylesheet" type="text/css" href="./css/modules/number.css"><link rel="stylesheet" type="text/css" href="./css/modules/tip.css"><link rel="stylesheet" type="text/css" href="./css/modules/items.css"><link rel="stylesheet" type="text/css" href="./css/modules/dialog.css"><link rel="stylesheet" type="text/css" href="./css/modules/message.css"><link rel="stylesheet" type="text/css" href="./css/modules/paging.css"><link rel="stylesheet" type="text/css" href="./css/modules/orders.css"><link rel="stylesheet" type="text/css" href="./css/modules/price.css"><link rel="stylesheet" type="text/css" href="./css/modules/disk.css"><link rel="stylesheet" type="text/css" href="http://g.alicdn.com/aliyun/www-dpl/0.1.18/knight/css/dpl/pagetitle.css"></head><body class="bk-scope"><style>.bar-buy-recommend{\n      position: relative; overflow: hidden; width: 100%;\n    }\n    .bar-buy-recommend .bar-buy-recommend-box{\n      border: solid 2px #e8e8e8; padding-bottom: 20px;\n    }\n    .bar-buy-recommend .bar-buy-recommend-title{\n      height: 20px; padding: 32px; \n      color: #000; font-size: 20px; line-height: 1;\n    }\n    .bar-buy-recommend .bar-buy-recommend-title h2{\n      float: left; display: inline; height: 20px; \n      line-height: 1; font-size: 20px;\n    }\n    .bar-buy-recommend .bar-buy-recommend-title .more{\n      margin-left: 16px;\n      font-size: 12px; line-height: 1;\n    }\n\n    .bar-buy-recommend .bar-buy-recommend-less{\n      position: absolute; top: 11px; left: -28px; height: 18px; padding: 2px 0; background: #00a2c5; width: 100px;\n      color: #fff; font-size: 12px; line-height: 18px; text-align: center;\n      -webkit-transform: rotate(-45deg); -moz-transform: rotate(-45deg); -ms-transform: rotate(-45deg); -o-transform: rotate(-45deg);\n      /* ie 8+ */\n      -ms-filter: "progid:DXImageTransform.Microsoft.Matrix(M11=0.7071067811865483, M12=0.7071067811865467, M21=-0.7071067811865467, M22=0.7071067811865483, SizingMethod=\'auto expand\')";\n      /* ie 6,7 */\n      filter: progid:DXImageTransform.Microsoft.Matrix(\n            M11=0.7071067811865483,\n            M12=0.7071067811865467,\n            M21=-0.7071067811865467,\n            M22=0.7071067811865483,\n            SizingMethod=\'auto expand\');\n\n      *left: -17px; *top: -19px;\n    }\n    /* IE8 hack */\n    @media \\0screen\\,screen\\9{\n      .bar-buy-recommend .bar-buy-recommend-less{\n        left: -19px; top: -19px;   \n      }\n    }\n\n    .bar-buy-recommend .bar-buy-recommend-list{\n      height: 96px; \n      zoom: 1;\n    }\n    .bar-buy-recommend .bar-buy-recommend-list:after{\n      visibility: hidden; display: block; font-size: 0; content: " "; clear: both; height: 0;\n    }\n\n    .bar-buy-recommend .bar-buy-recommend-list .bar-buy-recommend-list-title{\n      float: left; display: inline; width: 140px; height: 96px; text-align: center;\n    }\n    .bar-buy-recommend .bar-buy-recommend-list .bar-buy-recommend-icon-box{\n      display: block; width: 52px; height: 52px; margin: 12px auto 10px;\n      font-size: 52px; line-height: 1;\n    }\n    .bar-buy-recommend .bar-buy-recommend-list .bar-buy-recommend-name{\n      font-size: 12px; color: #666; line-height: 1;\n    }\n    .bar-buy-recommend .bar-buy-recommend-list .bar-buy-recommend-list-detail{\n      display: block; margin-left: 140px;\n    }\n\n    .bar-buy-recommend .bar-buy-recommend-list li{\n      float: left; display: inline; height: 96px;\n    }\n\n    .bar-buy-recommend .bar-buy-recommend-item{\n      height: 96px; border-left: solid 1px #e8e8e8; padding-left: 36px; padding-right: 24px;\n      font-size: 12px; line-height: 1; color: #000;\n    }\n    .bar-buy-recommend .bar-buy-recommend-item-title h3{\n      height: 12px; overflow: hidden;\n      line-height: 1; font-size: 12px;\n    }\n    .bar-buy-recommend .bar-buy-recommend-item-detail p{\n      height: 58px; padding-top: 6px;\n      font-size: 12px; line-height: 2; color: #666;\n    }\n    .bar-buy-recommend .bar-buy-recommend-item-go{\n      line-height: 1;\n    }\n\n    .bar-buy-recommend .bar-buy-recommend-col-2 li{\n      width: 50%;\n      *width: 49.9%;\n    }\n    .bar-buy-recommend .bar-buy-recommend-col-3 li{\n      width: 33%;\n    }\n    .bar-buy-recommend .bar-buy-recommend-col-4 li{\n      width: 25%;\n      *width: 24.9%;\n    }\n    .bar-buy-recommend .bar-buy-recommend-col-5 li{\n      width: 20%;\n      *width: 19.9%;\n    }</style><div style="margin-top: 40px"><div class="y-row"><div class="y-span12 y-last"><!--   www-dpl  global  iconfont S --><div class="bar-buy-recommend"><div class="bar-buy-recommend-box"><!--  S --><div class="bar-buy-recommend-title"><h2></h2><a href="#" class="more" hidefocus>>></a></div><!--  E --><!--  S --><div class="bar-buy-recommend-list"><dl><dt class="bar-buy-recommend-list-title"><span class="bar-buy-recommend-icon-box"><span class="icon-ecs-big" style="color:#16a5e8"></span></span> <span class="bar-buy-recommend-name">ECS</span></dt><dd class="bar-buy-recommend-list-detail bar-buy-recommend-col-3"><ul><li><dl class="bar-buy-recommend-item"><dt class="bar-buy-recommend-item-title"><h3> <span class="y-orange"><span class="y-cny">&yen;</span><span>45.9</span></span>/</h3></dt><dd class="bar-buy-recommend-item-detail"><p>CPU1 512M 1M </p><a href="#" class="bar-buy-recommend-item-go" hidefocus></a></dd></dl></li><li><dl class="bar-buy-recommend-item"><dt class="bar-buy-recommend-item-title"><h3> <span class="y-orange"><span class="y-cny">&yen;</span><span>45.9</span></span>/</h3></dt><dd class="bar-buy-recommend-item-detail"><p>CPU1 512M 1M </p><a href="#" class="bar-buy-recommend-item-go" hidefocus></a></dd></dl></li><li><dl class="bar-buy-recommend-item"><dt class="bar-buy-recommend-item-title"><h3> <span class="y-orange"><span class="y-cny">&yen;</span><span>45.9</span></span>/</h3></dt><dd class="bar-buy-recommend-item-detail"><p>CPU1 512M 1M </p><a href="#" class="bar-buy-recommend-item-go" hidefocus></a></dd></dl></li></ul></dd></dl></div><!--  E --><!--  S --><span class="bar-buy-recommend-less"></span><!--  E --></div></div><!--  E --></div></div></div><div class="y-page-title"><div class="y-row"><div class="y-span12 y-last"><div class="y-page-title-box"><h1>ECS</h1><div class="y-page-title-nav"><a href="#" class="y-lnk-gray" hidefocus></a><span class="y-lnk-gray y-page-title-other-products"><i></i></span></div><div class="y-page-title-other-list"><ul><li><a href="#" class="y-page-title-other-item" hidefocus>IP</a></li><li><a href="#" class="y-page-title-other-item" hidefocus>RDS</a></li><li><a href="#" class="y-page-title-other-item" hidefocus></a></li><li><a href="#" class="y-page-title-other-item" hidefocus></a></li></ul></div></div></div></div></div><button class="bk-button bk-button-primary" style="margin: 10px"></button> <button class="bk-button bk-button-primary bk-button-disabled" disabled="disabled" style="margin: 10px"></button> <button class="bk-button bk-button-default" style="margin: 10px"></button> <button class="bk-button bk-button-default bk-button-disabled" disabled="disabled" style="margin: 10px"></button><!-- orders S --><div class="bk-orders" style="margin-top: 20px; margin-left: 200px"><div class="bk-orders-title"><span class="bk-orders-title-txt">3</span> <span class="bk-orders-title-close" role="button" tabindex="0"><i class="aliyun-icon-wrong"></i></span></div><div class="bk-orders-list"><div class="bk-orders-item"><div class="bk-orders-item-title"><span class="bk-orders-item-name">ECS</span> <i class="bk-orders-item-os bk-os-aliyun-linux"></i> <span class="bk-orders-item-delete"><i class="aliyun-icon-wrong"></i></span> <span class="bk-orders-item-quantity">1 x 2</span></div><div class="bk-orders-item-items"><ul><li>D</li><li>1512MB50GB</li><li>1Mbps</li><li>ECS<span class="bk-orders-item-settle"><span class="bk-cny">&yen;</span><span class="bk-orders-item-money">56.8</span></span><i class="aliyun-icon-giving"></i></li><li>ECS<span class="bk-orders-item-settle"><span class="bk-cny">&yen;</span><span class="bk-orders-item-money">56.8</span><span class="bk-orders-item-unit">/GB</span></span><i class="aliyun-icon-giving"></i></li></ul></div></div><div class="bk-orders-item"><div class="bk-orders-item-title"><span class="bk-orders-item-name">ECS</span> <i class="bk-orders-item-os bk-os-windows-server"></i> <span class="bk-orders-item-delete"><i class="aliyun-icon-wrong"></i></span> <span class="bk-orders-item-quantity">1 x 2</span></div><div class="bk-orders-item-items"><ul><li>D</li><li>1512MB50GB</li><li>1Mbps</li><li>ECS<span class="bk-orders-item-settle"><span class="bk-cny">&yen;</span><span class="bk-orders-item-money">56.8</span></span><i class="aliyun-icon-giving"></i></li><li>ECS<span class="bk-orders-item-settle"><span class="bk-cny">&yen;</span><span class="bk-orders-item-money">56.8</span><span class="bk-orders-item-unit">/GB</span></span><i class="aliyun-icon-giving"></i></li></ul></div></div></div><div class="bk-items-price"><div class="bk-items-price-title"></div><div class="bk-items-price-settle"><span class="bk-cny">&yen;</span><span class="bk-items-price-money">1234.000</span><span class="bk-items-price-unit">/</span></div><div class="bk-items-price-offer"><span class="bk-items-price-cost bk-mr1"> <span class="bk-cny">&yen;</span>1234/</span><span class="bk-items-price-rebate"> <span class="bk-cny">&yen;</span>1234/</span></div><div class="bk-items-price-tag"><i class="bk-items-price-tag-title aliyun-icon-giving"></i><div class="bk-items-price-tag-list"><span class="bk-ploy"></span><span class="bk-ploy"></span><span class="bk-ploy"></span><span class="bk-ploy"></span><span class="bk-ploy"></span><span class="bk-ploy"></span></div></div></div><div class="bk-orders-control"><button class="bk-button bk-button-primary"></button></div></div><!-- orders E --><!-- grid S --><div class="y-row"><div class="y-span9"><div class="bk-message-row bk-message-row-normal bk-mb4"><div class="bk-message-row-icon"><i class="aliyun-icon-info"></i></div><div class="bk-message-row-message"></div></div><!-- group S --><dl class="bk-group"><dt class="bk-group-title"></dt><dd class="bk-group-detail"><div class="bk-group-control"><span class="bk-group-switch"><span class="bk-group-switch-icon"><i class="bk-group-switch-arrow"></i></span></span></div><!-- form row S --><div class="bk-form-row"><label class="bk-form-row-name"></label><div class="bk-form-row-cell"><div class="bk-form-row-li"><!-- button tab S --><span class="bk-buttontab"><span class="bk-button"></span><span class="bk-button bk-button-current"></span><span class="bk-button"></span><span class="bk-button"></span><span class="bk-button"></span><span class="bk-button"></span><span class="bk-button"></span><span class="bk-button"></span><a href="#" class="bk-lnk" hidefocus>>></a></span><!-- button tab E --> <a href="#" class="bk-lnk" hidefocus>>></a> <a href="#" class="bk-lnk" hidefocus><i class="aliyun-icon-help"></i></a></div><div class="bk-form-row-li"><input class="bk-form-input"><input class="bk-form-input bk-form-input-l2"><input class="bk-form-input bk-form-input-l3"></div><div class="bk-form-row-li"><!-- button tab S --><span class="bk-buttontab bk-buttontab-error"><span class="bk-button"></span><span class="bk-button bk-button-current"></span><span class="bk-button bk-button-current"></span><span class="bk-button bk-button-current"></span><span class="bk-button bk-button-current"></span></span><!-- button tab E --></div><div class="bk-form-row-li"><!-- select S --><span class="bk-select bk-select-l2"><span class="bk-select-button"><i class="bk-select-arrow"></i><i class="bk-select-icon"></i><span class="bk-select-txt"></span></span><ul class="bk-select-options"><li class="bk-select-option"><i class="bk-select-option-icon"></i><span class="bk-select-option-txt"></span></li></ul></span><span class="bk-select bk-select-focus bk-select-l3"><span class="bk-select-button bk-select-current"><i class="bk-select-arrow bk-select-arrow-rotate"></i><span class="bk-select-icon-box"><i class="bk-select-icon bk-os-aliyun-linux"></i></span><span class="bk-select-txt"></span></span><ul class="bk-select-options"><li class="bk-select-option"><span class="bk-select-icon-box"><i class="bk-select-option-icon bk-os-ubuntu"></i></span><span class="bk-select-option-txt"></span></li><li class="bk-select-option"><span class="bk-select-icon-box"><i class="bk-select-option-icon bk-os-aliyun-linux"></i></span><span class="bk-select-option-txt"></span></li><li class="bk-select-option"><span class="bk-select-icon-box"><i class="bk-select-option-icon bk-os-windows-server"></i></span><span class="bk-select-option-txt"></span></li><li class="bk-select-option"><span class="bk-select-icon-box"><i class="bk-select-option-icon bk-os-centos"></i></span><span class="bk-select-option-txt"></span></li><li class="bk-select-option"><span class="bk-select-icon-box"><i class="bk-select-option-icon bk-os-debian"></i></span><span class="bk-select-option-txt"></span></li><li class="bk-select-option"><span class="bk-select-icon-box"><i class="bk-select-option-icon bk-os-opensuse"></i></span><span class="bk-select-option-txt"></span></li><li class="bk-select-option"><span class="bk-select-icon-box"><i class="bk-select-option-icon bk-os-gentoo"></i></span><span class="bk-select-option-txt"></span></li></ul></span><!-- select E --></div><div class="bk-form-row-li"><!-- select S --><span class="bk-select bk-select-error bk-select-l2"><span class="bk-select-button"><i class="bk-select-arrow"></i><i class="bk-select-icon"></i><span class="bk-select-txt"></span></span><ul class="bk-select-options"><li class="bk-select-option"><i class="bk-select-option-icon"></i><span class="bk-select-option-txt"></span></li></ul></span><!-- select E --></div><div class="bk-form-row-txt"><br></div></div></div><!-- form row E --><!-- form row S --><div class="bk-form-row"><label class="bk-form-row-name"></label><div class="bk-form-row-cell"><div class="bk-form-row-li"><!-- select S --><span class="bk-select bk-select-l2"><span class="bk-select-button"><i class="bk-select-arrow"></i><i class="bk-select-icon"></i><span class="bk-select-txt"></span></span><ul class="bk-select-options"><li class="bk-select-option"><i class="bk-select-option-icon"></i><span class="bk-select-option-txt"></span></li></ul></span><!-- select E --></div><div class="bk-form-row-txt"><a href="#" class="bk-lnk" hidefocus></a><br></div><div class="bk-form-row-txt"><span class="bk-form-status bk-form-normal"><i class="bk-form-status-icon aliyun-icon-info"></i><span class="bk-form-status-message"></span></span></div><div class="bk-form-row-txt"><span class="bk-form-status bk-form-error"><i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message"></span></span></div><div class="bk-form-row-txt"><span class="bk-form-status bk-form-success"><i class="bk-form-status-icon aliyun-icon-yes3"></i><span class="bk-form-status-message"></span></span></div></div></div><!-- form row E --><div class="bk-form-row"><label class="bk-form-row-name"></label><div class="bk-form-row-cell"><div class="bk-form-row-li"><input class="bk-form-input bk-form-input-error"><span class="bk-form-status bk-form-error"><i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message"></span></span></div></div></div></dd></dl><!-- group E --><!-- group S --><dl class="bk-group bk-group-warning"><dt class="bk-group-title"></dt><dd class="bk-group-detail"><div class="bk-group-control"><span class="bk-group-switch"><span class="bk-group-switch-icon bk-group-switch-icon-rotate"><i class="bk-group-switch-arrow"></i></span></span></div><!-- form row S --><div class="bk-form-row"><label class="bk-form-row-name"></label><div class="bk-form-row-cell"><div class="bk-form-row-li"><!-- tip S --><div class="bk-tip-gray" style="left: 20px; top: 100px"><span>86</span> <i class="bk-tip-arrow"></i></div><div class="bk-tip-orange" style="left: 20px; top: 200px"><span>10%</span> <i class="bk-tip-arrow"></i></div><!-- tip E --><!-- slider & number S --><span class="bk-slider"><span class="bk-slider-range"><span class="bk-slider-block bk-slider-l2"><span class="bk-slider-block-box"><span class="bk-slider-txt">5M</span></span></span><span class="bk-slider-block bk-slider-l1"><span class="bk-slider-block-box"><span class="bk-slider-txt">100M</span></span></span><span class="bk-slider-block bk-slider-l1"><span class="bk-slider-block-box-last bk-slider-block-box"><span class="bk-slider-txt">200M</span></span></span> <span class="bk-slider-container" style="width: 50%"><span class="bk-slider-current"><span class="bk-slider-unit bk-slider-l2"><span class="bk-slider-unit-box"><span class="bk-slider-txt">5M</span></span></span><span class="bk-slider-unit bk-slider-l1"><span class="bk-slider-unit-box"><span class="bk-slider-txt">100M</span></span></span><span class="bk-slider-unit bk-slider-l1"><span class="bk-slider-unit-box bk-slider-unit-box-last"><span class="bk-slider-txt">200M</span></span></span></span></span> <span class="bk-slider-bar"></span> <span class="bk-slider-drag"><i></i> <i></i></span></span></span><span class="bk-number" style="margin-left: 10px"><input class="bk-number-input" value="0"> <span class="bk-number-unit">Mbps</span> <span class="bk-number-control"><span class="bk-number-up bk-number-disabled"><i class="bk-number-arrow"></i></span> <span class="bk-number-down"><i class="bk-number-arrow"></i></span></span></span><!-- slider & number E --></div><div class="bk-form-row-li"><!-- slider S --><span class="bk-slider bk-slider-duration"><span class="bk-slider-range"><span class="bk-slider-block bk-slider-mm"><span class="bk-slider-block-box"><span class="bk-slider-txt">1</span></span></span><span class="bk-slider-block bk-slider-mm"><span class="bk-slider-block-box"><span class="bk-slider-txt">2</span></span></span><span class="bk-slider-block bk-slider-mm"><span class="bk-slider-block-box"><span class="bk-slider-txt">3</span></span></span><span class="bk-slider-block bk-slider-mm"><span class="bk-slider-block-box"><span class="bk-slider-txt">4</span></span></span><span class="bk-slider-block bk-slider-mm"><span class="bk-slider-block-box"><span class="bk-slider-txt">5</span></span></span><span class="bk-slider-block bk-slider-mm"><span class="bk-slider-block-box"><span class="bk-slider-txt">6</span></span></span><span class="bk-slider-block bk-slider-mm"><span class="bk-slider-block-box"><span class="bk-slider-txt">7</span></span></span><span class="bk-slider-block bk-slider-mm"><span class="bk-slider-block-box"><span class="bk-slider-txt">8</span></span></span><span class="bk-slider-block bk-slider-mm"><span class="bk-slider-block-box"><span class="bk-slider-txt">9</span></span></span><span class="bk-slider-block bk-slider-yy"><span class="bk-slider-block-box"><span class="bk-slider-txt">1</span> <i class="aliyun-icon-giving"></i></span></span><span class="bk-slider-block bk-slider-yy"><span class="bk-slider-block-box"><span class="bk-slider-txt">2</span> <i class="aliyun-icon-giving"></i></span></span><span class="bk-slider-block bk-slider-yy"><span class="bk-slider-block-box bk-slider-block-box-last"><span class="bk-slider-txt">3</span> <i class="aliyun-icon-giving"></i></span></span> <span class="bk-slider-container"><span class="bk-slider-current"><span class="bk-slider-unit bk-slider-mm"><span class="bk-slider-unit-box"><span class="bk-slider-txt">1</span></span></span><span class="bk-slider-unit bk-slider-mm"><span class="bk-slider-unit-box"><span class="bk-slider-txt">2</span></span></span><span class="bk-slider-unit bk-slider-mm"><span class="bk-slider-unit-box"><span class="bk-slider-txt">3</span></span></span><span class="bk-slider-unit bk-slider-mm"><span class="bk-slider-unit-box"><span class="bk-slider-txt">4</span></span></span><span class="bk-slider-unit bk-slider-mm"><span class="bk-slider-unit-box"><span class="bk-slider-txt">5</span></span></span><span class="bk-slider-unit bk-slider-mm"><span class="bk-slider-unit-box"><span class="bk-slider-txt">6</span></span></span><span class="bk-slider-unit bk-slider-mm"><span class="bk-slider-unit-box"><span class="bk-slider-txt">7</span></span></span><span class="bk-slider-unit bk-slider-mm"><span class="bk-slider-unit-box"><span class="bk-slider-txt">8</span></span></span><span class="bk-slider-unit bk-slider-mm"><span class="bk-slider-unit-box"><span class="bk-slider-month"><span class="bk-slider-month-txt"></span></span> <span class="bk-slider-txt">9</span></span></span><span class="bk-slider-unit bk-slider-yy"><span class="bk-slider-unit-box"><span class="bk-slider-txt">1</span> <i class="aliyun-icon-giving"></i></span></span><span class="bk-slider-unit bk-slider-yy"><span class="bk-slider-unit-box"><span class="bk-slider-txt">2</span> <i class="aliyun-icon-giving"></i></span></span><span class="bk-slider-unit bk-slider-yy"><span class="bk-slider-unit-box bk-slider-unit-box-last"><span class="bk-slider-txt">3</span> <i class="aliyun-icon-giving"></i></span></span></span></span> <span class="bk-slider-bar"></span> <span class="bk-slider-drag"><i></i> <i></i></span></span></span><!-- slider E --></div><div class="bk-form-row-txt"><br></div></div></div><!-- form row E --></dd></dl><!-- group E --><!-- group S --><dl class="bk-group"><dt class="bk-group-title"></dt><dd class="bk-group-detail"><div class="bk-group-control"><span class="bk-group-switch"><span class="bk-group-switch-icon bk-group-switch-icon-rotate"><i class="bk-group-switch-arrow"></i></span></span></div><!-- form row S --><div class="bk-form-row"><label class="bk-form-row-name"></label><div class="bk-form-row-cell"><div class="bk-form-row-li"><!-- button tab S --><span class="bk-buttontab"><span class="bk-button bk-button-current"></span><span class="bk-button"></span></span><span class="bk-form-row-li-info bk-ml2">/dev/xvda/ <a href="#" class="bk-lnk" hidefocus></a></span><span class="bk-form-row-li-info bk-ml2"><a href="#" class="bk-lnk" hidefocus><i class="aliyun-icon-help"></i></a></span></div><div class="bk-form-row-txt">99.999%Linux20G</div></div></div><!-- form row E --><!-- form row S --><div class="bk-form-row"><label class="bk-form-row-name"></label><div class="bk-form-row-cell"><div class="bk-form-row-li"><!-- button tab S --><span class="bk-form-row-li-info bk-black"></span><span class="bk-form-row-li-info bk-ml2">/dev/xvda/</span><span class="bk-form-row-li-info bk-ml2"><span class="bk-lnk"><i class="aliyun-icon-help"></i></span></span></div><div class="bk-form-row-txt">99.999%Linux20G</div></div></div><!-- form row E --><div class="bk-form-row"><label class="bk-form-row-name"></label><div class="bk-form-row-cell"><div class="bk-form-row-li"><div class="bk-disk"><span class="bk-select"><span class="bk-select-button bk-select-current"><i class="bk-select-arrow"></i><i class="bk-select-icon"></i><span class="bk-select-txt"></span></span><ul class="bk-select-options"><li class="bk-select-option"><i class="bk-select-option-icon"></i><span class="bk-select-option-txt"></span></li></ul></span> <span class="bk-disk-storage bk-ml2"><input class="bk-disk-input" placeholder="5-2000"> <span class="bk-disk-unit">GB</span></span> <span class="bk-disk-snapshot bk-form-row-li-info bk-ml2"><span class="bk-lnk"></span></span> <span class="bk-disk-snapshot-help bk-form-row-li-info bk-ml2"><span class="bk-lnk"><i class="aliyun-icon-help"></i></span></span> <span class="bk-disk-delete"><i class="aliyun-icon-wrong"></i></span> <span class="bk-disk-mount bk-form-row-li-info"><span class="bk-lnk"></span></span></div></div><div class="bk-form-row-li"><div class="bk-disk"><span class="bk-form-row-li-info bk-disk-type"><span class="bk-black"></span></span> <span class="bk-disk-storage bk-form-row-li-info bk-ml2"><span class="bk-disk-size">200</span><span class="bk-pale">GB</span></span> <span class="bk-disk-snapshot bk-form-row-li-info bk-ml2"><span class="bk-lnk">...</span></span> <span class="bk-disk-snapshot-help bk-form-row-li-info bk-ml2"><span class="bk-lnk"><i class="aliyun-icon-help"></i></span></span> <span class="bk-disk-delete"><i class="aliyun-icon-wrong"></i></span> <span class="bk-disk-mount bk-form-row-li-info"><span class="bk-lnk">/dev/xvda/</span></span></div></div><div class="bk-form-row-li"><span class="bk-disk-add"><i class="bk-disk-add-icon"><em class="bk-disk-add-icon-line"></em> <em class="bk-disk-add-icon-line-b"></em></i><span class="bk-disk-add-txt"></span></span><span class="bk-form-row-li-info bk-ml2"><span class="bk-orange">2</span></span></div><style></style><div class="bk-form-row-li"><span class="bk-marketplace"><i class="bk-marketplace-icon"><em class="bk-marketplace-icon-rect"></em> <em class="bk-marketplace-icon-rect"></em> <em class="bk-marketplace-icon-rect"></em> <em class="bk-marketplace-icon-rect"></em></i><span class="bk-marketplace-txt"></span></span></div></div></div></dd></dl><!-- group E --></div><div class="y-span3 y-last"><!--  S --><div class="bk-orders-menu bk-mb4"><span class="bk-orders-menu-icon"><span class="bk-orders-menu-icon-line"></span> <span class="bk-orders-menu-icon-line"></span> <span class="bk-orders-menu-icon-line"></span></span> <span class="bk-orders-menu-name"></span> <span class="bk-orders-menu-quantity">2</span> <span class="bk-orders-menu-quantity bk-pale">0</span></div><!--  E --><!--  S --><div class="bk-items"><div class="bk-items-title"></div><div class="bk-items-list"><ul><li><span class="bk-items-item-name"></span> <span class="bk-items-item-value">D</span></li><li><span class="bk-items-item-name"></span> <span class="bk-items-item-value">CPU1512MB</span></li><li><span class="bk-items-item-name"></span> <span class="bk-items-item-value">Aliyun Linux 5.7 64</span></li><li><span class="bk-items-item-name"></span> <span class="bk-items-item-value">2(20GB20GB) 1(10GB)</span></li><li><span class="bk-items-item-name"></span> <span class="bk-items-item-value">1Mbps</span></li><li><span class="bk-items-item-name"></span> <span class="bk-items-item-value">1</span></li><li><span class="bk-items-item-name"></span> <span class="bk-items-item-value">1</span></li></ul><div class="bk-items-yundun bk-mt2"><i class="aliyun-icon-yundun"></i><span></span><i class="aliyun-icon-help"></i></div></div><div class="bk-items-price"><div class="bk-items-price-title">ECS<span class="bk-cny">&yen;</span>844/</div><div class="bk-items-price-settle"><span class="bk-cny">&yen;</span><span class="bk-items-price-money">123456.000</span><span class="bk-items-price-unit">/</span></div><div class="bk-items-price-offer"><span class="bk-items-price-cost bk-mr1"> <span class="bk-cny">&yen;</span>1234/</span><span class="bk-items-price-rebate"> <span class="bk-cny">&yen;</span>1234/</span></div><div class="bk-items-price-tag"><i class="bk-items-price-tag-title aliyun-icon-giving"></i><div class="bk-items-price-tag-list"><span class="bk-ploy"></span><span class="bk-ploy"></span><span class="bk-ploy"></span><span class="bk-ploy"></span><span class="bk-ploy"></span><span class="bk-ploy"></span></div></div></div><div class="bk-items-price"><div class="bk-items-price-title">ECS<span class="bk-cny">&yen;</span>844/</div><div class="bk-items-price-settle"><span class="bk-cny">&yen;</span><span class="bk-items-price-money">1234.000</span><span class="bk-items-price-unit">/</span></div><div class="bk-items-price-offer"><span class="bk-items-price-cost bk-mr1"> <span class="bk-cny">&yen;</span>1234/</span><span class="bk-items-price-rebate"> <span class="bk-cny">&yen;</span>1234/</span></div><div class="bk-items-price-tag"><i class="bk-items-price-tag-title aliyun-icon-giving"></i><div class="bk-items-price-tag-list"><span class="bk-ploy"></span><span class="bk-ploy"></span><span class="bk-ploy"></span><span class="bk-ploy"></span><span class="bk-ploy"></span><span class="bk-ploy"></span></div></div></div><div class="bk-items-price-info"><a href="#" class="bk-lnk bk-ml2" hidefocus>>></a></div><div class="bk-items-price-control"><button class="bk-button bk-button-primary"></button><button class="bk-button bk-button-default"></button></div></div><!--  E --></div></div><!-- grid E --><!-- dialog S --><div class="bk-dialog"><div class="bk-dialog-box"><div class="bk-dialog-head"><span class="bk-dialog-title"></span> <span class="bk-dialog-close"><span class="aliyun-icon-wrong"></span></span></div><div class="bk-dialog-body"><p class="bk-dialog-part"><span>Elastic Compute Service, ECS</span><br><span>IT</span></p></div><div class="bk-dialog-foot"><button class="bk-button bk-button-blue bk-button-s" type="button"></button><button class="bk-button bk-button-white bk-button-s" type="button"></button></div></div></div><div class="bk-dialog" style="margin-top: 10px"><div class="bk-dialog-box"><div class="bk-dialog-head"><span class="bk-dialog-title"></span> <span class="bk-dialog-close"><span class="aliyun-icon-wrong"></span></span></div><div class="bk-dialog-body"><div class="bk-message bk-message-warning bk-message-s"><div class="bk-message-icon"><i class="aliyun-icon-no3"></i></div><div class="bk-message-message"><div class="bk-message-title"></div><div class="bk-message-info"><a href="javascript:;" class="bk-lnk-bule" hidefocus></a></div></div></div></div><div class="bk-dialog-foot"><button class="bk-button bk-button-blue bk-button-s" type="button"></button><button class="bk-button bk-button-white bk-button-s" type="button"></button></div></div></div><!-- dialog E --><div class="bk-title" style="margin-top: 10px"><div class="bk-title-box"><div class="bk-title-head"></div><div class="bk-title-body"></div></div></div><div class="bk-title bk-title-loading" style="margin-top: 10px"><div class="bk-title-box"><div class="bk-title-body"><div class="bk-loading"></div></div></div></div><!--  S --><div style="margin-top: 20px"><span class="bk-paging bk-paging-rn"><span class="bk-paging-list"><span class="bk-paging-prev bk-paging-disabled"></span> <span class="bk-paging-page">1</span> <span class="bk-paging-omit">...</span> <span class="bk-paging-page">11</span> <span class="bk-paging-page">12</span> <span class="bk-paging-page bk-paging-current">13</span> <span class="bk-paging-page">14</span> <span class="bk-paging-page">15</span> <span class="bk-paging-omit">...</span> <span class="bk-paging-page">125</span> <span class="bk-paging-next bk-paging-disabled"></span></span> <span class="bk-paging-total"><span>121</span></span> <span class="bk-paging-jump"><span><span></span> <input class="bk-paging-input" placeholder=""> <span></span> <button class="bk-button-white bk-button-s">GO</button></span></span></span></div><!--  S --></body></html>')}]),angular.module("dominator/base/tempCode/test.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/base/tempCode/test.html",'<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><script type="text/javascript">Array.prototype.unique = function() {\n	    var hash = {},out=[];\n	    for(var i = 0; i < this.length; i++) {\n	      if (!hash[this[i]]) {\n	        hash[this[i]] = true;\n	        out.push(this[i]);\n	      }\n	    }\n	    return out;\n	  }</script><script type="text/javascript" src="https://g.alicdn.com/??aliyun/www-dpl/0.3.43/knight/js/base-all.js,aliyun/www-dpl/0.3.43/knight/js/widget/common-header.js"></script><script src="http://g-assets.daily.taobao.net/aliyun/buy-kernel/0.4.1/vendor/angular/angular.min.js"></script><script type="text/javascript" src="./constraintsForTreeModel.js"></script><script type="text/javascript" src="./transformCommodityInfo.js"></script><script type="text/javascript" src="./convertTree.js"></script><script type="text/javascript" src="./dependence.js"></script><script data-main="../main-test.js" src="http://localhost:3000/console/vendor/requirejs/require.js"></script><script>require([\'./index\', \'./Commodity/CommodityService\'], function(index, CommodityService){\n			var CommodityService = CommodityService.CommodityService;\n			var raw = {"code":"200","data":{"config":{"product_id":{"value":"381117"},"order_time":[{"step":1,"max":9,"min":1,"unit":"month"},{"step":1,"max":3,"min":1,"unit":"year"},{"step":1,"max":15,"min":1,"unit":"day"}],"order_num":{"step":1,"max":99,"min":1},"product_code":{"value":"ecs"},"product_name":{"value":"\\u4E91\\u670D\\u52A1\\u5668ECS\\uFF08\\u5305\\u5E74\\u5305\\u6708\\uFF09"},"jump_restrict":{"value":"false"},"aliyunProduceCode":{"value":"ecs"},"data_disk_max_sum":{"value":"4"},"business_strategy":{"value":"HasControlAuth"},"orderType":"BUY","spec_code":"vm","aliyun_uid":"test_lxp@aliyun-test.com","isCertified":true,"balanceAmount":0,"is_finance_customer":false,"regionOpen":true,"region_map":{"cn-shenzhen-st3-a01":294,"cn-qingdao-cm5-a01":28,"cn-beijing-btc-a01":25,"cn-shanghai-eu13-a01":657,"cn-hongkong-am4-c04":162,"cn-hangzhou-dg-a01":23,"us-west-ot7-a01":437}},"components":{"datadisk":{"datadisk_device":[{"value":"/dev/xvdb","text":"/dev/xvdb"},{"value":"/dev/xvdc","text":"/dev/xvdc"},{"value":"/dev/xvdd","text":"/dev/xvdd"},{"value":"/dev/xvde","text":"/dev/xvde"},{"value":"/dev/xvdf","text":"/dev/xvdf"},{"value":"/dev/xvdg","text":"/dev/xvdg"},{"value":"/dev/xvdh","text":"/dev/xvdh"},{"value":"/dev/xvdi","text":"/dev/xvdi"},{"value":"/dev/xvdj","text":"/dev/xvdj"},{"value":"/dev/xvdk","text":"/dev/xvdk"},{"value":"/dev/xvdl","text":"/dev/xvdl"},{"value":"/dev/xvdm","text":"/dev/xvdm"},{"value":"/dev/xvdn","text":"/dev/xvdn"},{"value":"/dev/xvdo","text":"/dev/xvdo"},{"value":"/dev/xvdp","text":"/dev/xvdp"},{"value":"/dev/xvdq","text":"/dev/xvdq"},{"value":"/dev/xvdr","text":"/dev/xvdr"},{"value":"/dev/xvds","text":"/dev/xvds"},{"value":"/dev/xvdt","text":"/dev/xvdt"},{"value":"/dev/xvdu","text":"/dev/xvdu"},{"value":"/dev/xvdv","text":"/dev/xvdv"},{"value":"/dev/xvdw","text":"/dev/xvdw"},{"value":"/dev/xvdx","text":"/dev/xvdx"},{"value":"/dev/xvdy","text":"/dev/xvdy"},{"value":"/dev/xvdz","text":"/dev/xvdz"}],"datadisk_deletewithinstance":[{"value":"true","text":"\\u968F\\u5B9E\\u4F8B\\u91CA\\u653E"},{"value":"false","text":"\\u4E0D\\u968F\\u5B9E\\u4F8B\\u91CA\\u653E"}],"datadisk_size":[{"step":1,"max":2000,"min":5},{"step":1,"max":800,"min":5},{"step":1,"max":1024,"min":20}],"datadisk_disknumber":[{"step":1,"max":4,"min":0}],"datadisk_category":[{"value":"cloud_ssd","text":"SSD\\u4E91\\u76D8"},{"value":"cloud","text":"\\u666E\\u901A\\u4E91\\u76D8"},{"value":"ephemeral_ssd","text":"\\u672C\\u5730SSD\\u76D8"}],"datadisk_totalsize":[{"step":1,"max":1024,"min":0},{"step":1,"max":8000,"min":0},{"step":1,"max":4096,"min":0}]},"vm_ram":{"vm_ram":[{"value":"512","text":"512MB"},{"value":"1024","text":"1GB"},{"value":"1536","text":"1.5GB"},{"value":"2048","text":"2GB"},{"value":"2560","text":"2.5GB"},{"value":"4096","text":"4GB"},{"value":"8192","text":"8GB"},{"value":"12288","text":"12GB"},{"value":"20480","text":"20GB"},{"value":"16384","text":"16GB"},{"value":"24576","text":"24GB"},{"value":"32768","text":"32GB"},{"value":"65536","text":"64GB"}]},"vm_yundun_service":{"vm_yundun_service":[{"value":"1","text":"\\u662F"},{"value":"0","text":"\\u5426"}]},"is_soft":{},"vm_cpu":{"vm_cpu":[{"value":"1","text":"1\\u6838"},{"value":"2","text":"2\\u6838"},{"value":"4","text":"4\\u6838"},{"value":"8","text":"8\\u6838"},{"value":"16","text":"16\\u6838"}]},"vm_yundun_monitor":{"vm_yundun_monitor":[{"value":"1","text":"\\u662F"},{"value":"0","text":"\\u5426"}]},"vm_ssd_storage":{"ssddisk_type":[{"value":"disk_type_data","text":"\\u6570\\u636E\\u76D8"},{"value":"disk_type_sys","text":"\\u7CFB\\u7EDF\\u76D8"}],"vm_ssd_num":[{"step":1,"max":4,"min":0}],"vm_ssd_storage":[{"step":1,"max":800,"min":5}],"vm_ssd_storage_max":[{"step":1,"max":1024,"min":0}]},"vm_package":{"image_package":[{"value":"package_rumen","text":\'{"name":"\\u5165\\u95E8\\u578B","des":"1\\u6838CPU-512M\\u5185\\u5B58-1M\\u5E26\\u5BBD","vm":{"vm_cpu":"1","vm_ram":"512","vm_bandwidth":[{"vm_bandwidth":"1024", "vm_is_flow_type": "5" }], "systemdisk": [{ "systemdisk_device": "/dev/xvda", "systemdisk_category": "cloud", "systemdisk_size": "0" }],"vm_yundun_monitor":"1","vm_yundun_service": "1", "vm_iz":"random"} } \'},{"value":"package_jichu_A","text":\'{"name":"\\u57FA\\u7840\\u578BA","des":"1\\u6838CPU-1G\\u5185\\u5B58-1M\\u5E26\\u5BBD","vm":{"vm_cpu":"1","vm_ram":"1024","vm_bandwidth":[{"vm_bandwidth":"1024", "vm_is_flow_type": "5" }], "systemdisk": [{ "systemdisk_device": "/dev/xvda", "systemdisk_category": "cloud", "systemdisk_size": "0" }],"vm_yundun_monitor":"1","vm_yundun_service": "1", "vm_iz":"random"} }\'},{"value":"package_jichu_B","text":\'{"name":"\\u57FA\\u7840\\u578BB","des":"1\\u6838CPU-1G\\u5185\\u5B58-2M\\u5E26\\u5BBD","vm":{"vm_cpu":"1","vm_ram":"1024","vm_bandwidth":[{"vm_bandwidth":"2048", "vm_is_flow_type": "5" }], "systemdisk": [{ "systemdisk_device": "/dev/xvda", "systemdisk_category": "cloud", "systemdisk_size": "0" }],"vm_yundun_monitor":"1","vm_yundun_service": "1", "vm_iz":"random"} } \'},{"value":"package_puji","text":\'{"name":"\\u666E\\u53CA\\u578B1","des":"2\\u6838CPU-2G\\u5185\\u5B58-3M\\u5E26\\u5BBD","vm":{"vm_cpu":"2","vm_ram":"2048","vm_bandwidth":[{"vm_bandwidth":"3072", "vm_is_flow_type": "5" }], "systemdisk": [{ "systemdisk_device": "/dev/xvda", "systemdisk_category": "cloud", "systemdisk_size": "0" }],"vm_yundun_monitor":"1","vm_yundun_service": "1", "vm_iz":"random"} } \'},{"value":"package_yingyong","text":\'{"name":"\\u5E94\\u7528\\u578B2","des":"4\\u6838CPU-4G\\u5185\\u5B58-5M\\u5E26\\u5BBD","vm":{"vm_cpu":"4","vm_ram":"4096","vm_bandwidth":[{"vm_bandwidth":"5120", "vm_is_flow_type": "5" }], "systemdisk": [{ "systemdisk_device": "/dev/xvda", "systemdisk_category": "cloud", "systemdisk_size": "0" }],"vm_yundun_monitor":"1","vm_yundun_service": "1", "vm_iz":"random"} } \'},{"value":"package_tehui","text":\'{"name":"\\u7279\\u60E0\\u578B","des":"1\\u6838CPU-1G\\u5185\\u5B58-0M\\u5E26\\u5BBD","vm":{"vm_cpu":"1","vm_ram":"1024","vm_bandwidth":[{"vm_bandwidth":"0", "vm_is_flow_type": "5" }], "systemdisk": [{ "systemdisk_device": "/dev/xvda", "systemdisk_category": "cloud", "systemdisk_size": "0" }],"vm_yundun_monitor":"1","vm_yundun_service": "1", "vm_iz":"random"} } \'},{"value":"package_puji2","text":\'{"name":"\\u666E\\u53CA\\u578B2","des":"2\\u6838CPU-8G\\u5185\\u5B58-5M\\u5E26\\u5BBD","vm":{"vm_cpu":"2","vm_ram":"8192","vm_bandwidth":[{"vm_bandwidth":"5120", "vm_is_flow_type": "5" }], "systemdisk": [{ "systemdisk_device": "/dev/xvda", "systemdisk_category": "cloud", "systemdisk_size": "0" }],"vm_yundun_monitor":"1","vm_yundun_service": "1", "vm_iz":"random"} } \'},{"value":"package_yingyong1","text":\'{"name":"\\u5E94\\u7528\\u578B1","des":"2\\u6838CPU-16G\\u5185\\u5B58-5M\\u5E26\\u5BBD","vm":{"vm_cpu":"2","vm_ram":"16384","vm_bandwidth":[{"vm_bandwidth":"5120", "vm_is_flow_type": "5" }], "systemdisk": [{ "systemdisk_device": "/dev/xvda", "systemdisk_category": "cloud", "systemdisk_size": "0" }],"vm_yundun_monitor":"1","vm_yundun_service": "1", "vm_iz":"random"} } \'},{"value":"package_zhuanxiang1","text":\'{"name":"\\u4E13\\u4EAB\\u578B1","des":"4\\u6838CPU-8G\\u5185\\u5B58-5M\\u5E26\\u5BBD","vm":{"vm_cpu":"4","vm_ram":"8192","vm_bandwidth":[{"vm_bandwidth":"5120", "vm_is_flow_type": "5" }], "systemdisk": [{ "systemdisk_device": "/dev/xvda", "systemdisk_category": "cloud", "systemdisk_size": "0" }],"vm_yundun_monitor":"1","vm_yundun_service": "1", "vm_iz":"random"} } \'},{"value":"package_zhuanxiang2","text":\'{"name":"\\u4E13\\u4EAB\\u578B2","des":"4\\u6838CPU-16G\\u5185\\u5B58-5M\\u5E26\\u5BBD","vm":{"vm_cpu":"4","vm_ram":"16384","vm_bandwidth":[{"vm_bandwidth":"5120", "vm_is_flow_type": "5" }], "systemdisk": [{ "systemdisk_device": "/dev/xvda", "systemdisk_category": "cloud", "systemdisk_size": "0" }],"vm_yundun_monitor":"1","vm_yundun_service": "1", "vm_iz":"random"} } \'}]},"iooptimized":{"iooptimized":[{"value":"none","text":"\\u975EIO\\u4F18\\u5316\\u5B9E\\u4F8B"},{"value":"optimized","text":"IO\\u4F18\\u5316\\u5B9E\\u4F8B"}]},"vm_region_no":{"vm_region_no":[{"value":"cn-beijing-btc-a01","text":"\\u5317\\u4EAC","disabled":false},{"value":"cn-shenzhen-st3-a01","text":"\\u6DF1\\u5733","disabled":false},{"value":"cn-qingdao-cm5-a01","text":"\\u9752\\u5C9B","disabled":false},{"value":"cn-hangzhou-dg-a01","text":"\\u676D\\u5DDE","disabled":false},{"value":"cn-hongkong-am4-c04","text":"\\u9999\\u6E2F","disabled":true},{"value":"us-west-ot7-a01","text":"\\u7F8E\\u56FD\\u7845\\u8C37","disabled":false},{"value":"cn-shanghai-eu13-a01","text":"\\u4E0A\\u6D77","disabled":false}]},"vm_zone_no":{"vm_zone_no":[{"value":"cn-hangzhou-gy009-a","text":"\\u53EF\\u7528\\u4E2D\\u5FC3C01"},{"value":"cn-hangzhou-et1003-a","text":"\\u53EF\\u7528\\u4E2D\\u5FC3C03"},{"value":"cn-qingdao-cm9008-a","text":"\\u53EF\\u7528\\u4E2D\\u5FC3C02"}]},"cloud_ssd":{},"systemdisk":{"systemdisk_device":[{"value":"/dev/xvda","text":"/dev/xvda"}],"systemdisk_category":[{"value":"cloud","text":"\\u666E\\u901A\\u4E91\\u76D8"},{"value":"cloud_ssd","text":"SSD\\u4E91\\u76D8"},{"value":"ephemeral_ssd","text":"\\u672C\\u5730SSD\\u76D8"}],"systemdisk_size":[{"value":"0","text":"0"}]},"vm_iz":{"vm_iz":[{"text":"\\u968F\\u673A\\u5206\\u914D","value":"random"},{"text":"\\u6DF1\\u5733\\u53EF\\u7528\\u533AA","value":"cn-shenzhen-a"},{"text":"\\u6DF1\\u5733\\u53EF\\u7528\\u533AB","value":"cn-shenzhen-b"},{"text":"\\u9752\\u5C9B\\u53EF\\u7528\\u533AB","value":"cn-qingdao-b"},{"text":"\\u9752\\u5C9B\\u53EF\\u7528\\u533AA","value":"cn-qingdao-a"},{"text":"\\u5317\\u4EAC\\u53EF\\u7528\\u533AA","value":"cn-beijing-a"},{"text":"\\u5317\\u4EAC\\u53EF\\u7528\\u533AB","value":"cn-beijing-b"},{"text":"\\u4E0A\\u6D77\\u53EF\\u7528\\u533AA","value":"cn-shanghai-a"},{"text":"\\u9999\\u6E2F\\u53EF\\u7528\\u533AA","value":"cn-hongkong-a"},{"text":"\\u676D\\u5DDE\\u53EF\\u7528\\u533AD","value":"cn-hangzhou-d"},{"text":"\\u676D\\u5DDE\\u53EF\\u7528\\u533AC","value":"cn-hangzhou-c"},{"text":"\\u7F8E\\u897F\\u53EF\\u7528\\u533A1A","value":"us-west-1a"}]},"vm_flow_out":{},"vm_sata_storage":{"vm_sata_num":[{"step":1,"max":4,"min":0}],"vm_sata_storage":[],"vm_sata_storage_max":[{"step":1,"max":2008,"min":0}],"vm_snapshot_id":[{"value":"111","text":"\\u4E09\\u70B9\\u591A"}],"satadisk_type":[{"value":"disk_type_sys","text":"\\u7CFB\\u7EDF\\u76D8"},{"value":"disk_type_data","text":"\\u6570\\u636E\\u76D8"}]},"vm_vpc_switch_id":{"vm_vpc_switch_id":[{"value":"1","text":"\\u865A\\u62DF\\u4EA4\\u6362\\u673A"}]},"vm_os":{"vm_os_kind":[{"value":"windows","text":"windows"},{"value":"linux","text":"linux"}],"vm_os_bit":[{"value":"32","text":"32\\u4F4D"},{"value":"64","text":"64\\u4F4D"}]},"vm_yundisk_storage":{"vm_yundisk_storage":[{"step":1,"max":2000,"min":5},{"value":"0","text":"0"}],"vm_snapshot_id":[{"value":"111","text":"\\u4E09\\u70B9\\u591A"}],"vm_yundisk_num":[{"step":1,"max":4,"min":0}],"vm_yundisk_storage_max":[{"step":1,"max":8000,"min":0}],"yundisk_type":[{"value":"disk_type_sys","text":"\\u7CFB\\u7EDF\\u76D8"},{"value":"disk_type_data","text":"\\u6570\\u636E\\u76D8"}]},"vm_bandwidth":{"vm_bandwidth":[{"step":1024,"max":204800,"min":0},{"step":1024,"max":204800,"min":1024},{"step":1024,"max":512000,"min":1024},{"step":1024,"max":409600,"min":1024},{"step":1024,"max":102400,"min":1024},{"step":1024,"max":307200,"min":1024}],"vm_is_flow_type":[{"value":"5","text":"\\u6309\\u56FA\\u5B9A\\u5E26\\u5BBD"},{"value":"1","text":"\\u6309\\u4F7F\\u7528\\u6D41\\u91CF"}]},"vm_web_type":{"vm_web_type":[{"value":"0","text":"\\u7ECF\\u5178\\u7F51\\u7EDC"},{"value":"1","text":"\\u4E13\\u6709\\u7F51\\u7EDC"}]},"vm_security":{"vm_security":[{"text":"\\u5317\\u4EAC\\u5B89\\u5168\\u7EC41","value":"1"},{"text":"\\u5317\\u4EAC\\u5B89\\u5168\\u7EC42","value":"2"},{"text":"\\u6DF1\\u5733\\u5B89\\u5168\\u7EC41","value":"3"},{"text":"\\u6DF1\\u5733\\u5B89\\u5168\\u7EC42","value":"4"},{"text":"\\u9752\\u5C9B\\u5B89\\u5168\\u7EC41","value":"5"},{"text":"\\u9752\\u5C9B\\u5B89\\u5168\\u7EC42","value":"6"}]}},"constraint":{"vm_ram":{"vm_cpu":{"1":["512","1024","2048","4096","8192"],"2":["2048","4096","8192","16384"],"4":["4096","8192","16384","32768"],"8":["8192","16384","32768","65536"],"16":["65536","16384","32768"]},"vm_region_no|vm_cpu":{"cn-hongkong-am4-c04|1":["1024","2048","4096","8192"],"cn-hongkong-am4-c04|2":["2048","4096","8192","16384"],"cn-hongkong-am4-c04|4":["4096","8192","16384","32768"],"us-west-ot7-a01|1":["1024","2048","4096","8192"],"us-west-ot7-a01|2":["2048","4096","8192","16384"],"us-west-ot7-a01|4":["4096","8192","16384","32768"],"us-west-ot7-a01|8":["8192","16384","32768","65536"],"us-west-ot7-a01|16":["16384","32768","65536"],"cn-shanghai-eu13-a01|1":["1024","2048","4096","8192"]},"vm_cpu|ssddisk_type":{"2|disk_type_sys":["4096","8192","16384"],"4|disk_type_sys":["4096","8192","16384","32768"],"8|disk_type_sys":["8192","16384","32768","65536"],"16|disk_type_sys":["16384","32768","65536"]},"iooptimized|vm_cpu":{"optimized|2":{"semantics":"NOT","values":["2048","2560"]}}},"vm_os_kind":{"vm_ram":{"512":["linux"]}},"vm_os_bit":{"vm_ram":{"8192":["64"],"12288":["64"],"16384":["64"],"20480":["64"],"24576":["64"],"32768":["64"],"65536":["64"]}},"vm_sata_storage":{"yundisk_type":{"disk_type_sys":["0"]}},"satadisk_type":{"vm_sata_storage":{"0":["disk_type_data"]},"vm_cpu|vm_ram":{"2|2048":["disk_type_sys","disk_type_data"]},"vm_cpu":{"1":["disk_type_sys","disk_type_data"]},"vm_web_type":{"0":["disk_type_sys","disk_type_data"],"1":["disk_type_sys","disk_type_data"]}},"vm_ssd_storage":{"yundisk_type":{"disk_type_sys":["0"]}},"ssddisk_type":{"vm_ssd_storage":{"0":["disk_type_data","disk_type_sys"]},"vm_web_type":{"0":["disk_type_data","disk_type_sys"],"1":["disk_type_data","disk_type_sys"]}},"yundisk_type":{"vm_cpu|vm_ram":{"2|2048":["disk_type_sys","disk_type_data"]},"vm_cpu":{"1":["disk_type_sys","disk_type_data"]},"vm_web_type":{"0":["disk_type_sys","disk_type_data"],"1":["disk_type_sys","disk_type_data"]}},"vm_cpu":{"ssddisk_type":{"disk_type_sys":["2","4","8","16"]},"iooptimized":{"optimized":{"semantics":"NOT","values":["1"]}}},"vm_web_type":{"ssddisk_type":{"disk_type_sys":["0","1"]},"yundisk_type":{"disk_type_sys":["0","1"]},"ssddisk_type|vm_region_no":{"disk_type_sys|cn-beijing-btc-a01":["0"],"disk_type_sys|cn-qingdao-cm5-a01":["0"],"disk_type_sys|cn-hongkong-am4-c04":["0"],"disk_type_sys|us-west-ot7-a01":["0"],"disk_type_sys|cn-shanghai-eu13-a01":["0"],"disk_type_sys|cn-hangzhou-test-306":["0"],"disk_type_sys|cn-hangzhou-dg-a01":["0"]},"iooptimized":{"optimized":{"semantics":"NOT","values":["1"]}}},"vm_bandwidth":{"vm_is_flow_type":{"5":[{"step":1024,"max":204800,"min":0}],"1":[{"step":1024,"max":102400,"min":1024}]}},"systemdisk_category":{"iooptimized":{"optimized":["cloud_ssd"],"none":["cloud","ephemeral_ssd"]},"vm_cpu":{"1":{"semantics":"NOT","values":["cloud_ssd","ephemeral_ssd"]}},"vm_cpu|vm_ram":{"2|2048":{"semantics":"NOT","values":["cloud_ssd","ephemeral_ssd"]},"2|2560":{"semantics":"NOT","values":["cloud_ssd","ephemeral_ssd"]}},"vm_web_type|vm_region_no":{"1|cn-hangzhou-dg-a01":["cloud"]},"vm_region_no|vm_iz":{},"vm_region_no|vm_iz|iooptimized|vm_web_type":{"cn-shenzhen-st3-a01|cn-shenzhen-a|none|0":["cloud_ssd","ephemeral_ssd","cloud"],"cn-shenzhen-st3-a01|random|none|0":["cloud_ssd","ephemeral_ssd","cloud"],"cn-shenzhen-st3-a01|cn-shenzhen-a|none|1":["cloud_ssd","ephemeral_ssd","cloud"],"cn-shenzhen-st3-a01|random|none|1":["cloud_ssd","ephemeral_ssd","cloud"],"cn-shenzhen-st3-a01|cn-shenzhen-a|optimized|0":["cloud_ssd","cloud"],"cn-shenzhen-st3-a01|random|optimized|0":["cloud_ssd","cloud"],"cn-shenzhen-st3-a01|cn-shenzhen-b|none|0":["cloud"],"cn-qingdao-cm5-a01|cn-qingdao-b|none|0":["cloud"],"cn-qingdao-cm5-a01|random|none|0":["cloud"],"cn-qingdao-cm5-a01|cn-qingdao-a|none|0":["cloud"],"cn-beijing-btc-a01|cn-beijing-a|none|0":["cloud_ssd","ephemeral_ssd","cloud"],"cn-beijing-btc-a01|random|none|0":["cloud_ssd","ephemeral_ssd","cloud"],"cn-beijing-btc-a01|cn-beijing-a|none|1":["cloud_ssd","cloud"],"cn-beijing-btc-a01|random|none|1":["cloud_ssd","cloud"],"cn-beijing-btc-a01|cn-beijing-a|optimized|0":["cloud_ssd","cloud"],"cn-beijing-btc-a01|random|optimized|0":["cloud_ssd","cloud"],"cn-beijing-btc-a01|cn-beijing-b|none|0":["ephemeral_ssd","cloud"],"cn-shanghai-eu13-a01|cn-shanghai-a|none|0":["cloud"],"cn-shanghai-eu13-a01|random|none|0":["cloud"],"cn-hongkong-am4-c04|cn-hongkong-a|none|0":["cloud"],"cn-hongkong-am4-c04|random|none|0":["cloud"],"cn-hangzhou-dg-a01|cn-hangzhou-d|optimized|0":["cloud_ssd","ephemeral_ssd","cloud"],"cn-hangzhou-dg-a01|random|optimized|0":["cloud_ssd","ephemeral_ssd","cloud"],"cn-hangzhou-dg-a01|cn-hangzhou-d|optimized|1":["cloud_ssd","cloud"],"cn-hangzhou-dg-a01|random|optimized|1":["cloud_ssd","cloud"],"cn-hangzhou-dg-a01|cn-hangzhou-c|none|0":["cloud"],"cn-hangzhou-dg-a01|random|none|0":["cloud"],"us-west-ot7-a01|us-west-1a|none|0":["cloud"],"us-west-ot7-a01|random|none|0":["cloud"]}},"datadisk_category":{"iooptimized|systemdisk_category":{"optimized|cloud":["cloud","cloud_ssd"],"optimized|cloud_ssd":["cloud_ssd","cloud"],"none|cloud":["cloud"],"none|ephemeral_ssd":["cloud","ephemeral_ssd"],"none|cloud_ssd":["cloud","cloud_ssd"]},"vm_region_no|vm_iz":{},"vm_region_no|vm_iz|iooptimized|vm_web_type|systemdisk_category":{"cn-shenzhen-st3-a01|cn-shenzhen-a|none|0|ephemeral_ssd":["cloud_ssd","ephemeral_ssd","cloud"],"cn-shenzhen-st3-a01|random|none|0|ephemeral_ssd":["cloud_ssd","ephemeral_ssd","cloud"],"cn-shenzhen-st3-a01|cn-shenzhen-a|none|1|ephemeral_ssd":["cloud_ssd","ephemeral_ssd","cloud"],"cn-shenzhen-st3-a01|random|none|1|ephemeral_ssd":["cloud_ssd","ephemeral_ssd","cloud"],"cn-shenzhen-st3-a01|cn-shenzhen-a|none|0|cloud_ssd":["cloud_ssd","cloud"],"cn-shenzhen-st3-a01|random|none|0|cloud_ssd":["cloud_ssd","cloud"],"cn-shenzhen-st3-a01|cn-shenzhen-a|none|0|cloud":["cloud_ssd","cloud"],"cn-shenzhen-st3-a01|random|none|0|cloud":["cloud_ssd","cloud"],"cn-shenzhen-st3-a01|cn-shenzhen-a|none|1|cloud_ssd":["cloud_ssd","cloud"],"cn-shenzhen-st3-a01|random|none|1|cloud_ssd":["cloud_ssd","cloud"],"cn-shenzhen-st3-a01|cn-shenzhen-a|none|1|cloud":["cloud_ssd","cloud"],"cn-shenzhen-st3-a01|random|none|1|cloud":["cloud_ssd","cloud"],"cn-shenzhen-st3-a01|cn-shenzhen-a|optimized|0|cloud_ssd":["cloud_ssd","cloud"],"cn-shenzhen-st3-a01|random|optimized|0|cloud_ssd":["cloud_ssd","cloud"],"cn-shenzhen-st3-a01|cn-shenzhen-a|optimized|0|cloud":["cloud_ssd","cloud"],"cn-shenzhen-st3-a01|random|optimized|0|cloud":["cloud_ssd","cloud"],"cn-shenzhen-st3-a01|cn-shenzhen-b|none|0|cloud":["cloud"],"cn-qingdao-cm5-a01|cn-qingdao-b|none|0|cloud":["cloud"],"cn-qingdao-cm5-a01|random|none|0|cloud":["cloud"],"cn-qingdao-cm5-a01|cn-qingdao-a|none|0|cloud":["cloud"],"cn-beijing-btc-a01|cn-beijing-a|none|0|cloud_ssd":["cloud_ssd","cloud"],"cn-beijing-btc-a01|random|none|0|cloud_ssd":["cloud_ssd","cloud"],"cn-beijing-btc-a01|cn-beijing-a|none|0|cloud":["cloud_ssd","cloud"],"cn-beijing-btc-a01|random|none|0|cloud":["cloud_ssd","cloud"],"cn-beijing-btc-a01|cn-beijing-a|none|0|ephemeral_ssd":["cloud_ssd","ephemeral_ssd","cloud"],"cn-beijing-btc-a01|random|none|0|ephemeral_ssd":["cloud_ssd","ephemeral_ssd","cloud"],"cn-beijing-btc-a01|cn-beijing-a|none|1|cloud_ssd":["cloud_ssd","cloud"],"cn-beijing-btc-a01|random|none|1|cloud_ssd":["cloud_ssd","cloud"],"cn-beijing-btc-a01|cn-beijing-a|none|1|cloud":["cloud_ssd","cloud"],"cn-beijing-btc-a01|random|none|1|cloud":["cloud_ssd","cloud"],"cn-beijing-btc-a01|cn-beijing-a|optimized|0|cloud_ssd":["cloud_ssd","cloud"],"cn-beijing-btc-a01|random|optimized|0|cloud_ssd":["cloud_ssd","cloud"],"cn-beijing-btc-a01|cn-beijing-a|optimized|0|cloud":["cloud_ssd","cloud"],"cn-beijing-btc-a01|random|optimized|0|cloud":["cloud_ssd","cloud"],"cn-beijing-btc-a01|cn-beijing-b|none|0|cloud":["cloud"],"cn-beijing-btc-a01|cn-beijing-b|none|0|ephemeral_ssd":["ephemeral_ssd","cloud"],"cn-shanghai-eu13-a01|cn-shanghai-a|none|0|cloud":["cloud"],"cn-shanghai-eu13-a01|random|none|0|cloud":["cloud"],"cn-hongkong-am4-c04|cn-hongkong-a|none|0|cloud":["cloud"],"cn-hongkong-am4-c04|random|none|0|cloud":["cloud"],"cn-hangzhou-dg-a01|cn-hangzhou-d|optimized|0|cloud_ssd":["cloud_ssd","cloud"],"cn-hangzhou-dg-a01|random|optimized|0|cloud_ssd":["cloud_ssd","cloud"],"cn-hangzhou-dg-a01|cn-hangzhou-d|optimized|0|cloud":["cloud_ssd","cloud"],"cn-hangzhou-dg-a01|random|optimized|0|cloud":["cloud_ssd","cloud"],"cn-hangzhou-dg-a01|cn-hangzhou-d|optimized|0|ephemeral_ssd":["cloud_ssd","ephemeral_ssd","cloud"],"cn-hangzhou-dg-a01|random|optimized|0|ephemeral_ssd":["cloud_ssd","ephemeral_ssd","cloud"],"cn-hangzhou-dg-a01|cn-hangzhou-d|optimized|1|cloud_ssd":["cloud_ssd","cloud"],"cn-hangzhou-dg-a01|random|optimized|1|cloud_ssd":["cloud_ssd","cloud"],"cn-hangzhou-dg-a01|cn-hangzhou-d|optimized|1|cloud":["cloud_ssd","cloud"],"cn-hangzhou-dg-a01|random|optimized|1|cloud":["cloud_ssd","cloud"],"cn-hangzhou-dg-a01|cn-hangzhou-c|none|0|cloud":["cloud"],"cn-hangzhou-dg-a01|random|none|0|cloud":["cloud"],"us-west-ot7-a01|us-west-1a|none|0|cloud":["cloud"],"us-west-ot7-a01|random|none|0|cloud":["cloud"]}},"datadisk_size":{"datadisk_category":{"cloud":[{"step":1,"max":2000,"min":5}],"cloud_ssd":[{"step":1,"max":1024,"min":20}],"ephemeral_ssd":[{"step":1,"max":800,"min":5}]}},"datadisk_totalsize":{"datadisk_category":{"cloud":[{"step":1,"max":8000,"min":0}],"cloud_ssd":[{"step":1,"max":4096,"min":0}],"ephemeral_ssd":[{"step":1,"max":1024,"min":0}]}},"vm_iz":{"vm_region_no":{"cn-shenzhen-st3-a01":["random","cn-shenzhen-a","cn-shenzhen-b"],"cn-qingdao-cm5-a01":["random","cn-qingdao-b","cn-qingdao-a"],"cn-beijing-btc-a01":["random","cn-beijing-a","cn-beijing-b"],"cn-shanghai-eu13-a01":["cn-shanghai-a"],"cn-hongkong-am4-c04":["cn-hongkong-a"],"cn-hangzhou-dg-a01":["random","cn-hangzhou-d","cn-hangzhou-c"],"us-west-ot7-a01":["us-west-1a"]}},"vm_security":{"vm_region_no":{"cn-shenzhen-st3-a01":["3","4"],"cn-qingdao-cm5-a01":["5","6"],"cn-beijing-btc-a01":["1","2"],"cn-shanghai-eu13-a01":[],"cn-hongkong-am4-c04":[],"cn-hangzhou-dg-a01":[],"us-west-ot7-a01":[]}},"iooptimized":{"vm_region_no|vm_iz":{"cn-shenzhen-st3-a01|cn-shenzhen-a":["optimized","none"],"cn-shenzhen-st3-a01|random":["optimized","none"],"cn-shenzhen-st3-a01|cn-shenzhen-b":["none"],"cn-qingdao-cm5-a01|cn-qingdao-b":["none"],"cn-qingdao-cm5-a01|random":["none"],"cn-qingdao-cm5-a01|cn-qingdao-a":["none"],"cn-beijing-btc-a01|cn-beijing-a":["optimized"],"cn-beijing-btc-a01|random":["optimized"],"cn-beijing-btc-a01|cn-beijing-b":["optimized"],"cn-shanghai-eu13-a01|cn-shanghai-a":["none"],"cn-shanghai-eu13-a01|random":["none"],"cn-hongkong-am4-c04|cn-hongkong-a":["none"],"cn-hongkong-am4-c04|random":["none"],"cn-hangzhou-dg-a01|cn-hangzhou-d":["optimized","none"],"cn-hangzhou-dg-a01|random":["optimized","none"],"cn-hangzhou-dg-a01|cn-hangzhou-c":["none"],"us-west-ot7-a01|us-west-1a":["none"],"us-west-ot7-a01|random":["none"]}}}},"requestId":"4e3e2b0f-9ad2-45fc-85e2-850a90ca611a","successResponse":true};\n\n			var componentsValueList = [{"type":"vm_region_no"},{"type":"vm_iz"}, {"type":"iooptimized"}, {"type":"vm_cpu"},{"type":"vm_ram"}];\n			var commponentsRunningInfo = CommodityService.parse(raw.data, componentsValueList);\n			CommodityService.parse(raw.data, componentsValueList);\n			console.log("commponentsRunningInfo====");\n			console.log(commponentsRunningInfo);\n		});</script><title>Document</title></head><body></body></html>')}]),define("dominator/base/buy-dominator-base-tpl",function(){}),define("dominator/base/index",["angular","./settings","./directives/_base","./helpers/_base","./buy-dominator-base-tpl"],function(e){var t=e.module("aliyun.buy.dominator.base",["aliyun.buy.settings","aliyun.buy.dominator.base.tpl","aliyun.buy.ui"]);return t}),define("dominator/driver/controllers/controllers",["angular","common/modelSystem/modelSystemBaseController"],function(e,t){var n=e.module("aliyun.buy.dominator.driver.controllers",[]);return n.controller=t.wrapController(n),n}),define("dominator/driver/cons/const",[],function(){return{TEMPLATE_PATH:"dominator/driver/partials/",EVENTS:{DOMINATOR:{INITIALIZED:"dominator:initialized",REMOTE_COMMODITY_LOADED:"dominator:remoteCommodityLoaded",READY:"dominator:ready",DESTROY:"dominator:destroy"},FIELD:{FIELD_CHANGED:"dominator:fieldValueChanged",FIELD_CHANGED_PUBLIC:"dominator:fieldValueChangedPublic",ANCHOR:"dominator:{fieldId}:anchor",VALIDATE:"dominator:field:validate"},CART:{QUERY_PRICE:"aliyunBuyCart:queryPrice",REMOVE_ITEM:"aliyunBuyCart:removeItem",PURCHASE:"aliyunBuyCart:purchase"},SUBTOTAL:{ADD_TO_CART:"aliyunBuySubtotal:addToCart",QUERY_PRICE:"aliyunBuySubtotal:queryPrice",PURCHASE:"aliyunBuySubtotal:purchase"}},UI_DIRECTIVE_OPTION_STYLE:{checkbox:"option",pwd:"option",buyButton:"option",buttonTab:"option",bricksTabs:"option",buySelect:"option",bricksSelect:"option",resourceGroup:"option",buyBandwidth:"option",buySliderWithNumber:"range",buyText:"option",duration:"option",amount:"range",numberStepper:"range"},FORM_FIELD_VALIDATE:{wraper:['<div class="bk-form-row-cell" ng-show="options.stateMessage">',"<%=validateInfos%>","</div>"].join("")}}}),define("dominator/driver/controllers/buyFormCommonFieldController",["angular","./controllers","../cons/const"],function(e,t,n){function r(e){throw new Error("DominatorCommonFormFieldController:"+e)}function i(e,t){this.$injector=e,this.setUIActionNames(["show","hide","enable","disable"])}t.controller("dominatorCommonFormFieldController",i,"$$baseController"),i.$inject=["$injector","aliyunBuyDominatorService"];var s={FIELD_CHANGE_EVENT:"dominator:{fieldName}:changed"};return i.prototype={constructor:i,$constructor:function(e,t){i.$parent.$constructor.call(this,e),!e.rawData&&(e.rawData={});var n=this,r=n.$injector.get("$timeout");t._getVM=function(){return n},this.getField=function(){return t},this.getRawData=function(){return e.rawData},n._timerForSysExec=0,this.onHandleSystemConstraints=this.getField().onHandleSystemConstraints||function(e,t,n,r,i,s){var o=i.getViewData(),u=r._getDynamicFieldOptions(o);r._setDynamicFieldOptions(u)},this.onHandleCustomConstraints=this.getField().onHandleCustomConstraints||function(e,t,n,r,i,s){var o=Array.prototype.slice.call(arguments,2);e.action.apply(e,o)},this._setUpSystemConstraints(),this._setUpCustomConstraints(),this._setUpUIAction(),this._setUpChangeNotify(),this._initConvertors(),this._initFieldOptionAndOptions()},_setUpSystemConstraints:function(){var e=this.getDepsFields()||[],t=this.$scope,n=this,r=this.getDominator();for(var i=0,s=null;s=e[i];i++)n.$on(n._getConstraintEventKey(s),function(e){return function(){var t=Array.prototype.slice.call(arguments,0);r||(r=n.getDominator()),t.push(e,n,r,n.$injector),n.onHandleSystemConstraints.apply(n,t)}}(s))},_setUpCustomConstraints:function(){var t=this.getField(),n=t.getConstraints();if(e.isArray(n)){var r=this,i=this.$scope,s=this.getDominator();for(var o=0,u=null;u=n[o];o++){var a=u.watches;for(var f=0,l=null;l=a[f];f++)r.$on(r._getConstraintEventKey(l),function(e,t){return function(){var n=Array.prototype.slice.call(arguments,0);n.push(t,r,s,r.$injector),n.unshift(e),r.onHandleCustomConstraints.apply(r,n)}}(u,l))}}},_setFieldChangeState:function(e){var t=this.getDominator();if(!t.isReady())return;var n=this.getField().getId(),r=t._getFormInstance(),i=r[n];if(!i)return;i.$setViewValue(e)},_setUpChangeNotify:function(){var e=this.getField(),t=this._getConstraintEventKey(e.componentCode),r=n.EVENTS.FIELD.FIELD_CHANGED,i=this,s=e.clientField===!0?!1:!0;this.$scope.$watch(this.getRawDataValueKey(),function(e){e!==undefined&&(i._setFieldChangeState(e),i.$publish(t,e),i.$publish(r,s))})},_setUpUIAction:function(){var t=this.getField(),n=this,i=this.getUIActionNames();e.isArray(i)||r('uiActionNames of the field "'+t.id+'" must be an array of strings!');for(var s=0,o=null;o=i[s];s++)e.isString(o)&&this.$on(t.id+":"+o,function(t){return function(){e.isFunction(n[t])&&n[t]()}}(o))},_initConvertors:function(){var e=this.getField().getConvertors()},_initFieldOptionAndOptions:function(){var e=this._getInitOptions();this._setDynamicFieldOptions(e)},_getDynamicFieldOptions:function(e){var t=this.getField(),n=[];return t.getFieldOptions(t.style,e)},_setDynamicFieldOptions:function(t){var n=this.getField(),r=this.$scope,i=n.style,s=n.initData;!r.options&&(r.options={}),!r.options.items&&(r.options.items={}),s&&e.extend(r,s),i=="range"||i=="intersectionRange"?e.extend(r.options,t):e.isArray(t)&&(r.options.items=t)},_getInitOptions:function(){return this.getField().getInitOptions()},getRawDataValueKey:function(){return"rawData."+this.getField().id},getDepsFields:function(){return this.getField().getDepsFields()},setOptionsAttr:function(e,t){!this.$scope.options&&(this.$scope.options={}),this.$scope.options[e]=t},getOptionsAttr:function(e){return this.$scope.options[e]},getOptions:function(){return this.$scope.options},getScope:function(){return this.$scope},setFieldOption:function(e){this.$scope.options=e},getFieldOption:function(){return this.$scope.options},getComponents:function(){var e=this.$scope,t=this.getFieldValue();return{options:e.options,value:t,detail:e.rawData.$detail}},getFieldValue:function(e){var t=this.getRawData(),n=this.getField();return t[n.id]},getOrderValue:function(){var e=this.getField().getConvertors(),t=this.getFieldValue();for(var n=0,r=null;r=e[n];n++)t=r.convert(t);return t},setFieldValue:function(e){var t=this.getRawData(),n=this.getField();t[n.id]=e},_getConstraintEventKey:function(e){return s.FIELD_CHANGE_EVENT.replace("{fieldName}",e)},getUIActionNames:function(){return this.uiActionNames},setUIActionNames:function(t){e.isArray(t)||r("uiActionNames must be an Array of string"),this.uiActionNames=t},show:function(){this._show=!0},hide:function(){this._show=!1},isHidden:function(){return this._show===!1},enable:function(){this._enable=!0},disable:function(){this._enable=!1},isDisabled:function(){return this._enable===!1}},i}),define("dominator/driver/controllers/_base",["./controllers","./buyFormCommonFieldController"],function(){}),define("dominator/driver/directives/directives",["angular","common/modelSystem/modelSystemBaseController"],function(e,t){var n=e.module("aliyun.buy.dominator.driver.directives",["aliyunConsoleModelSystem"]);return n.controller=t.wrapController(n),n}),define("dominator/base/convertors/convertorInterface",[],function(){function e(e){throw new Error("ConvertorInterface: "+e)}function t(){}return t.prototype={constructor:t,convert:function(){e('method "convert" not implemented')}},t}),define("dominator/base/convertors/stepConvertor",["angular","./convertorInterface","common/modelSystem/lib/util"],function(e,t,n){function r(e,t){this.convertRateCache=t,this.steps=this.initConvertorItems(e)}function i(t){delete t.getConvertRate,e.extend(this,t)}return r.prototype={constructor:r,initConvertorItems:function(t){var n=[];if(!e.isArray(t))throw new Error('StepConvertor: type of "convertorItems" should be an Array and it\'s value should not be undefined or null');var r=null;for(var s=0,o=null;o=t[s];s++)r=new i(o),r.index===undefined||r.index===null?r.index=s:r.index=r.index*1,s===0&&(r.pre=null,r.next=null),s>0&&(r.pre=n[s-1],r.pre.next=r,r.next=null),n.push(r);return n},convert:function(e,t,n){var r=this.steps,i=this.getConvertCacheKey(t,n),s=this.convertRateCache[i],o=this.getConvertDirectionAndStartPoint(t,n),u=o.direction;s||(s=this.getConvertRateStack(o,t,n),this.cacheConvertRate(i,s));var a=s.concat([]);switch(u){case"next":while(a.length>0)e/=a.shift();break;case"pre":while(a.length>0)e*=a.shift()}return e},getConvertCacheKey:function(e,t){return e+"2"+t},getConvertRateStack:function(e,t,n){var r=e.direction,i=e.startPoint,s=e.endPoint,o=[];return i.getConvertRate(s,n,r,o),o},getConvertDirectionAndStartPoint:function(e,t){var n=this.steps,r=0,i=0,s=!1,o=!1,u=null,a=null;for(var f=0,l=null;l=n[f];f++){if(s&&o)break;l.isMe(e)&&(s=!0,u=l,r=l.index),l.isMe(t)&&(o=!0,a=l,i=l.index)}return{startPoint:u,endPoint:a,direction:i-r>0?"next":"pre"}},cacheConvertRate:function(e,t){this.convertRateCache[e]=t}},i.prototype={constructor:r,getConvertRate:function(e,t,n,r){if(this[n]===null||this.isMe(t,e)){r.push(1);return}return r.push(this.rate),this[n].getConvertRate(e,t,n,r)},isMe:function(e,t){throw new Error('StepConvertorItem: method "isMe" must be overwrited by developer;check convertor config')}},r}),define("dominator/base/convertors/bitConvertor",["angular","./stepConvertor"],function(e,t){function n(e){return function(t,n){return t&&t.toLowerCase()==e?!0:!1}}function r(n){e.extend(this,n),this.cache={},this.stepConvertor=new t(i,this.cache),this.type="system"}var i=[{id:"bit",index:1,rate:8,isMe:function(e,t){return e=="bit"||e=="Bit"||e=="b"?!0:!1}},{id:"byte",index:2,rate:1024,isMe:function(e,t){return e.toLowerCase()=="byte"||e=="B"?!0:!1}},{id:"kb",index:3,rate:1024,isMe:n("kb")},{id:"mb",index:4,rate:1024,isMe:n("mb")},{id:"gb",index:5,rate:1024,isMe:n("gb")},{id:"tb",index:6,rate:1024,isMe:n("tb")},{id:"pb",index:7,rate:1,isMe:n("pb")}];return r.prototype={constructor:r,convert:function(e,t,n){return!e||e*1!=e*1?e:(e=e*1||this.value*1,e=e||this.value,t=t||this.currentUnit,n=n||this.targetUnit,this.stepConvertor.convert(e,t,n))}},r}),define("dominator/base/convertors/timeConvertor",["angular","./stepConvertor"],function(e,t){function n(e,t){return function(n,r){return!n||n.toLowerCase()!=e&&n!=t?!1:!0}}function r(n){e.extend(this,n),this.catchObj={},this.stepConvertor=new t(i,this.catchObj),this.type="system"}var i=[{id:"ms",index:1,rate:1e3,isMe:n("ms","")},{id:"second",index:2,rate:60,isMe:n("second","")},{id:"minute",index:3,rate:60,isMe:n("minute","")},{id:"hour",index:4,rate:24,isMe:n("hour","")},{id:"day",index:5,rate:30,isMe:n("day","")},{id:"month",index:6,rate:12,isMe:n("month","")},{id:"year",index:7,rate:1,isMe:n("year","")}];return r.prototype={constructor:r,convert:function(e,t,n){return!e||e*1!=e*1?e:(e=e*1||this.value*1,t=t||this.currentUnit,n=n||this.targetUnit,this.stepConvertor.convert(e,t,n))}},r}),define("dominator/base/convertors/_base",["./bitConvertor","./timeConvertor","./stepConvertor","./convertorInterface"],function(e,t){var n={bit:e,time:t};return{instance:function(e){var t=n[e.id],r=null;return t&&(r=new t(e)),r}}}),define("dominator/driver/directives/buyDominator",["angular","./directives","../cons/const","../../base/convertors/_base"],function(e,t,n,r){function i(e){throw new Error("BuyDominator:"+e)}function s(t){e.extend(this,t),this.getConstraints=function(){return this.constraints||[]},this.convertorInited=!1,this.getConvertors=function(){if(this.convertorInited)return this.convertors;var t=this.convertors,n=[];if(e.isArray(t))for(var i=0,s=null;s=t[i];i++){var o=r.instance(s);o&&n.push(o)}return this.convertors=n,this.convertorInited=!0,n}}function o(t,n,r,i,o,u){function a(n,r){for(var i=0,o=null;o=n[i];i++)if(o.type=="group")o.tip=o.tip||"",o.intro=o.intro||"",o.spmId=o.spmId||"",a(o.children,r);else{if(!r){var u=p[o.id];u&&e.extend(o,u)}o=new s(o,n),o.name?"":o.name=o.id,n[i]=o,t[o.id]=o,o.componentCode=o.componentCode||o.id,o.componentCode?t[o.componentCode]=o:""}}var f=o.viewModel||u.$getModel(i,"BuyViewModel"),l=[],c=[];if(!f){c=o.uiModel||u.$getModel(n,"BuyUiModel");var h=o.bizModel||u.$getModel(r,"BizModel"),p={};e.forEach(h.fields,function(e,t){p[e.id]=e}),l=c.fields,a(l),f=c}else l=f.fields,a(l,!0);return f}function u(e,t){var n=e.cartConfig||t.$getModel(e.cartConfigId,"BuyCartModel");return n||(n={display:"none"}),n}function a(e,t){var n=e.subtotalConfig||t.$getModel(e.subtotalConfigId,"BuySubtotalModel"),r=u(e,t);return n?r&&r.display=="none"&&(!n.options&&(n.options={}),n.options.displayCart="none"):n={display:"none"},n}function f(e,t){var n=e.frameworkSetting||t.$getModel(e.frameworkSettingId,"BuyFrameworkModel");if(!n)throw new Error("frameworkSetting");return n}function l(e){return n.EVENTS.FIELD.ANCHOR.replace("{fieldId}",e)}function c(t,n,r,i){if(!e.isObject(r))return;for(var s in r){var o=i.getFieldConfigByComponentCode(s).getId(),u=n[o];if(!u){console.error("Can not find the formElement which id is '"+o+"'");return}var a=u.$invalid;if(a){var f=l(o);t.$broadcast(f);break}}}function h(t,r,i,s,l,c,p,d,v){h.$parent.$constructor.call(this,t),t.$on("aliyunBuyAnchor:anchor",function(t,n){e.element(".viewFramework-product-body").animate({scrollTop:n.top+e.element(".viewFramework-product-body").scrollTop()+"px"},300)});var m=this,g=t.uiModelId,y=t.bizModelId,b=t.viewModelId,w=this,E=[],S=null,x={},T=n.UI_DIRECTIVE_OPTION_STYLE,N={};this.viewModelConfig=o(N,g,y,b,t,this);var C=this.viewModelConfig.id,k=f(t,this);this.formInvalid=!1,this.formInstance={},this.initFrameworkSetting=function(){var t=k.constraintService,n=k.components,i=function(){};t&&e.isFunction(t.getConstraints)&&(i=t.getConstraints,t.getConstraints=function(){var n=r.defer(),s=Array.prototype.slice.call(arguments,0),o=i.apply(t,s);return o&&e.isFunction(o.then)?(o.then(function(e){x=e,n.resolve(e)}),n.promise):o});if(e.isArray(n))for(var s=0,o=null;o=n[s];s++){var u=N[o.code];if(!e.isObject(u))continue;o.style||(o.style=T[u.type]),u.style=o.style}},this.initFrameworkSetting(),this.initSubtotal=function(n){this.updateSubtotalData=function(e){this.subtotalViewModel.data=e},this.setSubtotalOption=function(e){this.subtotalViewModel.options=e},this.setSubtotalOptionAttr=function(t,n){var r=this.getSubtotalOption();e.isObject(r)||(r={},this.setSubtotalOption(r)),r[t]=n},this.getSubtotalOption=function(){return this.subtotalViewModel.options},this.getSubtotalViewData=function(){return this.subtotalViewModel.data},this.getSubtotalPriceResult=function(){return this.subtotalViewModel.priceResult};var r=a(t,this);this.subtotalViewModel={},this.subtotalViewModel.priceService=r.priceService||k.priceService,this.subtotal=l.set(n,r,t,this,s,i)},this.initCart=function(e){this.updateCartData=function(e){this.cartViewModel.data=e},this.setCartOption=function(e){this.cartViewModel.options=e};var n=u(t,this);this.cartViewModel={},this.cartViewModel.priceService=n.priceService||k.priceService,this.cart=c.set(e,n,t,this,s,i)},this.buyModels={viewModel:undefined},this.initBuyForm=function(e){this.buyModels=e;if(!(this.buyModels&&this.buyModels.viewModel&&this.buyModels.orderModel))throw new Error("dominator-core does not return viewModel and orderModel");var t=this.buyModels.viewModel.id;p.initVirtualFields(this.buyModels.viewModel,this),S=s.set(t,this.buyModels.viewModel,this),S.getOriginConstraintData=function(){return x},this.buyModels.viewModel.name=this.buyModels.viewModel.name||this.buyModels.viewModel.id,p.removeVirtualFieldsFromViewModel(this.buyModels.viewModel),this.viewModel=this.buyModels.viewModel,this.orderModel=this.buyModels.orderModel},this.onFormInited=function(){S._setReady(),e.isFunction(m.buyModels.viewModel.onReady)&&m.buyModels.viewModel.onReady(S),m.$publish(n.EVENTS.DOMINATOR.READY,S)},this.isLoading=!0,d.init(this.viewModelConfig,k).then(function(e){m.$publish(n.EVENTS.DOMINATOR.REMOTE_COMMODITY_LOADED,S),m.initBuyForm(e),m.isLoading=!1,m.$publish(n.EVENTS.DOMINATOR.INITIALIZED,S)}),this.initCart(C),this.initSubtotal(C),this.$on(n.EVENTS.FIELD.FIELD_CHANGED,function(t,r){if(r){var i=S.getOrder(),s=S.getComponents();m.$publish(n.EVENTS.FIELD.FIELD_CHANGED_PUBLIC,[i],S),e.isFunction(m.subtotal.onFieldChange)&&m.subtotal.onFieldChange(t,r,i,s)}}),t.$on(n.EVENTS.CART.REMOVE_ITEM,function(e,t){m.cart.onRemoveFromCart(t)}),t.$on(n.EVENTS.CART.PURCHASE,function(t){var n=m.cart.getCartOrders(),r=k.orderService,i=r.beforePurchase;if(e.isFunction(i)&&!i(n,S,"cart",m.cart))return;r.purchase(n,S,"cart",m.cart)}),t.$on(n.EVENTS.SUBTOTAL.PURCHASE,function(i){var s=S.getOrder(),o=k.orderService,u=o.beforePurchase;if(e.isFunction(u)&&!u([s],S,"subtotal",m.subtotal))return;v.clearValidatorCheckPromise(),t.$broadcast(n.EVENTS.FIELD.VALIDATE),v.checkValid(r).then(function(){o.purchase([s],S,"subtotal",m.subtotal)})}),t.$on(n.EVENTS.SUBTOTAL.ADD_TO_CART,function(){var i=arguments,s=k.orderService,o=S.getOrder(),u=s.beforeAddToCart;if(e.isFunction(u)&&!u(S,m.cart))return;v.clearValidatorCheckPromise(),t.$broadcast(n.EVENTS.FIELD.VALIDATE),v.checkValid(r).then(function(){var e=S.getComponents();m.cart.onAddToCart(o,e),m.subtotalViewModel.handle.showAddToCartAnimation.apply(m.subtotalViewModel.handle,i)})}),t.$on("$destroy",function(){l.destroy(C),c.destroy(C),s.destroy(C),m.$publish(n.EVENTS.DESTROY)})}function p(){return{scope:{formConfig:"=",cartConfig:"=",subtotalConfig:"=",frameworkSetting:"=",formConfigId:"@",cartConfigId:"@",subtotalConfigId:"@",frameworkSettingId:"@",subtotalAlignStyle:"@",uiModelId:"@",bizModelId:"@",viewModelId:"@",uiModel:"=",bizModel:"=",viewModel:"="},controller:"aliyunBuyDominatorController as vm",templateUrl:n.TEMPLATE_PATH+"buyDominator.html",link:function(e,t,n){}}}t.directive("aliyunBuyDominator",p),t.controller("aliyunBuyDominatorController",h,"$$baseController"),p.$inject=[],h.$inject=["$scope","$q","$injector","aliyunBuyDominatorService","aliyunBuySubtotalService","aliyunBuyCartService","aliyunBuyVirtualFieldService","aliyun.buy.dominator.core.BuyCore","aliyunBuyDominatorCommonValidatorService"]}),define("dominator/driver/directives/formFieldFactory/fieldGroupField",["angular"],function(e){function t(t,r){this.templateEngine=r.templateEngine,this.formTemplateConst=r.formTemplateConst,this.formFieldFactory=r.formFieldFactory,this.attributes=e.extend({},t),this.attributes.formName=t.formName,this.fieldHtmlTemplate=this.formTemplateConst.FORM_FIELD_TEMPLATE[n.FACTORY_NAME],this.attributes.fieldHtml=this.renderFieldElement(n.FACTORY_NAME),this.attributes.formGroupAttrs=e.isArray(this.attributes.formGroupAttrs)&&this.attributes.formGroupAttrs.join(" ")||"",this.htmlStr=this.attributes.fieldHtml}var n={FACTORY_NAME:"group"};return t.prototype={constructor:t,getValidators:function(){return this.validators},getFieldRenderData:function(t){var n=this.getValidators(),r=e.extend({title:"",groupClass:"",groupStyle:!0,attributes:"",fieldCls:"",fieldsHtml:""},t||{});return r.attributes=e.isArray(r.attributes)?r.attributes.join(" "):e.isObject(r.attributes)?this.getAttrsHtml(r.attributes):"",r},getAttrsHtml:function(e){var t=e,n="";if(t)for(var r in t)t.hasOwnProperty(r)&&(n+=r+'="'+t[r]+'" ');return n},renderFieldElement:function(e){var t=[],n=this.attributes.children;for(var r=0,i=null;i=n[r];r++){i.formName=this.attributes.formName;var s=this.formFieldFactory.factory(i.type);i.fieldWraperTemplate=this.getFormTemplateConst().DOMINATOR_FORM_FIELD_WRAPER_TEMPLATE;var o=new s(i,this);t.push(o.html())}this.attributes.fieldsHtml=t.join("");var u=this.getFieldRenderData(this.attributes);return this.templateEngine.tmpl(this.fieldHtmlTemplate,u)},html:function(){return this.htmlStr?this.htmlStr:this.htmlStr=this.templateEngine.tmpl(this.htmlTmplate,{field:this.attributes})},htmlTmplate:function(){return this.htmlTmplate}},t}),define("dominator/driver/services/services",["angular","common/modelSystem/modelSystemBaseController"],function(e,t){var n=e.module("aliyun.buy.dominator.driver.services",[]);return n.controller=t.wrapController(n),n}),define("dominator/driver/services/commonValidatorService",["angular","./services"],function(e,t){function n(e){throw new Error("DominatorCommonValidatorService: "+e)}function r(e){this.$q=e}var i={};r.prototype={constructor:r,get:function(e,t,r){return e||n("formName is needed!"),e&&!t&&!r?i[e]:e&&t&&!r?i[e]?i[e][t]:n('form "'+e+'" has no validators! check the inputs'):i[e]?i[e][t]?i[e][t][r]:n('field "'+t+'" has no validators! check the form validators config'):n('form "'+e+'" has no validators! check the form validators config')},set:function(e,t,n,r){i[e]||(i[e]={}),i[e][t]||(i[e][t]={}),i[e][t][n]=r},init:function(e){if(!e)return;this.$q=e},checkValid:function(){if(!this.$q)return;var e=this.$q,t=e.defer();return e.all(this.validatorCheckPromiseList).then(function(e){var n=!0;for(var r=0;r<e.length;r++){var i=e[r];i||(n=!1)}n&&t.resolve(n)}),t.promise},getValidatorCheckePromiseList:function(){return this.validatorCheckPromiseList},addValidatorCheckPromise:function(e){this.validatorCheckPromiseList||(this.validatorCheckPromiseList=[]),this.validatorCheckPromiseList.push(e)},clearValidatorCheckPromise:function(){this.validatorCheckPromiseList=[]}};var s=new r;return t.factory("aliyunBuyDominatorCommonValidatorService",["$injector","$q",function(e,t){return s.init(t),s}]),s}),define("dominator/driver/directives/formFieldFactory/index",["angular","../../cons/const","./fieldGroupField","../../services/commonValidatorService"],function(e,t,n,r){var i={},s={};return e.forEach(["buyButton","buttonTab","buySelect","checkbox","pwd","newBrickTabs","newBrickRemarkTabs","bricksTabs","bricksSelect","buyBandwidth","buySliderWithNumber","selectLinkage","buyText","buyLabel","resourceGroup","duration","amount","numberStepper"],function(n){function s(t,r){this.getTemplateEngine=function(){return r.templateEngine},this.getFormTemplateConst=function(){return r.formTemplateConst},this.getFormFieldFactory=function(){return r.formFieldFactory},this.attributes=e.extend({},t),this.attributes.formName=this.attributes.formName?this.attributes.formName:t.formName,this.attributes.fieldId=this.attributes.id||this.attributes.name,this.fieldHtmlTemplate=this.getFieldHtmlTemplate(n),this.fieldWraperTmplate=t.fieldWrperTemplate||this.getFieldWraper(),this.initValidators(this.attributes),this.initDataBind(this.attributes),this.attributes.fieldHtml=this.renderFieldElement(n),this.attributes.formGroupAttrs=e.isArray(this.attributes.formGroupAttrs)&&this.attributes.formGroupAttrs.join(" ")||"",this.attributes.validateInfos=this.validators.validateInfos,this.htmlStr=this.getTemplateEngine().tmpl(this.fieldWraperTmplate,{field:this.attributes})}s.prototype={constructor:s,getFieldHtmlTemplate:function(e){return this.getFormTemplateConst().FORM_FIELD_TEMPLATE[e]},initValidators:function(n){function i(e){return e.replace(f,function(e,t,n,r){return r?n.toUpperCase():n}).replace(l,"Moz$1")}function s(e){var t,t="";if(e.type)t=e.type;else if(e.exp){var t=e.exp.split("=")[0];t&&t.length>0&&(t=i(t))}return t}function o(e){return u.FORM_FIELD_VALIDATE.DEFAULTS[e]||{exp:"",validateInfo:"",validatorName:""}}var u=this.getFormTemplateConst(),a=this.getTemplateEngine(),f=/([\:\-\_]+(.))/g,l=/^moz([A-Z])/,c=this,h=n.validators,p=[],d=[],v="",m=t.FORM_FIELD_VALIDATE.wraper,g=u.FORM_FIELD_VALIDATE.item;if(e.isArray(h)){var y=!1;e.forEach(h,function(t,n){var i=s(t),f=o(i);t.validateInfo=t.validateInfo?t.validateInfo:f.validateInfo,t.formName=c.attributes.formName,t.fieldName=c.attributes.name,t.dynamicHelpInfo=t.dynamicHelpInfo===!0?!0:!1,t.validatorName=t.validatorName?t.validatorName:f.validatorName||i,e.isFunction(t.handler)?(r.set(t.formName,t.fieldName,t.validatorName||t.id,t),y||(y=!0,p.push(t.exp||'aliyun-buy-dominator-common-validator common-validate-info="{{commonValidateInfo}}"'),d.push(a.tmpl(u.FORM_FIELD_VALIDATE.commonValidatorTemplate,t)))):(t.type&&!t.exp&&(t.exp=f.exp),p.push(t.exp||""),d.push(a.tmpl(g,t)))}),v=a.tmpl(m,{formName:n.formName,fieldName:n.name,validateInfoSpan:n.validateInfoSpan||null,validateInfos:d.join("")})}return this.validators={marks:p.join(" "),validateInfos:v},this.validators}},i[n]=s}),e.extend({group:n},i)}),define("dominator/driver/directives/dominatorFormGenerator",["angular","./directives","./formFieldFactory/index","common/modelSystem/directives/simpleForm"],function(e,t,n){function r(t){var n={FORM_TEMPLATE:['<form <%=attributes%> novalidate class="<%=inlineForm === true? "form-inline": "form-horizontal"%>  <%=formCls%>"','role="form"','name="<%=formName%>"',">","<%=fields%>","</form>"].join(""),DOMINATOR_FORM_FIELD_WRAPER_TEMPLATE:['<div aliyun-dominator-field-wraper form-id="<%=field.formName%>" field-id="<%=field.id%>">','<div <%=field.formGroupAttrs%> class="bk-form-row <%=field.fieldWraperCls||""%>" >',"<%if(!field.noLabel){%>",'<label class="bk-form-row-name <%=field.labelSpan%>">',"<%if(field.label){%>",' <div id="<%=field.id%>-label"><%=field.label || ""%></div>',"<%}%>","</label>","<%}%>","<div>","<%=field.fieldHtml%>",'<span class="help-block">',"<%=field.helpInfo%>","</span>","</div>","<%=field.validateInfos%>","</div>","</div>"].join(""),FORM_FIELD_TEMPLATE:{group:[' <div aliyun-buy-group class="<%=groupClass%>" data-title="<%=title%>" group-id="<%=id%>" group-tip="<%=tip%>" group-intro="<%=intro%>"',"   <%if(spmId){%>",'     data-spm="<%=spmId%>"',"   <%}%>",'   <%if(groupStyle === "none"){%>','     data-disabled="true"',"   <%}else{%>",'     data-disabled="false"',"   <%}%>",'   async="false">',"   <%=fieldsHtml%>"," </div>"].join(""),checkbox:['<div class="bk-form-row-cell" >','<div class="bk-form-row-li">',"<div","    aliyun-buy-checkbox",'    value="value" display="display" read-only="readOnly"',"    <%=attributes%>","    <%=validators%>","    <%=dataBind%>",'    class="bk-field-checkbox form-control-static <%=fieldCls%>"','    name="<%=fieldId%>" >',"</div>","<span aliyun-buy-field-tips ></span>","</div>","<div aliyun-buy-field-row-tip></div>","</div>"].join(""),pwd:['<div class="bk-form-row-cell" >','<div class="bk-form-row-li">',"<input",'    name="<%=name%>"','    type="password"',"    <%=validators%>","    <%=attributes%>","    <%=dataBind%>",'    class="bk-form-input bk-form-input-l2 <%=fieldCls%>"','    aria-labelledby="<%=name%>-label"','    aria-required="true"','    name="<%=fieldId%>"',"/>","<span aliyun-buy-field-tips ></span>","</div>","<div aliyun-buy-field-row-tip></div>","</div>"].join(""),buyButton:["<div","    aliyun-buy-button","    <%=attributes%>","    <%=dataBind%>",'    class="form-control-static <%=fieldCls%>"','    name="<%=fieldId%>" >',"</div>"].join(""),buttonTab:["<div","    aliyun-buy-buttontab",'    options="options.items" value="value" detail="rawData.$detail"',"    <%=attributes%>","    <%=validators%>","    <%=dataBind%>",'    class="form-control-static <%=fieldCls%>"','    name="<%=fieldId%>" >',"</div>"].join(""),bricksTabs:["<div","    aliyun-buy-bricks-tabs",'    options="options" value="value" detail="rawData.$detail"',"    <%=attributes%>","    <%=validators%>","    <%=dataBind%>",'    name="<%=fieldId%>" >',"</div>"].join(""),resourceGroup:["<div","    aliyun-buy-resource-group",'    value="value" field-id="<%=fieldId%>',"    <%=attributes%>","    <%=validators%>","    <%=dataBind%>",'    name="<%=fieldId%>" >',"</div>"].join(""),buySelect:["<div","    aliyun-buy-select","    <%=attributes%>","    <%=validators%>","    <%=dataBind%>",'    class="form-control-static <%=fieldCls%>"','    label-id="<%=fieldId%>-label"    name="<%=fieldId%>" >',"</div>"].join(""),bricksSelect:["<div",'    aliyun-buy-anchor="dominator:<%=fieldId%>:anchor"',"    aliyun-buy-bricks-select",'    options="options" value="value" detail="rawData.$detail"',"    <%=attributes%>","    <%=validators%>","    <%=dataBind%>",'    label-id="<%=fieldId%>-label"    name="<%=fieldId%>" >',"</div>"].join(""),buySliderWithNumber:["<div","    aliyun-buy-slider-with-number",'    options="options" value="value" detail="rawData.$detail"',"    <%=attributes%>","    <%=validators%>","    <%=dataBind%>",'    name="<%=fieldId%>"    label-id="<%=fieldId%>-label">',"</div>"].join(""),buyText:['<div class="bk-form-row-cell" >','<div class="bk-form-row-li">',"<input",'    name="<%=name%>"','    type="text"',"    <%=validators%>","    <%=attributes%>","    <%=dataBind%>",'    class="bk-form-input bk-form-input-l2 <%=fieldCls%>"','    name="<%=fieldId%>"',"/>","<span aliyun-buy-field-tips ></span>","</div>","<div aliyun-buy-field-row-tip></div>","</div>"].join(""),buyLabel:['<div class="bk-form-row-cell" >','<div class="bk-form-row-li">',"<div ",'    value="value"',"    <%=attributes%>","    <%=validators%>","    <%=dataBind%>"," aliyun-buy-label-info >","</div>","<span aliyun-buy-field-tips ></span>","</div>","<div aliyun-buy-field-row-tip></div>","</div>"].join(""),selectLinkage:["<div",'    aliyun-buy-anchor="dominator:<%=fieldId%>:anchor"',"    aliyun-buy-select-linkage",'    options="options" value="value" detail="rawData.$detail" root-value="rawData.$rootValue" children-value="rawData.$childrenValue" children-detail="rawData.$childrenDetail" root-detail="rawData.$rootDetail"',"    <%=attributes%>","    <%=validators%>","    <%=dataBind%>",'    label-id="<%=fieldId%>-label"','    name="<%=fieldId%>" >',"</div>"].join(""),duration:["<div","    aliyun-buy-duration",'    options="options" value="value" detail="rawData.$detail"',"    <%=attributes%>","    <%=validators%>","    <%=dataBind%>",'    name="<%=fieldId%>" >',"</div>"].join(""),amount:["<div","    aliyun-buy-amount",'    aliyun-buy-anchor="dominator:<%=fieldId%>:anchor"','    options="options" value="value" detail="rawData.$detail"',"    <%=attributes%>","    <%=validators%>","    <%=dataBind%>",'    name="<%=fieldId%>" >',"</div>"].join(""),numberStepper:["<div","    aliyun-buy-number-stepper",'    value="value" detail="rawData.$detail"','    min="options.min"','    max="options.max"','    step="options.step"','    unit="options.unit"','    is-disabled="options.isDisabled"',"    <%=attributes%>","    <%=validators%>","    <%=dataBind%>",'    name="<%=fieldId%>" >',"</div>"].join(""),newBrickTabs:['<div class="bk-form-row-cell" >','<div class="bk-form-row-li">',"<div","    aliyun-buy-new-brick-tabs",'    options="options" value="value" detail="rawData.$detail"',"    <%=attributes%>","    <%=validators%>","    <%=dataBind%>",'    name="<%=fieldId%>" >',"</div>","</div>","</div>"].join(""),newBrickRemarkTabs:['<div class="bk-form-row-cell" >','<div class="bk-form-row-li">',"<div","    aliyun-buy-new-brick-remark-tabs",'    options="options" value="value" detail="rawData.$detail"',"    <%=attributes%>","    <%=validators%>","    <%=dataBind%>",'    name="<%=fieldId%>" >',"</div>","</div>","</div>"].join("")},FORM_FIELD_VALIDATE:{commonValidatorTemplate:['<div class="bk-form-status bk-form-error">','<span class="bk-form-status-icon aliyun-icon-no3"></span>','<span class="bk-form-status-message" ng-bind-html="options.stateMessage"></span>',"</div>"].join("")}},r=e.extend({},t.FORM_FIELD_TEMPLATE,n.FORM_FIELD_TEMPLATE),i=e.extend({},t.FORM_FIELD_VALIDATE,n.FORM_FIELD_VALIDATE);e.extend(t,n),t.FORM_FIELD_TEMPLATE=r,t.FORM_FIELD_VALIDATE=i}function i(){this._parent.constructor.apply(this,arguments)}i.prototype={constructor:i},t.config(["aliyunModelSystemHtmlFormConfigProvider",function(e){e.extendFormGeneratorConst(r),e.extendFormFieldFactory(n)}])}),define("dominator/driver/directives/fieldWraper",["angular","./directives","../controllers/buyFormCommonFieldController"],function(e,t){function n(t,r,i){var s=i.get(t.formId),o=s.getFieldConfigById(t.fieldId);this.getDominator=function(){return s||(s=i.get()),s},this._show=!0,this._enable=!0,n.$parent.$constructor.call(this,t,o),e.isFunction(o.controller)&&o.controller(t,r,this,o.initData),this.formName=t.formId,this.commonValidateInfo=""}function r(e){return{scope:{fieldId:"@",formId:"@"},controller:"aliyunDominatorFieldWraperController as vm",link:function(t,n,r){var i=n.contents();i.attr("ng-if","vm._show"),e(n.contents())(t)}}}t.directive("aliyunDominatorFieldWraper",r),t.controller("aliyunDominatorFieldWraperController",n,"dominatorCommonFormFieldController"),r.$inject=["$compile"],n.$inject=["$scope","$injector","aliyunBuyDominatorService"]}),define("dominator/driver/directives/groupWraper",["angular","./directives"],function(e,t){function n(e,t){this.$parent.$constructor.call(this,e)}function r(){return{scope:{},controller:"aliyunBuyDominatorGroupWraperController as vm",link:function(e,t,n){}}}t.directive("aliyunDominatorGroupWraper",r),t.controller("aliyunDominatorGroupWraperController",n,"$$baseController"),r.$inject=[],n.$inject=["$scope","$injector"]}),define("dominator/driver/directives/commonValidator",["angular","./directives","../cons/const"],function(e,t,n){function r(e){return typeof e=="boolean"}function i(t,n,i,s){var o=null,u=null;t.initValidate=function(n){u=n,t.vm.commonValidateInfo="";var s=t.vm.getDominator(),a=t.vm.formName,f=n.$name;o=i.get(a,f);var l=t.vm,c=null;for(var h in o)if(o.hasOwnProperty(h)){c=o[h];if(e.isFunction(c.handler)){var p=function(i){return function(o,u){var a=l.isHidden()?!0:i.handler(o,n,t,t.vm,s,u);return r(a)||e.isUndefined(a)?(a=!!a,n.$setValidity(i.id,a),t.updateValidatorInfo(i),t.afterValidate(a,i,u,n),o):a&&e.isFunction(a.then)?(a.then(function(e){n.$setValidity(i.id,e),t.updateValidatorInfo(i),t.afterValidate(a,i,u,n)}),t.setFieldValid(n,o,i,u)):o}}(c);n.$parsers.push(p),n.$formatters.push(p)}}},t.updateValidatorInfo=function(e){t.vm.commonValidateInfo=e.validateInfo},t.afterValidate=function(e,n,r,a){function f(){var e=u.$error,n,r;for(var i in e)if(e.hasOwnProperty(i)&&e[i]){r="error",n=o[i].validateInfo||"";break}t.options.state=r,t.options.stateMessage=n}if(r){f();var l=s.defer();l.resolve(e),i.addValidatorCheckPromise(l.promise)}a.$dirty&&f()},t.setFieldValid=function(e,n,r){return e.$setValidity(r.id,!0),t.updateValidatorInfo(r),n}}function s(){return{require:"ngModel",controller:"aliyunBuyDominatorCommonValidatorController",link:function(t,r,i,s){t.vm&&t.initValidate(s),t.$on(n.EVENTS.FIELD.VALIDATE,function(t){e.forEach(s.$parsers,function(e){var t=!0;e(s.$viewValue,t)})})}}}t.directive("aliyunBuyDominatorCommonValidator",s),t.controller("aliyunBuyDominatorCommonValidatorController",i),s.$inject=[],i.$inject=["$scope","$injector","aliyunBuyDominatorCommonValidatorService","$q"]}),define("dominator/driver/directives/_base",["./directives","./buyDominator","./dominatorFormGenerator","./fieldWraper","./groupWraper","./commonValidator"],function(){}),define("dominator/driver/filters/filters",["angular","common/modelSystem/modelSystemBaseController"],function(e,t){var n=e.module("aliyun.buy.dominator.driver.filters",[]);return n.controller=t.wrapController(n),n}),define("dominator/driver/filters/_base",["./filters"],function(){}),define("dominator/driver/services/dominator/dominatorInterface",["angular"],function(e){function t(e){throw new Error("DominatorInterface:"+e)}function n(){}return n.prototype={Constructor:n,getOrder:function(){t('method "getOrder" is not implemented')},cacheOrder:function(){t('method "cacheOrder" is not implemented')},getOrderFromCache:function(){t('method "getOrderFromCache" is not implemented')},getViewData:function(){t('method "getViewData" is not implemented')}},n}),define("dominator/driver/services/dominator/customConstraintsHandler",["angular"],function(e){function t(e){throw new Error("CustomConstraintsHandler: "+e)}function n(){return!0}function r(e){e||t("fields should not be null or undefined"),this.fields=e.list,this.fieldsMap=e.map}return r.prototype={constructor:r,initFieldConstraints:function(){var e=this.fields;for(var t=0,n=null;n=e[t];t++)this._checkAndAnalyseConstraint(n,n.getConstraints())},_checkAndAnalyseConstraint:function(r,i){if(e.isArray(i))for(var s=0,o=null;o=i[s];s++)o.type!="system"&&(e.isArray(o.watches)||t('The constraint "'+o.id+'" of field "'+r.id+'" must has a property of watches which data type is Array'),e.isFunction(o.action)||t('The constraint "'+o.id+'" of field "'+r.id+'" must has a property of action which data type is Function'),o.condition===undefined&&(o.condition=n),this._wrapConstraintAction(o))},_wrapConstraintAction:function(e){var t=e.action;e.action=function(){var n=Array.prototype.slice.call(arguments,0);e.condition.apply(e,n)&&t.apply(e,n)}}},r}),define("dominator/driver/services/dominator/dominator",["angular","common/modelSystem/lib/util","./dominatorInterface","./customConstraintsHandler"],function(e,t,n,r){function i(e){throw new Error("Dominator:"+e)}function s(e,t){this.$viewModel=e,this._dominatorVm=t,this._fieldsCache={map:{},mapForComponentCode:{},list:[]},this.id=e.id,this._initFieldCache(),this._initFieldConstraints(),this.$cacheServcie={save:function(e){window.localStorage.setItem(this.id,JSON.stringify(e))},get:function(){var e=window.localStorage.getItem(this.id);return JSON.parse(e)}},this._isReady=!1}return s.prototype={Constructor:s,_setReady:function(){this._isReady=!0},isReady:function(){return this._isReady},_getFormInstance:function(){return this._dominatorVm.formInstance},_initFieldCache:function(){function e(t){for(var r=0,i=null;i=t[r];r++)i.type==="group"?e(i.children):(n.map[i.id]=i,n.mapForComponentCode[i.componentCode]=i,n.list.push(i))}var t=this.$viewModel.getFields(),n=this._fieldsCache;e(t)},_initFieldConstraints:function(){var e=new r(this._fieldsCache);e.initFieldConstraints()},initDefaultData:function(e){if(!this.isReady())throw new Error('Dominator  initDefaultDatacontroller "dominator:ready" dominatorViewModelonReadydomiantor');if(e)for(var t in e)if(e.hasOwnProperty(t)){var n=this.getFieldById(t)||this.getFieldByComponentCode(t);n?n.setFieldValue(e[t]):console.warn(' "'+t+'" keyinitDefaultData dominator ')}},getOrder:function(){var e=this._fieldsCache.list,t={},n=null;for(var r=0,i=null;i=e[r];r++){n=i._getVM();if(!n._show)continue;if(i.clientField==0||i.clientField==undefined||i.clientField==null)t[i.componentCode]=n.getOrderValue()}return t},getComponents:function(){var e=this._fieldsCache.list,t=null,n={};for(var r=0,i=null;i=e[r];r++){t=i._getVM();if(!t._show)continue;if(i.clientField==0||i.clientField==undefined||i.clientField==null)n[i.componentCode]=t.getComponents()}return n},cacheOrder:function(){this.$cacheServcie.save(this.getOrder())},getOrderFromCache:function(){return this.$cacheServcie.get()},getViewData:function(){var e=this._fieldsCache.list,t={};for(var n=0,r=null;r=e[n];n++)t[r.componentCode]=r._getVM().getFieldValue();return t},getOptionsFromConstraints:function(t,n,r){var i=this.getFieldConfigById(t),s=i?i.componentCode:t;r=i&&i.style?i.style:r;var o=null;try{o=this.getViewData()}catch(u){console.error("dominator.getOptionsFromConstraints.getViewData error")}return n=o?e.extend(o,n):n,this.$viewModel.getOptionsFromConstraints(s,r,n)},getFields:function(){return this._fieldsCache.list},getFieldMap:function(){return this._fieldsCache.map},getFieldConfigById:function(e){return this._fieldsCache.map[e]},getFieldById:function(e){var t=this._fieldsCache.map[e];if(t)return t._getVM();console.error("no field which id is "+e)},getFieldConfigByComponentCode:function(e){return this._fieldsCache.mapForComponentCode[e]},getFieldByComponentCode:function(e){var t=this._fieldsCache.mapForComponentCode[e];if(t)return t._getVM();console.error("no field which componentCode is "+e)},getFieldValueById:function(e){var t=this._fieldsCache.map[e];if(!t){console.error("Dominator: field does not exist! check your field id "+e);return}return t._getVM().getFieldValue()}},t.inherit(s,n),s}),define("dominator/driver/services/dominatorService",["angular","./services","./dominator/dominator"],function(e,t,n){var r={},i={get:function(e){return r[e]},set:function(e,t,i){var s=r[e];return s||(s=new n(t,i),r[e]=s),s},destroy:function(e){delete r[e]}};return t.factory("aliyunBuyDominatorService",["$injector",function(){return i}]),i}),define("dominator/driver/services/uiModelPorcessor",["angular","./services"],function(e,t){t.factory("aliyunBuyDominatorFormProcessService",["",function(){}]).factory("BuyCore",function(){var e={};return{init:function(t){e=t},run:function(){return e}}})}),define("dominator/driver/services/subtotal/subtotalServiceInterface",["angular"],function(e){function t(e){throw new Error("PriceServiceInterface:"+e)}function n(){}return n.prototype={Constructor:n,getItems:function(){t('method "getItems" is not implemented')}},n}),define("dominator/driver/services/subtotal/subtotalService",["angular","common/modelSystem/lib/util","./subtotalServiceInterface","../../cons/const"],function(e,t,n,r){function i(e){throw new Error("SubtotalService:"+e)}function s(t,n,r,i,s,o){this.id=t,delete n.onFieldChange,e.extend(this,n),this.getScope=function(){return r},this.getDominator=function(){return s.get(t)},this.getDominatorVm=function(){return i},this.getInjector=function(){return o},i.setSubtotalOption(this.options)}return s.prototype={Constructor:s,onFieldChange:function(t,n,i,s){var o=!0,u=this.getScope(),a=this.getDominatorVm(),f=this.getDominator();e.isFunction(this.onBeforeGetPrice)&&(o=this.onBeforeGetPrice(t,n,i,s,u,a));if(o===!1)return;if(n){var l=this.formatSubtotalData(i,s,u);a.updateSubtotalData(l),a.$publish(r.EVENTS.SUBTOTAL.QUERY_PRICE,[i],f,this)}},setSubtotalOptionAttr:function(e,t){var n=this.getDominatorVm();return n.setSubtotalOptionAttr.apply(n,arguments)},getSubtotalViewData:function(){var e=this.getDominatorVm();return e.getSubtotalViewData()},getSubtotalPriceResult:function(){var e=this.getDominatorVm();return e.getSubtotalPriceResult()},formatSubtotalData:function(e,t){}},t.inherit(s,n),s}),define("dominator/driver/services/cart/cartServiceInterface",["angular"],function(e){function t(e){throw new Error("CartServiceInterface:"+e)}function n(){}return n.prototype={Constructor:n,deleteItem:function(){t('method "deleteItem" is not implemented')},getItems:function(){t('method "getItems" is not implemented')}},n}),define("dominator/driver/services/cart/cartService",["angular","common/modelSystem/lib/util","./cartServiceInterface","../../cons/const"],function(e,t,n,r){function i(e){throw new Error("CartService:"+e)}function s(t,n,r,i,s,o){this.id=t,delete n.onAddToCart,delete n.onRemoveFromCart,e.extend(this,n),this.getScope=function(){return r},this.getDominatorVm=function(){return i},this.getDominator=function(){return s.get(this.id)},this.getInjector=function(){return o},this.cartViewOrders={totalAmount:0,viewOrders:[]},this.cartOrders=[],i.setCartOption(this.options),i.updateCartData(this.cartViewOrders)}return s.prototype={Constructor:s,_updateTotalAmount:function(){var t=0;e.forEach(this.cartViewOrders.viewOrders,function(n){if(!e.isNumber(n.amount))throw new Error("formatCartItemDataamountnumber");t+=n.amount}),this.cartViewOrders.totalAmount=t},getCartOrders:function(){return this.cartOrders},onAddToCart:function(t,n){this.cartOrders.push(e.copy(t));var i=this.getDominatorVm(),s=i.subtotalViewModel.priceResult,o=this.getScope(),u=this.getDominator(),a=this.formatCartItemData(t,n,s);this.addToCartList(a),i.updateCartData(this.cartViewOrders),i.$publish(r.EVENTS.CART.QUERY_PRICE,this.cartOrders,u)},onRemoveFromCart:function(e){var t=this.getDominatorVm(),n=this.getScope(),i=this.getDominator();this.cartOrders.splice(e,1),this.cartViewOrders.viewOrders.splice(e,1),this._updateTotalAmount(),t.updateCartData(this.cartViewOrders),t.$publish(r.EVENTS.CART.QUERY_PRICE,this.cartOrders,i)},getCartViewData:function(){return this.cartViewOrders},addToCartList:function(t){t&&(this.cartViewOrders.viewOrders.push(e.copy(t)),this._updateTotalAmount())},formatCartItemData:function(e,t){}},t.inherit(s,n),s}),define("dominator/driver/services/cartService",["angular","./services","./cart/cartService"],function(e,t,n){t.factory("aliyunBuyCartService",["$injector",function(){var e={};return{get:function(t){return e[t]},set:function(t,r,i,s,o,u){var a=e[t];return a||(a=new n(t,r,i,s,o,u),e[t]=a),a},destroy:function(t){delete e[t]}}}])}),define("dominator/driver/services/subtotalService",["angular","./services","./subtotal/subtotalService"],function(e,t,n){t.factory("aliyunBuySubtotalService",["$injector",function(){var e={};return{get:function(t){return e[t]},set:function(t,r,i,s,o,u){var a=e[t];return a||(a=new n(t,r,i,s,o,u),e[t]=a),a},destroy:function(t){delete e[t]}}}])}),define("dominator/driver/services/virtualField/virtualField",["angular","common/modelSystem/lib/util","../../controllers/buyFormCommonFieldController","../dominatorService"],function(e,t,n,r){function i(e,t,n){this.fieldValue="",this.orderValue="",this.options="",this.$scope={},this.$injector=n,this.$on=function(){var e=Array.prototype.slice.call(arguments,0);t.$on.apply(t,e)},this.$publish=function(){var e=Array.prototype.slice.call(arguments,0);t.$publish.apply(t,e)},this.getDominator=function(){return r.get(t.viewModelConfig.id)},this.getConstraints=function(){return e.constraints},this.$constructor.call(this,{},e)}return i.prototype={constructor:i,getUIActionNames:function(){return[]},getFieldValue:function(){var e=this.$scope;return e.options},getComponents:function(){var e=this.$scope,t=this.getFieldValue();return{options:e.options,value:t,detail:undefined}},$constructor:function(e,t){!e.rawData&&(e.rawData={}),this._show=!0;var n=this,r=this.$injector.get("$timeout");t._getVM=function(){return n},this.getField=function(){return t},this.getRawData=function(){return e.rawData},n._timerForSysExec=0,this.onHandleSystemConstraints=this.getField().onHandleSystemConstraints||function(e,t,n,r,i,s){var o=i.getViewData(),u=r._getDynamicFieldOptions(o);r._setDynamicFieldOptions(u)},this.onHandleCustomConstraints=this.getField().onHandleCustomConstraints||function(e,t,n,r,i,s){var o=Array.prototype.slice.call(arguments,2);e.action.apply(e,o)},this._setUpSystemConstraints(),this._setUpCustomConstraints(),this._initFieldOptionAndOptions()}},t.inherit(i,n),i}),define("dominator/driver/services/virtualFieldService",["angular","./services","./virtualField/virtualField"],function(e,t,n){t.factory("aliyunBuyVirtualFieldService",["$injector",function(t){function r(e,t){for(var n=0,i=null;i=e[n];n++)i.type=="group"?r(i.children,t):i.type=="virtual"&&t(i,e,n)}function i(t){if(e.isArray(t))for(var n=0,r=t.length;n<r;n++){var s=t[n];s&&(s.type=="group"?i(s.children):s.type=="virtual"&&(t.splice(n,1),n--,r--))}}var s={};return{initVirtualFields:function(e,i){var s=e.getFields();r(s,function(e,r,s){var o=new n(e,i,t);r[s]=e})},removeVirtualFieldsFromViewModel:function(e){var t=e.getFields();i(t)}}}])}),define("dominator/driver/services/_base",["./services","./dominatorService","./uiModelPorcessor","./commonValidatorService","./subtotal/subtotalService","./subtotal/subtotalServiceInterface","./cart/cartServiceInterface","./cart/cartService","./cartService","./subtotalService","./virtualFieldService"],function(){}),angular.module("aliyun.buy.dominator.driver.tpl",["dominator/driver/partials/buyDominator.html"]),angular.module("dominator/driver/partials/buyDominator.html",[]).run(["$templateCache",function(e){"use strict";e.put("dominator/driver/partials/buyDominator.html",'<!----><div class="bk-layout-2col" ng-if="subtotalAlignStyle == \'bottom\'"><div class="bk-layout-2col-main"><div html-form form-model="vm.viewModel" raw-data="vm.orderModel" form-inited="vm.onFormInited()" form-invalid="vm.formInvalid" form-instance="vm.formInstance"></div><!-- <span style="color:red;"></span>{{vm.formInvalid}} --><div ng-if="vm.cart.display != \'none\'" data-spm="{{vm.cartViewModel.options.spm}}" aliyun-buy-cart-fixed config="vm.cartViewModel.options" price-service="vm.cartViewModel.priceService" view-data="vm.cartViewModel.data"></div><div ng-if="vm.subtotal.display != \'none\'" data-spm="{{vm.subtotalViewModel.options.spm}}" aliyun-buy-subtotal-fixed config="vm.subtotalViewModel.options" price-service="vm.subtotalViewModel.priceService" price-result="vm.subtotalViewModel.priceResult" view-data="vm.subtotalViewModel.data" handle="vm.subtotalViewModel.handle"></div></div></div><!----><div class="bk-layout-2col" ng-if="subtotalAlignStyle != \'bottom\'"><div class="bk-layout-2col-side" aliyun-buy-order-roll bottom="209"><div ng-if="vm.cart.display != \'none\'" aliyun-buy-cart config="vm.cartViewModel.options" price-service="vm.cartViewModel.priceService" view-data="vm.cartViewModel.data"></div><div ng-if="vm.subtotal.display != \'none\'" aliyun-buy-subtotal config="vm.subtotalViewModel.options" price-service="vm.subtotalViewModel.priceService" price-result="vm.subtotalViewModel.priceResult" view-data="vm.subtotalViewModel.data" handle="vm.subtotalViewModel.handle"></div></div><div class="bk-layout-2col-main" aliyun-buy-preloader="vm.isLoading == true"><div html-form form-model="vm.viewModel" raw-data="vm.orderModel" form-inited="vm.onFormInited()" form-invalid="vm.formInvalid" form-instance="vm.formInstance"></div><!-- <span style="color:red;"></span>{{vm.formInvalid}} --></div></div>')}]),define("dominator/driver/buy-dominator-driver-tpl",function(){}),define("dominator/driver/index",["angular","../base/index","../core/index","./controllers/_base","./directives/_base","./filters/_base","./services/_base","./buy-dominator-driver-tpl","common/modelSystem/modelSystemCore"],function(e){var t=e.module("aliyun.buy.dominator.driver",["aliyun.buy.dominator.driver.tpl","aliyun.buy.dominator.driver.controllers","aliyun.buy.dominator.driver.directives","aliyun.buy.dominator.driver.filters","aliyun.buy.dominator.base","aliyun.buy.dominator.core","aliyunConsoleModelSystem","aliyun.buy.dominator.driver.services"]);return t}),define("dominator/index",["angular","dominator/core/index","dominator/base/index","dominator/driver/index"],function(){var e=angular.module("aliyun.buy.dominator",["aliyun.buy.dominator.driver","aliyun.buy.dominator.base","aliyun.buy.dominator.core"]);return e}),require(["dominator/index"]),define("buy-dominator",function(){}),define("ecsbuy/i18nConfig",["angular","common/helper/i18nHelper"],function(e,t){var n=window.ALIYUN_ECS_BUY_MESSAGE||{},r=t.getMessageObject();return t.i18nConfig(e.extend({},r,n)),t}),define("ecsbuy/base/directives/directives",["require","exports","angular","common/modelSystem/modelSystemBaseController"],function(e,t,n,r){var i=n.module("ecsbuyDirectives",[]);return i.controller=r.wrapController(i),i}),define("ecsbuy/base/helpers/buyUtils",["require","exports","angular"],function(e,t,n){var r=function(){function e(){}return e.getSelectItem=function(e,t,n){var r;return e=e||[],e.forEach(function(e){e&&e.value==t&&(r=e)}),r?r:(n||(r=e[0]),r||{})},e.hasUndefined=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t-0]=arguments[t];var r=!1;return n.forEach(e,function(e){e==undefined&&(r=!0)}),r},e.isNaNWarp=function(e){return isNaN(e)?undefined:e},e.hasIsNaN=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t-0]=arguments[t];var r=!1;return n.forEach(e,function(e){isNaN(e)&&(r=!0)}),r},e.getMapProperty=function(e,t){if(e&&t){var r=t.split("."),i=e;return n.forEach(r,function(e){e&&i!==undefined&&(i=i[e])}),i}return undefined},e.hashSetForMapList=function(e,t){var r={},i=[];e instanceof Array&&n.forEach(e,function(e,t){})},e.bitLenForString=function(e){var t=0;if(!e)return t;var n=e.length;for(var r=0;r<n;r++)e.charCodeAt(r)>255?t+=2:t++;return t},e.debounce=function(e,t,n){var r;return function(){var i=this,s=arguments;clearTimeout(r),r=n(function(){e.apply(i,s)},t||0)}},e.reverseMap=function(e){if(!e||typeof e!="object")return;var t={};for(var n in e)t[e[n]]=n;return t},e.unique=function(e,t){if(!n.isArray(e))return;var r={};n.forEach(e,function(e){t&&e[t]!=undefined?r[e[t]]=e:r[e]=!0});var i=[];for(var s in r)r[s]&&i.push(r[s]);return i},e.optimateTimeString=function(e){if(e!=undefined&&n.isFunction(e.toString)){var t=e.toString()||"";return t.replace(/-/g,"/")}return e},e.listToMap=function(e,t){var n={};return t=t||"id",e&&e.forEach(function(e,r){e[t]&&(n[e[t]]=e)}),n},e}();t.BuyUtils=r}),define("ecsbuy/base/cons/fieldCons",["require","exports"],function(e,t){var n=function(){function e(){}return e.FIELD_CHARGE_TYPE_POSTPAY="postpay",e.FIELD_CHARGE_TYPE_PREPAY="prepay",e.FIELD_NETWORK_TYPE_VPC="vpc",e.FIELD_NETWORK_TYPE_CLASSIC="classic",e.FIELD_BANDWIDTH_TYPE_TRAFFIC="PayByTraffic",e.FIELD_BANDWIDTH_TYPE_BANDWIDTH="PayByBandwidth",e.FIELD_IO_OPTIMIZED="optimized",e.FIELD_NON_IO_OPTIMIZED="none",e.VM_WEB_TYPE_VPC="1",e.VM_WEB_TYPE_CLASSIC="0",e.PREPAID_VM_WEB_TYPE_BANDWIDTH="5",e.PREPAID_VM_WEB_TYPE_TRAFFIC="1",e.POSTPAID_VM_WEB_TYPE_BANDWIDTH="0",e.POSTPAID_VM_WEB_TYPE_TRAFFIC="1",e}();t.FieldCons=n}),define("ecsbuy/base/cons/spotStrategy",["require","exports"],function(e,t){var n=function(){function e(){}return e.NO_SPOT="NoSpot",e.SPOT_AS_PRICE_GO="SpotAsPriceGo",e.SPOT_WITH_PRICE_LIMIT="SpotWithPriceLimit",e}();t.SpotStrategy=n}),define("ecsbuy/base/cons/diskCategory",["require","exports"],function(e,t){var n=function(){function e(){}return e.EPHEMERAL="ephemeral",e.EPHEMERAL_SSD="ephemeral_ssd",e.CLOUD="cloud",e.CLOUD_EFFICIENCY="cloud_efficiency",e.CLOUD_SSD="cloud_ssd",e.LOCAL_SSD_PRO="local_ssd_pro",e.LOCAL_HDD_PRO="local_hdd_pro",e.SAN_SSD="san_ssd",e.SAN_EFFICIENCY="san_efficiency",e}();t.DiskCategory=n}),define("ecsbuy/base/cons/buyBizCons",["require","exports","../../i18nConfig","./spotStrategy","./diskCategory"],function(e,t,n,r,i){var s=[{text:"",theme:"blue",handler:function(e){e.close(!0)}},{text:"",theme:"white",handler:function(e){e.close(!1)}}],o="buy.prepay",u="icon-buy-hui bk-icon-orange",a="icon-buy-qing bk-icon-gray",f="icon-buy-jiang bk-icon-orange",l=["cn-hongkong-am4-c04","us-west-ot7-a01","ap-southeast-os30-a01","us-east-us44-a01","ap-northeast-jp59-a01","eu-central-de46-a01","me-east-db47-a01","ap-southeast-au49-a01"],c=["ga1"],h=[{value:"1",text:"1"}],p={value:"0.25",text:"1 "+n.i18n("ECS_UNIT_WEEKS")},d=[{value:"1",text:"1 "+n.i18n("ECS_UNIT_MONTHS")},{value:"2",text:"2 "+n.i18n("ECS_UNIT_MONTHS")},{value:"3",text:"3 "+n.i18n("ECS_UNIT_MONTHS")},{value:"4",text:"4 "+n.i18n("ECS_UNIT_MONTHS")},{value:"5",text:"5 "+n.i18n("ECS_UNIT_MONTHS")},{value:"6",text:"6 "+n.i18n("ECS_UNIT_MONTHS")},{value:"7",text:"7 "+n.i18n("ECS_UNIT_MONTHS")},{value:"8",text:"8 "+n.i18n("ECS_UNIT_MONTHS")},{value:"9",text:"9 "+n.i18n("ECS_UNIT_MONTHS")},{value:"12",text:"1 "+n.i18n("ECS_UNIT_YEARS"),iconClass:u,tip:" 1  85 "},{value:"24",text:"2 "+n.i18n("ECS_UNIT_YEARS"),iconClass:u,tip:" 2  85 "},{value:"36",text:"3 "+n.i18n("ECS_UNIT_YEARS"),iconClass:u,tip:" 3  85 "}],v=[{value:"1",text:"1"},{value:"2",text:"2"},{value:"3",text:"3"},{value:"4",text:"4"},{value:"5",text:"5"},{value:"6",text:"6"},{value:"7",text:"7"},{value:"8",text:"8"},{value:"9",text:"9"},{value:"10",text:"10"},{value:"11",text:"11"},{value:"12",text:"12"}],m=[{value:r.SpotStrategy.SPOT_WITH_PRICE_LIMIT,text:n.i18n("ecs.buy.component.spotStrategy.spotWithPriceLimit")}],g={},y={},b={value:"public",text:n.i18n("ecs.buy.component.image.public")},w={value:"custom",text:n.i18n("ecs.buy.component.image.custom")},E={value:"shared",text:n.i18n("ecs.buy.component.image.shared")},S={tip:n.i18n("HOVER_TIP__TEXT__IMAGETYPE__MARKET"),value:"market",text:n.i18n("ecs.buy.component.image.market")},x=[{value:"prepay",text:n.i18n("ecs.buy.component.chargeType.prepay")},{value:"postpay",text:n.i18n("ecs.buy.component.chargeType.postpay")}],T=x.concat([{value:"spotPostpay",text:n.i18n("ecs.buy.component.chargeType.spotPostpay")}]),N={prepay:"PrePaid",postpay:"PostPaid",spotPostpay:"PostPaid"},C={onSale:"ONSALE",offSale:"OFFSALE"},k={PrePaid:"prepay",Prepaid:"prepay",PostPaid:"postpay",Postpaid:"postpay",AfterPay:"postpay"},L=[{value:"enabled",text:n.i18n("ecs.buy.component.publicIp.allocate")},{value:"disabled",text:n.i18n("ecs.buy.component.publicIp.notAllocate")}],A={value:"setupNow",text:n.i18n("ecs.buy.component.password.setupNow")},O={value:"setupLater",text:n.i18n("ecs.buy.component.password.setupLater")},M={value:"keyPair",text:n.i18n("ecs.buy.component.keypair")},_=[A,O],D=[{text:n.i18n("ECS_AEGIS_DISPLAY"),value:"Active"},{text:n.i18n("ECS_AEGIS_NO_DISPLAY"),value:"Deactive"}],P="youhuiquan_promotion_option_id_for_blank",H="default",B=[b,w,E,S],j="SystemDefaultSg",F={text:n.i18n("ecs.buy.componnet.securityGroup.SystemDefault"),value:j},I=[{value:"random",text:n.i18n("ecs.buy.component.vpc.defaultVpc")}],q=[{value:"random",text:n.i18n("ecs.buy.component.vpc.defaultVSwitch")}],R=[F],U={value:"system",text:n.i18n("ECS_SYSDISK")},z={value:"data",text:n.i18n("ECS_DATADISK")},W=["ecs.xn4.small","ecs.n4.small","ecs.n1.tiny","ecs.n1.small","ecs.t1.small","ecs.s1.small","ecs.c5.large","ecs.n4.large"],X="OFFICAL",V="FINANCE",$="JP",J="INDIA",K="SIN",Q="RESELLER",G=[$,J,K,Q],Y=[Q],Z=[i.DiskCategory.CLOUD,i.DiskCategory.CLOUD_SSD,i.DiskCategory.CLOUD_EFFICIENCY],et=["us-west-ot7-a01","us-east-us44-a01"],tt={DEFAULT_STATE:o,DEFAULT_BUTTONS:s,QING_ICON_CLASS:a,HUI_ICON_CLASS:u,DEFAULT_SPOT_DURATION:v,DEFAULT_SPOT_STRATEGY:m,DEFAULT_FREETIER_ORDERTIME_ITEMS:h,DEFAULT_ORDERTIME_ITEMS:d,INTL_REGIONS:l,VM_REGION_HUI_MAP:g,ECS_REGION_HUI_MAP:y,IMAGE_TYPE_PUBLIC:b,IMAGE_TYPE_CUSTOM:w,IMAGE_TYPE_SHARED:E,IMAGE_TYPE_MARKET:S,DEFAULT_IMAGE_TYPE:B,JIANG_ICON_CLASS:f,CHARGE_TYPE_MAP:N,CHARGE_TYPE_MAP_REVERT:k,CHARGE_TYPE_ITEMS:x,CHARGE_TYPE_ITEMS_WITH_SPOT:T,INSTANCE_FAMILIES_UNSUPPORTED_PUBLIC_IMAGE:c,ALLOCATE_PUBLIC_IP:L,SETTING_PASSWORD_ITEMS:_,SETTING_KEYPAIR_ITEM:M,SETTING_PASSWORD_NOW_ITEM:A,SETTING_PASSWORD_LATER_ITEM:O,SECURITY_ENHANCEMENT_ITEMS:D,COUPON_BLANK:P,DEFAULT_SECURITY_GROUP_ITEMS:R,DEFAULT_SYSTEM_SECURITY_GROUP_ITEM:F,DEFAULT_VPC_ITEMS:I,DEFAULT_VSWITCH_ITEMS:q,IMAGE_SELL_STATUS:C,DEFAULT_SYSTEM_SECURITY_GROUP:j,COUPON_DEFAULT:H,DISK_SYSTEM_ITEM:U,DISK_DATA_ITEM:z,DEFAULT_INSTANCE_TYPE:W,DURATION_WEEK_ITEM:p,CHANNEL_ID_OFFICAL:X,CHANNEL_ID_FINANCE:V,CHANNEL_IDS_FOR_INTL:G,DISK_UNSPPORTED_ENCRYPTED_REGIONS:et,CHANNEL_ID_RESELLER:Q,CHANNEL_IDS_FOR_4SERVICE:Y,DISK_CONVERTABLE_CATEGORYS:Z};t.BuyBizCons=tt}),define("ecsbuy/base/helpers/dateParseHelper",["require","exports"],function(e,t){var n=function(){function e(){}return e.format=function(e,t){Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)(new RegExp("("+n+")")).test(e)&&(e=e.replace(RegExp.$1,RegExp.$1.length==1?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e};var n=t||"yyyy-MM-dd 00:00",r=new Date(e);return r.Format(n)},e.getDateFromISOString=function(e){return new Date(e)},e.getISODateStringWithoutSecond=function(t){var n=e,r=n.pad;return t.getUTCFullYear()+"-"+r(t.getUTCMonth()+1)+"-"+r(t.getUTCDate())+"T"+r(t.getUTCHours())+":"+r(t.getUTCMinutes())+"Z"},e.getDayStartStampFromDate=function(e){if(e instanceof Date)return Date.parse(new Date(e.getFullYear(),e.getMonth(),e.getDate()))},e.getHourStartStampFromDate=function(e){if(e instanceof Date)return Date.parse(new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours()))},e.getMinuteStartStampFromDate=function(e){if(e instanceof Date)return Date.parse(new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes()))},e.pad=function(e){return e<10?"0"+e:e},e}();t.DateParseHelper=n}),define("ecsbuy/base/helpers/methodHelper",["require","exports","angular","./buyUtils"],function(e,t,n,r){var i=function(){function e(){}return e.filterArrayByCallback=function(e,t){var n=[];return e instanceof Array?(e.map(function(e,r){if(typeof t=="function"){var i=t(e);i===!0?n.push(e):i!==!1&&!!i&&n.push(i)}else n.push(e)}),n):n},e.transArrayToMapByKey=function(e,t){var r={};return t=t?t:"id",n.forEach(e,function(e,n){e[t]&&(r[e[t]]=e)}),r},e.transMapValueToArray=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},e.getArrayFromListMapByKey=function(e,t){var i=this,s=[];return!i.isNotEmptyArray(e)||!t?[]:(n.forEach(e,function(e,n){var i=r.BuyUtils.getMapProperty(e,t);i!=undefined&&s.indexOf(i)==-1&&s.push(i)}),s)},e.isNotEmptyArray=function(e){return n.isArray(e)&&e.length>0},e.min=function(e,t){return e>t?t:e},e}();t.MethodHelper=i}),define("ecsbuy/base/helpers/commodityHelper",["require","exports","angular","common/helper/i18nHelper","dominator/base/helpers/constraintHelper","./buyUtils","../cons/fieldCons","../cons/buyBizCons","./dateParseHelper","./methodHelper"],function(e,t,n,r,i,s,o,u,a,f){var l=function(){function e(){}return e.isLogin=function(e){var t=this.getConfig(e);return!!t.aliyun_uid},e.getComponents=function(e){if(!e)return;return e.components},e.getConstraints=function(e){if(!e)return;return e.constraint},e.getConfig=function(e){if(!e)return;return e.config},e.getInstanceDetail=function(e){if(!e)return;return e.instanceDetail},e.getOrderInfo=function(e){var t=this.getInstanceDetail(e);if(t)return t.orderInfo},e.getInstanceInfo=function(e){var t=this.getInstanceDetail(e);if(t)return t.instanceInfo},e.getFreetierConfig=function(e){if(!e)return;return e.freeTrialConfig},e.getFreetierConfigProperty=function(e,t){var n=this.getFreetierConfig(e);if(n&&t)return n[t]},e.getConfigProperty=function(e,t){var n=this.getConfig(e);if(n&&t)return n[t]},e.getComponent=function(e,t){var n=this.getComponents(e);if(n&&t)return n[t]},e.getComponentDeep=function(e,t){var r=this.getComponents(e);if(r&&t){var i=t.split("."),s=r;return n.forEach(i,function(e){s&&(s=s[e])}),s}return null},e.getComponentItem=function(e,t,n){var r=this.getComponentDeep(e,t);return s.BuyUtils.getSelectItem(r,n,!0)},e.getConstraintsByField=function(e,t,n){var r=this.getConstraints(e),i=r[t],s=n.join("|");return i[s]},e.getProperties=function(e,t,n){var r=this.getComponent(e,t);if(r&&n)return r[n]},e.getCommodityCode=function(e){var t=this.getConfig(e);return t&&t.spec_code},e.getOrderType=function(e){var t=this.getConfig(e);return t&&t.orderType},e.isFinanceUser=function(e){var t=this.getConfig(e);return t&&t.is_finance_customer},e.isChildAccount=function(e){var t=this.getConfig(e);return t&&t.is_child_account},e.inWhiteList4SpotInstance=function(e){return!0},e.getRegionAlias=function(e,t){var n=this.getConfig(e),r=n&&n.region_map;return r&&r[t]||t},e.getRegionId=function(t,n){var r=e.getConfigProperty(t,"region_map"),i=s.BuyUtils.reverseMap(r)||{};return i&&i[n]},e.getTextFromCollection=function(e,t){var r="";return n.forEach(t,function(t,n){t.value==e&&(r=t.text)}),r},e.removeItemFromCollection=function(e,t){if(e==undefined||!t||!n.isArray(t))return;for(var r=0;r<t.length;r++){var i=t[r];if(i&&i.value==e){t.splice(r,1);break}}},e.addItemToCollection=function(e,t,r,s){if(e==undefined||!t||!n.isArray(t))return;i.contains(t,e[r],r)||(isNaN(s)&&(s=0),t.splice(s,0,e))},e.getOrderTimeOptionsItems=function(e){var t=this,n=t.getConfigProperty(e,"order_time"),r=[];if(n instanceof Array){var i=f.MethodHelper.transArrayToMapByKey(n,"unit");for(var s in i)if(i.hasOwnProperty(s))switch(s){case"month":var o=t.getItemsFromRangeConfig(i[s],function(e){return t.formatOrderTimeItem(e,s)});r=r.concat(o);break;case"year":var u=t.getItemsFromRangeConfig(i[s],function(e){return t.formatOrderTimeItem(e*12,s)});r=r.concat(u);break;default:}}return r},e.formatOrderTimeItem=function(e,t){if(!isNaN(e))return e<1?{value:e,text:e*4+" "+r.i18n("ECS_UNIT_WEEKS"),unit:t}:e<=9&&e>=1?{value:e,text:e+" "+r.i18n("ECS_UNIT_MONTHS"),unit:t}:{value:e,text:e/12+" "+r.i18n("ECS_UNIT_YEARS"),unit:t}},e.getOrderTimeText=function(e){var t=this.formatOrderTimeItem(e,undefined);return s.BuyUtils.getMapProperty(t,"text")||""},e.getItemsFromRangeConfig=function(e,t){var r=[],i=s.BuyUtils.getMapProperty(e,"min"),o=s.BuyUtils.getMapProperty(e,"max"),u=s.BuyUtils.getMapProperty(e,"step");if(!s.BuyUtils.hasUndefined(i,o,u))for(var a=i;a<=o;a+=u){var f={text:a.toString(),value:a};if(n.isFunction(t)){var l=t(a);typeof l=="object"&&n.extend(f,l)}r.push(f)}return r},e.getNetworkType=function(e){return e=="1"||e=="vpc"?"vpc":"classic"},e.getVmWebType=function(e){if(o.FieldCons.FIELD_NETWORK_TYPE_VPC==e)return"1";if(o.FieldCons.FIELD_NETWORK_TYPE_CLASSIC==e)return"0"},e.getBandwidthType=function(e){return e=="1"||e=="PayByTraffic"?"PayByTraffic":"PayByBandwidth"},e.getVmIsFlowOut=function(e,t){return o.FieldCons.FIELD_BANDWIDTH_TYPE_TRAFFIC==e?"1":t?"0":"5"},e.getDuration=function(e){return e<1?{priceUnit:"Week",period:Math.floor(e*4),periodType:"Weekly"}:e<=9?{priceUnit:"Month",period:Math.floor(e),periodType:"Monthly"}:{priceUnit:"Year",period:Math.floor(e/12),periodType:"Yearly"}},e.getOrderTime=function(e,t,n){return t=="Year"||n=="Yearly"?e*12:t=="Week"||n=="Weekly"?e/4:e},e.getDuration4LX=function(e,t){var n=e&&e.toLocaleLowerCase(),r="",i="";return n=="year"?(r="Year",i="Yearly"):n=="month"?(r="Month",i="Monthly"):n=="hour"?(r="Hour",i="Hourly"):n=="week"&&(r="Week",i="Weekly"),{priceUnit:r,period:t,periodType:i}},e.getPostpayDuration=function(){return{priceUnit:"Hour",period:1,periodType:"Hourly"}},e.getVmRestartTime=function(e){if(!!e){var t=s.BuyUtils.isNaNWarp(Date.parse(e.toString()));if(!!t){var n=new Date(t);return a.DateParseHelper.getISODateStringWithoutSecond(n)}}},e.checkPublishConflictForVmRestartTime=function(e){if(!!e){var t=s.BuyUtils.isNaNWarp(Date.parse(e.toString()));if(!!t){var n=new Date(t),r=n.getDay(),i=n.getHours();if((r==2||r==4)&&i>=12)return!0;if((r==3||r==5)&&i<=12)return!0}}return!1},e.transformDurationValue=function(e,t){return t=="Month"?e:e*12},e.getDefaultConfig=function(e){var t=this.getConfigProperty(e,"regionIdOfRegionalization");if(t)return;var r=this.getProperties(e,"default_buy","default_config");if(!r||!n.isArray(r))return;var i=r[0]&&r[0].text,s;try{s=JSON.parse(i)}catch(o){console.error("parse defaultConfigValue error",o)}return s},e.getViewComponentsForEcs=function(e,t,i,o){var a=this,f=n.copy(t);if(!n.isObject(f)||!n.isObject(e))return;f.commodity&&(f=n.extend(f,f.commodity));var l=s.BuyUtils.getMapProperty(e,"vm_region_no.vm_region_no"),c=s.BuyUtils.getMapProperty(e,"instance_type.instance_type"),h=s.BuyUtils.getMapProperty(e,"iooptimized.iooptimized"),p=s.BuyUtils.getMapProperty(e,"systemdisk.systemdisk_category"),d=s.BuyUtils.getMapProperty(e,"datadisk.datadisk_category"),v="{size}GB{category}{deleteWithInstance}{encrypted}",m=f.ioOptimized?"optimized":"none",g={icmp:r.i18n("ecs.buy.componnet.securityGroup.icmp"),22:r.i18n("ecs.buy.componnet.securityGroup.tcp:22"),3389:r.i18n("ecs.buy.componnet.securityGroup.tcp:3389"),"80/80":r.i18n("ecs.buy.componnet.securityGroup.tcp:80"),"443/443":r.i18n("ecs.buy.componnet.securityGroup.tcp:443")},y=[{name:r.i18n("ecs.buy.label.region"),text:a.getTextFromCollection(f.regionId,l)},{name:r.i18n("ecs.buy.label.zone"),text:i?i[f.zoneId]:undefined},{name:r.i18n("ecs.buy.label.securityGroup")+" ID",text:function(){if(f.securityGroupId=="SystemDefaultSg"){var e=r.i18n("ecs.buy.componnet.securityGroup.SystemDefault");if(!f.groupRules)return e;var t=f.groupRules,i=[];return i.push(g.icmp),i.push(g[22]),i.push(g[3389]),n.forEach(t,function(e){e&&e.portRange&&i.push(g[e.portRange])}),e+=i.join(""),e}return f.securityGroupId}()},{name:r.i18n("ecs.buy.label.iooptimized"),text:a.getTextFromCollection(m,h)},{name:r.i18n("ecs.buy.label.instanceType"),text:a.getTextFromCollection(f.instanceType,c)},{name:r.i18n("ecs.buy.label.networkType"),text:f.networkType=="vpc"?r.i18n("ECS_PRIVATE_NETWORK"):r.i18n("ECS_CLASSICAL_NETWORK")},{name:r.i18n("ecs.buy.label.vSwitch")+" ID",text:f.vSwitchId},{name:r.i18n("ecs.buy.label.bandwidth.type"),text:function(){var e=f.internetMaxBandwidthOut;if(e==null||n.isUndefined(e))return undefined;var t=f.internetChargeType,i=t=="PayByBandwidth"?r.i18n("ECS_VIA_FIXED_BANDWIDTH"):r.i18n("ECS_VIA_FLOW");return e+"Mbps"+i+""}()},{name:r.i18n("ecs.buy.label.image"),text:function(){if(!o)return null;var e=o[f.regionId],t=e&&e[f.imageId]&&e[f.imageId].displayName;return t}()},{name:r.i18n("ecs.buy.label.disk.system"),text:f.systemDisk&&f.systemDisk.size+"GB "+a.getTextFromCollection(f.systemDisk.category,p)},{name:r.i18n("ECS_AEGIS_NAME"),text:a.getTextFromCollection(f.securityEnhancementStrategy,u.BuyBizCons.SECURITY_ENHANCEMENT_ITEMS)}];return n.forEach(f.dataDisks,function(e){if(e&&e.category){var t=e.deleteWithInstance?r.i18n("ECS_DATADISK_RELEASE"):r.i18n("ECS_DATADISK_NOT_RELEASE"),n=e.encryptedForView?r.i18n("ecs.buy.component.disk.data.encrypted"):r.i18n("ecs.buy.component.disk.data.unencrypted");y.push({name:r.i18n("ecs.buy.label.disk.data"),text:v.replace("{size}",e.size).replace("{category}",a.getTextFromCollection(e.category,d)).replace("{deleteWithInstance}",t).replace("{encrypted}",n)})}}),f.keyPairName?y=y.concat([{name:r.i18n("ecs.buy.label.keypair"),text:f.keyPairName}]):y=y.concat([{name:r.i18n("ecs.buy.label.password"),text:f.setupPassword=="setupNow"?r.i18n("ecs.buy.component.password.alreadySet"):r.i18n("ecs.buy.component.password.notSet")}]),f.spotStrategy&&(y=y.concat([{name:r.i18n("ecs.buy.label.spot.fee.strategy"),text:f.spotStrategy=="spotAsPriceGo"?r.i18n("ecs.buy.component.spotStrategy.spotAsPriceGo"):r.i18n("ecs.buy.component.spotStrategy.spotWithPriceLimit")}]),f.spotPriceLimit&&(y=y.concat([{name:r.i18n("ecs.buy.label.spot.fee.limit"),text:f.spotPriceLimit}]))),f.autoRenew!=undefined&&(y=y.concat([{name:r.i18n("ecs.buy.label.autoRenew"),text:f.autoRenew?r.i18n("ECS_TRUE"):r.i18n("ECS_FALSE")}])),f.recyclable!=undefined&&(y=y.concat([{name:r.i18n("ecs.buy.label.recyclable"),text:f.recyclable?r.i18n("ECS_TRUE"):r.i18n("ECS_FALSE")}])),y=y.concat([{name:r.i18n("ecs.buy.label.instanceName"),text:f.instanceName}]),y},e.getViewComponentsForYundisk=function(e,t,i){var o=n.copy(t);if(!n.isObject(o)||!n.isObject(e))return;o.commodity&&(o=n.extend(o,o.commodity));var u=s.BuyUtils.getMapProperty(e,"vm_region_no.vm_region_no"),a=s.BuyUtils.getMapProperty(e,"datadisk.datadisk_category"),f="{size}GB {category}, {encrypted}",l=[{name:r.i18n("ecs.buy.label.region"),text:this.getTextFromCollection(o.regionId,u)},{name:r.i18n("ecs.buy.label.zone"),text:i?i[o.zoneId]:undefined}],c=o.dataDisk;if(c&&c.category){var h=c.encryptedForView?r.i18n("ecs.buy.component.disk.data.encrypted"):r.i18n("ecs.buy.component.disk.data.unencrypted");l.push({name:r.i18n("ecs.buy.label.disk.clouddisk"),text:f.replace("{size}",c.size).replace("{category}",this.getTextFromCollection(c.category,a)).replace("{encrypted}",h)})}return c&&c.snapshotId&&l.push({name:r.i18n("ecs.buy.label.snapshot")+" ID",text:c.snapshotId}),l},e.getViewComponentsForVolume=function(e,t,i){var o=n.copy(t);if(!n.isObject(o)||!n.isObject(e))return;o.commodity&&(o=n.extend(o,o.commodity));var u=s.BuyUtils.getMapProperty(e,"vm_region_no.vm_region_no"),a=s.BuyUtils.getMapProperty(e,"volume.volume_category"),f="{size}GB {category}, {encrypted}",l=[{name:r.i18n("ecs.buy.label.region"),text:this.getTextFromCollection(o.regionId,u)},{name:r.i18n("ecs.buy.label.zone"),text:i?i[o.zoneId]:undefined}],c=o.volume;if(c&&c.category){var h=c.encryptedForView?r.i18n("ecs.buy.component.disk.data.encrypted"):r.i18n("ecs.buy.component.disk.data.unencrypted");l.push({name:r.i18n("ecs.buy.label.disk.volume"),text:f.replace("{size}",c.size).replace("{category}",this.getTextFromCollection(c.category,a)).replace("{encrypted}",h)})}return c&&c.snapshotId&&l.push({name:r.i18n("ecs.buy.label.snapshot")+" ID",text:c.snapshotId}),l},e.getViewComponentsForMarketImage=function(e,t,n){var i=s.BuyUtils.getMapProperty(e,"vm_region_no.vm_region_no"),o=t.regionId,u=t.commodity&&t.commodity.imageId,a=n[o]&&n[o][u]||{},f=[{name:r.i18n("ECS_SUPPLIER_NAME"),text:a.supplierName},{name:r.i18n("ecs.buy.label.region"),text:this.getTextFromCollection(t.regionId,i)},{name:r.i18n("ECS_IMAGE_NAME"),text:a.displayName},{name:r.i18n("ecs.buy.label.image")+" ID",text:a.imageId}];return f},e.getPaymentMethod=function(e){return u.BuyBizCons.CHARGE_TYPE_MAP_REVERT[e]},e.getConstraintValueByValue=function(t,r,i,s,o){var u;s&&n.isFunction(s.getOriginConstraintData)?u=s.getOriginConstraintData():u=n.copy(o);var a=e.getConstraintsByField(u,r,[i]),f=null;return n.forEach(a,function(e,r){n.isArray(e)&&e.indexOf(t)!==-1&&(f=r)}),f},e.hijackClassic=function(e,t){if(t&&t.inBlockList("ecsBuyClassic")){var n=this.getProperties(e,"vm_web_type","vm_web_type");this.removeItemFromCollection("0",n)}},e.getBuyChannelId=function(e){return s.BuyUtils.getMapProperty(e,"config.channel_id")||u.BuyBizCons.CHANNEL_ID_OFFICAL},e.isBuyChannelIntl=function(e){var t=this,n=t.getBuyChannelId(e).toLocaleUpperCase();return u.BuyBizCons.CHANNEL_IDS_FOR_INTL instanceof Array&&u.BuyBizCons.CHANNEL_IDS_FOR_INTL.indexOf(n)>-1},e.isBuyChannel4Service=function(e){var t=this,n=t.getBuyChannelId(e).toLocaleUpperCase();return u.BuyBizCons.CHANNEL_IDS_FOR_4SERVICE instanceof Array&&u.BuyBizCons.CHANNEL_IDS_FOR_4SERVICE.indexOf(n)>-1},e.getProductName=function(e){if(e=="vm"||e=="ecs")return r.i18n("ecs.buy.component.product.ecs");if(e=="yundisk"||e=="clouddisk")return r.i18n("ecs.buy.component.product.clouddisk");if(e=="san"||e=="volume")return r.i18n("ecs.buy.component.product.volume")},e}();t.CommodityHelper=l}),define("ecsbuy/base/baseClass/DataDiskValues",["require","exports","angular"],function(e,t,n){var r=function(){function e(e){this.deleteWithInstance=!1,this.convertChargeType=!1,this.inConvertableBlackListfalse=!1,this.disableSnapshot=!1,this.disableMount=!1,this.disableDeleteItem=!1,this.hideRelease=!1,this.isFullImage=!1,n.extend(this,e)}return e.prototype.coverToList=function(){return[this.category,this.size,this.snapshotId,this.device,this.instanceId,this.deleteWithInstance,this.convertChargeType,this.inConvertableBlackListfalse,this.snapshotSize,this.disableSnapshot,this.disableMount,this.disableDeleteItem,this.hideRelease,this.isFullImage,this.instanceName,this.paymentMethod]},e}();t.DataDiskValues=r}),define("ecsbuy/base/helpers/diskHelper",["require","exports","../cons/diskCategory","../baseClass/DataDiskValues","./commodityHelper","../cons/buyBizCons"],function(e,t,n,r,i,s){var o=function(){function e(){}return e.parseToDataDisk=function(e){return new r.DataDiskValues(e)},e.covertDiskDataList=function(e){var t=this.parseToDataDisk(this.covertDiskDataConfig(e));return t.coverToList()},e.parseValue=function(e){if(e&&e!==""){var t=angular.fromJson(e),n=[];if(t instanceof Array&&t.length>0)for(var r=0;r<t.length;r++){var i=t[r];n.push({category:i[0],size:i[1],snapshotId:i[2],device:i[3],instanceId:i[4],deleteWithInstance:i[5],convertChargeType:i[6],inConvertableBlackListfalse:i[7],snapshotSize:i[8],disableSnapshot:i[9],disableMount:i[10],disableDeleteItem:i[11],hideRelease:i[12],isFullImage:i[13],instanceName:i[14],paymentMethod:i[15]})}return n}return[]},e.covertDiskDataConfig=function(e){var t={category:e.datadisk_category,size:e.datadisk_size,snapshotId:e.datadisk_snapshot,device:e.datadisk_device,deleteWithInstance:e.datadisk_deletewithinstance,instanceId:e.datadisk_instanceId,instanceName:e.datadisk_instanceName,paymentMethod:i.CommodityHelper.getPaymentMethod(e.datadisk_chargeType)};return t},e.convertDiskDataToLxOrderParam=function(e){return{datadisk_category:e.category,datadisk_size:e.size,datadisk_snapshot:e.snapshotId,datadisk_device:e.device,datadisk_deletewithinstance:e.deleteWithInstance,datadisk_instanceId:e.instanceId,datadisk_instanceName:e.instanceName}},e.calculateIOPS=function(e,t){var r="";t=isNaN(t)?0:t;switch(e){case n.DiskCategory.CLOUD:r="200500";break;case n.DiskCategory.CLOUD_EFFICIENCY:r=Math.min(1e3+t*6,3e3);break;case n.DiskCategory.CLOUD_SSD:r=Math.min(t*30+1200,2e4);break;case n.DiskCategory.EPHEMERAL_SSD:r=3e3;break;case n.DiskCategory.LOCAL_SSD_PRO:r=Math.min(t*165,24e4);break;case n.DiskCategory.LOCAL_HDD_PRO:r="-";break;case n.DiskCategory.SAN_EFFICIENCY:r=Math.min(1e3+t*6,5e3);break;case n.DiskCategory.SAN_SSD:r=Math.min(t*40,3e4);break;default:r="200500"}return r},e.inConvertableDiskCategory=function(e){return s.BuyBizCons.DISK_CONVERTABLE_CATEGORYS.indexOf(e)>-1},e.inEncryptableDiskCategory=function(e){return this.inConvertableDiskCategory(e)},e.inEncryptableRegion=function(e,t){if(t==s.BuyBizCons.CHANNEL_ID_FINANCE)if(e=="cn-hangzhou-dg-a01"||e=="cn-qingdao-cm5-a01")return!1;return!(s.BuyBizCons.DISK_UNSPPORTED_ENCRYPTED_REGIONS.indexOf(e)>-1)},e}();t.DiskHelper=o}),define("ecsbuy/base/helpers/businessInfoHelper",["require","exports"],function(e,t){var n=function(){function e(){}return e.getBusinessInfo=function(e){if(e&&(e.activityId||e.orderSource))return{order_activity_id:e.activityId,orderSource:e.orderSource}},e}();t.BusinessInfoHelper=n}),define("ecsbuy/base/helpers/buyBizHelper",["require","exports","angular","./methodHelper"],function(e,t,n,r){var i=function(){function e(){}return e.setFieldValue=function(e,t,n){var r=n.getFieldMap();if(!r[e])return;var i=n.getFieldById(e);i.setFieldValue(t)},e.getFieldValue=function(e,t){var n=t.getFieldMap();if(!n[e])return;var r=t.getFieldValueById(e);return r},e.extend=function(e,t,r){if(r)for(var i in t)if(r.indexOf(i)!==-1){var s=e[i]||{};e[i]=n.extend(s,t[i])}else e[i]=t[i];else n.extend(e,t);return e},e.extendFieldModel=function(t,r,i){function o(e){return i?i.indexOf(e)!==-1:!0}var s=r.fields;return n.forEach(s,function(n){o(n.id)&&e.updateModelField(n,t)}),t},e.updateModelField=function(e,t){var r=t.fields,i=!1;n.forEach(r,function(t){if(t.id==e.id){var r=n.extend({},e,t);n.extend(t,r),i=!0}}),i||r.push(e)},e.extendFieldModelNew=function(e,t,i,s){var o=t.fields,u=r.MethodHelper.transArrayToMapByKey(o,"id"),a=e.fields,f=r.MethodHelper.transArrayToMapByKey(a,"id"),l=n.extend({},f);i instanceof Array||(i=Object.keys(u)),n.forEach(i,function(e,t){if(!(s instanceof Array)||s.indexOf(e)==-1){var r=u[e],i=f[e];l[e]=n.extend({},r,i)}});var c=r.MethodHelper.transMapValueToArray(l);return n.extend({},e,{fields:c})},e.getConstraintFieldValueByValue=function(t,r,i,s){var o=e.getOptionsFromConstraintSafe(t,null,s),u=[],a=s.getFieldMap();return n.forEach(o,function(o){var a=o.value,f={};f[t]=a;var l=e.getOptionsFromConstraintSafe(r,f,s);l.length>0&&n.forEach(l,function(e){i.indexOf(e.value)!==-1&&u.push(a)})}),u},e.getOptionsFromConstraintSafe=function(e,t,r){var i=r.getFieldMap(),s={};n.forEach(t,function(e,t){var n;i[t]?n=r.getFieldValueById(t):n=undefined,s[t]=n});var o=r.getOptionsFromConstraints(e,t);return r.getOptionsFromConstraints(e,s),o},e.getValueByConstraintMap=function(t,r,i){var s=e.getOptionsFromConstraintSafe(t,r,i),o=[];return n.forEach(s,function(e){o.push(e.value)}),o},e.getValueByConstraintValues=function(t,r,i,s){var o=[];return n.forEach(i,function(n){var i={};i[r]=n;var u=e.getValueByConstraintMap(t,i,s);o=o.concat(u)}),o},e.extendConstrainsForBizModel=function(e,t){typeof e=="object"&&typeof t=="object"&&n.forEach(e.fields,function(e){if(!e.constraints||!n.isArray(e.constraints))e.constraints=[];var r=e.id;if(typeof r!="undefined"&&t.hasOwnProperty(r)){var i=t[r];i instanceof Array||(i=[i]),e.constraints=e.constraints.concat(i)}})},e.replaceControllerForBizModel=function(e,t){if(!e||!n.isArray(e.fields)||!t)return;n.forEach(e.fields,function(e){var n=e.id;t[n]&&(e.controller=t[n])})},e}();t.BuyBizHelper=i}),define("ecsbuy/base/helpers/ImageHelper",["require","exports","angular","./commodityHelper","./diskHelper","./businessInfoHelper","./buyBizHelper"],function(e,t,n,r,i,s,o){var u=function(){function e(){}return e.parsePublicImageView=function(e){var t,n;if(!!e){var r=e.split("  ");t=r[0],n=r.slice(1,r.length).join("  ")}return{platform:t,version:n}},e.formatPublicImages=function(e){var t=this,r=[],i={};return n.forEach(e,function(e){var s=e.OSName,o=t.parsePublicImageView(s),u=e.ImageId,a=o.platform,f=t.OSBitMap[e.Architecture],l=o.version;if(!a||!l)return;var c=i[a];c||(c={icon:"icon-os-"+a.toLowerCase().replace(/ /g,"-"),text:a,value:a,childrens:{items:[]}},r.push(c),i[a]=c),c.childrens.items.push({text:l,value:n.toJson([u,e.OSType,f,e.Platform,e.Size,e.ImageOwnerAlias]),fullText:s})}),r},e.findPublicImageByImageId=function(e,t){var r=this;e=e||[];var i={rootValue:undefined,childValue:undefined};return t?(n.forEach(e,function(e,s){var o=e.value,u=e.childrens&&e.childrens.items;n.forEach(u,function(e,n){var s=e.value;if(s){var u=r.parseValue(s);u.imageId==t&&(i.rootValue=o,i.childValue=s)}})}),i):i},e.getPriceParamFromValue=function(e,t,n,r,i,s,o){var u=o=="Hour"?"-ECS":"-package",a=[{regionId:n,orderType:"marketplace-image",commodity:{productCode:e.imageProductCode,skuCode:e.imageProductCode+u,imageId:e.imageId,instanceType:r,amount:t,period:s,priceUnit:o},businessInfo:i}];return a},e.parseValue=function(e){if(e&&e!==""){var t=n.fromJson(e);return t?{imageId:t[0],osKind:t[1],osBit:t[2],platform:t[3],imageSize:t[4],imageCategory:t[5],capacity:t[6],used:t[7],quota:t[8],imageProductCode:t[9],specCode:t[10],version:t[11],deviceMaping:t[12]}:{}}return{}},e.toJsonString=function(e){return e?[e.imageId,e.osKind,e.osBit,null,e.imageSize,e.imageCategory,e.capacity,e.used,e.quota,e.imageProductCode,e.specCode,e.version]:(e={},[])},e.parseBuyParam=function(e,t){if(!e||!t)return"";var n;for(var i=0;i<e.imageVersions.length;i++)e.imageVersions[i].imageId==e.versionValue&&(n=e.imageVersions[i]);return n?{imageProductCode:e.imageProductCode,skuCode:e.skuCodes&&e.skuCodes[0],region:n.region,version:n.version,instanceType:t.instanceType,networkType:r.CommodityHelper.getNetworkType(t.networkType),orderSource:"ecs-buy"}:""},e.getOrderData=function(e){var t=e[0],n=t.components,i=this.getDatadisk(n.datadisk),o=n.networkType,u=t.data,a=s.BusinessInfoHelper.getBusinessInfo(u),f=r.CommodityHelper.getDuration4LX(u.pricingCycle,u.duration),l=this.getImageMarket(t.imageMarket,a,f),c=u.duration,h=n.vm_bandwidth[0],p=r.CommodityHelper.getBandwidthType(h.vm_is_flow_type),d=h.vm_bandwidth/1024,v=n.systemdisk[0],m=function(){return n.instance_type?n.instance_type[0].instance_type:""}(),g={orderType:"instance-buy",regionId:n.vm_region_no,imageMarket:l,fromUrl:!0,commodity:{zoneId:n["vm_iz"]=="random"?undefined:n.vm_iz,instanceType:m,networkType:o?o:"vpc",ioOptimized:n["iooptimized"]=="optimized",vSwitchId:n.vSwitchId,internetChargeType:p,internetMaxBandwidthOut:d,imageId:n.vm_os[0].vm_os,osKind:n.vm_os[0].vm_os_kind,systemDisk:{category:v.systemdisk_category,size:v["systemdisk_size"]==0?40:parseInt(v.systemdisk_size)},dataDisks:i,amount:parseInt(u.quantity),maxAmount:parseInt(u.quantity),periodType:f.periodType,period:parseInt(f.period),priceUnit:f.priceUnit},businessInfo:a};return g},e.getDatadisk=function(e){if(!e||!n.isArray(e))return null;var t=[];return n.forEach(e,function(e,n){t.push(i.DiskHelper.covertDiskDataConfig(e))}),t},e.getImageMarket=function(e,t,n){if(!e)return undefined;var r=e[0],i=r.components,s={imageProductCode:r.commodityCode,specCode:r.specCode,imageId:i.img_id},o=i.img_region,u=i.instance_type,a=r.data.quantity;return this.getPriceParamFromValue(s,a,o,u,t,n.period,n.priceUnit)},e.isCurrentImageFullImage=function(e,t){var n=e.getFieldValueById(t+"Image");if(!n)return!1;var r=this.parseValue(n),i=r.deviceMaping;return i&&i.length>1},e.getImageValue=function(e){var t=o.BuyBizHelper.getFieldValue("imageType",e);if(!t)return{};var n=t&&o.BuyBizHelper.getFieldValue(t+"Image",e);return this.parseValue(n)},e.getImageOsKind=function(e){var t=o.BuyBizHelper.getFieldValue("vm_os_kind",e);if(!t)return[];var r=n.fromJson(t);return r instanceof Array?r:[]},e.formatMarketPlatform=function(e){var t=[];for(var r in e){if(e.hasOwnProperty(r)){var i=[],s=e[r];if(n.isArray(s))for(var o=0;o<s.length;o++)i.push({value:s[o],text:s[o]});t.push({title:r,items:i})}return t}},e.OSBitMap={x86_64:"64",i386:"32"},e.ImageType={custom:"self","public":"system",shared:"others",market:"marketplace"},e}();t.ImageHelper=u}),define("ecsbuy/base/cons/cons",["require","exports"],function(e,t){var n=function(){function e(){}return e.VIEW_PATH="scripts/ecsbuy/base/views/",e.PARTIALS_PATH="scripts/ecsbuy/base/partials/",e.BASE_VIEW_PATH="scripts/ecsbuy/base/",e.BASE_PARTIALS_PATH="scripts/ecsbuy/base/",e.WINDOWS_SERVER_2003="Windows Server 2003",e}();t.Constant=n}),define("ecsbuy/base/directives/image/ecsImage",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","../../helpers/ImageHelper","../../cons/cons"],function(e,t,n,r,i,s,o){return r.directive("aliyunBuyEcsImage",["aliyunBuyEcsRemoteService",function(e){return{restrict:"EA",templateUrl:o.Constant.PARTIALS_PATH+"image/ecsImage.html",scope:{options:"=",value:"=",detail:"=",config:"&",imageType:"@",defaultValueImageId:"=?",valueAll:"="},replace:!0,compile:function(t,r){return i.require(["options","value","detail"],r),{pre:function(t){function a(e,t){var r=undefined;return n.forEach(e,function(e,i){var s=n.fromJson(e.value),o=s[0];t==o&&(r=e.value)}),r}function f(e,n){n&&(o.items=e.concat(n.items),t.fetchConfig.totalCount=n.totalCount),l(e,n)}function l(i,s){var f=t.defaultValueImageId,l=o.items,c=t.valueAll;if(!l||!n.isArray(l))return;if(f&&!a(l,f)){var h={imageOwnerAlias:u,instanceType:c.instanceType,pageNumber:1,pageSize:r,regionId:c.regionId,isSupportIoOptimized:c.iooptimized,oSType:c.osType,imageId:f};e.describeImages(h).then(function(e){var n=t.fetchConfig.resultsHandler(e);!n.items||n.items.length==0?t.value=l[0]&&l[0].value:(o.items=l.concat(n.items),t.value=a(n.items,f))})}else f?t.value=a(o.items,f):t.value=undefined}function c(e){if(!e||!n.isArray(e.DiskDeviceMapping))return;var t=e.DiskDeviceMapping,r=[];n.forEach(t,function(e){r.push({device:e.Device,snapshotId:e.SnapshotId,diskType:e.Device==="/dev/xvda"?"system":"data",size:typeof e.Size=="string"?parseInt(e.Size):e.Size})});if(r.length===0)return;return r}i.setDefault(t,{detail:{},options:{},value:""});var r=10,o=t.options,u=s.ImageHelper.ImageType[t.imageType];t.fetchConfig={pageSize:r,fetchData:function(n,r){var i=t.valueAll,s={imageOwnerAlias:u,instanceType:i.instanceType,pageNumber:n,pageSize:r,regionId:i.regionId,isSupportIoOptimized:i.iooptimized,oSType:i.osType};return e.describeImages(s)},resultsHandler:function(e){var t=e.Images.Image,r={totalCount:e.TotalCount,items:[]};return n.forEach(t,function(e){var t=s.ImageHelper.OSBitMap[e.Architecture],i=c(e.DiskDeviceMappings),o=n.toJson([e.ImageId,e.OSType,t,e.Platform,e.Size,null,null,null,null,e.ProductCode,null,null,i]);r.items.push({value:o,text:typeof e.ImageName!="undefined"?e.ImageName:e.ImageId})}),r}},t.$watchCollection("[valueAll.regionId, valueAll.iooptimized, valueAll.instanceType, valueAll.osType]",function(){o.items=undefined}),t.$watchCollection("[defaultValueImageId, valueAll.regionId, valueAll.iooptimized, valueAll.instanceType]",function(e){if(!!e[0]&&e[1]&&e[1]&&e[3]){var r=1,i=t.fetchConfig.fetchData,s=t.fetchConfig.resultsHandler,o=t.fetchConfig.pageSize||10,u=i(r,o);u&&n.isFunction(u.then)&&u.then(function(e){var t=s(e);f([],t)})}})}}}}}]),r}),define("ecsbuy/base/helpers/imageHelper",["require","exports","angular","./commodityHelper","./diskHelper","./businessInfoHelper","./buyBizHelper"],function(e,t,n,r,i,s,o){var u=function(){function e(){}return e.parsePublicImageView=function(e){var t,n;if(!!e){var r=e.split("  ");t=r[0],n=r.slice(1,r.length).join("  ")}return{platform:t,version:n}},e.formatPublicImages=function(e){var t=this,r=[],i={};return n.forEach(e,function(e){var s=e.OSName,o=t.parsePublicImageView(s),u=e.ImageId,a=o.platform,f=t.OSBitMap[e.Architecture],l=o.version;if(!a||!l)return;var c=i[a];c||(c={icon:"icon-os-"+a.toLowerCase().replace(/ /g,"-"),text:a,value:a,childrens:{items:[]}},r.push(c),i[a]=c),c.childrens.items.push({text:l,value:n.toJson([u,e.OSType,f,e.Platform,e.Size,e.ImageOwnerAlias]),fullText:s})}),r},e.findPublicImageByImageId=function(e,t){var r=this;e=e||[];var i={rootValue:undefined,childValue:undefined};return t?(n.forEach(e,function(e,s){var o=e.value,u=e.childrens&&e.childrens.items;n.forEach(u,function(e,n){var s=e.value;if(s){var u=r.parseValue(s);u.imageId==t&&(i.rootValue=o,i.childValue=s)}})}),i):i},e.getPriceParamFromValue=function(e,t,n,r,i,s,o){var u=o=="Hour"?"-ECS":"-package",a=[{regionId:n,orderType:"marketplace-image",commodity:{productCode:e.imageProductCode,skuCode:e.imageProductCode+u,imageId:e.imageId,instanceType:r,amount:t,period:s,priceUnit:o},businessInfo:i}];return a},e.parseValue=function(e){if(e&&e!==""){var t=n.fromJson(e);return t?{imageId:t[0],osKind:t[1],osBit:t[2],platform:t[3],imageSize:t[4],imageCategory:t[5],capacity:t[6],used:t[7],quota:t[8],imageProductCode:t[9],specCode:t[10],version:t[11],deviceMaping:t[12]}:{}}return{}},e.toJsonString=function(e){return e?[e.imageId,e.osKind,e.osBit,null,e.imageSize,e.imageCategory,e.capacity,e.used,e.quota,e.imageProductCode,e.specCode,e.version]:(e={},[])},e.parseBuyParam=function(e,t){if(!e||!t)return"";var n;for(var i=0;i<e.imageVersions.length;i++)e.imageVersions[i].imageId==e.versionValue&&(n=e.imageVersions[i]);return n?{imageProductCode:e.imageProductCode,skuCode:e.skuCodes&&e.skuCodes[0],region:n.region,version:n.version,instanceType:t.instanceType,networkType:r.CommodityHelper.getNetworkType(t.networkType),orderSource:"ecs-buy"}:""},e.getOrderData=function(e){var t=e[0],n=t.components,i=this.getDatadisk(n.datadisk),o=n.networkType,u=t.data,a=s.BusinessInfoHelper.getBusinessInfo(u),f=r.CommodityHelper.getDuration4LX(u.pricingCycle,u.duration),l=this.getImageMarket(t.imageMarket,a,f),c=u.duration,h=n.vm_bandwidth[0],p=r.CommodityHelper.getBandwidthType(h.vm_is_flow_type),d=h.vm_bandwidth/1024,v=n.systemdisk[0],m=function(){return n.instance_type?n.instance_type[0].instance_type:""}(),g={orderType:"instance-buy",regionId:n.vm_region_no,imageMarket:l,fromUrl:!0,commodity:{zoneId:n["vm_iz"]=="random"?undefined:n.vm_iz,instanceType:m,networkType:o?o:"vpc",ioOptimized:n["iooptimized"]=="optimized",vSwitchId:n.vSwitchId,internetChargeType:p,internetMaxBandwidthOut:d,imageId:n.vm_os[0].vm_os,osKind:n.vm_os[0].vm_os_kind,systemDisk:{category:v.systemdisk_category,size:v["systemdisk_size"]==0?40:parseInt(v.systemdisk_size)},dataDisks:i,amount:parseInt(u.quantity),maxAmount:parseInt(u.quantity),periodType:f.periodType,period:parseInt(f.period),priceUnit:f.priceUnit},businessInfo:a};return g},e.getDatadisk=function(e){if(!e||!n.isArray(e))return null;var t=[];return n.forEach(e,function(e,n){t.push(i.DiskHelper.covertDiskDataConfig(e))}),t},e.getImageMarket=function(e,t,n){if(!e)return undefined;var r=e[0],i=r.components,s={imageProductCode:r.commodityCode,specCode:r.specCode,imageId:i.img_id},o=i.img_region,u=i.instance_type,a=r.data.quantity;return this.getPriceParamFromValue(s,a,o,u,t,n.period,n.priceUnit)},e.isCurrentImageFullImage=function(e,t){var n=e.getFieldValueById(t+"Image");if(!n)return!1;var r=this.parseValue(n),i=r.deviceMaping;return i&&i.length>1},e.getImageValue=function(e){var t=o.BuyBizHelper.getFieldValue("imageType",e);if(!t)return{};var n=t&&o.BuyBizHelper.getFieldValue(t+"Image",e);return this.parseValue(n)},e.getImageOsKind=function(e){var t=o.BuyBizHelper.getFieldValue("vm_os_kind",e);if(!t)return[];var r=n.fromJson(t);return r instanceof Array?r:[]},e.formatMarketPlatform=function(e){var t=[];for(var r in e){if(e.hasOwnProperty(r)){var i=[],s=e[r];if(n.isArray(s))for(var o=0;o<s.length;o++)i.push({value:s[o],text:s[o]});t.push({title:r,items:i})}return t}},e.OSBitMap={x86_64:"64",i386:"32"},e.ImageType={custom:"self","public":"system",shared:"others",market:"marketplace"},e}();t.ImageHelper=u}),define("ecsbuy/base/cons/urlConfig",["require","exports"],function(e,t){var n=function(){function e(){}return e.userAuthenticationUrl="https://account.console.aliyun.com/#/auth/home",e.rechargeUrl="https://expense.console.aliyun.com/#/account/recharge/alipay",e.vpcConsoleUrl="https://vpc.console.aliyun.com",e.vpcConsoleListUrl="https://vpc.console.aliyun.com/#/vpc/{0}/list",e.ecsConsoleUrl="https://ecs.console.aliyun.com",e.ecsConsoleListUrl="https://ecs.console.aliyun.com/#/server/region/",e.diskListUrl="http://ecs.console.aliyun.com/#/disk/region/",e.volumeListUrl="http://ecs.console.aliyun.com/#/volume/region/",e.expenseOrderListUrl="https://expense.console.aliyun.com/#/order/list/",e.workorderUrl="https://workorder.console.aliyun.com/console.htm#/ticket/add?productId=12",e.orderTermUrl="https://help.aliyun.com/knowledge_detail/40680.html",e.marketImageBuyUrl="http://market.aliyun.com/products/buy.html?param=",e.freetierRuleUrl="https://free.aliyun.com",e.createKeyPair="https://ecs.console.aliyun.com/#/keyPair/region/{0}/create?createType=default",e.securityGroupRule="https://ecs.console.aliyun.com/#/securityGroupDetail/region/{0}/groupId/{1}/rule/{2}",e.imageOrderTermUrl="https://market.aliyun.com/product/protocol.htm?code=",e.intlSimpleBuyUrl="https://sp-buy-intl.aliyun.com/simple",e}();t.UrlConfig=n}),define("ecsbuy/base/helpers/homeConfigHelper",["require","exports","../cons/urlConfig"],function(e,t,n){var r=function(){function e(){}return e.setHomeConfig=function(e){this.homeConfig=e},e.getUA=function(){if(this.homeConfig.GETUA){var e=this.homeConfig.GETUA();return e?e:"aliyun"}return"aliyun"},e.getValue=function(e){return e?this.homeConfig[e]:""},e.getUmid=function(){var e=this.getValue("UMID");return e?e:"aliyun"},e.getUrlConfig=function(e){var t=this.homeConfig.urlConfig,r;t&&e&&t[e]?r=t[e]:r=n.UrlConfig[e]||"";if(r&&arguments.length>1)for(var i=1;i<arguments.length;i++)r=r.replace("{"+(i-1)+"}",arguments[i]);return r},e.isForService=function(){var e=this.homeConfig;return e.portalId=="FOR_SERVICE"?!0:!1},e.setCookie=function(e,t,n){if(!e)return;var r="";n&&(r=";domain="+n),document.cookie=e+"="+escape(t)+r+"; path=/"},e.getEnv=function(){return this.homeConfig.env?this.homeConfig.env:this.homeConfig.env?this.homeConfig.env:"production"},e.getRegionSetting=function(){return this.homeConfig.regionSetting},e.homeConfig=window.ALIYUN_BUY_CONFIG||{},e}();t.HomeConfigHelper=r}),define("ecsbuy/base/directives/image/imageOffline",["require","exports","../directives","dominator/base/helpers/moduleHelper","common/helper/i18nHelper","../../helpers/imageHelper","../../cons/cons","../../helpers/homeConfigHelper"],function(e,t,n,r,i,s,o,u){n.directive("aliyunBuyEcsImageOffline",["aliyunBuyConfigurable","aliyunBuyEcsRemoteService","aliyunBuyMsg","$filter",function(e,t,n,a){return{restrict:"EA",templateUrl:o.Constant.PARTIALS_PATH+"image/imageOffline.html",scope:{options:"=",value:"=",valueAll:"=",config:"&"},replace:!0,compile:function(a,f){return r.require(["options","value"],f),{post:function(a){e.apply(a),r.setDefault(a,{value:"hidden",options:{}});var f=a.options,l=o.Constant.WINDOWS_SERVER_2003;f.visible=!1,a.$watchCollection("[valueAll.customImage, valueAll.sharedImage, valueAll.marketImage]",function(e){f.visible=!1,a.value="hidden";if(!e[0]&&!e[1]&&!e[2])return;var n=a.valueAll,r=n.imageType,i=n[r+"Image"];if(!i)return;var o=s.ImageHelper.parseValue(i);o.platform==l&&t.queryNeedKeepUsingOfflineImage().then(function(e){e&&$.inArray(l,e)!=-1?(f.visible=!0,a.value="show"):(f.visible=!1,a.value="hidden")})}),a.agree=function(){var e=u.HomeConfigHelper.getValue("CSRF_TOKEN");t.keepUsingOfflineImage({platform:l,_csrf_token:e}).then(function(){a.value="agree",f.state=""},function(){n.alert(i.i18n("ECS_PROMPT"),i.i18n("ECS_ERRORTIP_SYSTEM_ERROR"))})}}}}}}])}),define("ecsbuy/base/helpers/httpHelper",["require","exports","dominator/base/helpers/moduleHelper"],function(e,t,n){var r=function(){function e(){}return e.setHttp=function(e){this.http=e},e.getHttp=function(){var e=this.http;if(!e)throw new Error("$http must be set!");return e},e.jsonp=function(){var e=this.getHttp(),t=this.wrap(arguments,1,"GET");return e.jsonp.apply(e,t)},e.post=function(){var e=this.getHttp(),t=this.wrap(arguments,2,"POST");return e.post.apply(e,t)},e.urlEndpointRegionalized=function(e,t){var n=e;return t.invoke(["regionService",function(e){var t=e.getRegionIdFromDomain(),r="";!t||(r="-"+t),n=n.replace("{regionalSuffix}",r)}]),n},e.wrap=function(e,t,r){e=Array.prototype.slice.call(e,0);var i=e[t]||{};return typeof i=="object"&&n.config(i,{headers:{"Business-Tag":"aliyun-buy"}}),e[t]=i,e},e}();t.HttpHelper=r}),define("ecsbuy/base/helpers/errorCodeHelper",["require","exports","common/helper/i18nHelper","./homeConfigHelper","./buyUtils"],function(e,t,n,r,i){var s=function(){function e(){}return e.amendErrorMessage=function(e){if(!e||e.code=="200")return;var t;switch(e.code){case"InvalidInstance.UnPaidOrder":case"InvalidInstance.UnpaidOrder":case"InvalidInstance.UnsettledOrder":t=n.i18n("InvalidInstance.UnPaidOrder",r.HomeConfigHelper.getUrlConfig("expenseOrderList"));break;case"INST_HAS_UNPAID_ORDER":t=n.i18n(e.code,r.HomeConfigHelper.getUrlConfig("expenseOrderList"));break;case"RealNameAuthenticationError":t=n.i18n(e.code,r.HomeConfigHelper.getUrlConfig("userAuthentication"),"_blank");break;case"INSTANCE_STATUS_NOT_VALID":var s=e.data;o&&o.action=="Downgrade"&&(t=n.i18n(e.code+"_WITH_LINK",r.HomeConfigHelper.getUrlConfig("ecsDetail",o.instanceId,o.regionId)));break;case"InvalidParameter.Encrypted.KmsNotEnabled":t=n.i18n(e.code,r.HomeConfigHelper.getUrlConfig("kmsActivationUrl"),"_blank");break;case"OperationDenied.NoStock":t=n.i18n(e.code);var o=e.data;i.BuyUtils.getMapProperty(e,"data.0.data.failedEcs.commodity.networkType")=="classic"&&(t=n.i18n(e.code+"_CLASSIC"));break;default:t=n.i18n(e.code)}t&&t!=e.code&&(e.message=t)},e}();t.ErrorCodeHelper=s}),define("ecsbuy/base/helpers/priceHelper",["require","exports","angular","common/helper/i18nHelper","./diskHelper","./errorCodeHelper","./buyUtils"],function(e,t,n,r,i,s,o){var u=function(){function e(){}return e.formaterPriceResponse=function(e){var t=this,r={code:"200",data:{code:"",priceList:[],trade:"",origin:"",discount:"",currency:""}};if(!e.order||!e.order.children)return e;var i=e.order.children;return n.isArray(i)?(r.data.code=e.order.code,r.data.trade=e.order.tradeAmount,r.data.origin=e.order.originalAmount,r.data.discount=e.order.discountAmount,r.data.currency=e.order.currency,n.forEach(i,function(e,i){if(e.code=="200"){var o=e.data,u=o&&o.order;if(!u)return;n.extend(o,t.getPriceExtraInfo(u)),r.data.priceList.push(o)}else s.ErrorCodeHelper.amendErrorMessage(e),r.data.priceList.push(e)}),r):e},e.getPriceExtraInfo=function(e){var t=e.orderType,n=e.isPostpay,i=e.spotPrice;if(o.BuyUtils.hasUndefined(t,n))return;return t=="traffic-bandwidth"?{name:r.i18n("ECS_FLOW_FEE"),moneyClass:"bk-flow-price-money",askTip:r.i18n("ECS_FLOW_FEE_TIP"),priceUnit:r.i18n("ECS_UNIT_PER_GB")}:t=="marketplace-image"||t=="marketplace-image-renew"?{name:r.i18n("ECS_IMG_FEE"),moneyClass:"bk-image-price-money",priceUnit:n?r.i18n("ECS_UNIT_PER_HOUR"):""}:t=="instance-buy"&&i!=undefined?{name:r.i18n("ECS_SPOT_CONFIG_FEE"),moneyClass:"bk-image-price-money",priceUnit:n?r.i18n("ECS_UNIT_PER_HOUR"):""}:{name:r.i18n("ECS_CONFIG_FEE"),moneyClass:"bk-spec-price-money",priceUnit:n?r.i18n("ECS_UNIT_PER_HOUR"):""}},e.convertYundiskSubOrder=function(e){var t=[];if(!e||!n.isArray(e))return;var r=this;return n.forEach(e,function(e,s){t.push(e);var o=e.commodity,u=o.dataDisks;if(!u||!n.isArray(u)||!u.length>0)return;for(var a=0;a<u.length;a++){var f=u[a];if(f.isFullImage)continue;if(i.DiskHelper.inConvertableDiskCategory(f.category)){var l=r.generationYundiskOrder(f.category,f.size,f.snapshotId,e.regionId,o.amount,e.zoneId,f.encrypted,f.encryptedForView);t.push(l),u.splice(a,1),a--}}}),t},e.convertImageOrder=function(e){if(!e||!n.isArray(e))return;var t=e[0]||{};return t.imageMarket&&n.isArray(t.imageMarket)&&(e=e.concat(t.imageMarket)),e},e.removeUselessParam=function(e){return n.isArray(e)?(n.forEach(e,function(e){e.commodity&&(e.commodity.userData=undefined)}),e):e},e.generationYundiskOrder=function(e,t,n,r,i,s,o,u){return{orderType:"disk-buy",regionId:r,zoneId:s,commodity:{dataDisk:{category:e,size:t,snapshotId:n,encrypted:o,encryptedForView:u},amount:i}}},e.generationVolumeOrder=function(e,t,n,r,i,s,o,u){return{orderType:"volume-buy",regionId:r,zoneId:s,commodity:{volume:{category:e,size:t,snapshotId:n,encrypted:o,encryptedForView:u},amount:i}}},e.formatPriceRules=function(e){var t=this,r=e.order,i=e.rules;if(!r)return e;var s=r.children,o;if(s)for(var u in s){o=s[u];if(o.success===!0||o.code=="200")s[u]=t.formatPriceRules(o.data)}var a={success:!0,extraCode:r.code,currency:r.currency,code:r.code,coupons:r.coupons,orderType:r.orderType,resourceId:r.resourceId,isPostpay:r.isPostpay,message:r.message,extraMessage:r.message,origin:r.originalAmount,trade:r.tradeAmount,discount:r.discountAmount,orderLines:r.orderLines?r.orderLines:{},strategies:this.formatStrategies(r.ruleIds,i),children:s,rules:i,activityInfo:r.activityInfo};return n.extend(a,t.getPriceExtraInfo(r)),a},e.formatStrategies=function(e,t){if(!t||t.length==0||!e||e.length==0)return[];var r=[];return n.forEach(e,function(e){n.forEach(t,function(t){t.ruleDescId==e&&r.push(t)})}),r},e}();t.PriceHelper=u}),define("ecsbuy/base/cons/instanceTypeCons",["require","exports"],function(e,t){var n={"ecs.n1":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2680v3"},"ecs.n2":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2680v3"},"ecs.e3":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2680v3"},"ecs.sn1":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.sn2":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.n4":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.mn4":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.xn4":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.e4":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.ga4":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.gn3":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2680v3"},"ecs.gn4":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.ga1":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.se1":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.i1":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.i2":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon Platinum 8163"},"ecs.d1":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.c4":{clockSpeed:"3.2 GHz",physicalProcessor:"Intel Xeon E5-2667v4"},"ecs.cm4":{clockSpeed:"3.2 GHz",physicalProcessor:"Intel Xeon E5-2667v4"},"ecs.ce4":{clockSpeed:"3.2 GHz",physicalProcessor:"Intel Xeon E5-2667v4"},"ecs.sn1ne":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.sn2ne":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.se1ne":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.gn5":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.gn5i":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.gn5t":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.g5":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon Platinum 8163"},"ecs.c5":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon Platinum 8163"},"ecs.r5":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon Platinum 8163"},"ecs.d1ne":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.hfc5":{clockSpeed:"3.1 GHz",physicalProcessor:"Intel Xeon Gold 6149"},"ecs.hfg5":{clockSpeed:"3.1 GHz",physicalProcessor:"Intel Xeon Gold 6149"},"ecs.f1":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.f2":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon E5-2682v4"},"ecs.s1":{clockSpeed:"2.6 GHz",physicalProcessor:"Intel Xeon E5-2650v2"},"ecs.t1":{clockSpeed:"2.6 GHz",physicalProcessor:"Intel Xeon E5-2650v2"},"ecs.s2":{clockSpeed:"2.6 GHz",physicalProcessor:"Intel Xeon E5-2650v2"},"ecs.s3":{clockSpeed:"2.6 GHz",physicalProcessor:"Intel Xeon E5-2650v2"},"ecs.c1":{clockSpeed:"2.6 GHz",physicalProcessor:"Intel Xeon E5-2650v2"},"ecs.c2":{clockSpeed:"2.6 GHz",physicalProcessor:"Intel Xeon E5-2650v2"},"ecs.m1":{clockSpeed:"2.6 GHz",physicalProcessor:"Intel Xeon E5-2650v2"},"ecs.m2":{clockSpeed:"2.6 GHz",physicalProcessor:"Intel Xeon E5-2650v2"},"ecs.re4":{clockSpeed:"2.2 GHz",physicalProcessor:"Intel Xeon E7-8880v4"},"ecs.t5":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon CPU"},"ecs.ebmg5":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon Platinum 8163"},"ecs.ebmr5":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon Platinum 8163"},"ecs.sccg5":{clockSpeed:"2.5 GHz",physicalProcessor:"Intel Xeon Platinum 8163"},"ecs.scch5":{clockSpeed:"3.1 GHz",physicalProcessor:"Intel Skylake Xeon Gold 6149"}},r={INSTANCE_TYPE_FAMILY_MAP:n};t.InstanceTypeCons=r}),define("ecsbuy/base/helpers/instanceTypeHelper",["require","exports","angular","dominator/base/helpers/constraintHelper","dominator/base/helpers/moduleHelper","common/helper/i18nHelper","./commodityHelper","./buyUtils","../cons/instanceTypeCons"],function(e,t,n,r,i,s,o,u,a){var f=function(){function e(){}return e.mergeFamilyName=function(e){var t=this,r=o.CommodityHelper.getComponents(e);if(!r)return;var i={},s=r.instance_type.instance_type_family,u=r.instance_type.instance_type;n.forEach(s,function(e){i[e.value]=e.text,n.isString(e.value)&&(e.spm=t.dotToDash(e.value))}),n.forEach(u,function(e){if(!e)return;var t=e.value.split(".");e.remark=e.value,e.spm=t.join("-"),e.familyName=i[e.family];var n=a.InstanceTypeCons.INSTANCE_TYPE_FAMILY_MAP[e.family];e.clockSpeed=n&&n.clockSpeed,e.physicalProcessor=n&&n.physicalProcessor})},e.getInstanceTypeDetail=function(e,t){var n="";return t&&(n=o.CommodityHelper.getTextFromCollection(e.family,o.CommodityHelper.getProperties(t,"instance_type","instance_type_family"))),n?e.value+""+e.text+""+n+"":e.value+""+e.text+""},e.getInstanceTypeObj=function(e,t){return o.CommodityHelper.getComponentItem(e,"instance_type.instance_type",t)},e.dotToDash=function(e){return n.isString(e)?e.replace(/\./g,"-"):e},e.getInstanceFamilyByInstanceType=function(e,t,r,i){var s;r&&n.isFunction(r.getOriginConstraintData)?s=r.getOriginConstraintData():s=n.copy(i);var u=o.CommodityHelper.getConstraintsByField(s,"instance_type",[t]),a=null;return n.forEach(u,function(t,r){n.isArray(t)&&t.indexOf(e)!==-1&&(a=r)}),a},e.inUpgradeDiscountingList=function(e,t){return!1},e.mergeInstanceTypeRegroupConfig=function(e){i.config(e,this.DEFAULT_INSTANCE_TYPE_GROUP)},e.formatUpgradeType=function(e){var t="upgrade_type",n=o.CommodityHelper.getConfig(e),r=o.CommodityHelper.getComponents(e),i=o.CommodityHelper.getConstraints(e);o.CommodityHelper.getComponent(e,t)||(r[t]={upgrade_type:[{text:s.i18n("ECS_UPGRADE_UPGRATE_TYPE_NONE"),value:"none"},{text:s.i18n("ECS_UPGRADE_UPGRATE_TYPE_MIGRATE"),value:"migrate"}]},delete i.instance_type["vm_region_no|vm_iz"])},e.isSpecialInstanceType=function(e,t,i){if(!e)return;var s=u.BuyUtils.getMapProperty(e,"components.instance_type.instance_type");if(!n.isArray(s))return;for(var o=0;o<s.length;o++){var a=s[o];if(a.value==t&&r.contains(i,a.flag))return!0}},e.isHpcInstanceType=function(e,t){return this.isSpecialInstanceType(e,t,this.HPC_INSTANCE_TYPE_FLAGS)},e.isElasticBareMetalInstanceType=function(e,t){return this.isSpecialInstanceType(e,t,this.ELASTIC_BARE_METAL_FLAGS)},e.HPC_INSTANCE_TYPE_FLAGS=[66],e.ELASTIC_BARE_METAL_FLAGS=[130],e.DEFAULT_INSTANCE_TYPE_GROUP={components:{customizeGeneration:{customizeGeneration:[{value:"last-generation",text:""},{value:"all-generation",text:""}],customizeGenerationBackup:[{value:"last-generation",text:"backup"}]},computingArchitecture:{computingArchitecture:[{text:"X86 ",value:"X86"},{text:"",value:"Heterogeneous"}]},customizeFamily:{customizeFamily:[{text:"",value:"general-purpose"},{text:"",value:"compute-optimized"},{text:"",value:"memory-optimized"},{text:"",value:"big-data"},{text:" SSD",value:"local-ssd"},{text:"",value:"high-clockSpeed"},{text:"GPU ",value:"GPU-compute"},{text:"GPU ",value:"GPU-visualization"},{text:"FPGA ",value:"FPGA-compute"},{text:"()",value:"basic"}]}},constraint:{customizeFamily:{computingArchitecture:{X86:["general-purpose","compute-optimized","memory-optimized","big-data","local-ssd","high-clockSpeed","basic"],Heterogeneous:["GPU-compute","GPU-visualization","FPGA-compute"]}},instance_type_family:{customizeFamily:{"general-purpose":["ecs.g5","ecs.sn2","ecs.sn2ne"],"compute-optimized":["ecs.c5","ecs.sn1","ecs.sn1ne"],"memory-optimized":["ecs.r5","ecs.se1","ecs.se1ne"],"big-data":["ecs.d1ne","ecs.d1"],"local-ssd":["ecs.i2","ecs.i1"],"high-clockSpeed":["ecs.hfg5","ecs.hfc5","ecs.cm4","ecs.c4","ecs.ce4"],"GPU-compute":["ecs.gn5","ecs.gn4"],"GPU-visualization":["ecs.ga1","ecs.gn3"],"FPGA-compute":["ecs.f1"],basic:["ecs.n1","ecs.n2","ecs.e3","ecs.t1","ecs.s1","ecs.s2","ecs.s3","ecs.m1","ecs.m2","ecs.c1","ecs.c2","ecs.n4","ecs.mn4","ecs.xn4","ecs.e4"]},customizeGeneration:{"last-generation":["ecs.g5","ecs.c5","ecs.r5","ecs.d1de","ecs.i2","ecs.hfg5","ecs.hfc5","ecs.gn5","ecs.ga1","ecs.f1","ecs.xn4","ecs.n4","ecs.mn4","e4"]},customizeGenerationBackup:{"last-generation-backup":["ecs.sn2","ecs.sn2ne","ecs.sn1","ecs.sn1ne","ecs.se1","ecs.se1ne","ecs.i1","ecs.cm4","ecs.c4","ecs.ce4","ecs.gn4","ecs.gn3","ecs.n1","ecs.n2","ecs.e3"]}}}},e}();t.InstanceTypeHelper=f}),define("ecsbuy/base/helpers/buyHistoryHelper",["require","exports","angular","common/helper/i18nHelper","dominator/base/helpers/constraintHelper","./commodityHelper","../cons/buyBizCons","../cons/fieldCons","./buyUtils","../baseClass/DataDiskValues","./dateParseHelper","./instanceTypeHelper","./diskHelper","./imageHelper","./homeConfigHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){var v=function(){function e(){}return e.getHistoryOrderParam=function(e){if(!n.isArray(e))return;var t=[];return n.forEach(e,function(e,r){var i=n.extend({},e);t.push({orderType:"instance-buy",regionId:e.regionId,commodity:i,businessInfo:{orderSource:"buyHistory"}})}),t},e.formatHistoryViewData=function(e,t,r){var i=this,s=[],o=i.getHistory(e);return o instanceof Array&&n.forEach(o,function(e,n){var o=i.formatHistoryItemData(e,t,r);!o||s.push(o)}),{viewOrders:s,totalAmount:s.length}},e.formatHistoryItemData=function(e,t,n){var r=this,i=r.getHistoryViewItems(e,t,n),s=parseInt(e.frequency);return{amount:s,items:i}},e.getText=function(e,t,r){var i=t&&t[e];return!i||!r?"-":i.options&&n.isArray(i.options.items)?s.CommodityHelper.getTextFromCollection(r,i.options.items):"-"},e.getOptionsText=function(e,t,r){return r?t&&n.isArray(t)?s.CommodityHelper.getTextFromCollection(r,t)||"-":"-":"-"},e.joinArrayBySeperate=function(e,t){return e instanceof Array&&e.length>0?e.join(t||"<br/>"):"-"},e.getDatadiskText=function(e,t,r){var i=this,s=r,o=[];return n.forEach(s,function(n){var r=h.DiskHelper.parseToDataDisk(n),s=r.coverToList(),u=s[0],a=s[1]?s[1]:"-";o.push(i.getOptionsText(e,t,u)+" "+a+"GB")}),i.joinArrayBySeperate(o,null)},e.generatePlatformHtml=function(e){var t="icon-os-"+e.toLowerCase().replace(/ /g,"-");return['<span class="margin-right-5">','<i class=" '+t+'"></i>',"</span>",'<span class="">',e,"</span>"].join("")},e.getImageText=function(e,t,n){var r=this,i=[];i.push(r.getOptionsText("imageType",o.BuyBizCons.DEFAULT_IMAGE_TYPE,e.imageType));switch(e.imageType){case"public":var s=p.ImageHelper.parsePublicImageView(e.osName),u=s.platform,a=s.version,f=[];if(!!u){var l=r.generatePlatformHtml(u);f.push(l)}!a||f.push(a),i=i.concat(r.joinArrayBySeperate(f," "));break;default:i.push(e.osName)}return r.joinArrayBySeperate(i,null)},e.getSecurityGroupText=function(e,t,n){var i=this,s=[];if(typeof e["securityGroupId"]!="undefined"){s.push((e.securityGroupName||"-")+" / "+e.securityGroupId);var o=a.BuyUtils.getMapProperty(n,"config.region_map."+e.regionId),u=typeof e["networkType"]!="undefined"?e["networkType"]=="vpc"?"intranetIngress":"internetIngress":undefined;if(!a.BuyUtils.hasUndefined(o,u)){var f=d.HomeConfigHelper.getUrlConfig("securityGroupRule",o,e.securityGroupId,u),l=r.i18n("ecs.buy.component.securityGroup.showGroupRule")+">";s.push('<a href="'+f+'" target="_blank" >'+l+"</a>")}}return i.joinArrayBySeperate(s,null)},e.getNetworkText=function(e,t,n){var f=this,l=[],c=f.getOptionsText("vm_web_type",a.BuyUtils.getMapProperty(n,"components.vm_web_type.vm_web_type"),s.CommodityHelper.getVmWebType(e.networkType)),h=typeof e["internetMaxBandwidthOut"]=="undefined"?"-":e.internetMaxBandwidthOut;l.push(r.i18n("ecs.buy.label.bandwidth.type")+" "+h+" Mbps"+f.wrapByparentheses(c));if(u.FieldCons.FIELD_NETWORK_TYPE_VPC==e["networkType"]&&!i.contains(o.BuyBizCons.DEFAULT_VPC_ITEMS,e.vpcId,"value")){var p=e.vpcName||e.vpcId||"-",v=e.vSwitchName||e.vSwitchId||"-";l.push(p+" / "+v);var m=a.BuyUtils.getMapProperty(n,"config.region_map."+e.regionId),g=e.vpcId,y=e.vSwitchId;if(!a.BuyUtils.hasUndefined(m,g,y)){var b=d.HomeConfigHelper.getUrlConfig("vswitchDetailForSearch",m,g,y),w=r.i18n("ecs.buy.component.vswitch.showDetail")+">";l.push('<a href="'+b+'" target="_blank">'+w+"</a>")}}return f.joinArrayBySeperate(l,null)},e.getAmountText=function(e,t,n,i){return(i=="prepay"?s.CommodityHelper.getOrderTimeText(s.CommodityHelper.getOrderTime(e.period,e.priceUnit,e.periodType))+" ":"")+e.amount+" "+r.i18n("ECS_INSTANCE_UNIT")},e.getHistoryViewItems=function(e,t,n){var s=this,f=o.BuyBizCons.CHARGE_TYPE_MAP_REVERT[e.instanceChargeType],h={label:r.i18n("ecs.buy.label.chargeType")+"",text:s.getText("chargeType",t,f)},p=s.getText("vm_iz",t,e.zoneId),d={label:r.i18n("ecs.buy.label.region")+"",text:s.getText("vm_region_no",t,e.regionId)+s.wrapByparentheses(p)},v={label:r.i18n("ecs.buy.label.buy.time")+"",text:l.DateParseHelper.format(e.buyTime,"yyyy-MM-dd hh:mm")},m=s.getOptionsText("instance_type_family",a.BuyUtils.getMapProperty(n,"components.instance_type.instance_type_family"),c.InstanceTypeHelper.getInstanceFamilyByInstanceType(e.instanceType,"instance_type_family",null,n)),g=s.getOptionsText("instance_generation",a.BuyUtils.getMapProperty(n,"components.instance_type.instance_generation"),e.instanceGeneration),y=m?m:g,b={label:r.i18n("ecs.buy.label.instanceType")+"",text:s.getOptionsText("instance_type",a.BuyUtils.getMapProperty(n,"components.instance_type.instance_type"),e.instanceType)+s.wrapByparentheses(y)},w={label:r.i18n("ecs.buy.label.io_optimized")+"",text:s.getOptionsText("iooptimized",a.BuyUtils.getMapProperty(n,"components.iooptimized.iooptimized"),e.ioOptimized?u.FieldCons.FIELD_IO_OPTIMIZED:u.FieldCons.FIELD_NON_IO_OPTIMIZED)},E={label:r.i18n("ecs.buy.label.network")+"",text:s.getNetworkText(e,t,n)},S={hide:i.contains(o.BuyBizCons.DEFAULT_SECURITY_GROUP_ITEMS,e.securityGroupId,"value"),label:r.i18n("ecs.buy.label.securityGroup")+"",text:s.getSecurityGroupText(e,t,n)},x={label:r.i18n("ecs.buy.label.image")+"",text:s.getImageText(e,t,n)},T={label:r.i18n("ecs.buy.label.disk.system")+"",text:s.getOptionsText("systemdisk_category",a.BuyUtils.getMapProperty(n,"components.systemdisk.systemdisk_category"),a.BuyUtils.getMapProperty(e,"systemDisk.category"))+s.wrapByparentheses(a.BuyUtils.getMapProperty(e,"systemDisk.size")+" GB")},N=s.getDatadiskText("datadisk",a.BuyUtils.getMapProperty(n,"components.datadisk.datadisk_category"),e.dataDisks),C={label:r.i18n("ecs.buy.label.disk.data")+"",text:N},k={label:r.i18n("ecs.buy.label.amount")+"",text:s.getAmountText(e,t,n,f)},L={label:r.i18n("ecs.buy.label.frequecy")+"",text:(e.frequency||"-")+" "+r.i18n("ecs.buy.label.frequecy.unit")};return[h,v,d,b,w,E,S,x,T,C,k,L]},e.getHistory=function(e){return e&&e.history},e.getDataDisk=function(e){var t=[];return n.forEach(e,function(e,n){var r=new f.DataDiskValues(e);t.push(r.coverToList())}),t},e.adjustResponseData=function(e,t,r){n.forEach(e,function(e,n){if(!e.instanceGeneration){var i=s.CommodityHelper.getConstraintValueByValue(e.instanceType,"instance_type","instance_type_family",t,r);if(i){var o=s.CommodityHelper.getConstraintValueByValue(i,"instance_type_family","instance_generation",t,r);e.instanceGeneration=o}}})},e.formatBuyHistoryResponse=function(e){var t=this,r={code:"200",data:{history:[]}};return e instanceof Array&&n.forEach(e,function(e,n){var i=t.getHistory(r.data);i.push(e)}),r},e.getCommodityCode=function(e){var t=o.BuyBizCons.CHARGE_TYPE_MAP_REVERT[e.instanceChargeType];return u.FieldCons.FIELD_CHARGE_TYPE_PREPAY==t?"vm":"ecs"},e.getDistinctInstanceTypes=function(e){var t=[];return n.isArray(e)?(n.forEach(e,function(e){e&&e.instanceType&&(i.contains(t,e.instanceType)||t.push(e.instanceType))}),t):t},e.wrapByparentheses=function(e){return"%s".replace("%s",e)},e}();t.BuyHistoryHelper=v}),define("ecsbuy/base/helpers/remoteConfigHelper",["require","exports","angular","./homeConfigHelper","common/helper/i18nHelper","./priceHelper","./buyHistoryHelper"],function(e,t,n,r,i,s,o){var u=function(){function e(){}return e.getEnv=function(){return r.HomeConfigHelper.getEnv()},e.specialSite=function(){var e=window.location.host;return e&&e.indexOf("4service")!==-1?"4service":""},e.getDomain=function(){return this.domainMap[this.getEnv()]},e.getJsonpUrl=function(e){return"//"+this.domainMap[this.getEnv()]+e+".jsonp?callback=JSON_CALLBACK"},e.getEcsConsoleJsonpUrl=function(e){return"//"+this.ecsConsoleDomainMap[this.getEnv()]+e+".jsonp?callback=JSON_CALLBACK"},e.getPostUrl=function(e){return"//"+this.domainMap[this.getEnv()]+e+".json"},e.getPayLinkUrl=function(e){return"//"+this.payDomainMap[this.getEnv()]+e},e.getLoginUrl=function(e){return"//"+this.accountDomainMap[this.getEnv()]+e},e.callbackShowDialog=function(e,t){if(e&&e.code&&e.code!="200"){if(e.code=="ConsoleNeedLogin"){t.invoke(["aliyunBuyMsg","aliyunBuyEcsDialogButtonConfigService",function(t,n){t.dialog(i.i18n("ECS_PROMPT"),e.message,n.login())}]);return}t.invoke(["aliyunBuyMsg","aliyunBuyEcsDialogButtonConfigService",function(t,n){t.dialog(i.i18n("ECS_PROMPT"),e.message,n.refresh())}])}else e||t.invoke(["aliyunBuyMsg","aliyunBuyEcsDialogButtonConfigService",function(e,t){e.dialog(i.i18n("ECS_PROMPT"),i.i18n("REQUEST_HTTP_ERROR"),t.refresh())}])},e.callBackFormatPriceResponse=function(e,t){if(e&&e.code=="200")return s.PriceHelper.formaterPriceResponse(e.data);if(e&&e.data&&e.data.order){var n=e.data.order,r=n&&n.children,i=r&&r[0]&&r[0].code;if(i=="ServiceUnavailable.RegionMaintaining")return e.code="ServiceUnavailable.RegionMaintaining",e;if(i=="NO_NAME_AUTHENTICATION")return e.code="NO_NAME_AUTHENTICATION",e}},e.callBackFormatPriceRules=function(e,t){if(e&&e.code=="200"){var r=e.data&&e.data.order&&e.data.order.children;return n.isArray(r)&&r.length==1?s.PriceHelper.formatPriceRules(r[0].data):s.PriceHelper.formatPriceRules(e.data)}var o={name:i.i18n("ECS_CONFIG_FEE")};return n.extend(e,o),e},e.callBackFormatBuyHistoryResponse=function(e,t){return e&&e.code=="200"?o.BuyHistoryHelper.formatBuyHistoryResponse(e.data):e},e.callBackFormatEcsBandwidthHistoryResponse=function(e,t){var n={},r=e.data||[],i=r.length-1,s=new Date,o=new Date;s.setTime(r[0].startTime),o.setTime(r[i].endTime);var u=s.getFullYear(),a=o.getFullYear();for(var f=u;f<=a;f++){n[f]={};var l=void 0;f<a?(l=new Date,l.setFullYear(f),l.setMonth(11),l.setDate(31)):l=o,l.setHours(23),l.setMinutes(59),l.setSeconds(59),l.setMilliseconds(999);for(var c=s;c.getTime()<=l.getTime();c.setDate(c.getDate()+1)){var h=c.toLocaleDateString();n[f][h]={date:h,datestamp:c.getTime()}}}for(var p=0;p<r.length;p++){var c=new Date;c.setTime(r[p].startTime),c.setHours(0),c.setMinutes(0),c.setSeconds(0),c.setMilliseconds(0);for(;c.getTime()<r[p].endTime;c.setDate(c.getDate()+1)){var h=c.toLocaleDateString();try{n[c.getFullYear()][h].bandwidth=r[p].bandwidthValue}catch(d){console.log(c)}}}return n},e.domainMap={development:"localhost:3010",test:"ecs-buy"+e.specialSite()+"{regionalSuffix}.aliyun.test",production:"ecs-buy"+e.specialSite()+"{regionalSuffix}.aliyun.com",pre:"ecs-buy"+e.specialSite()+"{regionalSuffix}.aliyun.com"},e.ecsConsoleDomainMap={development:"localhost:3010",test:"ecs"+e.specialSite()+"{regionalSuffix}.console.aliyun.test",production:"ecs"+e.specialSite()+"{regionalSuffix}.console.aliyun.com",pre:"ecs"+e.specialSite()+"{regionalSuffix}.console.aliyun.com"},e.payDomainMap={development:"localhost:3010",test:"finance.aliyun.test",production:"finance.aliyun.com",pre:"finance.aliyun.com"},e.accountDomainMap={development:"localhost:3010",test:"account.aliyun.test",production:"account.aliyun.com",pre:"account.aliyun.com"},e}();t.RemoteConfigHelper=u}),define("ecsbuy/base/directives/image/marketImage",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","dominator/base/helpers/constraintHelper","../../helpers/ImageHelper","../../cons/cons","../../cons/buyBizCons","../../helpers/commodityHelper","../../helpers/buyUtils","../../helpers/homeConfigHelper","../../helpers/httpHelper","../../helpers/remoteConfigHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){r.directive("aliyunBuyEcsImageMarket",["aliyunBuyDialog","aliyunBuyMsg","aliyunBuyEcsDialogButtonConfigService","aliyunBuyEcsRemoteService","aliyunBuyEcsImageService","base64","$rootScope","$injector",function(e,t,r,d,v,m,g,y){return{restrict:"EA",templateUrl:u.Constant.PARTIALS_PATH+"image/marketImage.html",scope:{options:"=",value:"=",detail:"=",config:"&",valueAll:"=",raw:"=",defaultValueImageId:"=?"},replace:!0,compile:function(t,r){return i.require(["options","value","detail"],r),{post:function(t){i.setDefault(t,{options:{},detail:{},value:""}),i.setDefault(t.options,{name:"ECS_IMAGE_NAME"}),t.login=function(){t.$emit("aliyunBuy:saveOptions"),d.login()};var r=g.$on("aliyunBuyImageMarket:detail",function(e,r){t.detail=n.extend({},t.detail,r)});t.$watch("defaultValueImageId",function(e){e&&(t.value=n.toJson(o.ImageHelper.toJsonString({imageId:e})))}),t.openImageMarket=function(){t.options.state="";var r="",i="";if(t.raw){var o=t.raw,d=f.CommodityHelper.getProperties(o,"vm_region_no","vm_region_no"),v=l.BuyUtils.getMapProperty(o,"instanceDetail.orderInfo");v&&(r=f.CommodityHelper.getTextFromCollection(v.vm_region_no,d)),i=f.CommodityHelper.getTextFromCollection(t.valueAll.regionId,d)}var m=e.open({templateUrl:u.Constant.PARTIALS_PATH+"image/marketImageDialog.html",windowClass:"imagemarket-dialog-v2",backdropClass:"imagemarket-backdrop",controller:["$scope","$sce",function(e,o){function u(t){var r=n.fromJson(t.data);r&&r.selectedVersion&&e.useImage(r)}function M(e){if(!e.selectedVersion)return;var r=e.selectedVersion,i=e.skuCodes?e.skuCodes[0]:null,s=r.diskDeviceMappings;t.value=n.toJson([r.imageId,e.osKind,e.osBit,null,r.imageSize,e.imageCategory,null,null,null,e.imageProductCode,i,null,s])}e.isReady=!0,e.regionName=i||r,typeof window.addEventListener!="undefined"?window.addEventListener("message",u,!1):typeof window.attachEvent!="undefined"&&window.attachEvent("onmessage",u);var d=t.raw,v=l.BuyUtils.getMapProperty(d,"instanceDetail.instanceInfo.chargeType"),g=f.CommodityHelper.getCommodityCode(d),b=f.CommodityHelper.getOrderType(d),w=t.valueAll.instanceType,E=t.valueAll.iooptimized=="True"?"true":undefined,S=t.valueAll.regionId,x=t.valueAll.osType,T=v=="Prepaid"||typeof v=="undefined"&&g=="vm"?"prepay":"postpay",N=f.CommodityHelper.getNetworkType(t.valueAll.networkType),C=s.contains(a.BuyBizCons.INTL_REGIONS,S),k=["instanceType="+w,"regionId="+S,"chargeType="+T,"networkType="+N,"orderType="+b];E&&k.push("iooptimized="+E),x&&k.push("osKind="+x),C!=undefined&&k.push("isIntlRegion="+C);var L=p.RemoteConfigHelper.getDomain(),A=h.HttpHelper.urlEndpointRegionalized(L,y);k.push("host="+A);var O=c.HomeConfigHelper.getUrlConfig("marketIframe")||"https://market.aliyun.com/imagechoose?";e.iframeSrc=o.trustAsResourceUrl(O+k.join("&")),e.useImage=function(e){m.close(),M(e)}}]})},t.$on("$destroy",function(){n.isFunction(r)&&r()})}}}}}])}),define("ecsbuy/base/directives/image/imageFromMarket",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","../../cons/cons"],function(e,t,n,r,i,s){r.directive("aliyunBuyEcsImageFromMarket",["aliyunBuyConfigurable","aliyunBuyEcsImageService","aliyunBuyEcsRemoteService","aliyunBuyMsg","$rootScope","$filter","$q",function(e,t,r,o,u,a,f){return{restrict:"EA",templateUrl:s.Constant.PARTIALS_PATH+"image/imageFromMarket.html",scope:{options:"=",value:"=",detail:"=",config:"&",valueAll:"=",raw:"&"},replace:!0,compile:function(r,s){return i.require(["options","value","detail"],s),{post:function(r){function o(){r.value=undefined,r.detail=undefined}e.apply(r),i.setDefault(r,{options:{}});var s=r.options;s.visible=!1,r.$watchCollection("[valueAll.region, valueAll.customImage, valueAll.sharedImage, valueAll.marketImage]",function(e){o();if(!e[1]&&!e[2]&&!e[3])return;var i=r.valueAll,s=t.completeImageMarketInfo(i);s&&n.isFunction(s.then)&&s.then(function(e){r.value=e.value,i.imageType=="market"&&(r.detail=e.detail,u.$emit("aliyunBuyImageMarket:detail",e.detail))},function(){r.value=null})})}}}}}])}),define("ecsbuy/base/directives/image/_base",["require","exports","./ecsImage","./imageOffline","./marketImage","./imageFromMarket"],function(e,t){}),define("ecsbuy/base/directives/disk/ecsSystemdisk",["require","exports","../directives","dominator/base/helpers/moduleHelper","common/helper/i18nHelper","../../cons/cons","../../helpers/diskHelper"],function(e,t,n,r,i,s,o){n.directive("aliyunBuyEcsSysdisk",["aliyunBuyConfigurable",function(e){return{restrict:"EA",templateUrl:s.Constant.PARTIALS_PATH+"disk/ecsSystemdisk.html",scope:{options:"=",category:"=",size:"=",detail:"=",config:"&"},replace:!0,compile:function(t,n){return r.require(["options","value","detail"],n),{post:function(t,n,s){e.apply(t),r.setDefault(t,{detail:{},options:{}});var u=t.options;r.setDefault(t.options,{name:"ECS_SYSDISK"}),t.$watchCollection("[options.max,options.min]",function(e){var n=e[0],r=e[1];if(!n||!r)return;r<=n?u.sizeRange=r+" - "+n:u.sizeRange=" - ",u.sizeHoverTip=u.systemDiskHoverTip||i.i18nByMap("ecs.buy.component.systemdisk.tip",{min:r,max:n}),t.size||(t.size=r)},!0),t.$watchCollection("[size, category]",function(){t.options&&(t.options.state="");var e=t.size,n=t.category;if(!e||!n)return;t.iops=o.DiskHelper.calculateIOPS(n,parseInt(e))})}}}}}])}),define("ecsbuy/base/directives/disk/ecsDatadisk",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","common/helper/i18nHelper","dominator/base/helpers/constraintHelper","common/helper/dateHelper","../../helpers/diskHelper","../../cons/cons"],function(e,t,n,r,i,s,o,u,a,f){r.directive("aliyunBuyEcsDatadisk",["aliyunBuyConfigurable","aliyunBuyEcsRemoteService","aliyunBuyEcsBlockListService","$filter","$timeout","$rootScope",function(e,t,r,s,u,l){function h(t,s,f){function p(e){return i.config({options:{editable:!0},size:null,paymentMethod:null,type:null,snapshot:null,mount:null,releaseWithEcs:!0,encrypted:!1,showSizeError:!1,convertChargeType:!1,instanceId:null,inConvertableBlackList:!1,snapshotSize:null},e)}function d(){var e=!1;return n.forEach(t.disks,function(t,n){t.size===null&&(t.showSizeError=!0,e=!0)}),e}function v(){t.options.state=""}function m(){x()&&(t.disks=[])}function g(){var e=t.disks;t.addible=h.diskMaxNumber>e.length,t.removable=h.diskMinNumber<e.length}function y(e,i){var s={},o={},u=t.tips={};n.forEach(e,function(e,t){s[e.type]||(s[e.type]=0),s[e.type]+=e.size,e.mount&&(o[e.mount]=!0)}),n.forEach(t.mounts,function(e){o[e.value]?e.checked=!0:e.checked=!1}),n.forEach(e,function(e,t){var n=e.options;n.types=h.diskTypes,n.originalPaymentMethod=h.defaultPaymentMethod;var i=e.type;if(!i)return;var o=h.totalMaxSizes[i]-s[i],f=h.singleDiskMaxSizes[i],c=h.singleDiskMinSizes[i],p=e.size+o;e.snapshotSize&&c<e.snapshotSize&&(c=e.snapshotSize),f>p&&(f=p),n.editable?(n.maxSize=f,n.minSize=c):(n.maxSize=Number.MAX_VALUE,n.minSize=0),n.encryptable=!r.inBlockList("ecsDiskEncrypted")&&h.encryptable&&a.DiskHelper.inEncryptableDiskCategory(e.type)&&a.DiskHelper.inEncryptableRegion(h.regionId,l.channelId);var d=e.paymentMethod+"."+e.type,v=n.portable=h.portableMap[d],m=n.originalPaymentMethod+"."+e.type,g=h.convertableMap[m];n.convertable=h.showConvertOption&&g,u[d]={paymentMethod:e.paymentMethod,type:i,showRestSize:h.totalMaxSizes[i]<h.diskMaxNumber*h.singleDiskMaxSizes[i],restSize:o,portable:v}})}function b(e,r){var i=[];n.forEach(e,function(e,t){var n=e.options||{};i[t]=[e.type,e.size!=null?e.size.toString():null,e.snapshot,e.mount,e.instanceId,e.releaseWithEcs,e.convertChargeType,e.inConvertableBlackList,e.snapshotSize,n.disableSnapshot,n.disableMount,n.disableDeleteItem,n.hideRelease,e.isFullImage,e.instanceName,e.paymentMethod,e.encrypted]}),t.value=n.toJson(i,!0)}function w(e,r){var i=[];n.forEach(e,function(e,t){i[t]=e.detail}),t.detail=i}function E(e){if(e&&e!="[]"){var r=S(e),i=n.copy(t.disks);n.equals(r,i)||u(function(){t.disks=r})}}function S(e){e=i.parseJsonSafe(e);var r=n.copy(t.disks),s=[];return n.forEach(e,function(e,t){var o=r[t]||{},u=i.config(n.copy(o),{type:e[0],size:parseInt(e[1])||null,snapshot:e[2],mount:e[3],instanceId:e[4],releaseWithEcs:e[5],convertChargeType:e[6],inConvertableBlackList:e[7],options:{editable:!e[4],disableSnapshot:e[9],disableMount:e[10],disableDeleteItem:e[11],hideRelease:e[12]},snapshotSize:e[8],isFullImage:e[13],instanceName:e[14],paymentMethod:e[15]?e[15]:h.defaultPaymentMethod,encrypted:e[16]});s[t]=p(u)}),y(s,r),s}function x(){var e=t.value,n=t.disks;if(t.value){var r=S(e);if(o.intersect(n,r,["type","size","snapshot","mount","releaseWithEcs","convertChargeType"]).length!=n.length)return!1}return!0}e.apply(t),i.setDefault(t,{detail:[],options:{},value:""});var c=t.config(),h=t.options;i.setDefault(t.options,{name:"ECS_DATADISK",hideRelease:c?c.hideRelease:undefined}),t.disks=[],t.tips={},g(),t.addDisk=function(){if(!t.addible)return;var e=n.copy(t.disks);t.disks.push(p()),y(t.disks,e)},t.removeDisk=function(e){if(!t.removable)return;t.disks.splice(e,1)},t.$watch("options.regionId",m,!0),t.$watch("options.diskTypes",m,!0),t.$watch("options.singleDiskMaxSizes",m,!0),t.$watch("options.singleDiskMinSizes",m,!0),t.$watch("options.totalMaxSizes",m,!0),t.$watch("options.diskMaxNumber",m,!0),t.$watch("options.diskMinNumber",m,!0),t.$watch("options.mounts",m,!0),t.$watch("disks",function(e,t){v(),g(),y(e,t),b(e,t),w(e,t)},!0),t.$watch("value",E),t.$watch("options.diskMaxNumber",g),t.$watch("options.diskMinNumber",g),t.$watch("options.state",function(e){e=="error"&&d()}),t.$watch("options.mounts",function(e){t.mounts=n.copy(e)},!0)}var c={restrict:"EA",templateUrl:f.Constant.PARTIALS_PATH+"disk/ecsDatadisk.html",scope:{options:"=",value:"=",config:"&",detail:"="},replace:!0,compile:function(e,t){return i.require(["options","value","detail"],t),{post:h}}};return c}]),r.directive("aliyunBuyEcsDatadiskItem",["aliyunBuyEcsRemoteService","aliyunBuyDialog","$rootScope",function(e,t,n){function o(e,t,n){i.setDefault(e,{detail:{}}),e.originDisk={paymentMethod:e.paymentMethod},e.remove=function(){var t=n.onremove,r=e.$parent;r.$eval(t)},e.$watchCollection("types()",function(t){t&&!e.type&&(e.type=t[0].value)}),e.$watch("portable()",function(t){t===!1&&(e.releaseWithEcs=null)}),e.$watch("convertChargeType",function(t){t!=undefined&&(t?e.paymentMethod=e.originDisk.paymentMethod=="postpay"?"prepay":"postpay":e.paymentMethod=e.originDisk.paymentMethod)}),e.$watch("type",function(t){var n=e.size;t&&n&&(e.iops=a.DiskHelper.calculateIOPS(t,n))}),e.$watch("size",function(t){var n="";if(t!=null){e.showSizeError=!1;var r=parseInt(t);n=a.DiskHelper.calculateIOPS(e.type,r)}e.detail.size={text:t+"GB",value:t},e.iops=n}),e.$watchCollection("[maxSize(),minSize()]",function(t){var n=t[1],r=t[0];n<=r?(e.sizeRange=n+" - "+r,e.sizeHoverTip=s.i18nByMap("ecs.buy.component.systemdisk.tip",{min:n,max:r})):(e.sizeRange="-",e.sizeHoverTip=s.i18nByMap("ecs.buy.component.datadisk.beyond.limit.hover.tip",{max:r,min:n}))})}var r={restrict:"EA",templateUrl:f.Constant.PARTIALS_PATH+"disk/ecsDatadiskItem.html",scope:{size:"=",showSizeError:"=",mount:"=",type:"=",snapshot:"=",snapshotSize:"=",snapshotEncrypted:"=",releaseWithEcs:"=",encrypted:"=?",isFullImage:"=?",detail:"=",paymentMethod:"=",convertChargeType:"=",instanceId:"=",instanceName:"=",originalPaymentMethod:"&",loggedIn:"&",regionId:"&",regionName:"=",portable:"&",hideRelease:"&",editable:"&",types:"&",mounts:"&",maxSize:"&",minSize:"&",index:"&",convertable:"&",encryptable:"&?",showExtraInfo:"&",disableMount:"=",disableSnapshot:"=",disableDeleteItem:"=",showConvertOption:"="},replace:!0,compile:function(e,t){return i.require(["size","showSizeError","mount","type","snapshot","snapshotSize","releaseWithEcs","detail","paymentMethod","encrypted"],t),{post:o}}};return r}]),r.directive("aliyunBuyEcsDatadiskSizeInput",[function(){function t(e,t,n){function i(t){var n=e.max(),i=e.min(),s=parseInt(r.val())||(t?0:null);s==null&&!t||n<i?(r.val(""),e.value=null):(typeof n=="number"&&s>n&&(s=n),typeof i=="number"&&s<i&&(s=i),r.val(s),e.value=s)}var r=jQuery(t);r.on("blur",function(){i(!0)}),e.$watchCollection("[max(),min(),value]",function(){r.val(e.value),i()})}var e={restrict:"A",scope:{min:"&",max:"&",value:"="},compile:function(e,n){return i.require(["value"],n),{post:t}}};return e}]),r.directive("aliyunBuyEcsDatadiskItemMount",[function(){function t(e,t,n){e.select=function(t){if(t.checked)return;e.mount=t.value,e.tipHandle&&e.tipHandle.close()}}var e={restrict:"EA",templateUrl:f.Constant.PARTIALS_PATH+"disk/ecsDatadiskItemMount.html",scope:{mounts:"&",editable:"&",mount:"="},replace:!0,compile:function(e,n){return i.require(["mount"],n),{post:t}}};return e}]),r.directive("aliyunBuyEcsDatadiskItemSnapshot",["aliyunBuyConfigurable","aliyunBuyEcsRemoteService",function(e,t){function o(e,r,o){function a(){e.searchModel.key="",c()}function f(e,t,n){return e=parseInt(e),t=parseInt(t),n=parseInt(n),e>n||e<t?!1:!0}function l(t){var n=t.id,r=t.name,i=parseInt(t.disk);if(!f(i,e.minSize(),e.maxSize()))return;e.id=n,e.name=r,e.size=i,e.encrypted=t.encrypted,e.hoverTip=s.i18nByMap("ECS_SNAP_SNAP_HOVER_TIP",{id:n,size:i,name:r||"--",sizeUnit:"GB"});var o=e.listHandle;o&&o.close()}function c(t){t||p();var n=e.pagination,r=e.searchModel,i=n.pageSize,s=e.searchModel.resultCollection.length,o;if(!t)o=0;else if(t=="next"){if(!n.nextEnabled)return;o=r.currentOffset+i}else if(t=="previous"){if(!n.previousEnabled)return;o=r.currentOffset-i}o<0&&(o=0),s>=i+o||r.total&&s==r.total?(r.currentOffset=o,e.states.searchError=!1,e.states.searching=!1):h(o)}function h(r){var i=e.searchModel.field,s=e.searchModel.key;s instanceof Date&&(s=u.getISODateString(s));var o=e.regionId(),a=e.pagination.pageSize,r=r||e.searchModel.resultCollection.length;e.states.searching=!0,e.states.searchError=!1;var f={regionId:o,pageSize:a,offset:r};i&&(f[i]=s),t.queryEcsSnapshot(f).then(function(t){var o=e.searchModel,u=t&&t.snapshotList;u.length>0&&(n.forEach(u,function(e,t){if(t>a-1)return;o.resultCollection[t+r]=e}),o.currentOffset=r,o.currentKey=s,o.currentField=i,o.currentRegion=e.regionId()),t.length<a?(o.hasMore=!1,o.total=o.resultCollection.length):(o.hasMore=!0,o.total=null),e.states.searchError=!1,e.states.searching=!1},function(t){e.states.searchError=!0,e.states.searchErrorMsg=t?t.message:"",e.states.searching=!1})}function p(){var t=e.searchModel,n=!0;if(t.key!=t.currentKey||t.field!=t.currentField||t.currentRegion!=e.regionId())t.resultCollection=[],t.currentPageResult=[],t.currentOffset=-1,t.hasMore=!1,t.total=null}function d(t){var n=[],r=e.pagination.pageSize,i=e.searchModel.resultCollection,s=i.length;if(t<0)return n;s>t+r&&(s=t+r);for(var o=t;o<s;o++)n.push(i[o]);return n}i.setDefault(e,{searchModel:{key:"",field:"snapshotNickName",resultCollection:[],currentPageResult:[],currentKey:"",currentField:"",currentRegion:"",currentOffset:-1,hasMore:!1,total:null},pagination:{pageSize:5,previousEnabled:!1,nextEnabled:!1},states:{visible:!0,searching:!1,searchError:!1,searchErrorMsg:""},searchFields:[{text:s.i18n("ECS_SNAP_SNAPNAME"),value:"snapshotNickName"},{text:s.i18n("ECS_SNAP_SNAPID"),value:"snapshotId"},{text:s.i18n("ECS_SNAP_CREATETIME"),value:"creationTime"}]}),e.querySnapshots=c,e.clearKey=a,e.selectSnapshot=l,e.checkDiskSelectable=f,e.open=function(){c()},e.$watch("searchModel.currentOffset",function(t){e.searchModel.currentPageResult=d(t)}),e.$watch("searchModel",function(t){var n=e.pagination;n.previousEnabled=t.currentOffset>=n.pageSize,n.nextEnabled=!(t.total!==null&&t.currentOffset+n.pageSize>=t.total)&&t.currentOffset!=-1},!0),e.$watch("searchModel.field",function(){e.searchModel.key=""}),e.$watch("id",function(n,r){var i=n;if(!i){e.name="";return}if(i){var s=0,o=1,u=e.regionId(),a={snapshotId:i,regionId:u,pageSize:o,offset:s};t.queryEcsSnapshot(a).then(function(t){var n=t.snapshotList;n&&n[0]?e.name=n[0].name:e.snapshot=null},function(t){e.snapshot=null})}}),e.remove=function(){e.id="",e.name="",e.size="",e.hoverTip="",e.encrypted=null}}var r={restrict:"EA",templateUrl:f.Constant.PARTIALS_PATH+"disk/ecsDatadiskItemSnapshot.html",replace:!0,scope:{loggedIn:"&",regionId:"&",regionName:"=",maxSize:"&",minSize:"&",editable:"&",id:"=",name:"=",size:"=",encrypted:"=?",showSnapClose:"=?"},compile:function(e,t){return i.require(["id","name","size","encrypted"],t),{post:o}}};return r}])}),define("ecsbuy/base/directives/disk/ecsLocalstorage",["require","exports","../directives","dominator/base/helpers/moduleHelper","../../cons/cons"],function(e,t,n,r,i){n.directive("aliyunBuyEcsLocalstorage",["aliyunBuyConfigurable",function(e){return{restrict:"EA",templateUrl:i.Constant.PARTIALS_PATH+"disk/ecsLocalStorage.html",scope:{options:"=",value:"=",detail:"=",config:"&"},replace:!0,compile:function(t,n){return r.require(["options","value","detail"],n),{post:function(t,n,r){e.apply(t)}}}}}])}),define("ecsbuy/base/directives/disk/clouddiskSelect",["require","exports","../directives","dominator/base/helpers/moduleHelper","../../cons/cons","../../helpers/diskHelper"],function(e,t,n,r,i,s){n.directive("aliyunBuyEcsClouddiskSelect",["aliyunBuyConfigurable","$filter","$rootScope","aliyunBuyEcsRemoteService","aliyunBuyEcsBlockListService",function(e,t,n,o,u){return{restrict:"EA",templateUrl:i.Constant.PARTIALS_PATH+"disk/clouddiskSelect.html",scope:{options:"=",value:"=",size:"=",snapshotSize:"=?",snapshotId:"=?",encrypted:"=?",detail:"=",config:"&"},replace:!0,compile:function(t,i){return r.require(["options","value","detail"],i),{post:function(t,i,o){function f(e,n){if(!e||!n)return"";t.iops=s.DiskHelper.calculateIOPS(e,n)}var a=t.options;e.apply(t),r.setDefault(t,{detail:{},_value:{},showLink:!0,defaultSize:20}),r.setDefault(t.options,{showLink:!0}),t.$watch("options.regionId",function(e){t.snapshotId=undefined,t.size=undefined,t.name=undefined,t.$broadcast("aliyunBuySnapshot:reset"),!u.inBlockList("ecsDiskEncrypted")&&s.DiskHelper.inEncryptableRegion(e,n.channelId)?t.encryptable=!0:(t.encryptable=!1,t.encrypted=null)}),t.$watch("size",function(e){e!=null&&(t.showSizeError=!1)}),t.$watch("value",function(e){f(e,t.size)}),t.$watch("size",function(e){f(t.value,e)}),t.$watchCollection("[options.min,options.max]",function(e){var n=e[0],r=e[1];n<=r?t.sizeRange=n+" - "+r:t.sizeRange=" - ",t.size||(t.size=n)})}}}}}])}),define("ecsbuy/base/cons/remoteActions",["require","exports"],function(e,t){var n=function(){function e(){}return e.GET_COMMODITY="getCommodity",e.GET_COMMODITY_WITH_INSTANCE_INFO="getCommodityWithInstanceInfo",e.GET_RESIZE_DISK_COMMODITY="getResizeDiskCommodity",e.GET_SIMPLE_BUY_COMMODITY="getSimpleBuyCommodity",e.GET_FREETIER_COMMODITY="getFreetierCommodity",e.GET_ENTERPRISE_FREETIER_COMMODITY="getEnterpriseFreetierCommodity",e.DESCRIBE_PRICE="describePrice",e.DESCRIBE_PRICE_POST="describePricePost",e.DESCRIBE_PRICE_4_SUBTOTAL="describePrice4Subtotal",e.DESCRIBE_IMAGES="describeImages",e.CREATE_CHANGE_OS_ORDER="createChangeOsOrder",e.BATCH_CREATE_RESIZE_DISK_ORDER="batchCreateDiskResizeOrder",e.DESCRIBE_RELEASE_PRICE="describeReleasePrice",e.RELEASE_INSTANCE="releaseInstance",e.CANCEL_RELEASE_INSTANCE="cancelReleaseInstance",e.QUERY_MARKET_IMAGE_CATEGORY="queryMarketImageCategory",e.QUERY_MARKET_IMAGES="queryMarketImages",e.CHECK_TOKEN_4_ECS="checkToken4Ecs",e.ECS_RISK_PUSH_DATA="ecsRiskPushData",e.LIST_IMAGE_BY_IMAGE_IDS="listImageByImageIds",e.LIST_BANDWIDTH_PRICE_MAP="listBandwidthPriceMap",e.QUERY_IMAGE_BY_IMAGE_ID="queryImageByImageId",e.QUERY_NEED_KEEP_USING_OFFLINE_IMAGE="queryNeedKeepUsingOfflineImage",e.KEEP_USING_OFFLINE_IMAGE="keepUsingOfflineImage",e.GET_COMPONENTS="getComponents",e.QUERY_ALL_IZ_NAME="queryAllIzName",e.QUERY_ECS_SNAPSHOT="queryEcsSnapshot",e.QUERY_LIMITATION="queryLimitation",e.QUERY_SECURITY_GROUP_LIST="queryEcsSecurityGroupList",e.QUERY_VPCS="describeVpcs",e.QUERY_VSWITCH="describeVSwitches",e.CPS_AJAX="cpsAjax",e.CREATE_POSTPAY_INSTANCES="createPostPayInstances",e.CREATE_BUY_ORDER="createBuyOrder",e.CREATE_FREETIER_ORDER="createFreetierOrder",e.CREATE_ENTERPRISE_FREETIER_ORDER="createEnterpriseFreetierOrder",e.DESCRIBE_FREETIER_PRICE="describeFreetierPrice",e.DESCRIBE_ENTERPRISE_FREETIER_PRICE="describeEnterpriseFreetierPrice",e.CREATE_DISKS="createDisks",e.CREATE_VOLUMES="createVolumes",e.WHITELIST_FOR_USERDATA="inWhiteListForUserData",e.QUERY_ECS_INSTANCE_INFO="queryEcsInstanceInfo",e.QUERY_ECS_DISK_INFO="queryEcsDiskInfo",e.LIST_MARKET_PLATFORM="listMarketPlatform",e.GET_COPY_WRITER="getCopywriter",e.CHECK_IMAGE_SUPPORT_CLOUDINIT="checkImageSupportCloudinit",e.IN_WHITE_UID_LIST="inWhiteUidList",e.IN_WHITE_UID_LIST_2="inWhiteUidList2",e.IN_WHITE_UID_LIST_COMMON="inWhiteUidListCommon",e.IN_WHITE_LIST_4_VOLUME_BUY="inWhiteListForVolumeBuy",e.DESCRIBE_KEYPAIRS="describeKeyPairs",e.IN_WHITE_LIST_4_DOWNGRADE="inWhiteListForDowngrade",e.IN_WHITE_LIST_4_NETWORK_INTERFACE="inWhiteListForNetworkInterface",e.IS_PREPAID_EIP_ADDRESS="isPrepaidEipAddress",e.QUERY_BUY_HISTORY="queryBuyHistory",e.QUERY_ECS_BANDWIDTH_HISTORY="queryBandwidthHistory",e.QUERY_MARKET_IMAGE_INSTANCES="queryMarketImageInstances",e.QUERY_ORDER_NOT_PAID="queryOrderNotPaid",e.CHECK_RISK_SECURITY_GROUP="checkRiskSecurityGroup",e.CLONE_SECURITY_GROUP_SAFETY="cloneSecurityGroupSafety",e.GET_SEC_TOKEN="getToken",e.CHECK_START_PACKAGE_INSTANCE="checkStartPackageInstance",e.CHECK_WEB_APPLICATION_PACKAGE_INSTANCE="checkWebApplicationPackageInstance",e.IS_KMS_ACTIVATED="isKmsActivated",e.ACTIVATE_KSM="activateKms",e.GET_RECOMMEND_INSTANCE_TYPE="getRecommendInstanceType",e.GET_COMMODITY_4_RECYCLE_BIN="getCommodity4RecycleBin",e.SIGN_RECYCLE_BIN_AGREEMENT="signRecycleBinAgreement",e.IS_SIGNED_RECYCLE_BIN_AGREEMENT="isSignedRecycleBinAgreement",e.DESCRIBE_HPC_CLUSTERS="describeHpcClusters",e.GET_ECS_REGION_QUOTA="getEcsRegionQuota",e.GET_SPOT_REGION_QUOTA="getSpotRegionQuota",e.LINK_TO_ORDER_PAGE="linkToOrderPayPage",e.LINK_TO_MARKET_IMAGE_BUY="linkToImageMarketBuy",e.LOGIN="login",e.LINK_TO_ECS_INSTANCE_PAGE="linkToEcsInstancePage",e.LINK_TO_ECS_CERTIFIED_PAGE="linkToCertifiedPage",e.LINK_TO_ECS_DISK_PAGE="linkToEcsDiskPage",e.LINK_TO_ECS_SECURITY_GROUP_RULE_PAGE="linkToEcsSecurityGroupRulePage",e}();t.RemoteActions=n}),define("ecsbuy/base/directives/disk/ecsDiskEncryption",["require","exports","../directives","dominator/base/helpers/moduleHelper","../../cons/cons","../../helpers/homeConfigHelper","../../cons/remoteActions"],function(e,t,n,r,i,s,o){n.directive("aliyunBuyEcsDiskEncryption",["aliyunBuyEcsRemoteService","aliyunBuyDialog","$rootScope",function(e,t,n){return{restrict:"EA",templateUrl:i.Constant.PARTIALS_PATH+"disk/ecsDiskEncryption.html",scope:{value:"=",disabled:"="},replace:!0,compile:function(u,a){return r.require(["options","value"],a),{post:function(r){function u(){var r=t.open({windowClass:"datadisk-kms-dialog",backdropClass:"datadisk-kms-backdrop",templateUrl:i.Constant.PARTIALS_PATH+"disk/kmsActivationDialog.html",controller:["$scope","$timeout",function(t,i){t.isLoading=!1,t.activateStatus="none",t.kmsTermUrl=s.HomeConfigHelper.getUrlConfig("kmsTermUrl"),t.activateKms=function(u){if(!u)return;t.isLoading=!0;var a=s.HomeConfigHelper.getValue("CSRF_TOKEN"),f={_csrf_token:a};e[o.RemoteActions.ACTIVATE_KSM](f).then(function(e){t.activateStatus="success",n.isKmsActivated=!0,i(function(){r.close()},800)},function(e){t.activateStatus="failed",t.isLoading=!1})}}]})}r.clickEncryption=function(t){if(n.isKmsActivated==1||!t)return;n.isKmsActivated==0?u():e[o.RemoteActions.IS_KMS_ACTIVATED]().then(function(e){n.isKmsActivated=e,e==0&&u()})}}}}}}])}),define("ecsbuy/base/directives/password/password",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","../../cons/cons"],function(e,t,n,r,i,s){r.directive("aliyunBuyEcsPassword",["$filter","aliyunBuyEcsRemoteService",function(e,t){return{restrict:"EA",templateUrl:s.Constant.PARTIALS_PATH+"password/password.html",scope:{value:"=",options:"=",reversalInstName:"@"},replace:!0,link:function(r){i.setDefault(r,{valueObject:{},options:{}}),r.$watch("valueObject",function(t){r.value=e("json")([t.password,t.instance])},!0),r.$watch("value",function(e){if(!e||e=="[]")r.password1="",r.password2="",r.valueObject.password="",r.valueObject.instance="",r.value=n.toJson([null,null],!0);r.options.state=""}),r.login=function(){r.$emit("aliyunBuy:saveOptions"),t.login()},r.$on("todoPasswordChange",function(){r.options.state="",r.$broadcast("passowdChange")})}}}])}),define("ecsbuy/base/directives/password/passwordInput",["require","exports","angular","../directives","../../cons/cons"],function(e,t,n,r,i){r.directive("aliyunBuyEcsPasswordInput",[function(){return{restrict:"AE",replace:!0,scope:{passwords:"@",needLogin:"=",ngModel:"=",tip:"@",spm:"@",value:"=",error:"=",login:"="},templateUrl:i.Constant.PARTIALS_PATH+"password/passwordInput.html",link:function(e,t,r){n.extend(e,{blur:function(){e.$emit("todoPasswordChange")}}),e.$on("passowdChange",function(){var t=e.passwords.split("|"),i=e.$parent[t[0]],s=/^[a-zA-Z\d-&:;'<>,=%`~!@#\(\)\$\^\*\+\|\{\}\[\]\.\?\/]{8,30}$/,o=3,u={reg_number:/(?=.*[0-9].*)/,reg_capital:/(?=.*[A-Z].*)/,reg_lowercase:/(?=.*[a-z].*)/,reg_character:/(?=.*[-&:;'<>,=%`~!@#\(\)\$\^\*\+\|\{\}\[\]\.\?\/].*)/},a=0;n.forEach(u,function(e,t){e.test(i)&&a++});var f=a>=o;!s.test(i)||!f?(r.ngModel==t[0]&&(e._error="ECS_PASSWORD_EXP_ERROR"),e.value=undefined):e.$parent[t[0]]!=e.$parent[t[1]]&&(r.ngModel==t[1]&&(e._error="ECS_PASSWORD_REPEAT_ERROR"),e.value=undefined),s.test(i)&&f&&e.$parent[t[0]]==e.$parent[t[1]]&&!n.isUndefined(e.$parent[t[0]])&&!n.isUndefined(e.$parent[t[1]])&&(e._error=!1,e.value=e.ngModel)})}}}])}),define("ecsbuy/base/directives/password/keyPairSetting",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","../../helpers/ImageHelper","../../cons/cons"],function(e,t,n,r,i,s,o){return r.directive("aliyunBuyEcsSettingKeyPair",["aliyunBuyEcsRemoteService",function(e){return{restrict:"EA",templateUrl:o.Constant.PARTIALS_PATH+"password/keyPairSetting.html",scope:{options:"=",value:"=",detail:"=",config:"&",valueAll:"="},replace:!0,compile:function(t,r){return i.require(["options","value","detail"],r),{pre:function(t){i.setDefault(t,{detail:{},options:{},value:""}),t.$watchCollection("[valueAll.regionId]",function(){t.options.items=undefined}),t.refresh=function(){t.options.items=undefined},t.fetchConfig={pageSize:10,fetchData:function(n,r){var i=s.ImageHelper.ImageType[t.imageType],o=t.valueAll,u={pageNumber:n,pageSize:r,regionId:o.regionId};return e.describeKeyPairs(u)},resultsHandler:function(e){var t=e.KeyPairs.KeyPair,r={totalCount:e.TotalCount,items:[]};return n.forEach(t,function(e){r.items.push({value:e.KeyPairName,text:e.KeyPairName})}),r}}}}}}}]),r}),define("ecsbuy/base/directives/password/instanceName",["require","exports","../directives","dominator/base/helpers/moduleHelper","../../cons/cons"],function(e,t,n,r,i){return n.directive("aliyunBuyEcsInstanceName",["$filter",function(e){return{restrict:"EA",templateUrl:i.Constant.PARTIALS_PATH+"password/instanceName.html",scope:{options:"=",value:"="},replace:!0,compile:function(t,n){return r.require(["options","value"],n),{pre:function(t){r.setDefault(t,{detail:{},options:{},value:""}),t.instanceValidate=!0,t.options.state="",t.blur=function(){t.instanceValidate=!0,t.value=e("json")([t.instanceName,!0]);if(!t.instanceName||t.instanceName.length==0)return;/^[a-zA-Z\u4e00-\u9fa5][\u4e00-\u9fa5\d\.\w\-]{1,127}$/.test(t.instanceName)||(t.instanceValidate=!1,t.value=e("json")([t.instanceName,!1]))},t.focus=function(){t.instanceValidate=!0,t.options.state=""}}}}}}]),n}),define("ecsbuy/base/directives/orderConfirm/common",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","common/helper/i18nHelper","../../cons/cons","../../helpers/commodityHelper","../../cons/buyBizCons"],function(e,t,n,r,s,o,u,a,f){return r.directive("aliyunBuyEcsOrderConfirm",["aliyunBuyEcsRemoteService","aliyunBuyMsg","aliyunBuyEcsDialogButtonConfigService","$filter","$q","base64","aliyunBuyEcsBlockListService",function(e,t,r,l,c,h,p){function d(s,u,l){function O(e){n.forEach(m,function(t,n){var r=s.commodityCode;t.commodity&&(t.commodity.password=undefined),r=="vm"&&e?t.couponNo=e[n]:r=="vm"&&n==0?t.couponNo="default":t.couponNo="blank"});var t=h.encode(n.toJson(m));v({data:t}).then(function(e){y.resolve(e)},function(e){y.reject(e)})}function M(){e.getComponents({commodityCode:g,orderType:"BUY"}).then(function(e){C.resolve(e)},function(e){C.reject(e)})}function _(){if(m&&m[0]&&m[0].imageMarket){var e=h.encode(n.toJson(m[0].imageMarket));v({data:e}).then(function(e){w.resolve(e)},function(e){w.reject(e)})}else w.resolve(undefined)}function D(){e.queryAllIzName().then(function(e){T.resolve(e)},function(e){T.resolve(null)})}function P(){var t=B().regionListForFlowPrice;if(t.length==0){S.resolve(null);return}jQuery.unique(t);var r=n.isArray(t)?t.join(","):undefined;e.listBandwidthPriceMap({regionIds:r}).then(function(e){S.resolve(e)},function(e){S.resolve(null)})}function H(){var t=B().regionMapForImageList,r={};n.forEach(t,function(e,t){r[t]=jQuery.unique(e).join(",")});var i=g=="vm"?"Prepaid":"AfterPay";e.listImageByImageIds({regionMapForImageIds:r,chargeType:i}).then(function(e){L.resolve(e)},function(e){L.resolve(null)})}function B(){var e={},t=[];return n.forEach(m,function(n){if(!n)return;var r=n.commodity;if(!r)return;var i=n.regionId,s=r.imageId;if(!i||!r.imageId)return;e[i]||(e[i]=[]),e[i].push(s);if(!r.internetMaxBandwidthOut)return;if(r.internetChargeType=="PayByBandwidth")return;t[i]||(t[i]=[]),t.push(i)}),{regionMapForImageList:e,regionListForFlowPrice:t}}function F(e,t){var n;return m.length==1?n=e:n=e.children&&e.children[t],n}function I(e){s.price={calculating:!1,success:!0,data:{success:!0,code:e.code,origin:e.origin,trade:e.trade,discount:e.discount,strategies:e.strategies,currency:e.currency,isPostpay:e.isPostpay}}}function q(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4];I(t);var u=R(i,r,o,n,t),a=U(u);s.orderViewData={orderLines:u},s.ready=!0}function R(e,t,n,r,i){var u=[],f=!1;for(var l=0;l<m.length;l++){var c=m[l],h=c.commodity||{},p=void 0,d=c.orderType=="disk-buy",v=c.orderType=="volume-buy",y=c.orderType=="marketplace-image";d?p=a.CommodityHelper.getViewComponentsForYundisk(e,c,t):v?p=a.CommodityHelper.getViewComponentsForVolume(e,c,t):y?p=a.CommodityHelper.getViewComponentsForMarketImage(e,c,n):p=a.CommodityHelper.getViewComponentsForEcs(e,c,t,n);var b=F(i,l)||{},w=null,E="";h.internetChargeType=="PayByTraffic"&&(w=r&&r[c.regionId]),h.internetMaxBandwidthOut>0&&h.networkType=="vpc"&&(E=o.i18n("ECS_BANDWIDTH_VPC_MORE_THAN_0_ORDERVIEW")),h.securityGroupId=="SystemDefaultSg"&&(E&&(E+="<div class='bk-orderconfirm-securitygroup-tip'><div>"),E+=o.i18n("ecs.buy.compoment.orderConfirm.systemDefaultSecurityGroup"));var S=h.maxAmount?h.maxAmount:h.amount;u.push({orderType:c.orderType,commodityCode:g,commodityName:function(){return d?o.i18n("ecs.buy.component.product.clouddisk"):v?o.i18n("ecs.buy.component.product.volume"):y?o.i18n("ecs.buy.component.image.market"):o.i18n("ecs.buy.component.product.ecs")}(),priceUnit:function(){return g=="vm"?"":" "+o.i18n("ECS_UNIT_PER_HOUR")}(),warningTip:E,coupons:b.coupons,items:p,period:h.period,periodType:h.priceUnit,quantity:S?S:c.amount,price:b,flowPrice:w}),b.coupons&&b.coupons.length>0&&(f=!0)}return s.hasCoupon=f,u}function U(e){var t=e[0]&&e[0].items;if(!n.isArray(t))return;for(i=0;i<t.length;i++){var r=t[i];if(r.name=="")return r.text}}s.price={calculating:!0},s.imageNameMap={},s.securityNameMap={},s.couponValueMap={},s.channelSwitch={hideAliyunServer:p.inBlockList("ecsFuncShowAliyunServer")};var d=s.remotePriceAction,v=d?e[d]:e.describePrice,m=s.orderData(),g=s.commodityCode;if(!v||!m)return;var y=c.defer(),b=y.promise,w=c.defer(),E=w.promise,S=c.defer(),x=S.promise,T=c.defer(),N=T.promise,C=c.defer(),k=C.promise,L=c.defer(),A=L.promise;c.allSettled([b,x,N,k,A]).then(function(e){var n=[];for(var i=0;i<e.length;i++){var s=e[i];if(!s)continue;if(s.state=="fulfilled")n.push(s.value);else{if(s.state=="rejected"&&s.reason&&s.reason.code=="ConsoleNeedLogin"){t.dialog(o.i18n("ECS_PROMPT"),o.i18n("ECS_ERRORTIP_NEEDLOGIN"),r.login());break}n.push({})}}q(n)}),O(),H(),M(),D({}),P({});var j=null;s.$watch("couponValueMap",function(e,t){var r=s.price,i=s.orderViewData;if(!e)return;s.$emit("aliyunBuyEcsCoupons:valueChanged",s.couponValueMap);for(var o in e)if(!t[o])return;var u={};for(var o in e)if(e[o]!=t[o]){u.key=o,u.value=e[o];break}for(var o in e)o!=u.key&&e[o]==u.value&&(e[o]=f.BuyBizCons.COUPON_BLANK);n.forEach(m,function(t,n){t.couponNo=e[n]}),r.calculating=!0;var a=h.encode(n.toJson(m));v({data:a}).then(function(e){r.calculating=!1;if(!i||!n.isArray(i.orderLines))return;n.forEach(i.orderLines,function(t,n){t.price=F(e,n)}),I(e)},function(e){r.calculating=!1}),s.$emit("aliyunBuyEcsCoupons:valueChanged",s.couponValueMap)},!0)}return{restrict:"EA",templateUrl:u.Constant.PARTIALS_PATH+"orderConfirm/common.html",scope:{orderData:"&",commodityCode:"@",remotePriceAction:"@",price:"=",ready:"="},replace:!0,compile:function(e,t){return s.require(["price"],t),{post:d}}}}]),r}),define("ecsbuy/base/directives/orderConfirm/clouddisk",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","../../cons/cons","../../helpers/homeConfigHelper","../../helpers/priceHelper"],function(e,t,n,r,i,s,o,u){r.directive("aliyunBuyEcsClouddiskOrderConfirm",["aliyunBuyEcsRemoteService",function(e){function t(e,t,r){e.priceService="describePrice",e.checked=!0;var i=[],s=e.orderData(),a=!1;n.forEach(s,function(e){var t=u.PriceHelper.generationYundiskOrder(e.dataDisk.category,e.dataDisk.size,e.dataDisk.snapshotId,e.regionId,e.amount,e.zoneId,e.dataDisk.encrypted,e.dataDisk.encryptedForView);i.push(t),e.dataDisk.encryptedForView&&(a=!0)}),e.clouddiskOrderData=i,e.kmsTermUrl=a&&o.HomeConfigHelper.getUrlConfig("kmsTermUrl"),e.purchase=function(){if(!e.checked)return;e.$emit("aliyunBuyClouddiskOrderConfirm:purchase",{orderData:e.orderData()})}}return{restrict:"EA",templateUrl:s.Constant.PARTIALS_PATH+"orderConfirm/clouddisk.html",replace:!0,scope:{orderData:"&",ready:"="},compile:function(e,n){return i.require(["price"],n),{post:t}}}}])}),define("ecsbuy/base/directives/orderConfirm/volume",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","../../cons/cons","../../helpers/homeConfigHelper","../../helpers/priceHelper"],function(e,t,n,r,i,s,o,u){r.directive("aliyunBuyEcsVolumeOrderConfirm",["aliyunBuyEcsRemoteService",function(e){function t(e,t,r){e.priceService="describePrice",e.checked=!0;var i=[],s=e.orderData(),a=!1;n.forEach(s,function(e){var t=u.PriceHelper.generationVolumeOrder(e.volume.category,e.volume.size,e.volume.snapshotId,e.regionId,e.amount,e.zoneId,e.volume.encrypted,e.volume.encryptedForView);i.push(t),e.volume.encryptedForView&&(a=!0)}),e.volumeOrderData=i,e.kmsTermUrl=a&&o.HomeConfigHelper.getUrlConfig("kmsTermUrl"),e.purchase=function(){if(!e.checked)return;e.$emit("aliyunBuyVolumeOrderConfirm:purchase",{orderData:e.orderData()})}}return{restrict:"EA",templateUrl:s.Constant.PARTIALS_PATH+"orderConfirm/volume.html",replace:!0,scope:{orderData:"&",ready:"="},compile:function(e,n){return i.require(["price"],n),{post:t}}}}])}),define("ecsbuy/base/cons/buyTipsCons",["require","exports"],function(e,t){var n=[{id:"webType",config:{text:""}},{id:"generation",config:{text:""}}],r=[],i=[{id:"bandwidth",translateValues:["https://help.aliyun.com/knowledge_detail/40032.html","https://www.aliyun.com/product/ddos"]},{id:"orderTime",translateValues:["https://help.aliyun.com/knowledge_detail/37096.html"]}],s={tip:i,askTip:r,textTip:n};t["default"]=s}),define("ecsbuy/base/helpers/buyTipsHelper",["require","exports","angular","common/helper/i18nHelper","../cons/buyTipsCons","./commodityHelper"],function(e,t,n,r,i,s){var o=["instance_type.instance_type_family","vm_web_type.vm_web_type"],u=function(){function e(){}return e.getAskTip=function(e,t){return this.getTip(e,"askTip",t)},e.getTextTip=function(e,t){return this.getTip(e,"textTip",t)},e.getBlockTip=function(e,t){var n=this.getTip(e,"tip",t);return n.text||""},e.getPurchaseTip=function(e,t){var n=this.getTip(e,"purchaseTip",t);return n.text||""},e.getHoverTip=function(e,t,n){var r=this.getHoverTipKey(e,t);return this.getTranslateText(r,n,!1)},e.getHoverTipKey=function(e,t){var n=["HOVER_TIP","TEXT",e,t].join("__");return n=n.toUpperCase(),n},e.getTip=function(e,t,r){t===void 0&&(t="tip");if(!e)return"";var i=this,s={},o=this.getTipCons(t),u=this.getTranslateKeys(t);return n.forEach(o,function(t){t.id==e&&(n.extend(s,t.config),r=r||t.translateValues||[])}),n.forEach(u,function(n){var o=s[n]||[t,n,e].join("__");s[n]=i.getTranslateText(o.toUpperCase(),r,!1)}),s},e.getTipCons=function(e){return i["default"][e]||[]},e.getTranslateKeys=function(e){var t={tip:["text"],askTip:["tooltip","spm"],textTip:["text","spm"],"default":["text","tooltip","spm"]};return t[e]||t["default"]},e.getTranslateText=function(e,t,n){var i=[e].concat(t),s=r.i18n.apply(null,i);return n&&s==e?"":s},e.mergeItemTip=function(e){var t=s.CommodityHelper.getComponents(e),r=this;if(!t)return;var i={};n.forEach(o,function(t){var i=t.split(".");if(i.length==0)return;var o=i[i.length-1],u=s.CommodityHelper.getComponentDeep(e,t);n.forEach(u,function(e){var t=r.getHoverTipKey(o,e.value),n=r.getHoverTip(o,e.value);n!=t&&(e.tip=n)})})},e}();t.BuyTipsHelper=u}),define("ecsbuy/base/helpers/purchaseHelper",["require","exports","./homeConfigHelper","./buyTipsHelper"],function(e,t,n,r){var i=function(){function e(){}return e.getUserAuthenticationTip=function(e,t){var i;t||(t="certified");if(e=="NO_NAME_AUTHENTICATION"||e=="ORDER.NO_REAL_NAME_AUTHENTICATION"||e=="NO_REAL_NAME_AUTHENTICATION"){var s=n.HomeConfigHelper.getUrlConfig("userAuthentication"),o=n.HomeConfigHelper.isForService()?"_self":"_blank";i=r.BuyTipsHelper.getPurchaseTip(t,[s,o])}return i},e.getInsufficientBalanceTip=function(e,t){t||(t="money_lessthan_100");var i;if(e=="MONEY_LESSTHAN_100"||e=="INSUFFICIENT_BALANCE"||e=="OWNING_FEE"||e=="PAY.OWNING_FEE"){var s=n.HomeConfigHelper.getUrlConfig("recharge");i=r.BuyTipsHelper.getPurchaseTip(t,[s])}return i},e}();t.PurchaseHelper=i}),define("ecsbuy/base/helpers/orderDataHelper",["require","exports","angular","dominator/base/helpers/moduleHelper","./commodityHelper","./imageHelper","./buyUtils","./businessInfoHelper","./diskHelper","../cons/fieldCons","../cons/buyBizCons","./instanceTypeHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=function(){function e(){}return e.getOrderParam4Ecs=function(e,t,r,s,o){var a=this;if(!n.isArray(e))return;var f=[];return n.forEach(e,function(e,l){if(!e)return;var h=e.instance_type,p=i.CommodityHelper.getNetworkType(e.vm_web_type),d=i.CommodityHelper.getBandwidthType(e.vm_is_flow_type),v=a.getDatadisk(e.datadisk,t,r),m=a.getSystemdisk(e),g=a.getImageValue(e,e.imageType),y=a.getVpc(e.vm_vpc),b=a.getSecurityGroupId(e.securityGroup),w=a.getPassword(e.password,e.setupPassword),E=a.getKeyPairName(e.keyPair,e.setupPassword),S=u.BusinessInfoHelper.getBusinessInfo(e),x=a.getInstanceName(e.instanceName),T=a.getDuration(e,t),N=a.getImageMarket(e,g.imageId,S,T),C=a.getUserdata(e),k=e.spotStrategy,L=e.spotPriceLimit,A=e.spotDuration,O=a.getSecurityEnhancementStrategy(e),M=a.getNetworkInterface(e),_=a.getGroupRules(e,b),D=a.getHpcCluster(e),P=c.InstanceTypeHelper.isHpcInstanceType(o,h),H={zoneId:e.vm_iz,instanceType:h,ioOptimized:e["iooptimized"]=="optimized",networkType:p,vSwitchId:p=="vpc"&&y?y.vSwitchId:undefined,securityGroupId:b,internetChargeType:d,internetMaxBandwidthOut:p=="vpc"&&e["allocatePublicIP"]=="disabled"?"0":e.vm_bandwidth,imageType:e.imageType,imageId:g&&g.imageId,securityEnhancementStrategy:O,systemDisk:m,dataDisks:v,priceUnit:T.priceUnit,periodType:T.periodType,period:T.period,amount:e.amount,maxAmount:e.amount,autoRenew:e.autoRenew,recyclable:e.recyclable,userData:C,setupPassword:e.setupPassword,password:w.password,instanceName:x.instanceName,spotStrategy:k,spotDuration:A,spotPriceLimit:L,keyPairName:E,vpcId:p=="vpc"&&y?y.vpcId:undefined,groupRules:_,networkInterfaces:M,hpcCluster:P?D:undefined,hpcClusterId:P&&!D?e.hpcClusterId:undefined};n.isArray(s)&&n.forEach(s,function(e,t){H[e]=undefined});var B={orderType:"instance-buy",regionId:e.vm_region_no,imageMarket:N,commodity:H,businessInfo:S};n.isArray(s)&&n.forEach(s,function(e,t){B[e]=undefined}),f.push(B)}),f},e.getOrderParam=function(e,t,n,r,i){var s=this,o=[];return r&&(o=["userData","password","instanceName","keyPairName","networkInterface","securityEnhancementStrategy","recommend_instance_type"]),s.getOrderParam4Ecs(e,t,n,o,i)},e.getOrderParam4CacheDefault=function(e,t,n,r){var i=this,s=["internetChargeType","internetMaxBandwidthOut"];return i.getOrderParam4Ecs(e,t,n,s,r)},e.getOrderParam4Yundisk=function(e,t){var r=this;if(!n.isArray(e))return;var i=[];return n.forEach(e,function(e,r){if(!e)return;var s={orderType:"disk-buy",regionId:e.vm_region_no,commodity:{zoneId:e.vm_iz,dataDisk:{category:e.datadisk_category,size:e.datadisk_size,snapshotId:e.snapshotId,encrypted:e.snapshotId?undefined:e.diskEncrypted,encryptedForView:e.diskEncrypted},amount:e.amount}};if(t)i.push(s);else{var o=n.extend(s,s.commodity);s.commodity=undefined,i.push(o)}}),i},e.getOrderParam4Volume=function(e,t){var r=this;if(!n.isArray(e))return;var i=[];return n.forEach(e,function(e,r){if(!e)return;var s={orderType:"volume-buy",regionId:e.vm_region_no,commodity:{zoneId:e.vm_iz,volume:{category:e.volume_category,size:e.volume_size,snapshotId:e.snapshotId,encrypted:e.snapshotId?undefined:e.diskEncrypted,encryptedForView:e.diskEncrypted},amount:e.amount}};if(t)i.push(s);else{var o=n.extend(s,s.commodity);s.commodity=undefined,i.push(o)}}),i},e.isPostpay=function(e){return e=="ecs"||e=="yundisk"},e.getDuration=function(e,t){var n=this;return n.isPostpay(t)?i.CommodityHelper.getPostpayDuration():i.CommodityHelper.getDuration(e.order_time)},e.getDatadisk=function(e,t,r){if(!e)return null;var i=[],s=n.fromJson(e);for(var o=0;o<s.length;o++){var u=s[o];if(!u[1])return i;var a=u[5],f=u[0];if(f=="ephemeral_ssd"||f=="ephemeral")a=!0;t=="vm"&&r=="BUY"&&(a=!0),i.push({category:f,size:u[1].toString(),snapshotId:u[2]?u[2]:"",device:u[3]?u[3]:"",deleteWithInstance:a,encrypted:u[2]?undefined:u[16],encryptedForView:u[16],isFullImage:u[13]})}return i},e.getConvertSelectedDiskIdString=function(e,t){var n=this,r=n.getConvertSelectedDiskId(e);return r instanceof Array&&r.length>0?r.join(t||","):undefined},e.getConvertSelectedDiskId=function(e){if(!e)return null;var t=[],r=a.DiskHelper.parseValue(e);return n.isArray(r)&&r.forEach(function(e){e&&e.convertChargeType&&t.push(e.instanceId)}),t},e.getConvertSelectedDiskCategory=function(e,t){if(!e||!t)return null;var r=null,i=a.DiskHelper.parseValue(e);return n.isArray(i)&&i.forEach(function(e){e&&e["instanceId"]==t&&(r=e.category)}),r},e.getSecurityGroupId=function(e){if(!e)return;var t=n.fromJson(e);return t[2]},e.getSystemdisk=function(e){var t=e.systemdisk_category,n=e.systemdisk_size||40;return n=Math.max(n,40),{category:t,size:n.toString()}},e.getImageValue=function(e,t){var n=e[t+"Image"];return s.ImageHelper.parseValue(n)},e.getImageMarket=function(e,t,n,r){if(e.imageFromMarket&&t){var i=s.ImageHelper.parseValue(e.imageFromMarket),o=i.quota,u=e["amount"]==undefined?1:e.amount,a=e.instance_type,f=e.vm_region_no;if(u>o)return s.ImageHelper.getPriceParamFromValue(i,u-o,f,a,n,r.period,r.priceUnit)}},e.getVpc=function(e){var t=r.parseJsonSafe(e);return t?{vSwitchId:t[0]=="random"?undefined:t[0],ipNum:t[1],vpcId:t[2],isDefault:t[3]}:{}},e.getPassword=function(e,t){if(!e||t!="setupNow")return{};var n=r.parseJsonSafe(e);return{password:n[0]}},e.getKeyPairName=function(e,t){return t!="keyPair"?undefined:e},e.getInstanceName=function(e){if(!e)return{};var t=r.parseJsonSafe(e);return{instanceName:t[0]}},e.getUserdata=function(e){return e["userdata_select"]=="text"?e.userdata:undefined},e.getNetworkInterface=function(e){var t=i.CommodityHelper.getNetworkType(e.vm_web_type),r=[];if(t==f.FieldCons.FIELD_NETWORK_TYPE_VPC){var s=e.networkInterface||{},o=s.vSwitchValues;if(n.isArray(o)&&o.length>0)return n.forEach(o,function(e,t){r.push({vSwitchId:e})}),r}},e.getSecurityEnhancementStrategy=function(e){return e["imageType"]=="public"?e.securityEnhancementStrategy?"Active":"Deactive":undefined},e.getGroupRules=function(e,t){var r=e.groupRule;if(r&&t==l.BuyBizCons.DEFAULT_SYSTEM_SECURITY_GROUP){var i=r.split(","),s=[];return n.forEach(i,function(e){var t=e.split(":");s.push({ipProtocol:t[0],portRange:t[1]})}),s}},e.getHpcCluster=function(e){if(e.hpcClusterName){var t=n.fromJson(e.hpcClusterName)[0],r;return e.hpcClusterDescription&&(r=n.fromJson(e.hpcClusterDescription)[0]),{name:t,description:r}}},e.hasEncryptedDisk=function(e){if(!n.isArray(e))return;for(var t=0;t<e.length;t++){var r=e[t];if(r&&r.commodity){var i=r.commodity.dataDisks;if(!n.isArray(i))continue;for(var s=0;s<i.length;s++){var o=i[s];if(o&&o.encryptedForView)return!0}}}},e.formatToLXOrderParam=function(e,t){var r=[];return e?t=="yundisk"||t=="san"?(r.push({components:{vm_region_no:o.BuyUtils.getMapProperty(e,"0.regionId"),vm_iz:o.BuyUtils.getMapProperty(e,"0.zoneId")}}),r):(n.forEach(e,function(e){if(!e)return;var s=e.commodity,o=e.businessInfo||{},u=s.dataDisks,f=[];n.isArray(u)&&n.forEach(u,function(e,t){var n=a.DiskHelper.convertDiskDataToLxOrderParam(e);!n||f.push(n)}),r.push({data:{orderSource:o.orderSource,activityId:o.activityId,duration:s.period,pricingCycle:s.periodType=="Monthly"?"Month":"Year",quantity:s.amount},components:{vm_region_no:e.regionId,hpcClusterId:s.hpcClusterId,vm_iz:s.zoneId,securityGroupId:s.securityGroupId,instance_type:[{instance_type:s.instanceType,instance_generation:s.instanceGeneration}],vm_web_type:s.networkType=="vpc"?"1":"0",iooptimized:s.ioOptimized?"optimized":"none",vm_bandwidth:[{vm_bandwidth:s.internetMaxBandwidthOut!=undefined?s.internetMaxBandwidthOut*1024:undefined,vm_is_flow_type:s.internetChargeType!=undefined?i.CommodityHelper.getVmIsFlowOut(s.internetChargeType,t!="vm"):undefined}],imageType:s.imageType,imageId:s.imageId,setupPassword:s.setupPassword,vm_os:[{vm_os:s.imageId}],vm_vpc_id:s.vpcId,vm_vpc_switch_id:s.vSwitchId,systemdisk:[{systemdisk_category:s.systemDisk.category,systemdisk_size:s.systemDisk.size}],groupRules:s.groupRules,datadisk:f}})}),r):r},e}();t.OrderDataHelper=h}),define("ecsbuy/base/directives/orderConfirm/prepay",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","common/helper/i18nHelper","../../cons/cons","../../helpers/homeConfigHelper","../../helpers/priceHelper","../../helpers/buyUtils","../../helpers/purchaseHelper","../../cons/urlConfig","../../helpers/orderDataHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){return r.directive("aliyunBuyEcsPrepayOrderConfirm",["aliyunBuyEcsBlockListService",function(e){function t(t,r,i){function d(e){var r=t.password;if(r.setupPasswordValue!="setupNow")return;n.forEach(e,function(e,t){if(!e||!e.commodity)return;e.commodity.password=r.passwordValue,e.commodity.instanceName=r.instanceName})}function v(){var e=t.password,n=e.setupPasswordValue;return n!="setupNow"?!0:e.passwordValue?e.instanceName===!1?!1:!0:!1}t.priceService="describePrice",t.checked=!0,t.password={},t.buttonText=s.i18n("ECS_CREATE_ORDER");var o=n.copy(t.orderData()),p=f.BuyUtils.getMapProperty(o,"0.imageMarket.0.commodity.productCode");p&&(t.imageOrderTermUrl=(u.HomeConfigHelper.getUrlConfig("imageOrderTermUrl")||c.UrlConfig.imageOrderTermUrl)+p),t.kmsTermUrl=h.OrderDataHelper.hasEncryptedDisk(o)&&u.HomeConfigHelper.getUrlConfig("kmsTermUrl"),a.PriceHelper.removeUselessParam(o),t.prepayOrderData=a.PriceHelper.convertImageOrder(o),t.channelSwitch={hideImportantTip:e.inBlockList("ecsFuncShowConfirmImportantTip"),hideRecommendCode:e.inBlockList("ecsFuncRecommendCode")},t.$watch("price",function(e){var n=f.BuyUtils.getMapProperty(e,"data.code");if(n){var r=l.PurchaseHelper.getUserAuthenticationTip(n,null);r&&(t.payOrderTip=r,t.checked=!1)}}),t.purchase=function(){if(!t.checked||!t.recommendValidation||!v())return;d(t.orderData()),t.$emit("aliyunBuyEcsPrepayOrderConfirm:purchase",{orderData:t.orderData(),remoteCreateOrderAction:t.remoteCreateOrderAction,promotionCode:t.recommendCode?t.recommendCode:undefined})},t.$on("aliyunBuyEcsCoupons:valueChanged",function(e,r){if(!r)return;var i=t.orderData();if(i&&n.isArray(i)&&i[0]&&i[0].imageMarket){var s=i[0];s.businessInfo||(s.businessInfo={}),s.businessInfo.marketImageCouponNo=r[1]}n.forEach(t.orderData(),function(e,t){e.couponNo=r[t]})}),function(){n.forEach(t.orderData(),function(e){if(!e.fromUrl)return;t.fromUrl=!0;if(e&&e.commodity){var n=e.commodity;t.password.osKind=n.osKind}})}()}return{restrict:"EA",templateUrl:o.Constant.PARTIALS_PATH+"orderConfirm/prepay.html",replace:!0,scope:{orderData:"&",remoteCreateOrderAction:"@",remotePriceAction:"@",ready:"="},compile:function(e,n){return i.require(["price"],n),{post:t}}}}]),r}),define("ecsbuy/base/directives/orderConfirm/postpay",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","common/helper/dateHelper","common/helper/i18nHelper","../../cons/cons","../../helpers/homeConfigHelper","../../helpers/priceHelper","../../helpers/buyUtils","../../helpers/purchaseHelper","../../cons/urlConfig","../../helpers/orderDataHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){return r.directive("aliyunBuyEcsPostpayOrderConfirm",["aliyunBuyEcsBlockListService",function(e){function t(t,r,i){t.priceService="describePrice",t.checked=!0,t.buttonText=o.i18n("ECS_PAY_POSTPAY"),t.hstep=1,t.mstep=60,t.$watch("isRelease",function(e){if(e){var n=new Date,r=Date.parse(n.toString());t.minDay=r,t.maxDay=Date.parse(new Date(n.getFullYear()+3,n.getMonth(),n.getDate())),r+=(59-n.getMinutes()+60)*60*1e3,t.releaseTime=new Date(r)}}),t.$watchCollection("[isRelease, releaseTime]",function(e){var n=e[0],r=e[1];if(n&&r){var i=Date.parse(r),s=new Date,o=Date.parse(s.toString())+36e5;if(i<o){var u=Date.parse(s.toString());u+=(59-s.getMinutes()+60)*60*1e3,t.releaseTime=new Date(u)}}else t.releaseTime=null}),t.isForService=a.HomeConfigHelper.isForService();var u=n.copy(t.orderData()),d=l.BuyUtils.getMapProperty(u,"0.imageMarket.0.commodity.productCode");d&&(t.imageOrderTermUrl=(a.HomeConfigHelper.getUrlConfig("imageOrderTermUrl")||h.UrlConfig.imageOrderTermUrl)+d),t.kmsTermUrl=p.OrderDataHelper.hasEncryptedDisk(u)&&a.HomeConfigHelper.getUrlConfig("kmsTermUrl"),f.PriceHelper.removeUselessParam(u),t.postpayOrderData=f.PriceHelper.convertYundiskSubOrder(u),t.postpayOrderData=f.PriceHelper.convertImageOrder(t.postpayOrderData),t.channelSwitch={hideImportantTip:e.inBlockList("ecsFuncShowConfirmImportantTip")},t.$watch("price",function(e){var n=l.BuyUtils.getMapProperty(e,"data.code");if(n){var r=c.PurchaseHelper.getInsufficientBalanceTip(n,null),i=c.PurchaseHelper.getUserAuthenticationTip(n,null);if(r||i)t.payOrderTip=r||i,t.checked=!1}}),t.purchase=function(){if(!t.checked)return;t.$emit("aliyunBuyEcsPostpayOrderConfirm:purchase",{orderData:t.orderData(),releaseTime:t.releaseTime?s.getISODateString(t.releaseTime):null})}}return{restrict:"EA",templateUrl:u.Constant.PARTIALS_PATH+"orderConfirm/postpay.html",replace:!0,scope:{orderData:"&",ready:"="},compile:function(e,n){return i.require(["price"],n),{post:t}}}}]),r}),define("ecsbuy/base/directives/orderConfirm/recommendCode",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","../../cons/cons","../../helpers/buyTipsHelper"],function(e,t,n,r,i,s,o){r.directive("aliyunBuyEcsRecommendCode",["base64","aliyunBuyEcsRemoteService","aliyunBuyMsg",function(e,t,r){function u(s,u,a){function c(t,i){var o=e.encode(n.toJson(t));f({data:o,promotionCode:i}).then(function(e){s.price={calculating:!1,success:!0,data:{success:!0,origin:e.origin,trade:e.trade,discount:e.discount,strategies:e.strategies}};if(e){var t=e.extraCode,n=e.extraMessage;t?(t=="INVITATION_CODE_RESTRICT_FIRST_UNPAID_ORDER"?s.errorTip=n+'<a href="https://expense.console.aliyun.com/#/order/list/"  target="_blank">></a>':t=="User_Not_Enterprise_Authentication"?s.errorTip=n+'<a href="https://account.console.aliyun.com/#/auth/home"  target="_blank">></a>':t=="User_Purchase_Quantity_Period_Exceeds_Limit"?s.errorTip=n+'<a href="http://promotion.aliyun.com/act/aliyun/recommand_code.html"  target="_blank">></a>':t=="Company_Code_Has_Commodity_Product"?s.errorTip=n+'<a href="http://promotion.aliyun.com/act/aliyun/recommand_code.html"  target="_blank">></a>':s.errorTip=n?n:"",s.successTip="",s.codeValidate=!1,s.recommendCode=undefined,s.recommendValidation=!1):(s.successTip="",s.codeValidate=!0,s.recommendCode=i,s.recommendValidation=!0)}},function(e){s.recommendCode=undefined,s.recommendValidation=!1;var t={buttons:[{text:"",theme:"blue",handler:function(){window.location.reload()}}]};r.dialog("",e.message,t)})}i.setDefault(s,{showInput:!1,recommendChecked:!1,codeValidate:!0,recommendValidation:!0,recommentAskTip:o.BuyTipsHelper.getAskTip("recommend_code").tooltip});var f=t.describePrice,l=s.orderData();if(!f||!l)return;s.$watch("recommendChecked",function(e){s.showInput=!!e,s.showTip=!!e,s.codeValidate=!0,e?s.recommendValidation=!s.errorTip:(s.recommendValidation=!0,s._recommendCode=undefined,s.errorTip="",s.successTip="",s.recommendCode&&(s.recommendCode=undefined,c(l,s.recommendCode)))}),s.$watch("_recommendCode",function(e){if(!e)return;s.errorTip="",s.successTip="",e.length==6&&c(l,e)}),s.blur=function(){var e=s._recommendCode;if(!e||e.length<6)s.errorTip="6",s.successTip="",s.codeValidate=!1,s.recommendCode=undefined,s.recommendValidation=!1}}return{restrict:"EA",templateUrl:s.Constant.PARTIALS_PATH+"orderConfirm/recommendCode.html",scope:{recommendCode:"=",recommendValidation:"=",orderData:"&",priceService:"&",price:"="},replace:!0,compile:function(e,t){return i.require(["price"],t),{post:u}}}}])}),define("ecsbuy/base/directives/orderConfirm/passwordWrapper",["require","exports","angular","../directives","../../cons/cons","../../cons/buyBizCons"],function(e,t,n,r,i,s){return r.directive("aliyunBuyEcsPasswordWrapper",[function(){function e(e,t,r){function i(){var t=e.password,r=t?n.fromJson(t):{};return{passwordValue:r[0],instanceName:r[1]}}e.setupPasswordValue="setupLater",e.passwordOptions=e.setupPasswordDetail={},e.setupPasswordOptions={items:s.BuyBizCons.SETTING_PASSWORD_ITEMS},e.$watch("password",function(){var t=i();e.passwordValue=t.passwordValue,e.instanceName=t.instanceName}),e.$watch("osKind",function(){e.passwordOptions.loginName=e.osKind=="windows"?"administrator":"root"})}return{restrict:"EA",templateUrl:i.Constant.PARTIALS_PATH+"orderConfirm/passwordWrapper.html",replace:!0,scope:{setupPasswordValue:"=",passwordValue:"=",instanceName:"=",osKind:"@"},compile:function(t,n){return{post:e}}}}]),r}),define("ecsbuy/base/directives/orderConfirm/dateTimePicker",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","../../cons/cons","../../helpers/buyUtils","../../helpers/dateParseHelper"],function(e,t,n,r,i,s,o,u){return r.directive("aliyunBuyEcsDateTimePicker",[function(){function e(e,t,r){var s,a,f,l,c,h;i.setDefault(e,{options:{},detail:{},value:""});var p=function(t){t!=undefined?e.value=new Date(t):e.value=undefined},d=function(t){var r;if(e.defaultValue!=undefined){var i=o.BuyUtils.optimateTimeString(e.defaultValue);r=o.BuyUtils.isNaNWarp(Date.parse(i))}if(n.isFunction(t)){var s=t(r);p(s)}};e.$watch("value",function(t){if(t!=undefined){var n=o.BuyUtils.optimateTimeString(t),r=o.BuyUtils.isNaNWarp(Date.parse(n.toString())),i=o.BuyUtils.optimateTimeString(e.options.min),s=o.BuyUtils.optimateTimeString(e.options.max),u=o.BuyUtils.isNaNWarp(Date.parse(i)),a=o.BuyUtils.isNaNWarp(Date.parse(s));o.BuyUtils.hasUndefined(r)||(r<u?p(u):r>a&&p(a))}}),e.$watchCollection("[options.min,options.max]",function(t){var n=o.BuyUtils.optimateTimeString(t[0]),r=o.BuyUtils.optimateTimeString(t[1]),i=o.BuyUtils.isNaNWarp(Date.parse(n)),p=o.BuyUtils.isNaNWarp(Date.parse(r));if(!o.BuyUtils.hasUndefined(i,p)){var v=new Date(i),m=new Date(p);s=u.DateParseHelper.getDayStartStampFromDate(v),f=u.DateParseHelper.getHourStartStampFromDate(v),c=u.DateParseHelper.getMinuteStartStampFromDate(v),a=u.DateParseHelper.getDayStartStampFromDate(m),l=u.DateParseHelper.getHourStartStampFromDate(m),h=u.DateParseHelper.getMinuteStartStampFromDate(m),d(function(e){return e?i<e&&e<p?e:e<=i?i:p:undefined})}else if(!o.BuyUtils.hasUndefined(i)){var v=new Date(i);s=u.DateParseHelper.getDayStartStampFromDate(v),f=u.DateParseHelper.getHourStartStampFromDate(v),c=u.DateParseHelper.getMinuteStartStampFromDate(v),a=undefined,l=undefined,h=undefined,d(function(e){return e?i<e?e:i:undefined})}else if(!o.BuyUtils.hasUndefined(p)){var m=new Date(p);s=undefined,f=undefined,c=undefined,a=u.DateParseHelper.getDayStartStampFromDate(m),l=u.DateParseHelper.getHourStartStampFromDate(m),h=u.DateParseHelper.getMinuteStartStampFromDate(m),d(function(e){return e?e<p?e:p:undefined})}else s=undefined,f=undefined,c=undefined,a=undefined,l=undefined,h=undefined,d(function(e){return e?e:undefined});e.viewModel={minDayStamp:s,maxDayStamp:a,minHourStamp:f,maxHourStamp:l,minMinuteStamp:c,maxMinuteStamp:h}})}return{restrict:"EA",templateUrl:s.Constant.PARTIALS_PATH+"orderConfirm/dateTimePicker.html",replace:!0,scope:{options:"=",value:"=",defaultValue:"=",detail:"=",config:"&"},compile:function(t,n){return i.require(["options","value","detail"],n),{post:e}}}}]),r}),define("ecsbuy/base/directives/orderConfirm/_base",["require","exports","./common","./clouddisk","./volume","./prepay","./postpay","./recommendCode","./passwordWrapper","./dateTimePicker"],function(e,t){}),define("ecsbuy/base/directives/network/vpcSelect",["require","exports","angular","../directives","common/helper/i18nHelper","dominator/base/helpers/constraintHelper","dominator/base/helpers/moduleHelper","../../helpers/homeConfigHelper","../../helpers/commodityHelper","../../helpers/buyUtils","../../cons/cons","../../cons/buyBizCons"],function(e,t,n,r,i,s,o,u,a,f,l,c){r.directive("aliyunBuyEcsVpc",["$q","aliyunBuyEcsRemoteService","aliyunBuyConfigurable","aliyunBuyEcsBlockListService",function(e,t,r,h){return{restrict:"EA",templateUrl:l.Constant.PARTIALS_PATH+"network/aliyunBuyEcsVpc.html",scope:{options:"=",value:"=",valueAll:"=",defaultValueVpcId:"=?",defaultValueVswitchId:"=?",raw:"=",config:"&"},replace:!0,link:function(l,p,d){function E(e,t,n){if(h.inBlockList("ecsBuyDefaultVPC")){if(!f.BuyUtils.getMapProperty(t,"items.0.value")&&f.BuyUtils.getMapProperty(e,"0.value")=="random"&&e.length==1){var r=u.HomeConfigHelper.getUrlConfig("vpcConsole");v.tip=i.i18n("TIP__TEXT__VPC_REQUIRED_TIP",r);return}v.tip=M()}t?(v.vpcItems=e.concat(t.items),v.fetchConfigForVpc.totalCount=t.totalCount):v.vpcItems=e,S(e,t,n)}function S(e,r,i){var o=l.defaultValueVpcId,u=l.valueAll,a=v.vpcItems;if(!a||!n.isArray(a))return;if(o&&!s.contains(a,o,"value")){var f={pageNumber:1,pageSize:m,regionId:u.region,isDefault:undefined,vpcId:o};t.describeVpcs(f).then(function(e){var t=v.fetchConfigForVpc.resultsHandler(e);!t.items||t.items.length==0?l.vpcId=a[0]&&a[0].value:(v.vpcItems=a.concat(t.items),l.vpcId=o)})}else o?l.vpcId=o:!r||r.items.length==0?l.vpcId=a[0]&&a[0].value:r&&r.items.length==1?l.vpcId=r.items[0]&&r.items[0].value:l.vpcId=undefined}function x(e,t,n,r,s){if(h.inBlockList("ecsBuyDefaultVPC")){if(!f.BuyUtils.getMapProperty(t,"items.0.value")&&f.BuyUtils.getMapProperty(e,"0.value")=="random"&&e.length==1){var o=u.HomeConfigHelper.getUrlConfig("vpcConsole");v.tip=i.i18n("TIP__TEXT__VSW_REQUIRED_TIP",o);return}v.tip=M()}t?(v.vswitchItems=e.concat(t.items),v.fetchConfigForVSwitch.totalCount=t.totalCount):v.vswitchItems=e,T(e,t,s),v.vswitchItems.length==0?v.vswitchHoverTip=O(n,r):v.vswitchHoverTip=undefined}function T(e,r,i){var o=l.defaultValueVswitchId,u=v.vswitchItems,a=l.valueAll;if(!u||!n.isArray(u))return;if(o&&!s.contains(u,o,"value")){var f=A(),c=l.vpcId,h={pageNumber:1,pageSize:m,regionId:a.region,zoneId:f,vpcId:c,isDefault:undefined,vSwitchId:o};t.describeVSwitches(h).then(function(e){var t=v.fetchConfigForVSwitch.resultsHandler(e);!t.items||t.items.length==0?l.vswitchId=u[0]&&u[0].value:(v.vswitchItems=u.concat(t.items),l.vswitchId=o)})}else if(o)l.vswitchId=o;else if(a.zone=="random")!l.vpcId||!!r&&r.items.length!=0||!!i&&i.items.length!=0?l.vswitchId=null:l.vswitchId=u[0]&&u[0].value;else if(!l.vpcId)l.vswitchId=null;else if(!r||r.items.length==0){var p=u[0];l.vswitchId=p&&p.value,l.vswitchId=p&&p.value}else if(r.items.length==1){var d=r.items[0];l.vswitchId=d&&d.value}else l.vswitchIdFromInitZoneId?l.vswitchId=l.vswitchIdFromInitZoneId:l.vswitchId=undefined}function N(e){var t=l.options.vswitchItems;if(t&&n.isArray(t))for(var r=0;r<t.length;r++){var i=t&&t[r];if(i&&i.value==e)return i.zoneId}}function C(e){if(!v.vpcItems||!n.isArray(v.vpcItems))return!1;for(var t=0;t<v.vpcItems.length;t++){var r=v.vpcItems[t];if(r.value==e&&r.isDefault==1)return!0}return!1}function k(e){if(l.valueAll&&a.CommodityHelper.getNetworkType(l.valueAll.networkType)=="vpc"){var t=N(e);if(!L(t))return;l.valueAll.vSwitchZone=N(e),l.vswitchIdFromInitZoneId=e}else l.vswitchIdFromInitZoneId=undefined}function L(e){var t=l.raw&&l.raw.components.vm_iz&&l.raw.components.vm_iz.vm_iz,r=!1,s="";v.zoneTip="",v.zoneNoStock=!1;if(t&&n.isArray(t))for(var o=0;o<t.length;o++){var u=t[o];if(u.value==e){r=!0,s=u.text;break}}return!r&&e?(v.zoneNoStock=!0,v.zoneTip='<span class="bk-red"><i class="icon-no-1"></i>&nbsp;'+i.i18n("TIP__TEXT__VPC_ZONE_CLOSE_TIP")+"</span>"):e&&(v.zoneTip=i.i18n("TIP__TEXT__VPC_ZONE_TIP",s)),r}function A(){var e=l.valueAll,t=e.zone=="random"?undefined:e.zone;return t}function O(e,t){var n=u.HomeConfigHelper.getUrlConfig("vswitchDetail",e,t),r="_self";return u.HomeConfigHelper.isForService()||(n="https://vpc.console.aliyun.com/#/vpc/"+e+"/detail/"+t+"/switch",r="_blank"),i.i18n("HOVER_TIP__TEXT__NO_VSWITCH_TIP",n,r)}function M(){var e=l.valueAll&&l.valueAll.region||"",t=f.BuyUtils.getMapProperty(l.raw,"config.region_map."+e),n="";return t?n=u.HomeConfigHelper.getUrlConfig("vpcConsoleListUrl",t):n=u.HomeConfigHelper.getUrlConfig("vpcConsoleUrl",t),i.i18n("TIP__TEXT__VPC_COMMON_TIP",n)}r.apply(l),o.setDefault(l,{options:{}}),l.options.vpcPlaceholder=i.i18n("ecs.buy.component.vpc.placeholder"),l.options.vswitchPlaceholder=i.i18n("ecs.buy.component.vswitch.placeholder"),o.setDefault(l.options,{name:"",vpcLong:!0,vSwitchLong:!0,zoneNoStock:!1});var v=l.options,m=50,g=c.BuyBizCons.DEFAULT_VPC_ITEMS,y=c.BuyBizCons.DEFAULT_VSWITCH_ITEMS,b="["+i.i18n("ecs.buy.component.vpc.defaultPrefix")+"]";v.ipTip=undefined;var w=l.valueAll;l.options.fetchConfigForVpc={pageSize:10,initialPageNumber:2,fetchData:function(e,n){var r=!1,i={pageNumber:e,pageSize:n,regionId:w.region,isDefault:r};return t.describeVpcs(i)},resultsHandler:function(e){var t=[];try{t=e.Vpcs.Vpc}catch(r){}var i={totalCount:e.TotalCount,items:[]};return n.forEach(t,function(e,t){var n=e.VpcName?e.VpcName:e.VpcId;e.IsDefault==1&&(n=b+n),i.items.push({value:e.VpcId,isDefault:e.IsDefault,text:n})}),i}},l.options.fetchConfigForVSwitch={pageSize:50,initialPageNumber:2,fetchData:function(e,n){var r=!1,i=l.valueAll,s={pageNumber:e,pageSize:n,regionId:i.region,zoneId:i.zone=="random"?undefined:i.zone,vpcId:l.vpcId,isDefault:r};return t.describeVSwitches(s)},resultsHandler:function(e){var t=e.VSwitches.VSwitch,r={totalCount:e.TotalCount,items:[]};return n.forEach(t,function(e,t){var n=e.VSwitchName?e.VSwitchName:e.VSwitchId;e.IsDefault==1&&(n=b+n),r.items.push({value:e.VSwitchId,text:n,isDefault:e.IsDefault,zoneId:e.ZoneId,availableIpCount:e.AvailableIpAddressCount})}),r}},l.$watch("raw",function(e){if(!e)return;var t=e.config;v.loggedIn=!!t.aliyun_uid}),l.$watchCollection("[valueAll.region, defaultValueVpcId]",function(){var r=l.valueAll;if(!r||!r.region)return;v.tip=M(),v.vpcItems=undefined;if(!v.loggedIn){E(g);return}var i=e.defer(),s=i.promise,o=e.defer(),u=o.promise;e.all([s,u]).then(function(e){var t=e[0],r=e[1],i=n.isArray(r.items)&&r.items.length>0,s;i?s=r.items:i||(s=g),E(s,t,r)},function(e){});var a=!0,f=1,c={pageNumber:f,pageSize:m,regionId:r.region,isDefault:a};t.describeVpcs(c).then(function(e){o.resolve(v.fetchConfigForVpc.resultsHandler(e))});var h=n.extend({},c,{isDefault:!1});t.describeVpcs(h).then(function(e){i.resolve(v.fetchConfigForVpc.resultsHandler(e))})}),l.$watchCollection("[vpcId, valueAll.zone, defaultValueVswitchId]",function(){var r=l.valueAll;l.options&&(l.options.state="",r&&L(r.zone));if(!r||!r.zone)return;v.vswitchItems=undefined;var i=l.vpcId,s=l.raw&&l.raw.config&&l.raw.config.region_map,o=s&&s[r.region],u=e.defer(),a=u.promise,f=e.defer(),c=f.promise;if(!i||i=="random"){x(y,null,o,i);return}e.all([a,c]).then(function(e){var t=e[0],s=e[1],u=n.isArray(s.items)&&s.items.length>0,a=r.zone=="random",f=[];u?f=s.items:!u&&(i=="random"||C(i))&&(f=y),x(f,t,o,i,s)});var h=!0,p=1,d=r.zone=="random"?undefined:r.zone,g={pageNumber:p,pageSize:m,regionId:r.region,zoneId:d,vpcId:i,isDefault:h};t.describeVSwitches(g).then(function(e){f.resolve(v.fetchConfigForVSwitch.resultsHandler(e))});var b=n.extend({},g,{isDefault:!1});t.describeVSwitches(b).then(function(e){u.resolve(v.fetchConfigForVSwitch.resultsHandler(e))}),v.ipTip=undefined}),l.$watch("vswitchId",function(){l.options&&(l.options.state="");var e=l.valueAll;l.vpcId&&l.vswitchId&&l.options.vswitchItems&&e.zone=="random"&&k(l.vswitchId)}),l.$watchCollection("[options.vswitchDetail, vpcId, options.zoneNoStock]",function(){var e=v.vswitchDetail,t=e&&e.availableIpCount,r=e&&e.isDefault,s=[l.vswitchId,t,l.vpcId,r,v.zoneNoStock];l.value=n.toJson(s),t==0?v.ipTip='<span class="bk-form-status bk-form-error bk-ml1"> <i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message">'+i.i18n("ECS_VPC_FAIL_ON_NO_PRIVATE_IP","ECS")+"</span> </span>":t>0?v.ipTip='<span class="bk-form-status-message">'+i.i18n("ECS_VPC_AVAILABLE_IP_COUNT",t)+"</span>":v.ipTip=undefined})}}}])}),define("ecsbuy/base/directives/network/networkInterface",["require","exports","angular","../directives","common/helper/i18nHelper","dominator/base/helpers/moduleHelper","../../cons/cons"],function(e,t,n,r,i,s,o){r.directive("aliyunBuyEcsNetworkInterface",["base64","aliyunBuyEcsRemoteService","$timeout",function(e,t,r){return{restrict:"EA",templateUrl:o.Constant.PARTIALS_PATH+"network/networkInterface.html",scope:{value:"=",valueAll:"="},replace:!0,link:function(e){function l(){e.addible=!0,r.slaves=[],e.value.vSwitchValues=[],e.value.vSwitchStates=[],e.value.interfaceValues=[],a.items=undefined}function c(){return r.slaves.length>=f?!0:!1}s.config(e,{masterInterfaceValue:"",value:{interfaceValues:[],vSwitchValues:[],vSwitchStates:[]},vSwitch:{options:{}},"interface":{}});var r=e.interface;r.options={items:[{value:"newInterface",text:""}]};var o="["+i.i18n("ecs.buy.component.vpc.defaultPrefix")+"]",u=[{value:"random",text:i.i18n("ecs.buy.component.vpc.defaultVSwitch")}],a=e.vSwitch.options;a.vSwitchPlaceholder=i.i18n("ecs.buy.component.vpc.placeholder"),a.fetchConfigForVSwitch={pageSize:10,initialPageNumber:2,fetchData:function(n,r){var i=e.valueAll,s={pageNumber:n,pageSize:r,regionId:i.region,zoneId:i.zoneId,vpcId:i.vpcId};return t.describeVSwitches(s)},resultsHandler:function(e){var t=e&&e.VSwitches&&e.VSwitches.VSwitch,r={totalCount:e.TotalCount,items:[]};return r.totalCount==0?(r.items=u,r):(n.forEach(t,function(e,t){var n=e.VSwitchName?e.VSwitchName:e.VSwitchId;e.IsDefault==1&&(n=o+n),r.items.push({value:e.VSwitchId,text:n,isDefault:e.IsDefault,zoneId:e.ZoneId,availableIpCount:e.AvailableIpAddressCount})}),r)}};var f=1;e.addible=!0,r.slaves=[],e.addInterface=function(){if(c()){e.addible=!1;return}r.slaves.push(1),c()&&(e.addible=!1)},e.removeInterface=function(t){e.addible=!0,r.slaves.splice(t,1),e.value.vSwitchValues.splice(t,1),e.value.vSwitchStates.splice(t,1),e.value.interfaceValues.splice(t,1)},e.$watch("valueAll.regionId",function(){l()}),e.$watch("valueAll.status",function(e){e=="disabled"&&l()})}}}])}),define("ecsbuy/base/directives/securityGroup/ecsSecurityGroup",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","common/helper/i18nHelper","../../cons/cons","../../helpers/homeConfigHelper","../../helpers/commodityHelper","../../helpers/buyUtils","../../helpers/methodHelper","../../cons/buyBizCons"],function(e,t,n,r,i,s,o,u,a,f,l,c){r.directive("aliyunBuyEcsSecurityGroup",["$filter","$q","$timeout","aliyunBuyDialog","aliyunBuyEcsRemoteService","aliyunBuyPriceQuerier","aliyunBuyEcsBlockListService",function(e,t,r,h,p,d,v){return{restrict:"EA",templateUrl:o.Constant.PARTIALS_PATH+"securityGroup/aliyunBuyEcsSecurityGroup.html",scope:{options:"=",value:"=",groupRuleValue:"=?",detail:"=",config:"&",raw:"=",valueAll:"=",defaultValueSgId:"="},replace:!0,compile:function(e,r){return i.require(["options","value","detail"],r),{post:function(e,r,m){function C(r){var i=e.raw;if(!i)return;var s=i.config,o=e.valueAll;e.loggedIn=a.CommodityHelper.isLogin(i),M(E.AUTOCREATE,null,null),e.hasSecurityGroup=!1,g.state="",y.text="";if(!e.loggedIn)return;if(D(o.networkType,o.vpc))return;var c=i.components.vm_region_no.vm_region_no;g.regionName=a.CommodityHelper.getTextFromCollection(o.region,c),g.regionAlias=s.region_map&&s.region_map[o.region],g.createSecurityGroupLink=k(g.regionAlias),g.chooseSecurityGroupTipsLink=u.HomeConfigHelper.getUrlConfig("chooseSecurityGroupTipsLink"),g.direction=a.CommodityHelper.getNetworkType(o.networkType)=="vpc"?"intranetIngress":"internetIngress";var h=1,v=P(h,undefined,undefined),m=new d(p.queryEcsSecurityGroupList),b=t.defer(),w=b.promise;m.promise.then(null,null,function(t){if(!t.pending){var n=t.data||{},r=n.TotalCount;e.hasSecurityGroup=parseInt(r)>0;var i=e.hasSecurityGroup;i||(g.defaultTypes.value=null),b.resolve(i)}}),m.query.call(m,v),w.then(function(e){var t=l.MethodHelper.getArrayFromListMapByKey(g.defaultTypes.items,"value")||[];if(!r)M(E.SELECTONE,null,null);else if(!e){var s=t.indexOf(r);if(s!=-1){g.defaultTypes.value=g.defaultTypes.items[s].value;var o=g.defaultTypes.value,u=f.BuyUtils.getSelectItem(g.defaultTypes.items,o,!0).text;M(E.AUTOCREATE,u,o)}}else{var i=P(h,r,undefined);i.isQueryEcsCount=!0,p.queryEcsSecurityGroupList(i).then(function(e){var t=e&&e.TotalCount;if(t>0){var i=f.BuyUtils.getMapProperty(e,"SecurityGroups.SecurityGroup");i&&n.forEach(i,function(e){e.SecurityGroupId==r&&A(e)})}})}})}function k(e){if(!e)return s.i18n("ecs.buy.componnet.securityGroup.new");var t=u.HomeConfigHelper.getUrlConfig("createSecurityGroup",e);return'<a href="'+t+'" class="bk-lnk" target="_blank" data-spm-click="gostr=/aliyun;locaid=gosecuritycreate">&nbsp;'+s.i18n("ecs.buy.componnet.securityGroup.new")+"></a>"}function L(e,t,n){if(!e)return s.i18n("ECS_CONSOLE");var r=u.HomeConfigHelper.getUrlConfig("securityGroupRule",e,t,n),i="blank";return r||(r="https://ecs.console.aliyun.com/#/securityGroupDetail/region/"+e+"/groupId/"+t+"/rule/"+n),'<a href="'+r+'" class="bk-lnk" data-spm-click="gostr=/aliyun;locaid=gosecurityconsole" target="'+i+'">&nbsp;'+s.i18n("ECS_CONSOLE")+">&nbsp;</a>"}function A(t,n){e.options.currentSecurityGroupId=t.SecurityGroupId,e.detail.access=!0,n&&n.close(),M(E.SELECTONE,t.SecurityGroupName,t.SecurityGroupId),t.SecurityGroupName?e.detail.text=t.SecurityGroupName+" / "+t.SecurityGroupId:e.detail.text=t.SecurityGroupId,g.createSecurityRuleLink=L(g.regionAlias,t.SecurityGroupId,g.direction),p.queryLimitation({limitation:"SecurityGroupMembers"}).then(function(n){if(!n)return;e.detail.EcsCount=t.EcsCount,e.detail.EcsCountRemain=n.Value-t.EcsCount})}function O(e,t){var n=e.SecurityGroupId,r=h.open({windowClass:"security-dialog",backdropClass:"security-backdrop",templateUrl:o.Constant.PARTIALS_PATH+"securityGroup/aliyunBuyEcsSecurityRiskDialog.html",controller:["$scope","$http",function(i,s){function o(e){i.isLoading=!1,i.cloneResult="failed",i.cloneResultMessage=e&&e.message}i.useSafetySg=function(){i.isLoading=!0,i.cloneResult="empty",p.getToken().then(function(e){var i={regionId:t.region,targetRegionId:t.region,securityGroupId:n,secToken:e,description:"Clone from "+n};p.cloneSecurityGroupSafety(i).then(function(e){A(e,r)},function(e){o(e)})},function(e){o(e)})},i.useRiskySg=function(){A(e,r)}}]})}function M(t,r,i){b.type=t,b.text=r||null,b.value=i||null,e.options.state="",e.value=n.toJson([b.type,b.text,b.value])}function _(e){if(!e)return null;var t=n.fromJson(e);return t&&t[2]}function D(e,t){return t?a.CommodityHelper.getNetworkType(e)=="vpc"&&_(t)=="random"?!0:!1:null}function P(t,n,r){var i=e.valueAll,s=a.CommodityHelper.getNetworkType(i.networkType),o=s=="vpc"?_(i.vpc):undefined,u=H();return u.regionId=i.region,u.vpcId=o,u.networkType=a.CommodityHelper.getNetworkType(i.networkType),u.fuzzyQuery=!1,u.isQueryEcsCount=!1,u.securityGroupId=n,u.securityGroupName=r,u.pageNumber=t,u.pageSize=S,u}function H(){return{regionId:"",vpcId:"",networkType:"",isQueryEcsCount:undefined,fuzzyQuery:undefined,securityGroupId:"",securityGroupName:"",pageNumber:"",pageSize:undefined}}e.hideSecurityGroup=v.inBlockList("ecsPageSecurityGroup"),i.setDefault(e,{options:{},detail:{}}),i.setDefault(e.options,{name:s.i18n("ecs.buy.label.securityGroup"),types:[],displayAutoCreateTip:!1,valueObject:{},securityListObject:{},newSecurityName:{},securityNameValidate:!0,securityQuotaValidate:!0,securityInstanceQuotaValidate:!0,region:{},quota:{},displayGroupRule:{icmp:s.i18n("ecs.buy.componnet.securityGroup.icmp"),sshAndRdp:s.i18n("ecs.buy.componnet.securityGroup.sshAndRdp"),http:s.i18n("ecs.buy.componnet.securityGroup.tcp:80"),https:s.i18n("ecs.buy.componnet.securityGroup.tcp:443")},groupRule:{},http80Intro:s.i18n("HOVER_TIP__TEXT__SECURITY_HTTP_80_INTRO"),groupRuleIntro:s.i18n("HOVER_TIP__TEXT__SECURITY_GROUP_RULE_INTRO"),sshAndRdpIntro:s.i18n("HOVER_TIP__TEXT__SECURITY_SSH_AND_RDP_INTRO")});var g=e.options;g.defaultTypes={placeholder:s.i18n("ecs.buy.componnet.securityGroup.placeholder"),items:c.BuyBizCons.DEFAULT_SECURITY_GROUP_ITEMS};var y=e.detail,b=g.valueObject,w=g.newSecurityName,E={AUTOCREATE:"1",SELECTONE:"2",CREATENEW:"3"},S=9,x=[];p.queryLimitation({limitation:"SecurityGroupMembers"}).then(function(e){if(!e)return;g.quota=e.Value}),e.getNetworkType=function(e){return a.CommodityHelper.getNetworkType(e)},e.$watchCollection("[valueAll.vpc, valueAll.region, valueAll.networkType, defaultValueSgId]",function(t,n){if(!t[0]||!t[1]||t[2]==null||t==undefined)return;var r=_(t[0]),i=_(n[0]),s=a.CommodityHelper.getNetworkType(t[2]);r=="random"&&s=="vpc"?g.defaultTypes.items=[c.BuyBizCons.DEFAULT_SYSTEM_SECURITY_GROUP_ITEM]:g.defaultTypes.items=c.BuyBizCons.DEFAULT_SECURITY_GROUP_ITEMS;var o=e.defaultValueSgId;C(o)}),e.$watchCollection("[options.defaultTypes.detail.text, options.defaultTypes.value]",function(){if(g.defaultTypes&&g.defaultTypes.value){var e=g.defaultTypes.detail&&g.defaultTypes.detail.text,t=g.defaultTypes.value;M(E.AUTOCREATE,e,t)}}),e.$watch("valueAll.allocatePublicIP",function(t){t=="enabled"&&(e.options.groupRule.sshAndRdp=!0),t=="disabled"&&(e.options.groupRule.sshAndRdp=!1)});var T={http:"tcp:80/80",https:"tcp:443/443"},N=f.BuyUtils.reverseMap(T);e.$watchCollection("[options.groupRule.http, options.groupRule.https]",function(){if(!e.options.groupRule)return;var t=e.options.groupRule,n=[];t.http&&n.push(T.http),t.https&&n.push(T.https),e.groupRuleValue=n.join(",")}),e.$watch("groupRuleValue",function(t){if(!t)return;var r=t.split(",");n.forEach(r,function(t){if(t){var n=N[t];e.options&&e.options.groupRule&&(e.options.groupRule[n]=!0)}})}),e.openSecurityGroups=function(){e.options.state="";var t=h.open({windowClass:"security-dialog",backdropClass:"security-backdrop",templateUrl:o.Constant.PARTIALS_PATH+"securityGroup/aliyunBuyEcsSecurityDialog.html",controller:["$scope","$http",function(n,r){function s(e,t){n.isLoading=!0;var r=null,i=null;e&&t&&(r=e=="id"?t:null,i=e=="name"?t:null);var s=n.security.currentPage,o=P(s,r,i);o.fuzzyQuery=!0,o.isQueryEcsCount=!0,p.queryEcsSecurityGroupList(o).then(function(e){n.isLoading=!1,n.isReady=!0;if(!e||!e.SecurityGroups){n.security.securityList=[];return}n.security.securityList=e.SecurityGroups.SecurityGroup,n.hasRiskySecurityGroup=e.hasRiskySecurityGroup,n.totalItems=e.TotalCount})}n.hideSecurityGroup=e.hideSecurityGroup,i.setDefault(n,{security:{},searchModel:{},searchFields:[{text:"",value:"name"},{text:"ID",value:"id"}]}),i.setDefault(n.searchModel,{key:"",type:"name"}),n.loggedIn=!e.options.needLogin,n.isReady=!1,n.isLoading=!1,n.security.currentPage=1,n.itemsPerPage=S,n.regionName=e.options.regionName,s(),n.$watch("security.currentPage",function(e,t){if(e==t)return;var r=n.searchModel.key,i=n.searchModel.type;s(i,r)}),n.clearKey=function(){n.searchModel.key=""},n.search=function(){var e=n.searchModel.key,t=n.searchModel.type;s(t,e)},n.enterSearch=function(e){e.which==13&&n.search()},n.useSecurity=function(r){var i=n.hasRiskySecurityGroup,s=e.valueAll;if(!i||a.CommodityHelper.getNetworkType(s.networkType)=="vpc"){A(r,t);return}var o={regionId:s.region,securityGroupId:r.SecurityGroupId};n.isLoading=!0,p.checkRiskSecurityGroup(o).then(function(e){if(!e){A(r,t);return}t.close(),O(r,s)},function(){A(r,t)})},n.viewGroupRule=function(e,t){e.stopPropagation();var n={regionAlias:g.regionAlias,securityGroupId:t.SecurityGroupId,direction:g.direction};p.linkToEcsSecurityGroupRulePage(n)}}]})}}}}}}])}),define("ecsbuy/base/directives/ecsBuyIoSelectDirective",["require","exports","./directives","../helpers/buyUtils"],function(e,t,n,r){var i=function(){function e(){this.template='<div class="bk-form-row-li">\n                <div class="bk-ecs-iooptimized" aliyun-buy-checkbox ng-model="formValue.selectValue" display="display" read-only="readOnly"></div>\n                <span aliyun-buy-inline-tips></span>\n              </div>',this.scope={options:"=",value:"=ngModel"}}return e.prototype.compile=function(e,t,n){return{pre:function(e,t,n){function o(e){s.selectValue=e==i.selectedValue}function u(t){e.value=t}function a(){var t=e.options||{},n=t.items||[],i;if(n.length>1){i=r.BuyUtils.getSelectItem(n,e.value,!1);var s=r.BuyUtils.getSelectItem(n,"optimized",!1);e.display=s.text,e.readOnly=!1}else i=r.BuyUtils.getSelectItem(n,e.value,!1),e.display=i.text,e.readOnly=!0;u(i.value),o(i.value)}e.formValue={selectValue:!1};var i={selectedValue:"optimized",nonSelectValue:"none"},s=e.formValue;e.$watch("formValue.selectValue",function(t,n){t!=n&&(e.value=s.selectValue?i.selectedValue:i.nonSelectValue)}),e.$watch("value",function(e){e&&o(e)}),e.$watch("options.items",function(e){e&&a()})}}},e.factory=function(){var t=function(){return new e};return t.$inject=[],t},e.directiveName="ecsIoSelect",e}();n.directive(i.directiveName,i.factory())}),define("ecsbuy/base/helpers/dataSpmHelper",["require","exports"],function(e,t){var n=function(){function e(){}return e.setPageSPM=function(e,t,n,r){var i=this;if(window.goldlog&&window.goldlog.setPageSPM){window.goldlog.setPageSPM(e,t,n,r);return}if(i.count<=0)return;setTimeout(function(){i.count--,i.setPageSPM(e,t,n,r)},1e3)},e.getSPMFromBodyTag=function(){if(!jQuery)return;var e=jQuery(jQuery.find("body")[0]);return e&&e.attr("data-spm")},e.count=6,e}();t.DataSpmHelper=n}),define("ecsbuy/base/directives/common/dataSpm",["require","exports","../directives","../../helpers/dataSpmHelper"],function(e,t,n,r){return n.directive("aliyunBuyEcsDataSpm",[function(){return{restrict:"EA",scope:{spmB:"@"},link:function(e){window.location.host&&window.location.host.indexOf("ecs.console")>-1&&(e.spmB+="Console");var t=r.DataSpmHelper.getSPMFromBodyTag();r.DataSpmHelper.setPageSPM(null,e.spmB),e.$on("$destroy",function(){r.DataSpmHelper.setPageSPM(null,t)})}}}]),n}),define("ecsbuy/base/directives/common/buyHistory",["require","exports","../../cons/cons","angular","../directives","../../helpers/buyHistoryHelper"],function(e,t,n,r,i,s){i.directive("aliyunBuyHistoryFixed",["$filter","$timeout","aliyunBuyLocal","aliyunBuyPriceQuerier","aliyunBuyEcsCacheService","buyDefaultValueService","aliyunBuyEcsBlockListService","aliyunBuyEcsRemoteService","$rootScope",function(e,t,i,o,u,a,f,l,c){return{restrict:"EA",templateUrl:n.Constant.PARTIALS_PATH+"common/aliyunBuyHistoryFixed.html",replace:!0,scope:{config:"&",priceService:"=",historyService:"="},compile:function(e,t){return{pre:function(e){e.hideBuyHistory=f.inBlockList("ecsBuyHistory")},post:function(e,t,n){var i,f,l,h,p,d=[];e.$watch("historyService",function(t){var n=t;if(!n)return;var i=function(){var e=n.queryHistory;if(r.isFunction(e))return e.apply(n,h)};f=new o(i),f.promise.then(null,null,function(t){if(t.pending)e.queryingHistory=!0;else{e.queryingHistory=!1;var n=p.getComponents(),r=p.getOriginConstraintData(),i=s.BuyHistoryHelper.getHistory(t.data);s.BuyHistoryHelper.adjustResponseData(i,p,null),d=i,c.buyHistoryInstanceTypes=s.BuyHistoryHelper.getDistinctInstanceTypes(i),e.viewData=s.BuyHistoryHelper.formatHistoryViewData(t.data,n,r);var o=e.viewData.totalAmount;o==0&&(e.showOrders=!1)}})}),e.$watch("priceService",function(t){var n=t;if(!n)return;var s=function(e){var t=n.getPrice;if(!r.isFunction(t))return;return t.apply(n,l)};i=new o(s),i.promise.then(null,null,function(t){t.pending?e.calculating=!0:(e.calculating=!1,e.price=t.data)})}),e.$watch("showOrders",function(t){!t||e.$emit("aliyunBuyHistory:queryPrice",d,p)});var v=c.$on("aliyunBuyHistory:queryPrice",function(e,t,n){l=Array.prototype.slice.call(arguments,1),i&&i.query.apply(i,l)}),m=c.$on("aliyunBuyHistory:queryHistory",function(t,n,i){!i||(p=i),h=Array.prototype.slice.call(arguments,1);var s=e.historyService||{},o=s.beforeQueryHistory,u=!0;!!o&&r.isFunction(o)&&(u=o.apply(s,h)),!u||f&&f.query.apply(f,h)}),g=c.$on("aliyunBuyHistory:importConfiguration",function(t,n){if(d&&r.isArray(d)){var i=d[n],o=s.BuyHistoryHelper.getHistoryOrderParam([i]);u.sessionStorageSet("aliyun.buy.ecs.cache.orderData",r.toJson(o)),a.setDefaultValue(p,s.BuyHistoryHelper.getCommodityCode(i)),e.closeCartDialog()}});e.$on("$destroy",function(){r.isFunction(v)&&v(),r.isFunction(m)&&m(),r.isFunction(g)&&g()}),e.viewModel={showOrders:!1},e.closeCartDialog=function(){e.viewModel.showOrders=!1},e.openCartDialog=function(){e.viewModel.showOrders=!0}}}}}}]),i.directive("aliyunBuyHistoryFixedItem",[function(){return{restrict:"EA",replace:!0,templateUrl:n.Constant.PARTIALS_PATH+"common/aliyunBuyHistoryFixedItem.html",scope:{viewOrders:"=",config:"&"},compile:function(e,t){return{pre:function(e,t,n){},post:function(e,t,n){e.importConfiguration=function(t){e.$emit("aliyunBuyHistory:importConfiguration",t)}}}}}}])}),define("ecsbuy/base/directives/common/orderTerm",["require","exports","../directives","../../cons/urlConfig","../../helpers/homeConfigHelper"],function(e,t,n,r,i){return n.directive("aliyunBuyEcsOrderTerms",["$filter",function(e){return{restrict:"EA",template:'<a class="bk-order-pact-link" href="{{theOrderTermUrl}}" target="_blank">{{(orderTermText || "ECS_ORDER_TERMS") | translate}}</a>',scope:{orderTermUrl:"@",orderTermText:"@"},link:function(e){e.theOrderTermUrl=i.HomeConfigHelper.getUrlConfig("orderTermUrl")||r.UrlConfig.orderTermUrl,e.$watch("orderTermUrl",function(t){t&&(e.theOrderTermUrl=e.orderTermUrl)})}}}]),n}),define("ecsbuy/base/directives/common/timezone",["require","exports","../directives","common/helper/i18nHelper","../../cons/cons"],function(e,t,n,r,i){return n.directive("aliyunBuyEcsTimezone",[function(){return{restrict:"EA",templateUrl:i.Constant.PARTIALS_PATH+"common/timezone.html",link:function(e){var t=new Date,n=t.getTimezoneOffset(),i=n<=0?"+":"-";e.hourOffset=i+Math.abs(n/60),e.timezonetip=r.i18n("ECS_TIMEZONE_TIP",e.hourOffset),n!=-480?e.show=!0:e.show=!1}}}]),n}),define("ecsbuy/base/directives/common/orderResultView",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","../../cons/cons","../../cons/urlConfig","../../helpers/homeConfigHelper","../../helpers/commodityHelper"],function(e,t,n,r,i,s,o,u,a){return r.directive("aliyunBuyEcsOrderResultView",["aliyunBuyEcsOrderResultService","aliyunBuyEcsRemoteService","aliyunBuyEcsCacheService","aliyunBuyEcsBlockListService",function(e,t,r,f){function l(s){function p(e){var t=h.data&&h.data.length;for(var n=0;n<t;n++){var r=h.data[n];if(r&&r.requestId==e)return r}}function d(){s.ecsConsoleList=u.HomeConfigHelper.getUrlConfig("ecsConsoleList")||o.UrlConfig.ecsConsoleListUrl,s.ecsConsoleDiskListUrl=u.HomeConfigHelper.getUrlConfig("diskList")||o.UrlConfig.diskListUrl,s.ecsConsoleVolumeListUrl=u.HomeConfigHelper.getUrlConfig("volumeList")||o.UrlConfig.volumeListUrl,s.expenseOrderListUrl=u.HomeConfigHelper.getUrlConfig("expenseOrderList")||o.UrlConfig.expenseOrderListUrl,s.workorderUrl=u.HomeConfigHelper.getUrlConfig("workorderUrl")||o.UrlConfig.workorderUrl,s.is4Service=u.HomeConfigHelper.isForService(),s.hideAlipayAutoDebitTip=f.inBlockList("ecsBuyAlipayAutoDebitTip")}function v(){t.getComponents({commodityCode:l,orderType:"BUY"}).then(function(e){s.ready=!0;var t=e,r=a.CommodityHelper.getProductName(l);if(!n.isObject(t))return;n.forEach(h.data,function(e,i){var s=e;if(!s)return;if(s.OrderId)return;if(!s.code)return;var o,u,f=l=="yundisk";l=="yundisk"&&(o=s.data&&s.data.failedDisk,u=a.CommodityHelper.getViewComponentsForYundisk(t,o)),l=="volume"&&(o=s.data&&s.data.failedVolume,u=a.CommodityHelper.getViewComponentsForVolume(t,o));if(l=="ecs"||l=="vm")o=n.copy(s.data&&s.data.failedEcs),u=a.CommodityHelper.getViewComponentsForEcs(t,o),o=n.extend(o,o.commodity);if(!o||!u)return;c.push({commodityName:f?"":r,errorMessage:s.message,items:u,isRetry:o.isTimeout,requestId:s.requestId,period:o.period,periodType:o.periodType,quantity:o.maxAmount?o.maxAmount:o.amount})})},function(){s.ready=!0})}function m(e){var t=[];return n.forEach(e.data,function(e,n){e&&e.OrderId&&t.push(e.OrderId)}),t.length==0?undefined:t.join(",")}var l=s.commodityCode,c=s.failOrdersInfo=[];d(),!s.orderResult&&(s.orderResult={}),!s.retryResult&&(s.retryResult={}),s.orderResult=i.parseJsonSafe(r.sessionStorageGet("aliyun.buy."+l+".orderRemoteResult.v2"));var h=s.orderResult;if(h.failCount==0){s.orderResult.successInfo=e.getOrderResultBycommodityCode(s.commodityCode);return}h.code!=="200"?s.orderResult.failInfo=e.getOrderErrorResultBycommodityCode(s.commodityCode,h.message):h.failCount>0&&(s.orderResult.failInfo=e.getOrderErrorResultBycommodityCode(s.commodityCode)),s.ready=!1,h.payId=m(h),s.continuePay=function(){h.payId&&t.linkToOrderPayPage({orderId:h.payId})},s.retry=function(e,n,r){s.retryResult[r]="processing";var i={ecs:"createPostPayInstances",vm:"createBuyOrder",yundisk:"createDisks"},o=p(n),u=o.data&&o.data.failedEcs;if(!u)return;var a=i[e];t[a]([u]).then(function(e){var t=!0;s.retryResult[r]="successful"},function(e){s.retryResult[r]="failed"})},v()}return{restrict:"EA",templateUrl:s.Constant.PARTIALS_PATH+"common/orderResultView.html",replace:!0,scope:{commodityCode:"@",config:"="},compile:function(e,t){return i.require(["price"],t),{post:l}}}}]),r}),define("ecsbuy/base/directives/common/ecsBuyTips",["require","exports","../directives","../../cons/cons","../../helpers/buyTipsHelper"],function(e,t,n,r,i){return n.directive("ecsBuyTips",[function(){return{restrict:"EA",templateUrl:r.Constant.PARTIALS_PATH+"common/ecsBuyTips.html",scope:{spm:"@"},link:function(e,t,n){var r=e.tipType=n.tipType||"askTip";e.options={},n.$observe("tipId",function(t){r=="tip"?e.options[r]=i.BuyTipsHelper.getTip(t,r).text:e.options[r]=i.BuyTipsHelper.getTip(t,r)})}}}]),n}),define("ecsbuy/base/directives/common/ecsBuyPrice",["require","exports","../directives","../../cons/cons"],function(e,t,n,r){n.directive("aliyunBuyEcsPrice",[function(){return{restrict:"EA",templateUrl:r.Constant.PARTIALS_PATH+"common/ecsBuyPrice.html",scope:{data:"&",options:"=?"},replace:!0}}]).directive("aliyunBuyPriceViewLight",[function(){return{restrict:"EA",templateUrl:r.Constant.PARTIALS_PATH+"common/aliyunBuyPriceViewLight.html",scope:{data:"&",options:"=?"},replace:!0}}])}),define("ecsbuy/base/directives/common/subheader",["require","exports","../directives","common/helper/i18nHelper","../../cons/cons"],function(e,t,n,r,i){n.directive("aliyunBuyEcsSubheader",["$timeout","aliyunBuyEcsRemoteService","aliyunBuyEcsBlockListService",function(e,t,n){return{restrict:"EA",templateUrl:i.Constant.PARTIALS_PATH+"common/subheader.html",scope:{commodityCode:"@",inWhiteListForVolumeBuy:"="},replace:!0,link:function(t,i,s){var o={ecs:["//www.aliyun.com/lego/individuation/buy/postpay/ad1","//www.aliyun.com/lego/individuation/buy/postpay/ad"],vm:["//www.aliyun.com/lego/individuation/buy/prepay/ad1","//www.aliyun.com/lego/individuation/buy/prepay/ad"],clouddisk:["//www.aliyun.com/lego/individuation/buy/yundisk/ad1","//www.aliyun.com/lego/individuation/buy/yundisk/ad"]};t.productNameMap={volume:r.i18n("ecs.buy.component.product.volume"),clouddisk:r.i18n("ecs.buy.component.product.clouddisk"),ecs:r.i18n("ecs.buy.component.product.ecs"),vm:r.i18n("ecs.buy.component.product.ecs"),freetier:r.i18n("ecs.buy.component.product.ecs"),enterpriseFreetier:r.i18n("ecs.buy.component.product.ecs")},t.headStates=[],n.inBlockList("ecsBuyClouddisk")||(t.headStates=[{id:"clouddisk",state:"buy.prepay",title:r.i18n("ecs.buy.component.subhead.purchaseEcs")},{id:"ecs",state:"buy.clouddisk",title:r.i18n("ecs.buy.component.subhead.purchaseClouddisk")},{id:"vm",state:"buy.clouddisk",title:r.i18n("ecs.buy.component.subhead.purchaseClouddisk")}]);var u=[{id:"ecs",state:"buy.volume",title:r.i18n("ecs.buy.component.subhead.purchaseVolume")},{id:"vm",state:"buy.volume",title:r.i18n("ecs.buy.component.subhead.purchaseVolume")},{id:"volume",state:"buy.prepay",title:r.i18n("ecs.buy.component.subhead.purchaseEcs")}];t.$watch("inWhiteListForVolumeBuy",function(e){e&&!n.inBlockList("ecsBuyClouddisk")&&(t.headStates=t.headStates.concat(u))}),t.$watch("commodityCode",function(e){e&&(t.headStateId=e,t.legoData=o[e]||[])});var a=n.inBlockList("ecsBuyLego");typeof window.Aliyun_Lego_System_Manual_Init=="function"&&!a&&e(function(){window.Aliyun_Lego_System_Manual_Init()})}}}])}),define("ecsbuy/base/directives/common/ecsCoupon",["require","exports","angular","../directives","common/helper/i18nHelper","dominator/base/helpers/moduleHelper","../../cons/cons","../../cons/buyBizCons"],function(e,t,n,r,i,s,o,u){r.directive("aliyunBuyEcsCouponNew",[function(){return{restrict:"EA",templateUrl:o.Constant.PARTIALS_PATH+"common/ecsCoupon.html",scope:{coupons:"=",value:"="},link:function(e){s.setDefault(e,{detail:{},couponList:{},value:""});var t=u.BuyBizCons.COUPON_BLANK;e.$watch("coupons",function(){var r=e.coupons;if(!n.isArray(r))return;var s=[],o=t;n.forEach(r,function(e){e.isSelected&&(o=e.couponNo),s.push({value:e.couponNo,text:e.couponNo==t?i.i18n("ecs.buy.component.coupon.notUseCoupon"):e.name})}),e.couponList=s,e.value=o})}}}]),r.directive("aliyunBuyEcsCouponNewWrapper",[function(){return{restrict:"EA",templateUrl:o.Constant.PARTIALS_PATH+"common/ecsCouponWrapper.html",scope:{price:"=",value:"="},link:function(e){e.options={},e.$watch("price",function(){var t=e.price;if(!t||!t.data)return;t.data.coupons&&n.isArray(t.data.coupons)&&(e.options.couponList=t.data.coupons)},!0),e.$watch("options.couponNo",function(){e.value=e.options.couponNo})}}}])}),define("ecsbuy/base/directives/common/ecsBuyOrderButton",["require","exports","../directives","../../cons/cons"],function(e,t,n,r){n.directive("aliyunBuyEcsOrderButton",[function(){return{restrict:"EA",templateUrl:r.Constant.PARTIALS_PATH+"common/ecsBuyOrderButton.html",link:function(e){var t=e.purchase;e.purchase=function(){e.checked&&!e.payDisabled&&t()}}}}])}),define("ecsbuy/base/directives/common/thresholdTip",["require","exports","../directives","../../helpers/homeConfigHelper","common/helper/i18nHelper"],function(e,t,n,r,i){n.directive("aliyunBuyEcsThreshold",["aliyunBuyEcsBlockListService",function(e){return{restrict:"EA",template:'<span ng-bind-html="thresholdTip"></span>',link:function(t){e.inBlockList("ecsBuyThresholdTip")||(t.thresholdTip=i.i18n("ECS_DDOS_THRESHOLD",r.HomeConfigHelper.getUrlConfig("bandwidthMoreTips"),"_blank",r.HomeConfigHelper.getUrlConfig("bandwidthDDosTips"),"_blank"))}}}])}),define("ecsbuy/base/directives/common/buttontabLight",["require","exports","../directives","../../cons/cons","../../helpers/buyUtils"],function(e,t,n,r,i){return n.directive("aliyunBuyButtontabLight",[function(){return{restrict:"EA",templateUrl:r.Constant.PARTIALS_PATH+"common/buttontabLight.html",scope:{items:"=",value:"="},link:function(e){e.select=function(t){if(!t)return;e.value=t.value},e.$watchCollection("[value, items]",function(t){var n=t[0],r=t[1],s=i.BuyUtils.getSelectItem(r,n,!1);e.value=s&&s.value})}}}]),n}),define("ecsbuy/base/directives/common/ecsDescription",["require","exports","../directives","dominator/base/helpers/moduleHelper","../../cons/cons"],function(e,t,n,r,i){return n.directive("aliyunBuyEcsDescription",["$filter",function(e){return{restrict:"EA",templateUrl:i.Constant.PARTIALS_PATH+"common/description.html",scope:{options:"=",value:"="},replace:!0,compile:function(t,n){return r.require(["options","value"],n),{pre:function(t){r.setDefault(t,{detail:{},options:{},value:""}),t.valid=!0,t.blur=function(){t.valid=!0,t.value=e("json")([t.description,!0]);if(!t.description||t.description.length==0)return;/^(?!http:\/\/)(?!https:\/\/)[\s\S]{2,256}$/.test(t.description)||(t.valid=!1,t.value=e("json")([t.description,!1]))},t.focus=function(){t.valid=!0}}}}}}]),n}),define("ecsbuy/base/directives/common/ecsLabel",["require","exports","../directives","dominator/base/helpers/moduleHelper","../../cons/cons"],function(e,t,n,r,i){return n.directive("aliyunBuyEcsLabel",["$filter",function(e){return{restrict:"EA",templateUrl:i.Constant.PARTIALS_PATH+"common/ecsLabel.html",scope:{value:"=",detail:"="},replace:!0,compile:function(e,t){return r.require(["value"],t),{pre:function(e){}}}}}]),n}),define("ecsbuy/base/directives/common/_base",["require","exports","./dataSpm","./buyHistory","./orderTerm","./timezone","./orderResultView","./ecsBuyTips","./ecsBuyPrice","./subheader","./ecsCoupon","./ecsBuyOrderButton","./thresholdTip","./buttontabLight","./ecsDescription","./ecsLabel"],function(e,t){}),define("ecsbuy/base/directives/simpleBuy/simpleBuy.SelectClass",["require","exports","../directives","../../cons/cons"],function(e,t,n,r){function i(){return{templateUrl:r.Constant.PARTIALS_PATH+"simplebuy/selectClass.html",scope:{options:"=",value:"=ngModel",detail:"="},link:function(e,t,n){var r=e.options||{};e.config={theme:r.theme||"simplebuy",transclude:!0}}}}function s(){return{templateUrl:r.Constant.PARTIALS_PATH+"simplebuy/instanceClass.html",scope:{item:"="},link:function(e,t,n){var r=function(e){return e||""};e.$watch("item.value",function(){e.classTyleText=r(e.item.text);var t={cpu:{title:"CPU",unit:""},memory:{title:"",unit:"GB"},sysdiskSize:{title:"",unit:"GB"},datadiskSize:{title:"",unit:"GB"},bandwidth:{title:"",unit:"Mbps"}};e.configs=[];for(var n in t)if(t.hasOwnProperty(n)&&e.item&&typeof e.item[n]!="undefined"){var i={title:t[n].title,text:r(e.item[n])+t[n].unit};e.configs.push(i)}})}}}n.directive("simplebuySelectClass",i),i.$inject=[],n.directive("simplebuyInstanceClass",s),s.$inject=[]}),define("ecsbuy/base/directives/customBuy/customBuy.SelectClass",["require","exports","../directives","../../cons/cons"],function(e,t,n,r){function i(){return{templateUrl:r.Constant.PARTIALS_PATH+"customBuy/selectClass.html",scope:{options:"=",value:"=ngModel",detail:"="},link:function(e,t,n){var r=e.options||{};e.config={theme:r.theme||"custombuy",transclude:!0}}}}function s(){return{templateUrl:r.Constant.PARTIALS_PATH+"customBuy/instanceClass.html",scope:{item:"="},link:function(e,t,n){var r=function(e){return e||""};e.$watch("item.value",function(){e.classTyleText=r(e.item.text),e.configs=[];var t=e.item&&e.item.views;if(typeof t=="object")for(var n in t)t.hasOwnProperty(n)&&e.configs.push(t[n])})}}}n.directive("customBuySelectClass",i),i.$inject=[],n.directive("customBuyInstanceClass",s),s.$inject=[]}),define("ecsbuy/base/directives/userdata/userdata",["require","exports","../directives","dominator/base/helpers/moduleHelper","../../helpers/buyUtils","../../cons/cons"],function(e,t,n,r,i,s){n.directive("aliyunBuyEcsUserdata",["base64","aliyunBuyEcsRemoteService","$timeout",function(e,t,n){return{restrict:"EA",templateUrl:s.Constant.PARTIALS_PATH+"userdata/aliyunBuyEcsUserdata.html",scope:{options:"=",value:"=",valueAll:"="},replace:!0,link:function(t){function u(){o.state="",o.stateMessage="";var n=t.userdataValue;if(!n){t.value=null;return}var r=null,u=!1;if(t.alreadyBase64){r=n,n.indexOf(" ")!=-1&&(u=!0);try{n=e.decode(r)}catch(a){u=!0}}else r=e.encode(n);var f=i.BuyUtils.bitLenForString(n)/1e3;u===!0?(o.state="error",o.stateMessage="base64, ",t.value=null):f>s?(o.state="error",o.stateMessage="16KB, ",t.value=null):(o.state="",o.stateMessage="",t.value=r)}!t.options&&(t.options={}),r.setDefault(t.options,{state:"",stateMessage:""});var s=16,o=t.options;t.inWhiteListForUserData=!1,t.$watch("alreadyBase64",u),t.$watch("userdataValue",i.BuyUtils.debounce(u,200,n))}}}])}),define("ecsbuy/base/directives/instanceType/class/baseSelectorClass",["require","exports"],function(e,t){var n=function(){function e(){this.items=[]}return e}();t.BaseSelectorClass=n});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/base/directives/instanceType/class/customizeGenerationClass",["require","exports","./baseSelectorClass"],function(e,t,n){var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.initDefaultValue=function(e){this.value=e||"last-generation"},t.prototype.initItems=function(e){this.items=e.getOptions("customizeGeneration")},t}(n.BaseSelectorClass);t.CustomizeGenerationClass=r});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/base/directives/instanceType/class/computingArchitectureClass",["require","exports","angular","./baseSelectorClass","../../../helpers/instanceTypeHelper","../../../helpers/commodityHelper"],function(e,t,n,r,i,s){var o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.initDefaultValue=function(e){this.value=e||"X86"},t.prototype.initItems=function(e,t,r){var o=e.getOptions("computingArchitecture");if(!n.isArray(t)){this.items=o;return}var u=!1,a=!1;for(var f=0;f<t.length;f++){var l=t[f]&&t[f].value;i.InstanceTypeHelper.isHpcInstanceType(r,l)&&(u=!0),i.InstanceTypeHelper.isElasticBareMetalInstanceType(r,l)&&(a=!0)}u||s.CommodityHelper.removeItemFromCollection("super-computeCluster",o),a||s.CommodityHelper.removeItemFromCollection("elastic-bareMetal",o),this.items=o},t}(r.BaseSelectorClass);t.ComputingArchitectureClass=o});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/base/directives/instanceType/class/customizeFamilyClass",["require","exports","angular","./baseSelectorClass","../../../helpers/buyUtils","../../../helpers/commodityHelper"],function(e,t,n,r,i,s){var o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.initDefaultValue=function(e){this.value=e||"general-purpose"},t.prototype.appendOrUpdateItem=function(e){if(!e||!e.value)return;var t=i.BuyUtils.getSelectItem(this.items,e.value,!0);!t||!t.value?this.items.push(e):n.extend(t,e),this.value=e.value},t.prototype.removeItem=function(e){s.CommodityHelper.removeItemFromCollection(e,this.items)},t.prototype.computingArchitectureValueChanged=function(e,t){this.items=t.getOptions("customizeFamily",[{code:"computingArchitecture",value:e}])},t}(r.BaseSelectorClass);t.CustomizeFamilyClass=o});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/base/directives/instanceType/class/instanceTypeClass",["require","exports","angular","dominator/base/helpers/constraintHelper","./baseSelectorClass","../../../helpers/buyUtils"],function(e,t,n,r,i,s){var o=function(e){function t(t,n,r,i,s,o){e.call(this),this.CPU_MEMORY_FILTER_VALUE="cpuMemoryFilter",this.INSTANCE_TYPE_FILTER_VALUE="instanceTypeFilter",this.raw=t,this.constraintTool=o,this.cpuFilter=n,this.memoryFilter=r,this.customizeGeneration=i,this.customizeFamily=s}return __extends(t,e),t.prototype.init=function(e){e.options&&(this.originInstanceTypes=n.copy(e.options.items)),this.cpuFilter.items=this.getCpuFilterItems()},t.prototype.select=function(e){if(!e)return;this.value=e.value},t.prototype.render=function(e,t,r){var i=this,o=[];e||(e=this.customizeFamily.value),t||(t=this.customizeGeneration.value);if(e==this.CPU_MEMORY_FILTER_VALUE){var u=s.BuyUtils.getSelectItem(this.customizeFamily.items,this.CPU_MEMORY_FILTER_VALUE,!0);if(u){for(var a=0;a<this.originInstanceTypes.length;a++){var f=this.originInstanceTypes[a];f&&f.cpu==u.cpu&&f.memory==u.memory&&o.push(f)}this.setItems(o);return}}if(e=="instanceTypeFilter"){var l=s.BuyUtils.getSelectItem(this.customizeFamily.items,"instanceTypeFilter",!0);if(l){for(var a=0;a<this.originInstanceTypes.length;a++){var f=this.originInstanceTypes[a];f&&f.value.indexOf(l.filterValue)>-1&&o.push(f)}this.setItems(o);return}}var c=[{code:"customizeFamily",value:e},{code:"customizeGeneration",value:t},{code:"customizeGenerationBackup",value:r}],h=this.constraintTool.getOptions("instance_type_family",c);n.forEach(h,function(e){if(e&&e.value){var t=i.constraintTool.getOptions("instance_type",[{code:"instance_type_family",value:e.value}]);o=o.concat(t)}});if((!o||o.length==0)&&!r){this.render(e,"xx-yy","last-generation-backup");return}this.setItems(o)},t.prototype.getInstanceTypeObjWithDefault=function(e){return s.BuyUtils.getSelectItem(this.items,e,!1)},t.prototype.getInstanceTypeObj=function(e){return s.BuyUtils.getSelectItem(this.items,e,!0)},t.prototype.cpuFilterValueChanged=function(e){this.memoryFilter.items=this.getMemoryFilterItems(e),this.customizeFamily.appendOrUpdateItem(this.generateCpuMemoryFilterItem(e,null)),this.render(null,null,null)},t.prototype.memoryFilterValueChanged=function(e){this.customizeFamily.appendOrUpdateItem(this.generateCpuMemoryFilterItem(null,e)),this.render(null,null,null)},t.prototype.instanceTypeFilterValueChanged=function(e){if(!e){this.customizeFamily.removeItem(this.INSTANCE_TYPE_FILTER_VALUE);return}this.customizeFamily.appendOrUpdateItem(this.generateInstanceTypeFilterItem(e)),this.render(null,null,null)},t.prototype.generateCpuMemoryFilterItem=function(e,t){e||(e=this.cpuFilter.value),t||(t=this.memoryFilter.value);if(!e||!t)return;return{value:this.CPU_MEMORY_FILTER_VALUE,text:e+"  "+t+" GB",cpu:e,memory:t}},t.prototype.generateInstanceTypeFilterItem=function(e){if(!e)return;return{value:this.INSTANCE_TYPE_FILTER_VALUE,filterValue:e,text:""+e}},t.prototype.setItems=function(e){this.items=e;var t=this.getInstanceTypeObjWithDefault(this.value);t&&t.value&&this.select(t)},t.prototype.getCpuFilterItems=function(){var e=[];return n.forEach(this.originInstanceTypes,function(t){if(!t||!t.cpu)return;r.contains(e,t.cpu,"value")||e.push({value:t.cpu,text:t.cpu+" "})}),this.sortAsc(e),e},t.prototype.getMemoryFilterItems=function(e){var t=[];return n.forEach(this.originInstanceTypes,function(n){if(!n||!n.memory)return;!r.contains(t,n.memory,"value")&&e==n.cpu&&t.push({value:n.memory,text:n.memory+" GB"})}),this.sortAsc(t),t},t.prototype.sortAsc=function(e){e.sort(function(e,t){return e&&t?e.value-t.value:0})},t.prototype.getOriginInstanceTypes=function(){return this.originInstanceTypes},t}(i.BaseSelectorClass);t.InstanceTypeClass=o}),define("ecsbuy/base/directives/instanceType/instanceType",["require","exports","angular","../directives","dominator/core/Commodity/Commodity","../../helpers/buyUtils","../../cons/cons","../../helpers/instanceTypeHelper","../../helpers/buyTipsHelper","../../helpers/commodityHelper","./class/customizeGenerationClass","./class/computingArchitectureClass","./class/customizeFamilyClass","./class/baseSelectorClass","./class/instanceTypeClass"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){r.directive("aliyunBuyEcsInstanceTypes",["base64","aliyunBuyDialog","aliyunBuyEcsRemoteService","$timeout","$rootScope",function(e,t,r,v,m){return{restrict:"EA",templateUrl:o.Constant.PARTIALS_PATH+"instanceType/instanceType.html",scope:{value:"=",options:"=",detail:"=",valueAll:"=",raw:"="},replace:!0,link:function(e){function b(){if(!e.buyHistoryInstanceTypes)return;if(!e.options||!e.options.items)return;g.items=w(e.buyHistoryInstanceTypes)}function w(t){var r=[];return n.forEach(t,function(t){var n=s.BuyUtils.getSelectItem(e.options.items,t,!0);if(!n||!n.value)return;var i=u.InstanceTypeHelper.getInstanceTypeDetail(n,e.raw);r.push({value:t,spm:"history-"+u.InstanceTypeHelper.dotToDash(t),text:i})}),r}function E(t){function C(){var t,n,r,i;e.value&&(t=f.CommodityHelper.getConstraintValueByValue(e.value,"instance_type","instance_type_family",null,o),n=f.CommodityHelper.getConstraintValueByValue(t,"instance_type_family","customizeFamily",null,o),r=f.CommodityHelper.getConstraintValueByValue(n,"customizeFamily","computingArchitecture",null,o),i=f.CommodityHelper.getConstraintValueByValue(t,"instance_type_family","customizeGeneration",null,o),i||(i=f.CommodityHelper.getConstraintValueByValue(t,"instance_type_family","customizeGenerationBackup",null,o)),i||(i="all-generation"),N.value=e.value),b.initDefaultValue(i),w.initDefaultValue(r),E.initDefaultValue(n),N.render(E.value,b.value,null)}t.tableHeadSetting={localSSD:!0,GPUFPGA:!0,intelAESNI:!1,intelAVX:!1,intelTurbo:!1,privatePPS:!0,intranetBandwidth:!0,baselineCredit:!0},t.instanceTypeFilterValue=undefined,t.valueAll=e.valueAll;var i=e.raw,o=n.copy(i),m=s.BuyUtils.getMapProperty(o,"components.instance_type");m&&(m.instance_type=e.options.items),s.BuyUtils.getMapProperty(o,"components.customizeFamily")||u.InstanceTypeHelper.mergeInstanceTypeRegroupConfig(o);var g=new r(o,[]),b=t.customizeGeneration=new l.CustomizeGenerationClass,w=t.computingArchitecture=new c.ComputingArchitectureClass,E=t.customizeFamily=new h.CustomizeFamilyClass,S=t.cpuFilter=new p.BaseSelectorClass,x=t.memoryFilter=new p.BaseSelectorClass,T=t.instanceTypeFilter=new p.BaseSelectorClass,N=t.instanceType=new d.InstanceTypeClass(e.raw,S,x,b,E,g);b.initItems(g),N.init(e),w.initItems(g,N.getOriginInstanceTypes(),i),t.$watch("computingArchitecture.value",function(e){E.computingArchitectureValueChanged(e,g),N.render(E.value,null,null)}),t.$watch("customizeFamily.value",function(e){N.render(e,null,null)}),t.$watch("customizeGeneration.value",function(e){N.render(null,e,null)}),t.$watch("cpuFilter.value",function(e){N.cpuFilterValueChanged(e)}),t.$watch("memoryFilter.value",function(e){N.memoryFilterValueChanged(e)}),t.$watch("instanceTypeFilter.value",function(e){N.instanceTypeFilterValueChanged(e)}),t.$watch("instanceType.value",function(n){e.historyInstanceType.value=undefined;var r=N.getInstanceTypeObj(n);t.selectedInstanceTypeDetail=u.InstanceTypeHelper.getInstanceTypeDetail(r,e.raw),e.value=r.value,e.detail={text:t.selectedInstanceTypeDetail,value:r.value}}),C(),t.ensure=function(){v.close()};var k=!0;t.sortColumn=function(e){k=!k,N.items.sort(function(t,n){var r=0;return!t||!n?r:(e=="cpu"||e=="memory"?r=parseInt(t[e])-parseInt(n[e]):r=t[e].localeCompare(n[e]),k?r:-r)})},t.getAskTip=function(e){var t=a.BuyTipsHelper.getHoverTipKey("instance_type_family",e),n=a.BuyTipsHelper.getHoverTip("instance_type_family",e);return t==n?"":n},t.dotToDash=u.InstanceTypeHelper.dotToDash,e.$on("$destroy",function(){n.isFunction(y)&&y()})}var r=i.Commodity,v;e.openDialog=function(){v=t.open({windowClass:"instance-type-dialog",backdropClass:"instance-type-backdrop",templateUrl:o.Constant.PARTIALS_PATH+"instanceType/instanceTypeDialog.html",controller:["$scope","$http",E]})};var g=e.historyInstanceType=new p.BaseSelectorClass,y=m.$watch("buyHistoryInstanceTypes",function(t){e.buyHistoryInstanceTypes=t,b()});e.$watch("options.items",function(){b()}),e.$watch("historyInstanceType.value",function(t){if(!t)return;e.value=t,e.detail=e.historyInstanceType.detail})}}}])}),define("ecsbuy/base/directives/recommend/instanceType",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","../../cons/cons"],function(e,t,n,r,i,s){return r.directive("aliyunBuyEcsRecommendInstanceType",["$filter",function(e){return{restrict:"EA",templateUrl:s.Constant.PARTIALS_PATH+"recommend/instanceType.html",scope:{options:"=",value:"="},replace:!0,compile:function(e,t){return i.require(["options","value"],t),{pre:function(e){i.setDefault(e,{detail:{},options:{},value:""}),e.scene="CREATE",e.select=function(t){if(t.noStock)return;e.options.items.forEach(function(e){e.active&&(e.active=!1)}),t.active=!0,e.value=t.InstanceType.InstanceType},e.$watch("options.items",function(t){n.isArray(t)&&t.length>0&&e.options.items[0]&&(e.options.items[0].active=!0,e.value=e.options.items[0].InstanceType.InstanceType)})}}}}}]),r}),define("ecsbuy/base/directives/_base",["require","exports","./directives","./image/_base","./disk/ecsSystemdisk","./disk/ecsDatadisk","./disk/ecsLocalstorage","./disk/clouddiskSelect","./disk/ecsDiskEncryption","./password/password","./password/passwordInput","./password/keyPairSetting","./password/instanceName","./orderConfirm/_base","./network/vpcSelect","./network/networkInterface","./securityGroup/ecsSecurityGroup","./ecsBuyIoSelectDirective","./common/_base","./simpleBuy/simpleBuy.SelectClass","./customBuy/customBuy.SelectClass","./userdata/userdata","./instanceType/instanceType","./recommend/instanceType"],function(e,t){}),define("ecsbuy/base/models/base/buy/ecs.buy.ui",["require","exports","common/modelSystem/modelFactory","common/helper/i18nHelper","../../../helpers/homeConfigHelper","../../../helpers/buyTipsHelper"],function(e,t,n,r,i,s){n.regist("ecs.buy.ui","BuyUiModel",{id:"ecsPrepay",fields:[{id:"orderTypeConfig",type:"group",spmId:"chargeType",title:"<i class='bk-group-title-icon icon-buy-chargeType'></i>"+r.i18n("ecs.buy.component.label.chargeType"),children:[{id:"chargeType",type:"newBrickTabs",noLabel:!0,fieldWraperCls:"bk-label-non"}]},{id:"regionConfig",type:"group",spmId:"region",intro:s.BuyTipsHelper.getBlockTip("REGION",[i.HomeConfigHelper.getUrlConfig("chooseRegionTips"),"_blank"]),title:"<i class='bk-group-title-icon icon-buy-region'></i>"+r.i18n("ecs.buy.component.label.region"),children:[{id:"vm_region_no",type:"customField",template:"<div aliyun-buy-buttontab-with-select parent-value='rawData.vm_region_no' child-value='rawData.vm_iz' options='options' ng-model='rawData.vm_region_no'></div>",fieldWraperCls:"bk-label-non vm-region-no",noLabel:!0,attributes:[]},{id:"vm_iz",type:"newBrickTabs",fieldWraperCls:"bk-label-non",noLabel:!0}]},{id:"networkConfig",type:"group",spmId:"network",title:"<i class='bk-group-title-icon icon-buy-network-2'></i>"+r.i18n("ecs.buy.component.label.network"),children:[{id:"vm_web_type",type:"newBrickTabs",fieldWraperCls:"bk-label-non",noLabel:!0},{id:"vm_vpc",type:"customField",template:"<div aliyun-buy-ecs-vpc\n                      aliyun-buy-anchor=\"dominator:vm_vpc:anchor\"\n                      options='options'\n                      value='rawData.vm_vpc'\n                      detail='rawData.detail'\n                      value-all='valueAll'\n                      raw='raw'\n                      default-value-vpc-id='rawData.defaultValueVpcId'\n                      default-value-vswitch-id='rawData.defaultValueVswitchId'></div>",fieldWraperCls:"bk-label-non",noLabel:!0},{id:"defaultSecurityGroupId",type:"buyText"},{id:"defaultValueVpcId",type:"buyText"},{id:"defaultValueVswitchId",type:"buyText"},{id:"allocatePublicIP",fieldWraperCls:"bk-form-row-allocate-publicip",type:"bricksSelect",label:r.i18n("ecs.buy.label.publicIp")},{id:"securityGroup",type:"customField",clientField:!0,template:"<div aliyun-buy-ecs-security-group\n                      group-rule-value='rawData.groupRule'\n                      value='rawData.securityGroup'\n                      options='options'\n                      value-all='valueAll'\n                      raw='raw'\n                      detail='rawData.$detail'\n                      default-value-sg-id=\"rawData.defaultSecurityGroupId\"></div>",fieldWraperCls:"bk-label-non",noLabel:!0},{id:"groupRule",type:"customField",clientField:!0,template:"<input value='rawData.groupRule' />"}]},{id:"instanceConfig",type:"group",spmId:"instance",title:"<i class='bk-group-title-icon icon-buy-instance'></i>"+r.i18n("ecs.buy.component.label.instance"),children:[{id:"iooptimized",type:"customField",template:"<div ecs-io-select ng-model='rawData.iooptimized' options='options'></div>",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]},{id:"instance_type",type:"customField",template:"<span aliyun-buy-ecs-instance-types\n                       value='rawData.instance_type'\n                       options='options'\n                       raw=\"raw\"\n                       detail=\"rawData.$detail\"\n                       value-all='valueAll'></span>",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]},{id:"defaultIooptimized",type:"buyText"},{id:"defaultInstanceType",type:"buyText"}]},{id:"hpcClusterConfig",type:"group",spmId:"hpcCluster",title:"<i class='bk-group-title-icon icon-hpc'></i>"+r.i18n("ecs.buy.component.label.hpcCluster"),children:[{id:"hpcClusterId",clientField:!0,label:r.i18n("ecs.buy.compoonet.hpcCluster.name"),type:"customField",template:'<span aliyun-buy-ecs-label\n                       value="rawData.hpcClusterId"\n                       detail="rawData.$detail"></span>'},{id:"hpcClusterName",clientField:!0,label:r.i18n("ecs.buy.compoonet.hpcCluster.name"),type:"customField",template:'<span  aliyun-buy-ecs-instance-name\n                        aliyun-buy-anchor="dominator:hpcClusterName:anchor"\n                        options="options"\n                        value="rawData.hpcClusterName"></span>'},{id:"hpcClusterDescription",clientField:!0,label:r.i18n("ecs.buy.compoonet.hpcCluster.description"),type:"customField",template:'<span  aliyun-buy-ecs-description\n                        aliyun-buy-anchor="dominator:hpcClusterDescription:anchor"\n                        options="options"\n                        value="rawData.hpcClusterDescription"></span>'}]},{id:"networkInterfaceConfig",type:"group",spmId:"networkInterface",title:"<i class='bk-group-title-icon glyphicon glyphicon-transfer'></i>"+r.i18n("ecs.buy.component.label.networkInterface"),children:[{id:"inWhiteListForNetworkInterface",type:"buyText"},{id:"networkInterface",clientField:!0,type:"customField",template:"<span aliyun-buy-ecs-network-interface\n                       vswitch-value-map='rawData.vswitchValueMap'\n                       value='rawData.networkInterface'\n                       value-all='valueAll'></span>",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]}]},{id:"bandwidthConfig",type:"group",spmId:"bandwidth",intro:"<span aliyun-buy-ecs-threshold></span>",title:"<i class='bk-group-title-icon icon-buy-bandwidth-2'></i>"+r.i18n("ecs.buy.component.label.bandwidth.type"),children:[{id:"vm_is_flow_type",type:"newBrickTabs",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]},{id:"vm_bandwidth",type:"buySliderWithNumber",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]}]},{id:"imageConfig",type:"group",spmId:"image",title:"<i class='bk-group-title-icon icon-buy-image'></i>"+r.i18n("ecs.buy.component.label.image"),children:[{id:"imageType",type:"newBrickTabs",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]},{id:"publicImage",type:"customField",template:"<span aliyun-buy-select-linkage\n                       aliyun-buy-anchor=\"dominator:publicImage:anchor\"\n                       options='options'\n                       value='rawData.allValue'\n                       detail='rawData.allDetail'\n                       root-value='rawData.rootValue'\n                       root-detail=\"options.rootDetail\"\n                       children-value='rawData.publicImage'\n                       children-detail='options.childDetail'></span>",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]},{id:"customImage",type:"customField",template:"<span  aliyun-buy-ecs-image\n                        aliyun-buy-anchor=\"dominator:customImage:anchor\"\n                        options='options'\n                        value='rawData.customImage'\n                        detail='rawData.$detail'\n                        image-type='custom'\n                        value-all='valueAll'\n                        default-value-image-id='rawData.customDefaultValueImageId'></span>",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]},{id:"sharedImage",type:"customField",template:"<span  aliyun-buy-ecs-image\n                        aliyun-buy-anchor=\"dominator:sharedImage:anchor\"\n                        options='options'\n                        value='rawData.sharedImage'\n                        detail='rawData.$detail'\n                        image-type='shared'\n                        value-all='valueAll'\n                        default-value-image-id='rawData.sharedDefaultValueImageId'></span>",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]},{id:"marketImage",type:"customField",template:"<span  aliyun-buy-ecs-image-market\n                        aliyun-buy-anchor=\"dominator:marketImage:anchor\"\n                        options='options'\n                        detail = 'rawData.$detail'\n                        value='rawData.marketImage'\n                        value-all='valueAll'\n                        raw='raw'\n                        default-value-image-id='rawData.marketDefaultValueImageId'></span>",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]},{id:"imageOffline",fieldWraperCls:"bk-form-row-pb0 ",type:"customField",template:"<span  aliyun-buy-ecs-image-offline\n                        aliyun-buy-anchor=\"dominator:imageOffline:anchor\"\n                        options='options'\n                        value='rawData.imageOffline'\n                        value-all='valueAll'>",noLabel:!0},{id:"imageFromMarket",type:"customField",fieldWraperCls:"bk-form-row-pb0 ",template:"<span  aliyun-buy-ecs-image-from-market\n                        options='options'\n                        detail=\"rawData.$detail\"\n                        value='rawData.imageFromMarket'\n                        value-all='valueAll'>",noLabel:!0},{id:"publicImageDataLoaded",type:"buyText"},{id:"publicDefaultValueImageId",type:"buyText"},{id:"customDefaultValueImageId",type:"buyText"},{id:"sharedDefaultValueImageId",type:"buyText"},{id:"marketDefaultValueImageId",type:"buyText"},{id:"securityEnhancementStrategy",type:"checkbox",noLabel:!0,fieldWraperCls:"bk-label-non bk-security-enhancement",fieldCls:"bk-ecs-security-enhancement ",clientField:!0}]},{id:"storageConfig",type:"group",spmId:"storage",title:"<i class='bk-group-title-icon icon-buy-storage-2'></i>"+r.i18n("ecs.buy.component.label.storage"),children:[{id:"systemdisk_category",type:"customField",label:r.i18n("ecs.buy.label.disk.system"),template:"<span  aliyun-buy-ecs-sysdisk\n                        aliyun-buy-anchor=\"dominator:systemdisk_category:anchor\"\n                        options='options'\n                        category='rawData.systemdisk_category'\n                        size='rawData.systemdisk_size'></span>"},{id:"systemdisk_size",type:"customField",template:"<input value='rawData.systemdisk_size'/>"},{id:"localstorage",type:"customField",template:"<span  aliyun-buy-ecs-localstorage\n                        options='options'></span>",label:r.i18n("ecs.buy.label.storage.local")},{id:"datadisk",type:"customField",label:r.i18n("ecs.buy.label.disk.data"),template:"<span  aliyun-buy-ecs-datadisk\n                        aliyun-buy-anchor=\"dominator:datadisk:anchor\"\n                        options='options'\n                        value='rawData.datadisk'></span>"}]},{id:"amountConfig",type:"group",spmId:"quantity",title:"<i class='bk-group-title-icon icon-buy-amount'></i>"+r.i18n("ecs.buy.component.label.amount"),children:[{id:"durationConfig",type:"group",groupClass:"merge-field-group",groupStyle:"none",children:[{id:"order_time",type:"newBrickTabs",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]},{id:"autoRenew",clientField:!0,type:"checkbox",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]},{id:"recyclable",clientField:!0,type:"checkbox",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]}]},{id:"amount",type:"amount",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]}]},{id:"userdataConfig",type:"group",spmId:"login",title:"<i class='bk-group-title-icon icon-buy-security'></i>"+r.i18n("ecs.buy.component.label.userData"),children:[{id:"userdata_select",type:"newBrickTabs",fieldWraperCls:"bk-label-non bk-form-row-pb0",clientField:!0,noLabel:!0,attributes:[]},{id:"userdata",type:"customField",noLabel:!0,clientField:!0,fieldWraperCls:"bk-label-non",template:'<span  aliyun-buy-ecs-userdata\n                          options="options"\n                          value="rawData.userdata"></span>'}]},{id:"securityConfig",type:"group",spmId:"login",title:"<i class='bk-group-title-icon icon-buy-security'></i>"+r.i18n("ecs.buy.component.label.securitySetting"),children:[{id:"setupPassword",type:"newBrickTabs",fieldWraperCls:"bk-label-non",clientField:!0,noLabel:!0,attributes:[]},{id:"password",clientField:!0,noLabel:!0,fieldWraperCls:"bk-form-row-pb0",type:"customField",template:'<span  aliyun-buy-ecs-password\n                        aliyun-buy-anchor="dominator:password:anchor"\n                        options="options"\n                        value="rawData.password"></span>'},{id:"keyPair",clientField:!0,label:r.i18n("ecs.buy.label.keypair"),type:"customField",template:'<span  aliyun-buy-ecs-setting-key-pair\n                        aliyun-buy-anchor="dominator:keyPair:anchor"\n                        options="options"\n                        value-all="valueAll"\n                        value="rawData.keyPair"></span>'},{id:"instanceName",clientField:!0,label:r.i18n("ecs.buy.component.password.instanceName"),type:"customField",template:'<span  aliyun-buy-ecs-instance-name\n                        aliyun-buy-anchor="dominator:instanceName:anchor"\n                        options="options"\n                        value="rawData.instanceName"></span>'},{id:"activityId",type:"buyText"},{id:"orderSource",type:"buyText"}]}]})}),define("ecsbuy/base/models/base/buy/ecs.buy.biz",["require","exports","angular","common/modelSystem/modelFactory"],function(e,t,n,r){r.regist("ecs.buy.biz","BizModel",["modelFactory",function(e){var t=["base","network","instanceType","bandwidth","image","disk","amount","userdata","security","hpcCluster"],r=[];return n.forEach(t,function(t){var n="ecs.buy.bizField."+t,i=e.getModel(n,"BizModel");i&&(r=r.concat(i))}),{id:"ecsPrePay",fields:r}}])}),define("ecsbuy/base/helpers/cartHelper",["require","exports","angular","./commodityHelper","./homeConfigHelper","./orderDataHelper"],function(e,t,n,r,i,s){var o=function(){function e(){}return e.vpcValidation=function(e,t,i){var o=0;if(!i)return!0;var u=i.vm_web_type;if(r.CommodityHelper.getNetworkType(u)!="vpc")return!0;var a=s.OrderDataHelper.getVpc(i.vm_vpc),f=a.vSwitchId,l=a.ipNum;if(!f||!l)return!0;var c=parseInt(i.amount);return n.forEach(t,function(e){var t=s.OrderDataHelper.getVpc(e.vm_vpc),n=t.vSwitchId;n&&n==f&&(o+=parseInt(e.amount))}),c+o>l?(e.alert("","IP "+l+"  "+l+" "),!1):!0},e.totalValidation=function(e,t,r,i){if(!r)return!1;var s=i.getFieldMap();if(!s.amount)return!0;var o=i.getFieldById("amount"),u=o.getOptionsAttr("maxLimit");if(!u&&u!=0)return!0;var a=0;n.forEach(t,function(e){a+=parseInt(e.amount)});var f=parseInt(r.amount);return f+a>u?(e.alert(""," "+u+" "),!1):!0},e.sumCartSecurityGroup=function(e,t){var r=0;return t&&t.length>0&&n.forEach(t,function(t){var n=s.OrderDataHelper.getSecurityGroupId(t.securityGroup);n===e&&(r+=parseInt(t.amount))}),r},e.securityInstanceQuotaValidation=function(e,t,n,r){var i=r.getFieldMap();if(!i.securityGroup)return!0;var o=r.getFieldById("securityGroup"),u=o.getComponents().detail||{},a=o.getOptionsAttr("quota"),f=u.EcsCount,l=s.OrderDataHelper.getSecurityGroupId(n.securityGroup),c=this.sumCartSecurityGroup(l,t),h;try{a=parseInt(a),h=parseInt(n.amount),f=parseInt(f)}catch(p){return!0}return h+c+f>a?(e.alert(""," "+a+"  "+f+"  "+(h+c)+" "),!1):!0},e.cartNumbersValidation=function(e,t){var r=i.HomeConfigHelper.getValue("allowAddToCartNumber");return!r&&(r=5),t&&n.isArray(t)&&t.length>=r?(e.alert(""," "+r+" "),!1):!0},e}();t.CartHelper=o}),define("ecsbuy/base/helpers/fields/regionHelper",["require","exports","angular","common/helper/i18nHelper","dominator/base/helpers/constraintHelper","../../cons/buyBizCons","../commodityHelper","../buyUtils"],function(e,t,n,r,i,s,o,u){var a=function(){function e(){}return e.mergeRegionItems=function(e,t){n.forEach(t,function(t){var n=e.getOptionsFromConstraints("vm_iz",{vm_region_no:t.value});t.children={items:n},t.disabled&&(t.iconClass=s.BuyBizCons.QING_ICON_CLASS,t.tip=r.i18n("ECS_REGION_SOLD_OUT_TIP"))})},e.hijackFinanceRegionname=function(e){var t=this.needHijackRegionsOfFinance,r=o.CommodityHelper.isFinanceUser(e);if(!r)return;var s=u.BuyUtils.getMapProperty(e,"components.vm_region_no.vm_region_no");n.forEach(s,function(e){i.contains(t,e.value)&&(e.text=e.text+" ")})},e.mergeRegionTip=function(e,t,r){var i=e.getFieldMap().chargeType,s=e.getOriginConstraintData(),u=o.CommodityHelper.isFinanceUser(s),a;if(i){var f=e.getFieldValueById("chargeType");f=="prepay"?a=r.vm:f=="postpay"&&(a=r.ecs)}if(!a)return;n.forEach(t,function(e){var t=a[e.value];if(t){if(u&&!t.supportedFinance)return;t.tip&&(e.tip=t.tip,e.iconClass=t.iconClass)}})},e.needHijackRegionsOfFinance=["cn-qingdao-cm5-a01","cn-hangzhou-dg-a01"],e}();t.RegionHelper=a}),define("ecsbuy/base/models/base/frameworkClass/EcsBaseFramework",["require","exports","../../../helpers/instanceTypeHelper","../../../helpers/orderDataHelper","../../../helpers/commodityHelper","../../../helpers/buyTipsHelper","../../../helpers/cartHelper","../../../helpers/fields/regionHelper"],function(e,t,n,r,i,s,o,u){var a=function(){function e(e){this.commodityCode="vm",this.orderType="BUY",this.purchaseConfig={sessionStorageKey:"aliyun.buy.ecs.prepay.orderConfirm.v2",orderConfirmPage:"prepayOrderConfirm",sessionStorageCacheKey:"aliyun.buy.ecs.cache.orderData",orderConfirmRiskCode:"VM_SELECT"},this.components=[{code:"vm_region_no"},{code:"vm_iz"},{code:"vm_web_type"},{code:"instance_type"},{code:"vm_is_flow_type"},{code:"vm_bandwidth"},{code:"systemdisk_category"}],this.$injector=e}return e.prototype.getCommodity=function(){var e=this.$injector.get("aliyunBuyEcsRemoteService");return e.getCommodity({commodityCode:this.commodityCode,orderType:this.orderType})},e.prototype.onBeforeConstraintHandled=function(e){var t=this.$injector.get("$rootScope");t.channelId=i.CommodityHelper.getBuyChannelId(e),n.InstanceTypeHelper.mergeFamilyName(e),s.BuyTipsHelper.mergeItemTip(e),u.RegionHelper.hijackFinanceRegionname(e);var r=this.$injector.get("aliyunBuyEcsBlockListService");i.CommodityHelper.hijackClassic(e,r);var o=this.$injector.get("ecsBuyRegionService");return o.initRegionSetting(e),e},e.prototype.purchase=function(e,t,n,r){var i=t.getOriginConstraintData(),s=this.$injector.get("aliyunBuyEcsCacheService"),o=this.getOrderParam(e,this.commodityCode,this.orderType,i);s.sessionStorageSet(this.purchaseConfig.sessionStorageKey,angular.toJson({orderData:o})),this.cacheOrderData(e,i);var u=r.getScope();u.$emit("aliyunBuyEcs:purchase",this.purchaseConfig)},e.prototype.cacheOrderData=function(e,t){var n=this.$injector.get("aliyunBuyEcsCacheService"),r=this.getOrderParam(e,this.commodityCode,this.orderType,t);this.purchaseConfig.sessionStorageCacheKey&&n.sessionStorageSet(this.purchaseConfig.sessionStorageCacheKey,angular.toJson(r))},e.prototype.getOrderParam=function(e,t,n,i){return r.OrderDataHelper.getOrderParam(e,t,n,null,i)},e.prototype.beforePurchase=function(e,t,n,r){var s=this.$injector.get("aliyunBuyEcsRemoteService"),o=this.$injector.get("aliyunBuyEcsValidateService"),u=t.getOriginConstraintData();if(!i.CommodityHelper.isLogin(u))return this.cacheOrderData(e),s.login(),!1;var a=o.validate(t,e);return a},e.prototype.beforeAddToCart=function(e,t){var n=this.$injector.get("aliyunBuyMsg"),r=t.getCartOrders(),i=e.getOrder(),s=this.beforePurchase(i,e,"cart",t),u=o.CartHelper.cartNumbersValidation(n,r),a=o.CartHelper.vpcValidation(n,r,i),f=o.CartHelper.totalValidation(n,r,i,e),l=o.CartHelper.securityInstanceQuotaValidation(n,r,i,e);return s&&u&&a&&f&&l},e.prototype.convertToBindFn=function(e){if(!e)return null;var t=this;return function(){var n=Array.prototype.slice.call(arguments);return e.apply(t,n)}},e.prototype.makeFrameworkFactory=function(){return{constraintService:{getConstraints:this.convertToBindFn(this.getCommodity),onBeforeConstraintHandled:this.convertToBindFn(this.onBeforeConstraintHandled)},priceService:{getPrice:this.convertToBindFn(this.getPrice)},orderService:{purchase:this.convertToBindFn(this.purchase),beforeAddToCart:this.convertToBindFn(this.beforeAddToCart),beforePurchase:this.convertToBindFn(this.beforePurchase)},components:this.components}},e}();t.EcsBaseFramework=a}),define("ecsbuy/base/models/base/buy/ecs.buy.framework",["require","exports","common/modelSystem/modelFactory","../frameworkClass/EcsBaseFramework"],function(e,t,n,r){n.regist("ecs.buy.frameworkModel","BuyFrameworkModel",["$injector","aliyunBuyMsg","aliyunBuyEcsRemoteService","aliyunBuyEcsValidateService",function(e,t,n,i){var s=new r.EcsBaseFramework(e);return s.makeFrameworkFactory()}])}),define("ecsbuy/base/helpers/subtotalHelper",["require","exports","angular","common/helper/i18nHelper","./commodityHelper","./homeConfigHelper","./buyTipsHelper","../cons/urlConfig","./purchaseHelper","./buyUtils"],function(e,t,n,r,i,s,o,u,a,f){var l=function(){function e(){}return e.wrapByparentheses=function(e){return"%s".replace("%s",e)},e.getText=function(e,t){var r=t&&t[e];return r?r&&r.detail?r.detail.text:r.options&&n.isArray(r.options.items)?i.CommodityHelper.getTextFromCollection(r.value,r.options.items):"-":"-"},e.getDatadiskText=function(e,t){var r=this,s=e.datadisk;if(!s)return;var o=n.fromJson(s);if(!n.isArray(o)||o.length==0)return;var u=[],a=t.datadisk.options&&t.datadisk.options.diskTypes;return n.forEach(o,function(e){var t=e,n=t[0],r=t[1]?t[1]:"-";u.push(i.CommodityHelper.getTextFromCollection(n,a)+" "+r+"GB")}),u.join("<br/>")},e.getSubtotalViewItems4Disk=function(e,t,n,i,s){!n&&(n=r.i18n("ecs.buy.label.disk.clouddisk")),!i&&(i="datadisk_category"),!s&&(s="datadisk_size");var o=this,u=o.getText("vm_iz",t),a={type:"staticText",label:r.i18n("ecs.buy.label.region")+"",text:o.getText("vm_region_no",t)+o.wrapByparentheses(u)},f={type:"staticText",label:n+"",text:e[s]+" GB "+o.getText(i,t)},l={type:"staticText",label:r.i18n("ecs.buy.label.amount")+"",text:e.amount+" "+r.i18n("ECS_DISK_UNIT")},c=t[i]&&t[i].options.snapshotName,h=e.snapshotId,p={type:"staticText",label:r.i18n("ecs.buy.label.snapshot")+"",text:c||h},d=[a,f,l];return(c||h)&&d.push(p),d},e.getSubtotalViewItems=function(t,s,o){var u=this,a=t.chargeType,f={type:"staticText",label:r.i18n("ecs.buy.label.chargeType")+"",text:u.getText("chargeType",s)},l=u.getText("vm_iz",s),c={type:"staticText",label:r.i18n("ecs.buy.label.region")+"",text:u.getText("vm_region_no",s)+u.wrapByparentheses(l)},h={type:"staticText",label:r.i18n("ecs.buy.label.instanceType")+"",text:u.getText("instance_type",s)},p={type:"staticText",label:r.i18n("ecs.buy.label.io_optimized")+"",text:e.getText("iooptimized",s)},d=u.getText("vm_web_type",s),v={type:"staticText",label:r.i18n("ecs.buy.label.network")+"",text:r.i18n("ecs.buy.label.bandwidth.type")+" "+t.vm_bandwidth+"Mbps"+u.wrapByparentheses(d)},m={type:"staticText",label:r.i18n("ecs.buy.label.securityGroup")+"",text:function(){var e;try{e=n.fromJson(t.securityGroup)}catch(r){}return e&&e[1]}()},g={type:"staticText",label:r.i18n("ecs.buy.label.image")+"",text:function(){if(t.imageType=="public"){var e=s.publicImage&&s.publicImage.options;if(e){var n=e.rootDetail,r=e.childDetail;return n&&n.text&&r&&r.text?n.text+" "+r.text:""}}return u.getText(t.imageType+"Image",s)}()},y={type:"staticText",label:r.i18n("ecs.buy.label.disk.system")+"",text:u.getText("systemdisk_category",s)+u.wrapByparentheses(t.systemdisk_size+" GB")},b=this.getDatadiskText(t,s),w={label:r.i18n("ecs.buy.label.disk.data")+""};b&&(w.type="staticText",w.text=b);var E={type:"staticText",label:r.i18n("ecs.buy.label.amount")+"",text:(a=="prepay"?i.CommodityHelper.getOrderTimeText(t.order_time):"")+" "+t.amount+" "+r.i18n("ECS_INSTANCE_UNIT")};return[f,c,h,p,v,g,y,w,E]},e.getPurchaseTipMiddle=function(e,t,n){if(!n)return;var r=this.getPurchaseInfo(t,e),i=r.purchaseTip,s=r.purchaseAvailable;return function(r){if(r&&r.code&&r.code!="200"){var o=a.PurchaseHelper.getInsufficientBalanceTip(r.code,null);o&&(i=o,s=!1);var u=a.PurchaseHelper.getUserAuthenticationTip(r.code,null);u&&(i=u,s=!1)}n&&n.setSubtotalOptionAttr("purchaseTip",i),n.setSubtotalOptionAttr("purchaseAvailable",s);var f=t.getFieldMap();if(f.priceResult){var l=t.getFieldById("priceResult");l.setFieldValue(r)}return r}},e.getHandlePriceError=function(e,t,n){var r=this;return function(u){var a=!0,f=r.getPurchaseInfo(t,e);if(u.code=="ServiceUnavailable.RegionMaintaining"){a=!1;var l=s.HomeConfigHelper.getUrlConfig("regionMaintiningUrl"),c=o.BuyTipsHelper.getPurchaseTip("region_maintaining",[l]);f.purchaseTip=c,f.purchaseAvailable=a}return n&&n.setSubtotalOptionAttr("purchaseTip",f.purchaseTip),n.setSubtotalOptionAttr("purchaseAvailable",f.purchaseAvailable),u}},e.getPurchaseInfo=function(e,t){var n=e.getOriginConstraintData(),r=!0,s="",u=t[0],a=u.vm_region_no,l=i.CommodityHelper.getComponentItem(n,"vm_region_no.vm_region_no",a),c=i.CommodityHelper.isLogin(n);c||(s=o.BuyTipsHelper.getPurchaseTip("unLoggedDeclare")),l.disabled&&(s=o.BuyTipsHelper.getPurchaseTip("regionDisabled",[l.text]),r=!1);var h=i.CommodityHelper.getConfigProperty(n,"order_num"),p=i.CommodityHelper.getConfigProperty(n,"already_has_resource_num");return f.BuyUtils.getMapProperty(t,"0.amount")<=0&&(s=o.BuyTipsHelper.getPurchaseTip("quota_exceeded"),r=!1),{purchaseTip:s,purchaseAvailable:r}},e.getFreetierPurchaseTipMiddle=function(e,t,n){if(!n)return;var r=!0,i="";return function(t){if(t&&t.trade&&t.trade>0){var s=u.UrlConfig.freetierRuleUrl;i=o.BuyTipsHelper.getPurchaseTip("noMatchFreetier",[s])}return n&&n.setSubtotalOptionAttr("purchaseTip",i),n.setSubtotalOptionAttr("purchaseAvailable",r),t}},e.getSubtotalConfigText=function(){return{rightTip:o.BuyTipsHelper.getPurchaseTip("buyNotes",[s.HomeConfigHelper.getUrlConfig("buyNoteTips"),"_blank"]),priceOriginal:r.i18n("ECS_OLDPRICE"),priceSave:r.i18n("ECS_REDUCE"),priceTotal:r.i18n("ECS_TOTAL"),basePrice:r.i18n("ECS_CONFIG_FEE_NO_COLON"),calculatingPrice:r.i18n("ECS_CALCULATING_PRICE"),calculatingPriceFailed:r.i18n("ECS_PRICE_ERROR"),currentConfig:r.i18n("ecs.buy.label.currentConfiguration"),purchaseCart:r.i18n("ecs.buy.label.purchase.cart")}},e.getCartConfigText=function(){return this.getSubtotalConfigText()},e.getHistoryConfigText=function(){return{rightTip:o.BuyTipsHelper.getPurchaseTip("buyNotes",[s.HomeConfigHelper.getUrlConfig("buyNoteTips"),"_blank"]),priceOriginal:r.i18n("ECS_OLDPRICE"),priceSave:r.i18n("ECS_REDUCE"),priceTotal:r.i18n("ECS_TOTAL"),purchaseCart:r.i18n("ecs.buy.label.buyHistory")}},e}();t.SubtotalHelper=l}),define("ecsbuy/base/models/base/buy/ecs.buy.history",["require","exports","angular","common/modelSystem/modelFactory","../../../cons/buyBizCons","../../../helpers/subtotalHelper","../../../helpers/commodityHelper","../../../helpers/buyHistoryHelper"],function(e,t,n,r,i,s,o,u){r.regist("ecs.buy.historyModel","BizModel",["modelFactory","base64","aliyunBuyEcsRemoteService",function(e,t,r){function a(e,i){var s=u.BuyHistoryHelper.getHistoryOrderParam(e),o={data:t.encode(n.toJson(s))};return r.describePrice(o)}function f(e,t){var n=e.vm_region_no||t.getFieldValueById("vm_region_no"),s=e.chargeType||t.getFieldValueById("chargeType"),o=i.BuyBizCons.CHARGE_TYPE_MAP[s],u={chargeType:o,regionId:n};return r.queryBuyHistory(u)}function l(e,t){var n=t.getOriginConstraintData();return o.CommodityHelper.isLogin(n)?!0:!1}var c={options:{spm:"history",productName:"ECS",amountUnit:"",showTotalPrice:!0,purchaseCart:"",batchPurchaseButtonText:"",texts:s.SubtotalHelper.getHistoryConfigText()},historyService:{queryHistory:f,beforeQueryHistory:l}};return c}])}),define("ecsbuy/base/models/base/buy/ecs.subtotal",["require","exports","angular","common/modelSystem/modelFactory","common/helper/i18nHelper","../../../helpers/subtotalHelper","../../../helpers/orderDataHelper","../../../helpers/commodityHelper"],function(e,t,n,r,i,s,o,u){r.regist("ecs.buy.subtotalModel","BuySubtotalModel",["$q","aliyunBuyEcsRemoteService","base64",function(e,t,r){function a(e,a,f){var l=a.getOriginConstraintData(),c=!0,h=!0,p="",d=o.OrderDataHelper.getOrderParam(e,u.CommodityHelper.getCommodityCode(l),u.CommodityHelper.getOrderType(l),c,l);if(d.length==1){var v=d[0];v&&v.commodity.internetChargeType=="PayByTraffic"&&(d=[{orderType:"traffic-bandwidth",regionId:v.regionId}].concat(d)),v&&n.isArray(v.imageMarket)?(d=v.imageMarket.concat(d),h=!1,p=i.i18n("ECS_IMAGE_MARKET_ADDTOCART_TIP")):h=!0,f&&f.setSubtotalOptionAttr("addCartAvailable",h),f&&f.setSubtotalOptionAttr("addCartTip",p)}var m={data:r.encode(n.toJson(d))};return t.describePrice4Subtotal(m).then(s.SubtotalHelper.getPurchaseTipMiddle(e,a,f),s.SubtotalHelper.getHandlePriceError(e,a,f))}var f={options:{spm:"subtotal",texts:s.SubtotalHelper.getSubtotalConfigText(),purchaseButtonText:i.i18n("ecs.buy.component.purchase.buynow"),addToCartButtonText:i.i18n("ecs.buy.component.purchase.addToCart")},formatSubtotalData:function(e,t,n){return s.SubtotalHelper.getSubtotalViewItems(e,t)},priceService:{getPrice:a}};return f}])}),define("ecsbuy/base/models/base/buy/ecs.cart",["require","exports","angular","common/modelSystem/modelFactory","common/helper/i18nHelper","../../../helpers/subtotalHelper","../../../helpers/orderDataHelper","../../../helpers/commodityHelper"],function(e,t,n,r,i,s,o,u){r.regist("ecs.buy.cartModel","BuyCartModel",["$q","base64","aliyunBuyEcsRemoteService","aliyunBuyEcsBlockListService",function(e,t,r,a){function f(e,i,s){var a=i.getOriginConstraintData(),f=!0,l=o.OrderDataHelper.getOrderParam(e,u.CommodityHelper.getCommodityCode(a),u.CommodityHelper.getOrderType(a),f,a),c={data:t.encode(n.toJson(l))};return r.describePrice(c)}if(a.inBlockList("ecsBuyAddToCart"))return;var l={options:{spm:"cart",productName:"ECS",amountUnit:"",showTotalPrice:!0,batchPurchaseButtonText:"",texts:s.SubtotalHelper.getCartConfigText()},formatCartItemData:function(e,t,n){var r=n&&n.data&&n.data.tradeAmount,o=s.SubtotalHelper.getSubtotalViewItems(e,t),u=e.chargeType;o=o.concat([{type:"staticText",label:i.i18n("ECS_CONFIG_FEE"),text:""+(r==undefined?"":r)+(u=="postpay"?"/":""),textCss:"bk-orange"}]);var a=parseInt(e.amount);return{amount:a,items:o}},priceService:{getPrice:f}};return l}])}),define("ecsbuy/base/models/base/buy/_base",["require","exports","./ecs.buy.ui","./ecs.buy.biz","./ecs.buy.framework","./ecs.buy.history","./ecs.subtotal","./ecs.cart"],function(e,t){}),define("ecsbuy/base/models/constraints/region/regionRedirectConstraint",["require","exports"],function(e,t){var n={id:"regionChangeConstraint",watches:["vm_region_no"],action:function(e,t,n,r,i){if(!e)return;var s=i.get("ecsBuyRegionService");s.changeRegionHandler(e)}};return n}),define("ecsbuy/base/models/constraints/region/regionQueryHistoryConstraint",["require","exports"],function(e,t){var n={id:"regionChangeConstraint",watches:["vm_region_no"],action:function(e,t,n,r,i){if(!e)return;var s=r.getOrder(),o=i.get("$rootScope");o.$broadcast("aliyunBuyHistory:queryHistory",s,r)}};return n}),define("ecsbuy/base/models/base/bizModel/baseField",["require","exports","angular","common/modelSystem/modelFactory","../../constraints/region/regionRedirectConstraint","../../constraints/region/regionQueryHistoryConstraint","../../../helpers/buyTipsHelper","../../../helpers/fields/regionHelper","../../../helpers/homeConfigHelper","../../../cons/buyBizCons","../../../helpers/buyUtils"],function(e,t,n,r,i,s,o,u,a,f,l){r.regist("ecs.buy.bizField.base","BizModel",["ecsBuyRegionService","aliyunBuyEcsCacheService","aliyunBuyEcsBlockListService","aliyunBuyEcsDynamicDictService",function(e,t,r,c){return[{id:"chargeType",initData:{options:{askTip:o.BuyTipsHelper.getAskTip("chargeType",[a.HomeConfigHelper.getUrlConfig("chargeTypePostpayTips"),"_blank",a.HomeConfigHelper.getUrlConfig("chargeTypeSpotTips")])}},controller:function(e,t,r,i){var s=t.get("$state"),o=t.get("aliyunBuyEcsBlockListService"),u=r.getDominator(),a=!o.inBlockList("ecsBuySpotInstance");e.$watch("rawData.chargeType",function(e){s.includes("buy.prepay")?r.setFieldValue("prepay"):s.includes("buy.postpay")?r.setFieldValue("postpay"):s.includes("buy.spotPostpay")&&r.setFieldValue("spotPostpay"),e=="prepay"?s.go("buy.prepay"):e=="postpay"?s.go("buy.postpay"):e=="spotPostpay"&&(a?s.go("buy.spotPostpay"):s.go("buy.prepay"))});var h=a?f.BuyBizCons.CHARGE_TYPE_ITEMS_WITH_SPOT:f.BuyBizCons.CHARGE_TYPE_ITEMS;c.getCopywriter("chargeType").then(function(e){var t=r.getOptionsAttr("items");if(!t||!e)return;n.forEach(t,function(t){if(e[t.value]){var n=l.BuyUtils.getMapProperty(e,t.value+".tip");if(!n||o.inBlockList("ecsBuyDiscountTip"))return;t.tip=n,t.iconClass=l.BuyUtils.getMapProperty(e,t.value+".iconClass")}})}),r.setOptionsAttr("items",h)}},{id:"vm_region_no",controller:function(e,t,n,r){var i=n.getDominator(),s=t.get("aliyunBuyEcsBlockListService");e.$watch("options",function(e){if(e&&e.items){u.RegionHelper.mergeRegionItems(i,e.items);if(s.inBlockList("ecsBuyDiscountTip"))return;c.getCopywriter("region").then(function(t){if(!t)return;u.RegionHelper.mergeRegionTip(i,e.items,t)})}}),e.$watch("rawData.vm_iz",function(e){var t=i.getFieldById("vm_iz");t.setFieldValue(e)})},constraints:[{id:"izChangeConstraint",watches:["vm_iz"],action:function(e,t,n,r,i){n.$scope&&n.$scope.rawData&&(n.$scope.rawData.vm_iz=e)}},i,s]},{id:"vm_iz",controller:function(e,t,n,r){n.hide()}}]}])}),define("ecsbuy/base/models/constraints/securityGroupConstraints",["require","exports"],function(e,t){var n={id:"securityGroupsConstraint",watches:["vm_region_no","vm_web_type","vm_vpc","allocatePublicIP","defaultSecurityGroupId"],action:function(e,t,n,r,i){var s=n.$scope,o=r.getFieldValueById("vm_region_no"),u=r.getFieldValueById("vm_web_type"),a=r.getFieldValueById("allocatePublicIP"),f=r.getFieldValueById("vm_vpc");if(!o||!u)return;s.valueAll={region:o,networkType:u,vpc:f,allocatePublicIP:a}}};return n}),define("ecsbuy/base/models/constraints/vpcSelectConstraints",["require","exports","../../helpers/commodityHelper"],function(e,t,n){var r={id:"vpcSelectConstraint",watches:["vm_region_no","vm_web_type","vm_iz"],action:function(e,t,r,i,s){var o=r.$scope,u=i.getFieldValueById("vm_region_no"),a=i.getFieldValueById("vm_iz"),f=i.getFieldValueById("vm_web_type");if(!u||!f)return;n.CommodityHelper.getNetworkType(f)=="vpc"?r.show():r.hide(),o.valueAll={region:u,zone:a,networkType:f}}};return r}),define("ecsbuy/base/models/constraints/fieldDynamicTipConstraintsFn",["require","exports","../../helpers/buyUtils","../../helpers/buyTipsHelper"],function(e,t,n,r){var i=function(e,t,i){return{id:e,watches:t,action:function(e,s,o,u,a){var f=[],l=[],c=o.getField().getId();angular.forEach(t,function(e){l.push(u.getFieldValueById(e))});if(n.BuyUtils.hasUndefined.apply(null,l))return;var h=[c,l.join("_")].join("__"),p=i&&i.translateValues||[],d=r.BuyTipsHelper.getBlockTip(h,p);o.setOptionsAttr("tip",d)}}};return i}),define("ecsbuy/base/models/constraints/common/defaultValueConstraintFn",["require","exports"],function(e,t){var n=function(e){return{id:"defaultValueConstraintFn",watches:angular.isArray(e)?e:[e],action:function(t,n,r,i,s){var o=r.$scope;if(!o)return;e=angular.isArray(e)?e:[e],n&&t&&(o.rawData[n]=t)}}};return n}),define("ecsbuy/base/helpers/constraintHelper",["require","exports","angular","./commodityHelper"],function(e,t,n,r){var i=function(){function e(){}return e.filterComponentWhenChildNull=function(e,t,i,s,o,u){if(!n.isArray(t)||!s)return;for(var a=0;a<t.length;a++){var f=t[a];if(!f)return;var l={},c={};l[i]=f.value;var c=o?n.extend(c,o,l):l,h=this.mapToList(c),p=e.getOptions(s,h);n.isFunction(u)&&u(p,f.value);if(!p||p.length==0)r.CommodityHelper.removeItemFromCollection(f.value,t),a--}},e.mapToList=function(e){var t=[];if(e)for(var n in e)t.push({code:n,value:e[n]});return t},e.deleteComponentWhenChildComponentIsNull=function(e,t,i,s){if(!n.isArray(t)||!i)return;var o=i.split(".");for(var u=0;u<t.length;u++){var a=t[u];if(!a)return;var f={},l={},c=o[0],h=o[1];f[c]=a.value;var l=s?n.extend(l,s,f):f,p=e.getOptionsFromConstraints(h,l);u==t.length-1,o.length>=2&&this.deleteComponentWhenChildComponentIsNull(e,p,o,l);if(!p||p.length==0)r.CommodityHelper.removeItemFromCollection(a.value,t),u--}},e}();t.ConstraintHelper=i}),define("ecsbuy/base/models/base/bizModel/networkField",["require","exports","angular","common/modelSystem/modelFactory","common/helper/i18nHelper","dominator/base/helpers/moduleHelper","dominator/core/Commodity/Commodity","../../constraints/securityGroupConstraints","../../constraints/vpcSelectConstraints","../../constraints/fieldDynamicTipConstraintsFn","../../constraints/common/defaultValueConstraintFn","../../../helpers/buyTipsHelper","../../../helpers/commodityHelper","../../../cons/buyBizCons","../../../helpers/homeConfigHelper","../../../helpers/orderDataHelper","../../../helpers/buyUtils","../../../helpers/constraintHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){r.regist("ecs.buy.bizField.network","BizModel",["aliyunBuyEcsDynamicDictService","aliyunBuyEcsRemoteService",function(e,t){return[{id:"vm_web_type",initData:{options:{spm:"type",tip:i.i18n("ECS_NETWORK_TYPE_TIP"),askTip:c.BuyTipsHelper.getAskTip("webType")}},controller:function(t,r,i,s){var o=r.get("aliyunBuyEcsBlockListService");t.$watch("options.items",function(t){var r=i.getOptionsAttr("items");if(r&&n.isArray(r)&&r.length==2){if(o.inBlockList("ecsBuyDiscountTip"))return;e.getCopywriter("networkType").then(function(e){if(!e)return;n.forEach(r,function(t){var n=h.CommodityHelper.getNetworkType(t.value);if(e[n]){var r=m.BuyUtils.getMapProperty(e,n+".tip"),i=m.BuyUtils.getMapProperty(e,n+".iconClass");r&&(t.tip=r),i&&(t.iconClass=i)}})})}})},constraints:[{id:"networkTypeRenderConstraint",watches:["vm_region_no","vm_iz"],action:function(e,t,n,r,i){var s=r.getOptionsFromConstraints("vm_web_type"),u=r.getOriginConstraintData(),a=o.Commodity,f=new a(u,[]),l=r.getFieldValueById("vm_region_no"),c=r.getFieldValueById("vm_iz");g.ConstraintHelper.filterComponentWhenChildNull(f,s,"vm_web_type","instance_generation",{vm_region_no:l,vm_iz:c},function(e,t){g.ConstraintHelper.filterComponentWhenChildNull(f,e,"instance_generation","instance_type_family",{vm_region_no:l,vm_iz:c,vm_web_type:t},function(e,n){g.ConstraintHelper.filterComponentWhenChildNull(f,e,"instance_type_family","instance_type",{vm_region_no:l,vm_iz:c,vm_web_type:t,instance_generation:n},null)})}),n.setOptionsAttr("items",s)}}]},{id:"vm_vpc",controller:function(e,t,n,r){var i=n.getDominator();e.raw=i.getOriginConstraintData(),e.$watch("valueAll.vSwitchZone",function(e){if(e){var t=i.getFieldById("vm_iz");t.setFieldValue(e)}})},constraints:[a,l(["defaultValueVpcId","defaultValueVswitchId"])]},{id:"defaultSecurityGroupId",controller:function(e,t,n,r){n.hide()}},{id:"defaultValueVpcId",controller:function(e,t,n,r){n.hide()}},{id:"defaultValueVswitchId",controller:function(e,t,n,r){n.hide()}},{id:"allocatePublicIP",initData:{options:{items:p.BuyBizCons.ALLOCATE_PUBLIC_IP}},controller:function(e,t,n,r){},constraints:[f("allocatePublicIpTipConstraint",["allocatePublicIP"],{translateValues:[d.HomeConfigHelper.getUrlConfig("bindPublicIpTips"),"_blank"]}),{id:"allocatePublicIpRenderConstraint",watches:["vm_web_type","vm_vpc"],action:function(e,t,n,r,i){var o=i.get("aliyunBuyEcsBlockListService");if(o.inBlockList("ecsBuyPublicIp")){n.setFieldValue("disabled"),n.hide();return}n.hide();var u=h.CommodityHelper.getNetworkType(r.getFieldValueById("vm_web_type"));if(u=="classic")return;var a=r.getFieldValueById("vm_vpc"),f=s.parseJsonSafe(a),l=f[0],c=f[3];if(!l)return;n.show(),c||l=="random"?n.setFieldValue("enabled"):n.setFieldValue("disabled")}}]},{id:"securityGroup",initData:{options:{askTip:c.BuyTipsHelper.getAskTip("securityGroup",[d.HomeConfigHelper.getUrlConfig("securityGroupTips"),"_blank"])}},controller:function(e,t,n,r){var i=n.getDominator();e.raw=i.getOriginConstraintData(),e.$watch("rawData.groupRule",function(e){var t=i.getFieldById("groupRule");t.setFieldValue(e)})},constraints:[u,l(["defaultSecurityGroupId","groupRule"])]},{id:"groupRule",controller:function(e,t,n,r){n.hide()}},{id:"inWhiteListForNetworkInterface",controller:function(e,t,n,r){n.hide()}},{id:"networkInterface",controller:function(e,n,r,i){var s=r.getDominator();t.inWhiteListForNetworkInterface().then(function(e){if(e==1){var t=s.getFieldById("inWhiteListForNetworkInterface");t.setFieldValue(!0)}})},constraints:[{id:"networkInterfaceDependencyConstraint",watches:["vm_region_no","vm_iz","vm_web_type","vm_vpc","iooptimized","instance_type","inWhiteListForNetworkInterface"],action:function(e,t,n,r,i){var s=r.getOriginConstraintData(),o=n.$scope,u=r.getFieldValueById("vm_region_no"),a=r.getFieldValueById("vm_iz"),f=h.CommodityHelper.getNetworkType(r.getFieldValueById("vm_web_type")),l=r.getFieldValueById("vm_vpc"),c=r.getFieldValueById("iooptimized"),p=v.OrderDataHelper.getVpc(l),d=p.vpcId,g=p.vSwitchId,y=r.getFieldById("vm_vpc"),b=y&&y.getOptionsAttr("vswitchDetail"),w=r.getFieldValueById("inWhiteListForNetworkInterface"),E=r.getFieldValueById("instance_type"),S=m.BuyUtils.getSelectItem(m.BuyUtils.getMapProperty(s,"components.instance_type.instance_type"),E,!0),x=S&&S.cpu;if(!u||!f)return;var T=i.get("$rootScope"),N;f!="vpc"||c!="optimized"||!g||!w||x<4?(N="disabled",T.$broadcast("aliyunBuyGroupDisplay:networkInterfaceConfig",!1)):(N="enabled",T.$broadcast("aliyunBuyGroupDisplay:networkInterfaceConfig",!0)),o.valueAll={region:u,networkType:f,vpcId:d,zoneId:a,vSwitchId:g,status:N,cpu:x,vSwitchText:b&&b.text}}}]}]}])}),define("ecsbuy/base/models/base/bizModel/instanceTypeField",["require","exports","angular","dominator/base/helpers/constraintHelper","common/modelSystem/modelFactory","dominator/core/Commodity/Commodity","../../../helpers/buyTipsHelper","../../../helpers/instanceTypeHelper","../../../helpers/buyUtils","../../../cons/buyBizCons","../../../helpers/buyBizHelper"],function(e,t,n,r,i,s,o,u,a,f,l){i.regist("ecs.buy.bizField.instanceType","BizModel",[function(){return[{id:"instance_type",initData:{options:{theme:"remarkClass"}},controller:function(e,t,n,r){var i=n.getDominator();e.raw=i.getOriginConstraintData()},constraints:[{id:"instanceTypeRenderConstraint",watches:["vm_region_no","vm_iz","iooptimized","vm_web_type","defaultInstanceType"],action:function(e,t,i,o,c){var h=o.getOriginConstraintData(),p=s.Commodity,d=l.BuyBizHelper.getFieldValue("defaultInstanceType",o),v=o.getFieldValueById("instance_type"),m=o.getFieldValueById("vm_region_no"),g=o.getFieldValueById("vm_iz"),y=o.getFieldValueById("vm_web_type"),b=o.getFieldValueById("iooptimized"),w=new p(h,[]),E=[{code:"vm_region_no",value:m},{code:"vm_iz",value:g},{code:"vm_web_type",value:y}],S=w.getOptions("instance_generation",E),x=[];n.forEach(S,function(e){E.push({code:"instance_generation",value:e.value});var t=w.getOptions("instance_type_family",E);x=x.concat(t)}),x=a.BuyUtils.unique(x,"value");var T=[];n.forEach(x,function(e){E.push({code:"iooptimized",value:b},{code:"instance_type_family",value:e.value},{code:"instance_generation",value:undefined});var t=w.getOptions("instance_type",E);T=T.concat(t)}),T=a.BuyUtils.unique(T,"value");if(!n.isArray(T))return;d||(d=v);if(!r.contains(T,d,"value")){var N=a.BuyUtils.getMapProperty(h,"config.defaultInstanceTypes")||f.BuyBizCons.DEFAULT_INSTANCE_TYPE;for(var C=0;C<N.length;C++){var k=a.BuyUtils.getSelectItem(T,N[C],"value");if(k&&k.value){d=k.value;break}}}r.contains(T,d,"value")||(d=a.BuyUtils.getMapProperty(T,"0.value"));var L=i.getScope(),A=a.BuyUtils.getSelectItem(T,d,!1),O=A.value;L.rawData.$detail={text:u.InstanceTypeHelper.getInstanceTypeDetail(A,h),value:O},L.valueAll={regionId:m,zoneId:g,iooptimized:b,networkType:y},i.setFieldValue(O),i.setOptionsAttr("items",T)}}]},{id:"defaultInstanceType",controller:function(e,t,n,r){n.hide()}},{id:"defaultIooptimized",controller:function(e,t,n,r){n.hide()}},{id:"iooptimized",initData:{options:{askTip:o.BuyTipsHelper.getAskTip("iooptimized")}},controller:function(e,t,n,r){},constraints:[{id:"iooptimizedConstraint",watches:["vm_region_no","vm_iz","vm_web_type","defaultIooptimized"],action:function(e,t,r,i,o){var u=i.getOriginConstraintData(),f=s.Commodity,c=new f(u,[]),h=i.getFieldValueById("vm_region_no"),p=i.getFieldValueById("vm_iz"),d=i.getFieldValueById("vm_web_type"),v=l.BuyBizHelper.getFieldValue("defaultIooptimized",i),m=[{code:"vm_region_no",value:h},{code:"vm_iz",value:p},{code:"vm_web_type",value:d}],g=c.getOptions("instance_generation",m),y=[];n.isArray(g)&&n.forEach(g,function(e){m.push({code:"instance_generation",value:e.value});var t=c.getOptions("iooptimized",m);y=y.concat(t)}),y=a.BuyUtils.unique(y,"value"),r.setOptionsAttr("items",y);if(y.length>1)v?r.setFieldValue(v):r.setFieldValue("optimized");else if(y.length==1){var b=a.BuyUtils.getMapProperty(y,"0.value");r.setFieldValue(b)}else r.setFieldValue("optimized")}}]}]}])}),define("ecsbuy/base/models/constraints/bandwidth/bandwidthDefaultValueConstraintsFn",["require","exports"],function(e,t){var n=function(){return{id:"bandwidthDefaultValueConstraints",watches:["vm_is_flow_type"],action:function(e,t,n,r,i){var s=i.get("$timeout");n.setOptionsAttr("min",n.getOptionsAttr("min")/1024),n.setOptionsAttr("max",n.getOptionsAttr("max")/1024),n.setOptionsAttr("step",n.getOptionsAttr("step")/1024),n.setOptionsAttr("spm","type"+e);var o=r.getOptionsFromConstraints("default_bandwidth");s(function(){angular.isArray(o)&&o[0]?n.setFieldValue(o[0].value):n.setFieldValue(n.getOptionsAttr("min"))})}}};return n}),define("ecsbuy/base/models/constraints/bandwidth/bandwidthTypeTipConstraints",["require","exports","../../../helpers/commodityHelper","../../../cons/fieldCons","../../../helpers/buyTipsHelper","../../../helpers/buyUtils"],function(e,t,n,r,i,s){var o={id:"bandwidthTypeTipConstraints",watches:["vm_bandwidth","vm_web_type","vm_is_flow_type"],action:function(e,t,o,u,a){var f=u.getFieldValueById("chargeType"),l=u.getFieldValueById("vm_web_type"),c=u.getFieldValueById("vm_is_flow_type");if(s.BuyUtils.hasUndefined(f,l,c))return;var h;n.CommodityHelper.getBandwidthType(c)==r.FieldCons.FIELD_BANDWIDTH_TYPE_TRAFFIC?h="traffic":n.CommodityHelper.getNetworkType(l)==r.FieldCons.FIELD_NETWORK_TYPE_VPC?h="bandwidth_vpc_"+f:h="bandwidth_classic_"+f,h="bandwidthType_"+h;var p=i.BuyTipsHelper.getBlockTip(h);o.setOptionsAttr("tip",p)}};return o}),define("ecsbuy/base/models/constraints/bandwidth/bandWidthTipConstraint",["require","exports","dominator/base/helpers/constraintHelper","../../../helpers/buyTipsHelper","../../../helpers/commodityHelper","../../../cons/buyBizCons"],function(e,t,n,r,i,s){var o={id:"bandWidthTipConstraint",watches:["vm_bandwidth","vm_web_type","vm_region_no"],action:function(e,t,o,u,a){var f=u.getOriginConstraintData(),l=i.CommodityHelper.isFinanceUser(f),c=r.BuyTipsHelper.getBlockTip("bandwidth_finance"),h=r.BuyTipsHelper.getBlockTip("bandwidth_more_then_0_vpc"),p=r.BuyTipsHelper.getBlockTip("bandwidth_more_then_0_classic"),d=r.BuyTipsHelper.getBlockTip("bandwidth_intl"),v=u.getFieldValueById("vm_region_no"),m=[],g=i.CommodityHelper.getNetworkType(u.getFieldValueById("vm_web_type")),y=u.getFieldValueById("vm_bandwidth");if(y>0)g=="vpc"?m.push(h):g=="classic"&&m.push(p);else{var b=r.BuyTipsHelper.getBlockTip("bandwidth_value_0");m.push(b)}l&&m.push(c),n.contains(s.BuyBizCons.INTL_REGIONS,v)&&m.push(d);var w=m.join("<br/>");o.setOptionsAttr("tip",w)}};return o}),define("ecsbuy/base/models/constraints/bandwidth/BandwidthTypeDefaultValueConstraint",["require","exports"],function(e,t){var n={id:"bandwidthTypeDefaultValueConstraints",watches:["vm_region_no"],action:function(e,t,n,r,i){var s=i.get("$timeout"),o=r.getOptionsFromConstraints("default_vm_is_flow_type");s(function(){angular.isArray(o)&&o[0]&&n.setFieldValue(o[0].value)})}};return n}),define("ecsbuy/base/models/constraints/bandwidth/bandwidthDisplayConstraint",["require","exports","../../../helpers/commodityHelper","../../../helpers/buyBizHelper"],function(e,t,n,r){var i=null,s={id:"BandwidthDisplayConstraints",watches:["allocatePublicIP","vm_web_type"],action:function(e,t,s,o,u){var a=u.get("$rootScope"),f=r.BuyBizHelper.getFieldValue("allocatePublicIP",o),l=n.CommodityHelper.getNetworkType(o.getFieldValueById("vm_web_type"));l=="vpc"&&f=="disabled"?(i=s.getFieldValue(),s.setFieldValue(0),a.$broadcast("aliyunBuyGroupDisplay:bandwidthConfig",!1)):(i!=null&&s.setFieldValue(i),a.$broadcast("aliyunBuyGroupDisplay:bandwidthConfig",!0))}};return s}),define("ecsbuy/base/models/base/bizModel/bandwidthField",["require","exports","common/modelSystem/modelFactory","../../constraints/bandwidth/bandwidthDefaultValueConstraintsFn","../../constraints/bandwidth/bandwidthTypeTipConstraints","../../constraints/bandwidth/bandWidthTipConstraint","../../constraints/bandwidth/BandwidthTypeDefaultValueConstraint","../../constraints/bandwidth/bandwidthDisplayConstraint","../../../helpers/buyTipsHelper"],function(e,t,n,r,i,s,o,u,a){n.regist("ecs.buy.bizField.bandwidth","BizModel",[function(){return[{id:"vm_bandwidth",initData:{options:{unit:"M",numberUnit:"Mbps"}},constraints:[u,r(),s]},{id:"vm_is_flow_type",initData:{spm:"type",options:{askTip:a.BuyTipsHelper.getAskTip("bandwidth")}},constraints:[i,o]}]}])}),define("ecsbuy/base/models/constraints/image/imageTypeRenderConstraint",["require","exports","dominator/base/helpers/constraintHelper","../../../cons/buyBizCons","../../../helpers/commodityHelper"],function(e,t,n,r,i){var s={id:"imageTypeConstraint",watches:["vm_region_no","instance_type"],action:function(e,t,s,o,u){var a=o&&o.getOriginConstraintData(),f=i.CommodityHelper.isLogin(a),l=o.getFieldValueById("vm_region_no"),c=o.getFieldValueById("instance_type"),h=c&&c.split(".")[1],p=n.contains(r.BuyBizCons.INSTANCE_FAMILIES_UNSUPPORTED_PUBLIC_IMAGE,h),d=n.contains(r.BuyBizCons.INTL_REGIONS,l),v;f?v=[r.BuyBizCons.IMAGE_TYPE_PUBLIC,r.BuyBizCons.IMAGE_TYPE_CUSTOM,r.BuyBizCons.IMAGE_TYPE_SHARED,r.BuyBizCons.IMAGE_TYPE_MARKET]:v=[r.BuyBizCons.IMAGE_TYPE_PUBLIC,r.BuyBizCons.IMAGE_TYPE_MARKET];if(p)if(f&&!d)v=[r.BuyBizCons.IMAGE_TYPE_MARKET,r.BuyBizCons.IMAGE_TYPE_CUSTOM,r.BuyBizCons.IMAGE_TYPE_SHARED];else if(!f||d)v=[r.BuyBizCons.IMAGE_TYPE_MARKET];var m=u.get("aliyunBuyEcsBlockListService"),g=m&&m.inBlockList("ecsBuyShareImage"),y=m&&m.inBlockList("ecsBuyMarketImage")||i.CommodityHelper.isChildAccount(a);y&&i.CommodityHelper.removeItemFromCollection("market",v),g&&i.CommodityHelper.removeItemFromCollection("shared",v),s.setOptionsAttr("items",v)}};return s}),define("ecsbuy/base/models/constraints/image/imageDepsFieldValueConstraints",["require","exports","../../../helpers/imageHelper"],function(e,t,n){var r={id:"fetchDataConstraint",watches:["vm_region_no","imageType","iooptimized","instance_type"],action:function(e,t,r,i,s){var o=r.$scope;r.setFieldValue(null);var u=i.getFieldValueById("vm_region_no"),a=i.getFieldValueById("instance_type"),f=i.getFieldValueById("iooptimized")=="optimized"?"True":undefined,l=i.getFieldValueById("vm_web_type"),c=n.ImageHelper.getImageOsKind(i),h=c.length==1?c[0]:undefined;if(!u||!a)return;o.valueAll={regionId:u,instanceType:a,iooptimized:f,networkType:l,osType:h}}};return r}),define("ecsbuy/base/models/constraints/image/imageDisplayConstraintsFn",["require","exports"],function(e,t){var n=function(e){return{id:"displayConstraint",watches:["imageType"],action:function(t,n,r,i,s){t==e?r.show():r.hide()}}};return n}),define("ecsbuy/base/models/constraints/image/imageValueAllConstraints",["require","exports","../../../helpers/buyBizHelper"],function(e,t,n){var r={id:"imageFromMarketConstraints",watches:["vm_region_no","imageType","customImage","sharedImage","marketImage"],action:function(e,t,r,i,s){var o=r.$scope;r.setFieldValue(null);var u=i.getFieldValueById("customImage"),a=i.getFieldValueById("sharedImage"),f=i.getFieldValueById("marketImage"),l=i.getFieldValueById("imageType"),c=i.getFieldValueById("vm_region_no"),h=i.getFieldValueById("iooptimized"),p=n.BuyBizHelper.getFieldValue("chargeType",i);o.valueAll={customImage:u,sharedImage:a,marketImage:f,imageType:l,region:c,iooptimized:h,chargeType:p}}};return r}),define("ecsbuy/base/models/constraints/image/publicImageFetchDataConstraintsFn",["require","exports","../../../helpers/imageHelper","../../../helpers/buyBizHelper","../../../helpers/buyUtils"],function(e,t,n,r,i){var s=function(e){var t=e.get("aliyunBuyEcsRemoteService"),s=e.get("aliyunBuyPriceQuerier"),o=new s(t.describeImages);return{id:"fetchDataConstraint",watches:["vm_region_no","iooptimized","instance_type","vm_os_kind"],action:function(e,t,s,u,a){var f=s.$scope;if(!e)return;var l=u.getFieldValueById("vm_region_no"),c=u.getFieldValueById("instance_type"),h=u.getFieldValueById("iooptimized")=="optimized"?"True":undefined,p=n.ImageHelper.getImageOsKind(u),d=p.length==1?p[0]:undefined;if(!l||!c)return;var v={imageOwnerAlias:"system",instanceType:c,pageNumber:1,pageSize:100,regionId:l,isSupportIoOptimized:h,oSType:d};!!o&&angular.isFunction(o.promise.then)&&(o.promise.then(null,null,function(e){if(!e.pending){var t=e.data,o=t&&t.Images&&t.Images.Image,a=n.ImageHelper.formatPublicImages(o);s.setOptionsAttr("items",a),r.BuyBizHelper.setFieldValue("publicImageDataLoaded",!0,u);var l=s.getFieldValue(),c=l?n.ImageHelper.parseValue(l).imageId:undefined,h=n.ImageHelper.findPublicImageByImageId(a,c);i.BuyUtils.hasUndefined(h.rootValue,h.childValue)?f.rawData.publicImage=undefined:(f.rawData.rootValue=h.rootValue,f.rawData.publicImage=h.childValue)}}),o.query.call(o,v))}}};return s}),define("ecsbuy/base/models/constraints/clearStateErrorConstraintsFn",["require","exports"],function(e,t){var n=function(e){return{id:"clearStateErrorConstrants",watches:[e],action:function(e,t,n,r,i){n.setOptionsAttr("state","")}}};return n}),define("ecsbuy/base/models/constraints/image/imageTypeTipConstraint",["require","exports","dominator/base/helpers/constraintHelper","../../../helpers/buyTipsHelper","../../../cons/buyBizCons"],function(e,t,n,r,i){var s={id:"imageTypeTipConstraint",watches:["vm_region_no","instance_type","imageType"],action:function(e,t,s,o,u){var a=r.BuyTipsHelper.getBlockTip("image_type_intl"),f=r.BuyTipsHelper.getBlockTip("image_type_gpu"),l=o.getFieldValueById("vm_region_no"),c=o.getFieldValueById("instance_type"),h=c&&c.split(".")[1],p=n.contains(i.BuyBizCons.INSTANCE_FAMILIES_UNSUPPORTED_PUBLIC_IMAGE,h),d="";n.contains(i.BuyBizCons.INTL_REGIONS,l)&&(d=a),p&&s.getFieldValue()=="market"&&(d+=f),s.setOptionsAttr("tip",d)}};return s}),define("ecsbuy/base/models/constraints/image/publicImageDefaultValueConstraint",["require","exports","../../../helpers/imageHelper","../../../helpers/buyUtils","../../../helpers/buyBizHelper"],function(e,t,n,r,i){var s={id:"defaultValueConstraint",watches:["publicDefaultValueImageId","imageType","publicImageDataLoaded"],action:function(e,t,s,o,u){var a=s.$scope,f=o.getFieldValueById("imageType");if(f!="public")return;var l=s.getOptionsAttr("items"),c=i.BuyBizHelper.getFieldValue("publicDefaultValueImageId",o),h=n.ImageHelper.findPublicImageByImageId(l,c);r.BuyUtils.hasUndefined(h.rootValue,h.childValue)||(a.rawData.rootValue=h.rootValue,a.rawData.publicImage=h.childValue)}};return s}),define("ecsbuy/base/models/constraints/image/imageSecurityDisplayConstraint",["require","exports"],function(e,t){var n={id:"securityDisplayConstraint",watches:["imageType"],action:function(e,t,n,r,i){e=="public"?n.show():n.hide()}};return n}),define("ecsbuy/base/models/constraints/image/imageSecurityEnhanceTipConstraint",["require","exports","../../../helpers/buyTipsHelper"],function(e,t,n){var r={id:"securityEnhanceTipConstraint",watches:["securityEnhancementStrategy"],action:function(e,t,r,i,s){if(!e){var o=n.BuyTipsHelper.getBlockTip("security_warning_tip");r.setOptionsAttr("tip",o)}else r.setOptionsAttr("tip","")}};return r}),define("ecsbuy/base/models/base/bizModel/imageField",["require","exports","common/modelSystem/modelFactory","common/helper/i18nHelper","../../constraints/image/imageTypeRenderConstraint","../../constraints/image/imageDepsFieldValueConstraints","../../constraints/image/imageDisplayConstraintsFn","../../constraints/image/imageValueAllConstraints","../../constraints/image/publicImageFetchDataConstraintsFn","../../constraints/clearStateErrorConstraintsFn","../../constraints/common/defaultValueConstraintFn","../../constraints/image/imageTypeTipConstraint","../../constraints/image/publicImageDefaultValueConstraint","../../constraints/image/imageSecurityDisplayConstraint","../../constraints/image/imageSecurityEnhanceTipConstraint","../../../helpers/buyTipsHelper","../../../cons/buyBizCons","../../../helpers/homeConfigHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){n.regist("ecs.buy.bizField.image","BizModel",["$injector",function(e){return[{id:"imageType",initData:{options:{items:m.BuyBizCons.DEFAULT_IMAGE_TYPE,askTip:v.BuyTipsHelper.getAskTip("imageType",[!0,!0,!0,!0])}},controller:function(e,t,n,r){var i=t.get("aliyunBuyEcsBlockListService"),s=i&&i.inBlockList("ecsBuyShareImage"),o=i&&i.inBlockList("ecsBuyMarketImage"),u=v.BuyTipsHelper.getAskTip("imageType",[!0,!0,!s,!o]);n.setOptionsAttr("askTip",u)},constraints:[i,c]},{id:"publicImage",initData:{options:{placeholder:r.i18n("ecs.buy.component.image.public.selectPlatform"),"short":!0,childrenPlaceholder:r.i18n("ecs.buy.component.image.public.selectVersion"),childrensLong:!0,textTip:v.BuyTipsHelper.getTextTip("publicImage",[g.HomeConfigHelper.getUrlConfig("publicImageTips"),"_blank"])}},constraints:[f("publicImage"),o("public"),a(e),h]},{id:"customImage",initData:{options:{placeholder:r.i18n("ecs.buy.component.image.custom.select")}},constraints:[f("customImage"),s,o("custom"),l("customDefaultValueImageId")]},{id:"sharedImage",initData:{options:{placeholder:r.i18n("ecs.buy.component.image.shared.select")}},constraints:[f("sharedImage"),s,o("shared"),l("sharedDefaultValueImageId")]},{id:"marketImage",initData:{options:{}},controller:function(e,t,n,r){var i=n.getDominator();e.raw=i.getOriginConstraintData()},constraints:[f("marketImage"),s,o("market"),l("marketDefaultValueImageId")]},{id:"imageOffline",constraints:[u]},{id:"imageFromMarket",constraints:[u]},{id:"publicImageDataLoaded",controller:function(e,t,n,r){n.hide()}},{id:"publicDefaultValueImageId",controller:function(e,t,n,r){n.hide()}},{id:"customDefaultValueImageId",controller:function(e,t,n,r){n.hide()}},{id:"sharedDefaultValueImageId",controller:function(e,t,n,r){n.hide()}},{id:"marketDefaultValueImageId",controller:function(e,t,n,r){n.hide()}},{id:"securityEnhancementStrategy",initData:{options:{askTip:v.BuyTipsHelper.getAskTip("securityEnhancement")},display:r.i18n("ECS_AEGIS_NAME")},controller:function(e,t,n,r){n.hide(),n.setFieldValue(!0)},constraints:[p,d]}]}])}),define("ecsbuy/base/models/constraints/amount/orderTimeConstraints",["require","exports","angular","../../../helpers/commodityHelper"],function(e,t,n,r){var i={id:"appendUnitConstraint",watches:["order_time"],action:function(e,t,i,s,o){var u=i.getOptionsAttr("items");n.forEach(u,function(t){var n=t.value;n<10&&n>=1&&(n!=e?t.text=n:t.text=r.CommodityHelper.getOrderTimeText(n))})}};return i}),define("ecsbuy/base/models/constraints/amount/amountLimitConstraints",["require","exports","common/helper/i18nHelper","../../../helpers/commodityHelper"],function(e,t,n,r){var i={id:"amountLimitConstraints",watches:["vm_region_no"],action:function(e,t,i,s,o){var u=s.getOriginConstraintData(),a=r.CommodityHelper.getConfig(u),f=r.CommodityHelper.getCommodityCode(u),l=r.CommodityHelper.getConfigProperty(u,"order_num"),c=r.CommodityHelper.getConfigProperty(u,"already_has_resource_num")||0,h=l.max;h-c<l.min?(i.setOptionsAttr("min",0),i.setOptionsAttr("max",0)):h-c>500?i.setOptionsAttr("max",500):i.setOptionsAttr("max",h-c),f!="vm"&&i.setOptionsAttr("maxLimit",h-c);var p="",d="";if(f=="vm"||f=="ecs")p=n.i18n("ECS_INSTANCE_UNIT"),d="ECS";f=="yundisk"&&(p=n.i18n("ECS_DISK_UNIT"),d=n.i18n("ecs.buy.component.product.clouddisk")),f=="san"&&(p=n.i18n("ECS_DISK_UNIT"),d=n.i18n("ecs.buy.component.product.volume"));var v=n.i18nByMap("ECS_AMOUNT_LIMIT_MSG",{unit:p,prodName:d,allowMax:h,has:c});i.setOptionsAttr("unit",p),r.CommodityHelper.isLogin(u)&&f!="vm"&&i.setOptionsAttr("tip",v)}};return i}),define("ecsbuy/base/models/constraints/amount/discountTipConstraints",["require","exports","angular","dominator/base/helpers/constraintHelper","../../../cons/buyBizCons","../../../helpers/commodityHelper","../../../helpers/buyUtils"],function(e,t,n,r,i,s,o){var u={id:"discountTipConstraints",watches:["vm_region_no","imageType"],action:function(e,t,u,a,f){if(!e)return;var l=a.getOriginConstraintData(),c=f.get("aliyunBuyEcsBlockListService"),h=s.CommodityHelper.isFinanceUser(l),p=u.getOptionsAttr("items"),d=f.get("aliyunBuyEcsDynamicDictService");d.getCopywriter("buyDuration").then(function(t){n.forEach(p,function(n){var s="",u=n.value;u&&u.toString().indexOf(".")>-1&&(u=u.toString().replace(".","-")),h&&!c.inBlockList("ecsBuyDiscountTip")?s=o.BuyUtils.getMapProperty(t,"finance."+u):r.contains(i.BuyBizCons.INTL_REGIONS,e)?s=o.BuyUtils.getMapProperty(t,"internationalRegion."+u):s=o.BuyUtils.getMapProperty(t,"internalRegion."+u),s&&!c.inBlockList("ecsBuyDiscountTip")?(n.tip=s,n.iconClass=i.BuyBizCons.HUI_ICON_CLASS):(n.tip="",n.iconClass="")})})}};return u}),define("ecsbuy/base/directives/dialog/class/agreementDialogClass",["require","exports","angular","../../../helpers/homeConfigHelper"],function(e,t,n,r){var i=function(){function e(e,t,i,s,o){if(!e||!t)throw Error("templateUrl is required");this.templateUrl=e,this.agreementAction=t,this.signSuccessCallback=s;var u=this;if(o)return;this.controller=["$scope","$timeout","$injector",function(e,s,o){e.isLoading=!1,e.activateStatus="none",e.config=i,e.signAgreement=function(i){if(!i)return;e.isLoading=!0;var s=r.HomeConfigHelper.getValue("CSRF_TOKEN"),a={_csrf_token:s},f=o.get("aliyunBuyEcsRemoteService");f[t](a).then(function(t){e.activateStatus="success",n.isFunction(u.signSuccessCallback)&&u.signSuccessCallback(e)},function(t){e.activateStatus="failed",e.isLoading=!1})}}]}return e}();t.AgreementDialogClass=i}),define("ecsbuy/base/models/base/bizModel/amountField",["require","exports","common/modelSystem/modelFactory","common/helper/i18nHelper","../../constraints/amount/orderTimeConstraints","../../constraints/amount/amountLimitConstraints","../../constraints/amount/discountTipConstraints","../../../helpers/buyTipsHelper","../../../helpers/commodityHelper","../../../cons/buyBizCons","../../../helpers/buyUtils","../../../cons/remoteActions","../../../directives/dialog/class/agreementDialogClass","../../../cons/cons","../../../helpers/homeConfigHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){function v(e,t,n,r){var i=n.getDominator().getOriginConstraintData(),s=a.CommodityHelper.getCommodityCode(i);s=="vm"?n.show():n.hide()}n.regist("ecs.buy.bizField.amount","BizModel",["aliyunBuyEcsRemoteService","aliyunBuyEcsBlockListService",function(e,t){return[{id:"autoRenew",initData:{display:r.i18n("ECS_AUTO_RENEW"),options:{askTip:u.BuyTipsHelper.getAskTip("autoRenew")}},controller:v},{id:"recyclable",initData:{display:"",options:{askTip:{spm:"askTipForRecyclable",tooltip:r.i18n("ASKTIP__TOOLTIP__RECYCLABLE",d.HomeConfigHelper.getUrlConfig("recycleBinAgreementUrl"))}}},controller:function(n,i,s,o){function b(){function o(e){n.isSignedAgreement=!0,y(function(){s.close()},500)}var e=p.Constant.PARTIALS_PATH+"dialog/recycleBinAgreement.html",t={title:r.i18n("ECS_RECYCLE_BIN_TERM_TITLE"),content:r.i18n("ECS_RECYCLE_BIN_TERM_CONTENT"),height:"320px",termText:r.i18n("ECS_RECYCLE_BIN_TERM_TEXT"),termUrl:d.HomeConfigHelper.getUrlConfig("recycleBinAgreementUrl"),signText:r.i18n("ECS_RECYCLE_BIN_TERM_SIGN_TEXT"),successTip:r.i18n("ECS_RECYCLE_BIN_TERM_SIGN_SUCCESS_TIP"),failedTip:r.i18n("ECS_RECYCLE_BIN_TERM_SIGN_FAILED_TIP")},i=new h.AgreementDialogClass(e,c.RemoteActions.SIGN_RECYCLE_BIN_AGREEMENT,t,o,null),s=g.open(i)}var u=s.getDominator().getOriginConstraintData(),f=a.CommodityHelper.getCommodityCode(u),v=a.CommodityHelper.isChildAccount(u),m=l.BuyUtils.getMapProperty(u,"config.inWhiteList");f=="vm"&&!t.inBlockList("ecsRecycleBin")&&!v&&m?s.show():s.hide();var g=i.get("aliyunBuyDialog"),y=i.get("$timeout");n.$watch("rawData.recyclable",function(t){if(!t)return;if(n.isSignedAgreement)return;e[c.RemoteActions.IS_SIGNED_RECYCLE_BIN_AGREEMENT]().then(function(e){n.isSignedAgreement=e,e||b()})})}},{id:"order_time",initData:{options:{spm:"duration-",theme:"mini",items:f.BuyBizCons.DEFAULT_ORDERTIME_ITEMS}},controller:function(e,t,n,r){var i=n.getDominator().getOriginConstraintData(),s=a.CommodityHelper.getOrderTimeOptionsItems(i);s instanceof Array&&s.length>0&&n.setOptionsAttr("items",s);var o=a.CommodityHelper.getCommodityCode(i);o=="vm"?n.show():n.hide();var u=n.getFieldValue();u||(u=1,n.setFieldValue(u))},constraints:[{id:"appendWeeklyConstraint",watches:["vm_region_no"],action:function(e,t,n,r,i){var s=i.get("aliyunBuyEcsBlockListService"),o=n.getOptionsAttr("items");s.inBlockList("ecsBuyWeekly")?a.CommodityHelper.removeItemFromCollection("0.25",o):a.CommodityHelper.addItemToCollection(f.BuyBizCons.DURATION_WEEK_ITEM,o,"value",0),n.setOptionsAttr("items",o)}},i,o]},{id:"amount",controller:function(e,t,n,r){},constraints:[s]}]}])}),define("ecsbuy/base/models/constraints/datadiskConstraints",["require","exports","dominator/base/helpers/moduleHelper","common/helper/i18nHelper","../../helpers/commodityHelper"],function(e,t,n,r,i){var s={id:"renderDatadisk",watches:["vm_region_no","vm_iz","vm_web_type","iooptimized","systemdisk_category","instance_type"],action:function(e,t,s,o,u){if(!e)return;var a=o.getOriginConstraintData(),f=a.config,l=s.$scope.options||{},c=o.getOrder(),h=!!f.aliyun_uid,p=f.orderType,d=f.spec_code;n.config(l,function(){var e,t={},s={},u={},f={},l,v,m,g=c.vm_region_no,y=i.CommodityHelper.getComponentDeep(a,"vm_region_no.vm_region_no"),b=i.CommodityHelper.getTextFromCollection(g,y);e=o.getOptionsFromConstraints("datadisk_category",c);var w,E,S;for(var x=0,T=e.length;x<T;x++){w=e[x].value,E=n.config({datadisk_category:w},c),S=o.getOptionsFromConstraints("datadisk_size",E,"range"),t[w]=S.max,s[w]=S.min,u[w]=S.unit;var N=o.getOptionsFromConstraints("datadisk_totalsize",E,"range");f[w]=N?N.max:{}}var C=o.getOptionsFromConstraints("datadisk_disknumber",c,"range");l=C?C.max:null,v=C?C.min:null,m=o.getOptionsFromConstraints("datadisk_device",c);var k={portableMap:{"postpay.cloud":!0,"postpay.cloud_ssd":!0,"postpay.cloud_efficiency":!0,"postpay.ephemeral":!1,"postpay.ephemeral_ssd":!1,"prepay.cloud":!1,"prepay.cloud_ssd":!1,"prepay.cloud_efficiency":!1,"prepay.ephemeral":!1,"prepay.ephemeral_ssd":!1},convertableMap:{"postpay.cloud":!0,"postpay.cloud_ssd":!0,"postpay.cloud_efficiency":!0,"postpay.ephemeral":!1,"postpay.ephemeral_ssd":!1,"prepay.cloud":!0,"prepay.cloud_ssd":!0,"prepay.cloud_efficiency":!0,"prepay.ephemeral":!1,"prepay.ephemeral_ssd":!1},paymentMethods:[{text:r.i18n("ECS_BUY_YEARMONTH"),value:"prepay"},{text:r.i18n("ECS_BUY_POSTPAY"),value:"postpay"}],regionId:g,regionName:b,diskTypes:e,singleDiskMaxSizes:t,singleDiskMinSizes:s,singleDiskUnits:u,totalMaxSizes:f,diskMaxNumber:l,diskMinNumber:v,mounts:m,defaultPaymentMethod:d=="ecs"?"postpay":"prepay",showHeader:p=="DOWNGRADE"||p=="DOWNGRADE_NOW"||p=="UPGRADE",hideRelease:p=="DOWNGRADE"||p=="DOWNGRADE_NOW"||p=="UPGRADE",showConvertOption:p=="DOWNGRADE"||p=="DOWNGRADE_NOW"||p=="UPGRADE",addible:p=="BUY",loggedIn:h,encryptable:p=="BUY"};return k}())}};return s}),define("ecsbuy/base/models/constraints/renderFullImageConstraints",["require","exports","angular","../../helpers/diskHelper","../../helpers/imageHelper","../../helpers/buyUtils"],function(e,t,n,r,i,s){var o={id:"renderFullImageConstraints",watches:["publicImage","sharedImage","customImage","marketImage"],action:function(e,t,o,u,a){var f=u.getFieldValueById("imageType"),l=u.getFieldById("imageType");if(!f)return;var c=u.getFieldValueById(f+"Image");if(!c)return;var h=n.fromJson(c),p=h[12],d=[],v=i.ImageHelper.isCurrentImageFullImage(u,f),m=l.getOptionsAttr("fullImage");!s.BuyUtils.hasUndefined(v,m)&&v!=m&&o.setFieldValue(null),l.setOptionsAttr("fullImage",v);var d=[];v&&(n.forEach(p,function(e,t){if(e.diskType=="system")return;var n=r.DiskHelper.parseToDataDisk({category:null,size:e.size,snapshotId:e.snapshotId,device:e.device,instanceId:null,deleteWithInstance:!0,snapshotSize:e.size,disableSnapshot:!0,disableMount:!0,disableDeleteItem:!0,hideRelease:!1,isFullImage:!0});d.push(n.coverToList())}),o.setFieldValue(n.toJson(d)))}};return o}),define("ecsbuy/base/models/constraints/common/InnerFieldWatchConstraintFn",["require","exports"],function(e,t){var n=function(e){return{id:"watchField"+e+"Constraints",watches:[e],action:function(t,n,r,i,s){t&&r.$scope.rawData&&(r.$scope.rawData[e]=t)}}};return n}),define("ecsbuy/base/models/base/bizModel/diskField",["require","exports","angular","common/modelSystem/modelFactory","../../constraints/datadiskConstraints","../../constraints/renderFullImageConstraints","../../constraints/common/InnerFieldWatchConstraintFn","common/helper/i18nHelper","../../../helpers/imageHelper","../../../helpers/commodityHelper","../../../helpers/buyTipsHelper","../../../helpers/buyBizHelper","../../../cons/cons","../../../helpers/homeConfigHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){r.regist("ecs.buy.bizField.disk","BizModel",[function(){return[{id:"systemdisk_category",initData:{options:{tip:l.BuyTipsHelper.getBlockTip("clouddisk_category_introduce",[p.HomeConfigHelper.getUrlConfig("clouddiskCategoryIntroduce"),"_blank"])}},controller:function(e,t,n,r){var i=n.getDominator(),s=i.getOriginConstraintData(),o=f.CommodityHelper.getProperties(s,"systemdisk","systemdisk_device");n.setOptionsAttr("mount",o[0]),e.$watch("rawData.systemdisk_size",function(e){if(!e)return;c.BuyBizHelper.setFieldValue("systemdisk_size",e,i)})},constraints:[{id:"sizeRangeConstraints",watches:["systemdisk_category","publicImage","customImage","sharedImage","marketImage"],action:function(e,t,n,r,i){var s=n.getFieldValue(),o=r.getOptionsFromConstraints("systemdisk_size",{systemdisk_category:s},"range"),u=a.ImageHelper.getImageValue(r),f=u.imageSize||40;if(o){var l=Math.max(f,o.min,40);n.setOptionsAttr("min",l),n.setOptionsAttr("max",o.max)}if(u.platform==h.Constant.WINDOWS_SERVER_2003){var c=Math.max(40,f);n.setOptionsAttr("max",c),n.setOptionsAttr("showWindows2003Tip",!0)}else n.setOptionsAttr("showWindows2003Tip",!1)}},o("systemdisk_size")]},{id:"systemdisk_size",controller:function(e,t,n,r){n.hide()}},{id:"datadisk",controller:function(e,t,n,r){var i=n.getDominator(),s=i&&i.getOriginConstraintData()},constraints:[i,s]},{id:"localstorage",controller:function(e,t,n,r){var i=n.getDominator(),s=i&&i.getOriginConstraintData(),o=f.CommodityHelper.getProperties(s,"instance_localstorage","instance_localstorage");n.setOptionsAttr("types",o)},constraints:[{id:"renderLocalstorageConstraints",watches:["instance_type"],action:function(e,t,r,i,s){var o=function(t){var r=i.getOriginConstraintData(),s=f.CommodityHelper.getProperties(r,"instance_type","localstorage"),o;if(!s||!e)return;return s[e]?(t.show(),n.forEach(s[e],function(e,n){e.mount=u.i18n("ecs.buy.component.region.izRandom"),e&&e.type=="local_hdd_pro"?t.setOptionsAttr("hideIOPS",!0):t.setOptionsAttr("hideIOPS",!1)}),o=s[e]):t.hide(),o}(r);o&&r.setOptionsAttr("disks",o)}}]}]}])}),define("ecsbuy/base/models/constraints/security/securityDisplayConstraintsFn",["require","exports"],function(e,t){var n=function(e){return{id:"displayConstraintForSecurity",watches:["setupPassword"],action:function(t,n,r,i,s){t==e?r.show():r.hide()}}};return n}),define("ecsbuy/base/models/base/bizModel/securityField",["require","exports","common/modelSystem/modelFactory","common/helper/i18nHelper","../../constraints/fieldDynamicTipConstraintsFn","../../constraints/clearStateErrorConstraintsFn","../../constraints/security/securityDisplayConstraintsFn","../../../helpers/imageHelper","../../../cons/buyBizCons","../../../helpers/homeConfigHelper","../../../helpers/buyTipsHelper","../../../helpers/commodityHelper","../../../helpers/buyUtils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){n.regist("ecs.buy.bizField.security","BizModel",[function(){return[{id:"setupPassword",initData:{options:{items:[]}},controller:function(e,t,n,r){},constraints:[i("setupPasswordConstraint",["setupPassword"],{translateValues:[f.HomeConfigHelper.getUrlConfig("keypairHelper")]}),{id:"setupPwdItemsDisplayConstraint",watches:["imageType","publicImage","sharedImage","customImage","marketImage","iooptimized"],action:function(e,t,n,r,i){var s=u.ImageHelper.getImageValue(r),o=a.BuyBizCons.SETTING_PASSWORD_ITEMS,f=r.getFieldValueById("iooptimized");s&&s.osKind=="linux"&&f=="optimized"&&(o=[a.BuyBizCons.SETTING_KEYPAIR_ITEM].concat(o)),n.setOptionsAttr("items",o)}}]},{id:"password",constraints:[o(h.BuyUtils.getMapProperty(a.BuyBizCons.SETTING_PASSWORD_NOW_ITEM,"value")),{id:"imageKindConstraints",watches:["setupPassword","imageType","publicImage","sharedImage","customImage","marketImage"],action:function(e,t,n,r,i){n.setOptionsAttr("loginName",null);var s=u.ImageHelper.getImageValue(r);if(!s)return;s["osKind"]=="windows"?n.setOptionsAttr("loginName","administrator"):s["osKind"]=="linux"?n.setOptionsAttr("loginName","root"):n.setOptionsAttr("loginName",null)}}]},{id:"keyPair",initData:{options:{placeholder:r.i18n("ecs.buy.component.keypair.placeholder")}},constraints:[s("keyPair"),o(h.BuyUtils.getMapProperty(a.BuyBizCons.SETTING_KEYPAIR_ITEM,"value")),{id:"keyPairSelectDisplayConstraints",watches:["setupPassword","vm_region_no","imageType","publicImage","sharedImage","customImage","marketImage"],action:function(e,t,n,r,i){var s=n.$scope,o=r.getFieldValueById("vm_region_no");s.valueAll={regionId:o};var u=c.CommodityHelper.getRegionAlias(r.getOriginConstraintData(),o),a=f.HomeConfigHelper.getUrlConfig("createKeyPair",u),h=l.BuyTipsHelper.getBlockTip("setuppassword__create_keypair",[a]);n.setOptionsAttr("tip",h)}}]},{id:"activityId",controller:function(e,t,n,r){n.hide()}},{id:"orderSource",controller:function(e,t,n,r){n.hide()}}]}])}),define("ecsbuy/base/models/constraints/userdata/userdataSelectConstraint",["require","exports","../../../helpers/commodityHelper","../../../helpers/imageHelper"],function(e,t,n,r){function i(e,t,n){var r=e.get("$rootScope"),i=e.get("$timeout");i(function(){r.$broadcast("aliyunBuyGroupDisplay:userdataConfig",n),n==0&&t.setFieldValue("empty")})}var s={id:"userdataSelectConstraint",watches:["vm_region_no","vm_web_type","iooptimized","imageType","publicImage","customImage","sharedImage","marketImage"],action:function(e,t,s,o,u){var a=o.getFieldValueById("vm_region_no"),f=n.CommodityHelper.getNetworkType(o.getFieldValueById("vm_web_type")),l=o.getFieldValueById("iooptimized")=="optimized"?"IoOptimized":"none",c=o.getFieldValueById("imageType"),h=r.ImageHelper.getImageValue(o),p=h&&h.imageId,d=o.getOriginConstraintData();if(!a||!p||!f||!n.CommodityHelper.isLogin(d)){i(u,s,!1);return}var v=u.get("aliyunBuyEcsRemoteService"),m={regionId:a,imageId:p,networkType:f,ioOptimized:l};v.checkImageSupportCloudinit(m).then(function(e){e?i(u,s,!0):i(u,s,!1)},function(){i(u,s,!1)})}};return s}),define("ecsbuy/base/models/constraints/userdata/userdataTextConstraint",["require","exports"],function(e,t){function n(e,t){e.$broadcast("aliyunBuyGroupDisplay:userdataConfig",t)}var r={id:"vpcSelectConstraint",watches:["userdata_select"],action:function(e,t,n,r,i){e=="empty"?n.hide():n.show()}};return r}),define("ecsbuy/base/models/base/bizModel/userdataField",["require","exports","common/modelSystem/modelFactory","../../constraints/userdata/userdataSelectConstraint","../../constraints/userdata/userdataTextConstraint","../../../helpers/buyTipsHelper"],function(e,t,n,r,i,s){n.regist("ecs.buy.bizField.userdata","BizModel",[function(){return[{id:"userdata_select",initData:{options:{spm:"userdata",askTip:s.BuyTipsHelper.getAskTip("userdata"),items:[{value:"empty",text:""},{value:"text",text:""}]}},controller:function(e,t,n,r){},constraints:[r]},{id:"userdata_base64",initData:{display:"base64"}},{id:"userdata",initData:{spm:"type",options:{tip:s.BuyTipsHelper.getBlockTip("ECS_USER_DATA_TIP")}},constraints:[i]}]}])}),define("ecsbuy/base/models/constraints/hpcCluster/hpcClusterDisplayConstraint",["require","exports","../../../helpers/instanceTypeHelper"],function(e,t,n){var r={id:"HpcClusterDisplayConstraint",watches:["instance_type"],action:function(e,t,r,i,s){var o=i.getOriginConstraintData(),u=s.get("$rootScope");n.InstanceTypeHelper.isHpcInstanceType(o,e)?u.$broadcast("aliyunBuyGroupDisplay:hpcClusterConfig",!0):u.$broadcast("aliyunBuyGroupDisplay:hpcClusterConfig",!1)}};return r}),define("ecsbuy/console/helpers/commonConsoleHelper",["require","exports","angular","../../base/helpers/homeConfigHelper","../../base/cons/urlConfig","../../base/cons/buyBizCons","../../base/helpers/methodHelper","../../base/helpers/dateParseHelper"],function(e,t,n,r,i,s,o,u){var a=function(){function e(){}return e.isPostpay=function(e){return"postpay"==e||"postpay"==s.BuyBizCons.CHARGE_TYPE_MAP_REVERT[e]},e.isPayByTraffic=function(e){return"PayByTraffic"==e||"payByTraffic"==e},e.transformChargeType=function(t){var n=e;return n.isPostpay(t)?s.BuyBizCons.CHARGE_TYPE_MAP.postpay:s.BuyBizCons.CHARGE_TYPE_MAP.prepay},e.isPrepay=function(e){var t=this;return!t.isPostpay(e)},e.isPayByBandwidth=function(e){var t=this;return!t.isPayByTraffic(e)},e.isImagePrepay=function(e){return s.BuyBizCons.CHARGE_TYPE_MAP_REVERT[e]=="prepay"},e.isImagePostpay=function(e){var t=this;return!t.isImagePrepay(e)},e.isImageOnSale=function(e){return e==s.BuyBizCons.IMAGE_SELL_STATUS.onSale},e.isImageOffSale=function(e){return e==s.BuyBizCons.IMAGE_SELL_STATUS.offSale},e.getImageOrderTermUrl=function(e){if(e)return(r.HomeConfigHelper.getUrlConfig("imageOrderTermUrl")||i.UrlConfig.imageOrderTermUrl)+e},e.filterStringForAngualrBindingKey=function(e){if(e)return e.replace("-","")},e.hasPrepayOrder=function(e){e instanceof Array||(e=[e]);var t=o.MethodHelper.getArrayFromListMapByKey(e,"chargeType");return t.indexOf(s.BuyBizCons.CHARGE_TYPE_MAP.prepay)!==-1},e.getVmRestartTime=function(e){e instanceof Array||(e=[e]);var t=o.MethodHelper.getArrayFromListMapByKey(e,"commodity.rebootTime");if(!!t.length){var n=t[0];return u.DateParseHelper.format(n,"yyyy-MM-dd hh:mm")}},e.getCouponsFromPriceResult=function(e){if(e==undefined)return[];var t=[];e.coupons instanceof Array&&(t=t.concat(e.coupons)),e.priceList instanceof Array?n.forEach(e.priceList,function(e,n){t=t.concat(e.coupons)}):e.children instanceof Array&&n.forEach(e.children,function(e,n){t=t.concat(e.coupons)});var r={},i=o.MethodHelper.filterArrayByCallback(t,function(e){var t=e&&e.couponNo;return t&&r[t]==undefined?(r[t]=e,!0):!1});return i},e}();t.CommonConsoleHelper=a}),define("ecsbuy/console/helpers/instanceDetailHelperNew",["require","exports","common/helper/i18nHelper","../../base/helpers/buyUtils","./commonConsoleHelper","../../base/cons/fieldCons"],function(e,t,n,r,i,s){var o=function(){function e(){}return e.getRegionAlias=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.RegionId")},e.getZoneId=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.ZoneId")},e.getIoOptimized=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.IoOptimized")},e.getInstanceType=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.InstanceType")},e.getVpcId=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.VpcAttributes.VpcId")},e.getVSwitchId=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.VpcAttributes.VSwitchId")},e.getNetworkType=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.InstanceNetworkType")},e.getSecurityGroupId=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.SecurityGroupIds.SecurityGroupId.0")},e.getVmWebType=function(e){var t=this.getNetworkType(e);return t==s.FieldCons.FIELD_NETWORK_TYPE_VPC?s.FieldCons.VM_WEB_TYPE_VPC:s.FieldCons.VM_WEB_TYPE_CLASSIC},e.getBandwidthType=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.InternetChargeType")},e.getBandwidthValue=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.InternetMaxBandwidthOut")},e.getVmFlowType=function(e){var t=this.getBandwidthType(e);if(i.CommonConsoleHelper.isPrepay(e)&&t==s.FieldCons.FIELD_BANDWIDTH_TYPE_TRAFFIC)return s.FieldCons.PREPAID_VM_WEB_TYPE_TRAFFIC;if(i.CommonConsoleHelper.isPrepay(e)&&t==s.FieldCons.FIELD_BANDWIDTH_TYPE_BANDWIDTH)return s.FieldCons.PREPAID_VM_WEB_TYPE_BANDWIDTH;if(!i.CommonConsoleHelper.isPostpay(e)&&t==s.FieldCons.FIELD_BANDWIDTH_TYPE_TRAFFIC)return s.FieldCons.POSTPAID_VM_WEB_TYPE_TRAFFIC;if(!i.CommonConsoleHelper.isPostpay(e)&&t==s.FieldCons.FIELD_BANDWIDTH_TYPE_BANDWIDTH)return s.FieldCons.POSTPAID_VM_WEB_TYPE_BANDWIDTH},e.getEipAddress=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.EipAddress.IpAddress")},e.getEipChargeType=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.EipAddress.InternetChargeType")},e.getEipBandwidth=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.EipAddress.Bandwidth")},e.getEipInstanceId=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.EipAddress.AllocationId")},e.getPrivateIp=function(e){return this.getNetworkType(e)==s.FieldCons.FIELD_NETWORK_TYPE_VPC?r.BuyUtils.getMapProperty(e,"instanceDetail.VpcAttributes.PrivateIpAddress.IpAddress.0"):r.BuyUtils.getMapProperty(e,"instanceDetail.InnerIpAddress.IpAddress.0")},e.getPublicIP=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.PublicIpAddress.IpAddress.0")},e.getSystemDiskInfo=function(e){var t=r.BuyUtils.getMapProperty(e,"instanceDetail.Disks");for(var n=0;n<t.length;n++){var i=t[n];if(i&&i.Type=="system")return i}},e.getSystemDiskSize=function(e){var t=this.getSystemDiskInfo(e);return t&&t.Size},e.getSystemDiskCategory=function(e){var t=this.getSystemDiskInfo(e);return t&&t.Category},e.getDataDiskList=function(e){var t=r.BuyUtils.getMapProperty(e,"instanceDetail.Disks"),n=[];for(var i=0;i<t.length;i++){var s=t[i];s&&s.Type=="data"&&n.push(s)}return n},e.hasEncryptedDisk=function(e){var t=r.BuyUtils.getMapProperty(e,"instanceDetail.Disks");for(var n=0;n<t.length;n++){var i=t[n];if(i&&i.Encrypted)return!0}},e.formatRecommendInstanceType=function(t,i,s){if(!t||!i)return null;var o=r.BuyUtils.getMapProperty(t,"Data.RecommendInstanceType");if(!o||o.length==0)return null;var u=[],a=r.BuyUtils.getMapProperty(s,"components.instance_type.instance_type_family"),f=r.BuyUtils.listToMap(a,"value"),l=e.getZoneId(s),c=e.getNetworkType(s);return o.forEach(function(e,t){e.InstanceType&&i!=e.InstanceType.InstanceType&&(e.InstanceType.InstanceTypeFamilyDesc=f[e.InstanceType.InstanceTypeFamily],e.InstanceType.cpuMemDesc=n.i18n("ECS_INSTANCE_CPU_MEM",e.InstanceType.Cores,e.InstanceType.Memory/1024),e.noStock=!0,e.Zones.zone&&e.Zones.zone.length>0&&e.Zones.zone.forEach(function(t){t.ZoneNo==l&&t.NetworkTypes&&t.NetworkTypes.NetworkType&&t.NetworkTypes.NetworkType.indexOf(c)!=-1&&(e.noStock=!1)}),u.push(e))}),u},e}();t.InstanceDetailHelperNew=o}),define("ecsbuy/base/helpers/hpcClusterHelper",["require","exports","angular","../cons/diskCategory","./commodityHelper","./orderDataHelper","../../console/helpers/instanceDetailHelperNew","../cons/spotStrategy"],function(e,t,n,r,i,s,o,u){var a=function(){function e(){}return e.getHpcClusterDetail=function(e,t){if(!n.isArray(e))return;for(var r=0;r<e.length;r++){var i=e[r];if(i&&i.HpcClusterId==t)return i}},e.getOrderParams=function(e,t,a){if(!e||!t||!n.isArray(t))return;var f=[r.DiskCategory.LOCAL_HDD_PRO,r.DiskCategory.LOCAL_SSD_PRO],l=e.instanceDetail||{},c=i.CommodityHelper.getCommodityCode(e),h="BUY",p=t[0].systemdisk_category,d=s.OrderDataHelper.getOrderParam(t,c,h,a,e),v=d&&d[0]||{},m=o.InstanceDetailHelperNew.getSystemDiskSize(e),g=l.InstanceType;v.regionId=o.InstanceDetailHelperNew.getRegionAlias(e),n.extend(v.commodity,{zoneId:l.zoneId,instanceType:g,networkType:o.InstanceDetailHelperNew.getNetworkType(e),vSwitchId:o.InstanceDetailHelperNew.getVSwitchId(e),securityGroupId:o.InstanceDetailHelperNew.getSecurityGroupId(e),ioOptimized:l.IoOptimized,hpcClusterId:l.HpcClusterId});var y=o.InstanceDetailHelperNew.getEipInstanceId(e);return y&&(v.commodity.internetChargeType="PayByBandwidth",v.commodity.internetMaxBandwidthOut=0),a||(v.businessInfo={orderSource:"hpcClusterScaling"}),v.commodity.internetChargeType||(v.commodity.internetChargeType=o.InstanceDetailHelperNew.getBandwidthType(e)),!v.commodity.internetMaxBandwidthOut&&v.commodity.internetMaxBandwidthOut!=0&&(v.commodity.internetMaxBandwidthOut=o.InstanceDetailHelperNew.getBandwidthValue(e)),l.SpotStrategy&&l.SpotStrategy!=u.SpotStrategy.NO_SPOT&&(v.commodity.spotStrategy=l.SpotStrategy,v.commodity.spotPriceLimit=l.SpotPriceLimit),[v]},e}();t.HpcClusterHelper=a}),define("ecsbuy/base/models/base/bizModel/hpcClusterField",["require","exports","common/modelSystem/modelFactory","../../constraints/hpcCluster/hpcClusterDisplayConstraint","../../../cons/remoteActions","../../../helpers/hpcClusterHelper","../../../helpers/buyBizHelper"],function(e,t,n,r,i,s,o){n.regist("ecs.buy.bizField.hpcCluster","BizModel",["$injector","aliyunBuyEcsRemoteService",function(e,t){return[{id:"hpcClusterName",initData:{options:{instNamePlaceholder:" "}},controller:function(e,t,n,r){},constraints:[r]},{id:"hpcClusterDescription",controller:function(e,t,n,r){},constraints:[]},{id:"hpcClusterId",controller:function(e,t,n,r){},constraints:[{id:"hpcClusterIdDisplayConstraint",watches:["vm_region_no"],action:function(e,n,r,u,a){r.hide(),u.getFieldById("hpcClusterName").show(),u.getFieldById("hpcClusterDescription").show();var f=r.getFieldValue();if(!f)return;var l={regionId:e,hpcClusterIds:f};t[i.RemoteActions.DESCRIBE_HPC_CLUSTERS](l).then(function(e){var t=s.HpcClusterHelper.getHpcClusterDetail(e,f);t&&(r.show(),r.$scope.rawData.$detail=t.Name,o.BuyBizHelper.setFieldValue("hpcClusterName",undefined,u),o.BuyBizHelper.setFieldValue("hpcClusterDescription",undefined,u),u.getFieldById("hpcClusterName").hide(),u.getFieldById("hpcClusterDescription").hide())},function(e){r.hide()})}}]}]}])}),define("ecsbuy/base/models/base/bizModel/_base",["require","exports","./baseField","./networkField","./instanceTypeField","./bandwidthField","./imageField","./amountField","./diskField","./securityField","./userdataField","./hpcClusterField"],function(e,t){}),define("ecsbuy/base/models/simple/ecs.buy.simple.ui",["require","exports","common/modelSystem/modelFactory","common/helper/i18nHelper"],function(e,t,n,r){n.regist("ecs.buy.simple.ui","BuyUiModel",{id:"ecsPrePay",fields:[{id:"regionConfig",type:"group",spmId:"region",title:"<i class='bk-group-title-icon icon-buy-region'></i>"+r.i18n("ecs.buy.component.label.region"),children:[{id:"chargeType",type:"newBrickTabs",noLabel:!0,fieldWraperCls:"bk-label-non"},{id:"vm_region_no",type:"newBrickTabs",fieldWraperCls:"bk-label-non simplebuy-field-region vm-region-no",noLabel:!0,attributes:[]},{id:"vm_iz",type:"newBrickTabs",fieldWraperCls:"bk-label-non",noLabel:!0}]},{id:"instanceConfig",type:"group",spmId:"instance",title:"<i class='bk-group-title-icon icon-buy-instance'></i>"+r.i18n("ecs.buy.component.label.instance"),children:[{id:"instance_type",type:"customField",template:"<div simplebuy-select-class ng-model='rawData.instance_type' options='options' detail='rawData.detail'></div>",fieldWraperCls:"bk-label-non bk-simplebuy-instanceType",noLabel:!0,attributes:[]},{id:"defaultInstanceType",type:"buyText"},{id:"iooptimized",type:"newBrickTabs"},{id:"systemdisk_category",type:"customField",noLabel:!0,template:"<span  aliyun-buy-ecs-sysdisk\n                        aliyun-buy-anchor=\"dominator:systemdisk_category:anchor\"\n                        options='options'\n                        category='rawData.systemdisk_category'\n                        size='rawData.systemdisk_size'></span>"},{id:"systemdisk_size",type:"customField",template:"<span></span>"}]},{id:"imageConfig",type:"group",spmId:"image",title:"<i class='bk-group-title-icon icon-buy-image'></i>"+r.i18n("ecs.buy.component.label.image"),children:[{id:"imageType",type:"newBrickTabs"},{id:"publicImage",type:"customField",template:"<span aliyun-buy-select-linkage\n                       aliyun-buy-anchor=\"dominator:publicImage:anchor\"\n                       options='options'\n                       value='rawData.allValue'\n                       detail='rawData.allDetail'\n                       root-value='rawData.rootValue'\n                       root-detail=\"options.rootDetail\"\n                       children-value='rawData.publicImage'\n                       children-detail='options.childDetail'></span>",fieldWraperCls:"bk-label-non",noLabel:!0},{id:"securityEnhancementStrategy",type:"checkbox",noLabel:!0,fieldWraperCls:"bk-label-non bk-security-enhancement",fieldCls:"bk-ecs-security-enhancement ",clientField:!0}]},{id:"networkConfig",type:"group",spmId:"network",intro:"<span aliyun-buy-ecs-threshold></span>",title:"<i class='bk-group-title-icon icon-buy-bandwidth-2'></i>"+r.i18n("ecs.buy.component.label.bandwidth.type"),children:[{id:"vm_web_type",type:"newBrickTabs",label:r.i18n("ecs.buy.label.networkType"),attributes:[]},{id:"vm_is_flow_type",type:"newBrickTabs"},{id:"vm_bandwidth",type:"buySliderWithNumber",label:r.i18n("ecs.buy.label.bandwidth")}]},{id:"amountConfig",type:"group",spmId:"amount",title:"<i class='bk-group-title-icon icon-buy-amount'></i>"+r.i18n("ecs.buy.component.label.amount"),children:[{id:"instance_amount",type:"group",groupClass:"merge-field-group",groupStyle:!1,children:[{id:"order_time",type:"newBrickTabs",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]},{id:"autoRenew",type:"checkbox",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]}]},{id:"amount",type:"amount",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]}]}]})}),define("ecsbuy/base/models/simple/ecs.buy.simple.biz",["require","exports","angular","common/modelSystem/modelFactory","common/helper/i18nHelper","dominator/base/helpers/constraintHelper","../constraints/image/publicImageFetchDataConstraintsFn","../constraints/clearStateErrorConstraintsFn","../constraints/region/regionRedirectConstraint","../../helpers/buyBizHelper","../../helpers/buyTipsHelper","../../cons/buyBizCons"],function(e,t,n,r,i,s,o,u,a,f,l,c){r.regist("ecs.buy.simple.biz","BizModel",["$state","$injector","$rootScope","$timeout","modelFactory",function(e,t,r,h,p){var d=p.getModel("ecs.buy.biz","BizModel"),v={id:"ecsSimpleBuy",fields:[{id:"chargeType",initData:{options:{items:c.BuyBizCons.CHARGE_TYPE_ITEMS}},controller:function(e,t,n,r){n.hide(),n.setFieldValue("prepay")}},{id:"vm_region_no",initData:{options:{askTip:l.BuyTipsHelper.getAskTip("simplebuy_region")}},constraints:[a]},{id:"vm_iz",controller:function(e,t,n,r){n.hide()},constraints:[{id:"izValueConstraints",watches:["vm_region_no"],action:function(e,t,r,i,s){if(!e)return;var o=i.getOptionsFromConstraints("vm_iz"),u="";n.isArray(o)&&(u=o[0]&&o[0].value),r.setFieldValue(u)}}]},{id:"instance_type",initData:{options:{askTip:l.BuyTipsHelper.getAskTip("simplebuy_instanceType")}},controller:function(e,t,n,r){},constraints:[{id:"instanceTypeRenderConstraint",watches:["defaultInstanceType"],action:function(e,t,r,i,o){var u=r.getOptionsAttr("items");n.isArray(u)&&e&&s.contains(u,e,"value")&&r.setFieldValue(e)}}]},{id:"defaultInstanceType",controller:function(e,t,n,r){n.hide()}},{id:"iooptimized",controller:function(e,t,n,r){n.hide(),n.setFieldValue("optimized")}},{id:"systemdisk_category",controller:function(e,t,n,r){n.hide(),n.setFieldValue("cloud_efficiency")}},{id:"systemdisk_size",controller:function(e,t,n,r){n.hide(),n.setFieldValue(40)}},{id:"vm_web_type",initData:{options:{askTip:l.BuyTipsHelper.getAskTip("simplebuy_webType")}}},{id:"vm_is_flow_type",controller:function(e,t,n,r){n.hide();var i="5";n.setFieldValue(i)}},{id:"vm_bandwidth",initData:{options:{unit:"M",numberUnit:"Mbps",askTip:l.BuyTipsHelper.getAskTip("simplebuy_bandwidth")}}},{id:"imageType",initData:{options:{items:[c.BuyBizCons.IMAGE_TYPE_PUBLIC]}},controller:function(e,t,n,r){n.hide(),n.setFieldValue("public")}},{id:"publicImage",initData:{options:{placeholder:i.i18n("ecs.buy.component.image.public.selectPlatform"),childrenPlaceholder:i.i18n("ecs.buy.component.image.public.selectVersion"),childrensLong:!0,askTip:l.BuyTipsHelper.getAskTip("simplebuy_publicImage")}},constraints:[u("publicImage"),o(t)]}]},m=f.BuyBizHelper.extendFieldModel(v,d,["vm_region_no","vm_iz","amount","vm_bandwidth","securityEnhancementStrategy","order_time","autoRenew"]);return m}])});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/base/models/simple/ecs.buy.simple.framework",["require","exports","angular","common/modelSystem/modelFactory","../base/frameworkClass/EcsBaseFramework","../../helpers/buyUtils","../../helpers/commodityHelper"],function(e,t,n,r,i,s,o){var u=function(e){function t(t){e.call(this,t),this.components=[{code:"vm_region_no"},{code:"vm_iz"},{code:"vm_web_type"},{code:"instance_type"},{code:"vm_is_flow_type"},{code:"vm_bandwidth"},{code:"systemdisk_category"},{code:"amount"},{code:"buy_type"}],n.extend(this.purchaseConfig,{orderConfirmPage:"prepayOrderConfirm?type=simple"})}return __extends(t,e),t.prototype.getCommodity=function(){var e=this.$injector.get("aliyunBuyEcsRemoteService");return e.getSimpleBuyCommodity({commodityCode:this.commodityCode,orderType:this.orderType})},t.prototype.onBeforeConstraintHandled=function(t){e.prototype.onBeforeConstraintHandled.call(this,t);var r=s.BuyUtils.getMapProperty(t,"constraint.instance_type");for(var i in r)i!="instance_type_family"&&delete r[i];var u=s.BuyUtils.getMapProperty(t,"constraint.vm_web_type.vm_region_no|vm_iz");if(u){var a=["cn-hongkong-am4-c04","us-west-ot7-a01","ap-southeast-os30-a01"];for(var f in u)for(var l=0;l<a.length;l++)f&&f.indexOf(a[l])>-1&&(u[f]=["1"])}var c=s.BuyUtils.getMapProperty(t,"constraint.vm_iz.vm_region_no.cn-qingdao-cm5-a01");if(n.isArray(c)&&c.length==1&&c[0]=="cn-qingdao-c"){var h=s.BuyUtils.getMapProperty(t,"components.vm_region_no.vm_region_no");o.CommodityHelper.removeItemFromCollection("cn-qingdao-cm5-a01",h)}return t},t.prototype.getOrderParam=function(t,r,i){var s=e.prototype.getOrderParam.call(this,t,r,i);return n.forEach(s,function(e){e.businessInfo||(e.businessInfo={}),e.businessInfo.orderSource||(e.businessInfo.orderSource="simplebuy"),e.commodity&&(e.commodity.groupRules=[{ipProtocol:"tcp",portRange:"80/80"},{ipProtocol:"tcp",portRange:"443/443"}])}),s},t}(i.EcsBaseFramework);r.regist("ecs.buy.simple.frameworkModel","BuyFrameworkModel",["$injector","$q","modelFactory","aliyunBuyEcsRemoteService","aliyunBuyEcsOrderConfirmService","aliyunBuyEcsCacheService",function(e,t,n,r,i,s){var o=new u(e);return o.makeFrameworkFactory()}])}),define("ecsbuy/base/models/simple/_base",["require","exports","./ecs.buy.simple.ui","./ecs.buy.simple.biz","./ecs.buy.simple.framework"],function(e,t){});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/base/models/prepay/ecs.buy.prepay.framework",["require","exports","common/modelSystem/modelFactory","../base/frameworkClass/EcsBaseFramework","../../helpers/buyUtils"],function(e,t,n,r,i){var s=function(e){function t(t){e.call(this,t)}return __extends(t,e),t.prototype.onBeforeConstraintHandled=function(t){e.prototype.onBeforeConstraintHandled.call(this,t);var n=i.BuyUtils.getMapProperty(t,"constraint.datadisk_category");return n&&(n.iooptimized={optimized:{semantics:"NOT",values:["cloud"]}}),t},t.prototype.getCommodity=function(){var e=this.$injector.get("aliyunBuyEcsRemoteService");return e.getCommodity({commodityCode:this.commodityCode,orderType:this.orderType,abTestKey:"recycleBin"})},t}(r.EcsBaseFramework);n.regist("ecs.buy.prepay.frameworkModel","BuyFrameworkModel",["$q","modelFactory","aliyunBuyEcsRemoteService","aliyunBuyEcsOrderConfirmService","aliyunBuyEcsCacheService","$injector",function(e,t,n,r,i,o){var u=new s(o);return u.makeFrameworkFactory()}])}),define("ecsbuy/base/models/prepay/_base",["require","exports","./ecs.buy.prepay.framework"],function(e,t){}),define("ecsbuy/base/models/postpay/ecs.buy.postpay.ui",["require","exports"],function(e,t){});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/base/models/postpay/ecs.buy.postpay.framework",["require","exports","common/modelSystem/modelFactory","../base/frameworkClass/EcsBaseFramework"],function(e,t,n,r){var i=function(e){function t(){e.apply(this,arguments),this.commodityCode="ecs",this.purchaseConfig={sessionStorageKey:"aliyun.buy.ecs.postpay.orderConfirm.v2",sessionStorageCacheKey:"aliyun.buy.ecs.cache.orderData",orderConfirmPage:"postpayOrderConfirm",orderConfirmRiskCode:"ECS_SELECT"}}return __extends(t,e),t}(r.EcsBaseFramework);t.PostpayFramework=i,n.regist("ecs.buy.postpay.frameworkModel","BuyFrameworkModel",["$injector","$q","modelFactory","aliyunBuyEcsRemoteService","aliyunBuyEcsOrderConfirmService","aliyunBuyEcsCacheService",function(e,t,n,r,s,o){var u=new i(e);return u.makeFrameworkFactory()}])}),define("ecsbuy/base/models/postpay/ecs.buy.postpay.cart",["require","exports","common/modelSystem/modelFactory","dominator/base/helpers/moduleHelper"],function(e,t,n,r){n.regist("ecs.buy.postpay.cartModel","BuyCartModel",["base64","modelFactory",function(e,t){var n={options:{showTotalPrice:!1}},i=t.getModel("ecs.buy.cartModel","BuyCartModel");return i&&r.config(i,n),i}])}),define("ecsbuy/base/models/postpay/_base",["require","exports","./ecs.buy.postpay.ui","./ecs.buy.postpay.framework","./ecs.buy.postpay.cart"],function(e,t){}),define("ecsbuy/base/models/spotPostpay/ecs.buy.spotPostpay.ui",["require","exports"],function(e,t){}),define("ecsbuy/base/models/constraints/spotStrategy/spotDurationSuffixConstraint",["require","exports","common/helper/i18nHelper"],function(e,t,n){var r={id:"appendUnitConstraint",watches:["spotDuration"],action:function(e,t,r,i,s){var o=r.getOptionsAttr("items"),u=r.getFieldValue();e&&angular.forEach(o,function(t){t.value==e?t.text=t.value+" ":t.text=t.value}),r.setOptionsAttr("tip",n.i18n("ECS_SPOT_DURATION_TIP",u))}};return r}),define("ecsbuy/base/models/constraints/amount/userRegionQuotaConstraint",["require","exports","common/helper/i18nHelper","../../../helpers/commodityHelper","../../../cons/remoteActions","../../../helpers/buyBizHelper","../../../helpers/instanceTypeHelper"],function(e,t,n,r,i,s,o){var u={id:"amountLimitConstraints",watches:["vm_region_no","instance_type"],action:function(e,t,u,a,f){function v(e){var t=r.CommodityHelper.getCommodityCode(h),i=e.userRetainVcpu,s=e.userRegionVcpuQuota,a=o.InstanceTypeHelper.getInstanceTypeObj(h,c),f=a&&parseInt(a.cpu);if(isNaN(f)||i==undefined||s==undefined)return;if(s==-1){u.setOptionsAttr("max",500),u.setOptionsAttr("tip",n.i18nByMap("ECS_SPOT_AMOUNT_LIMIT_MSG",{allowMaxVCpu:n.i18n("ECS_NO_LIMIT"),currentVCpu:f,allowMaxEcs:n.i18n("ECS_NO_LIMIT"),retainVCpu:i}));return}var l=Math.floor((s-i)/f);l<1?(u.setOptionsAttr("min",0),u.setOptionsAttr("max",0)):l>500?u.setOptionsAttr("max",500):u.setOptionsAttr("max",l),t!="vm"&&u.setOptionsAttr("maxLimit",l);var p=n.i18nByMap("ECS_SPOT_AMOUNT_LIMIT_MSG",{allowMaxVCpu:s-i,currentVCpu:f,allowMaxEcs:l,retainVCpu:i});u.setOptionsAttr("tip",p)}u.setOptionsAttr("unit",n.i18n("ECS_INSTANCE_UNIT"));var l=s.BuyBizHelper.getFieldValue("vm_region_no",a),c=s.BuyBizHelper.getFieldValue("instance_type",a),h=a.getOriginConstraintData();if(!l||!c)return;if(!r.CommodityHelper.isLogin(h)){u.setOptionsAttr("max",500);return}var p=u.getOptionsAttr("spotRegionQuota");if(t=="instance_type"&&p){v(p);return}var d=f.get("aliyunBuyEcsRemoteService");d[i.RemoteActions.GET_SPOT_REGION_QUOTA]({regionNo:l}).then(function(e){u.setOptionsAttr("spotRegionQuota",e),v(e)})}};return u}),define("ecsbuy/base/models/spotPostpay/ecs.buy.spotPostpay.biz",["require","exports","angular","common/helper/i18nHelper","common/modelSystem/modelFactory","../constraints/spotStrategy/spotDurationSuffixConstraint","../constraints/amount/userRegionQuotaConstraint","../../helpers/buyTipsHelper","../../cons/buyBizCons","../../cons/spotStrategy"],function(e,t,n,r,i,s,o,u,a,f){i.regist("ecs.buy.spotPostpay.biz","BizModel",["$state","$injector","$rootScope","aliyunBuyEcsRemoteService","$timeout","$filter","modelFactory",function(e,t,i,l,c,h,p){var d=p.getModel("ecs.buy.biz","BizModel"),v={id:"ecsSpotPostpayBuy",fields:[{id:"spotDuration",initData:{options:{askTip:u.BuyTipsHelper.getAskTip("spotDuration"),theme:"mini",items:a.BuyBizCons.DEFAULT_SPOT_DURATION}},constraints:[s]},{id:"spotStrategy",initData:{options:{askTip:u.BuyTipsHelper.getAskTip("spotStrategy"),items:a.BuyBizCons.DEFAULT_SPOT_STRATEGY}},controller:function(e,t,n,r){n.setFieldValue(f.SpotStrategy.SPOT_WITH_PRICE_LIMIT)}},{id:"spotPriceLimit",initData:{options:{step:.001,supportFloat:!0,formatter:function(e){if(e==undefined)return;return parseInt(e)==e?e:parseFloat(parseFloat(e).toFixed(3))},askTip:u.BuyTipsHelper.getAskTip("spotPriceLimit")}},constraints:[{id:"spotPriceLimitDisplayConstraint",watches:["spotStrategy"],action:function(e,t,n,r,i){e==f.SpotStrategy.SPOT_AS_PRICE_GO?n.hide():e==f.SpotStrategy.SPOT_WITH_PRICE_LIMIT&&n.show()}},{id:"priceResultConstraint",watches:["priceResult"],action:function(e,t,i,s,o){var u=o.get("$timeout"),a=e&&e.priceList;if(!n.isArray(a))return;for(var f=0;f<a.length;f++){var l=a[f],c=h("aliyunBuyPriceCurrency")(l.currency);l&&l.spotPrice!=undefined&&(i.setOptionsAttr("min",l.spotPrice),i.setOptionsAttr("max",l.spotOriginalPrice),i.setOptionsAttr("unit",c),i.setOptionsAttr("tip",r.i18n("ECS_SPOT_CONFIG_FEE_RANGE")+c+l.spotPrice+" ~ "+l.spotOriginalPrice+" "+r.i18n("ECS_UNIT_PER_HOUR")+""+c+l.spotOriginalPrice+r.i18n("ECS_UNIT_PER_HOUR")),u(function(){i.setFieldValue(l.spotOriginalPrice)}))}}}]},{id:"priceResult",controller:function(e,t,n,r){n.hide()}},{id:"amount",constraints:[o]}]};return v.fields=d.fields.concat(v.fields),v}])});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/base/models/spotPostpay/ecs.buy.spotPostpay.framework",["require","exports","angular","common/modelSystem/modelFactory","../postpay/ecs.buy.postpay.framework","../../cons/spotStrategy"],function(e,t,n,r,i,s){var o=function(e){function t(t){e.call(this,t),n.extend(this.purchaseConfig,{orderConfirmPage:"postpayOrderConfirm?type=spotInstance"})}return __extends(t,e),t.prototype.getCommodity=function(){var e=this.$injector.get("aliyunBuyEcsRemoteService");return e.getCommodity({commodityCode:this.commodityCode,orderType:this.orderType,spotStrategy:s.SpotStrategy.SPOT_WITH_PRICE_LIMIT})},t}(i.PostpayFramework);r.regist("ecs.buy.spotPostpay.frameworkModel","BuyFrameworkModel",["$injector",function(e){var t=new o(e);return t.makeFrameworkFactory()}])}),define("ecsbuy/base/models/spotPostpay/_base",["require","exports","./ecs.buy.spotPostpay.ui","./ecs.buy.spotPostpay.biz","./ecs.buy.spotPostpay.framework"],function(e,t){});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/base/models/disk/base/virtualClass/diskBaseFramework",["require","exports","angular","../../../../helpers/orderDataHelper","../../../../helpers/cartHelper","../../../../helpers/subtotalHelper","../../../../helpers/fields/regionHelper","../../../base/frameworkClass/EcsBaseFramework"],function(e,t,n,r,i,s,o,u){var a=function(e){function t(){e.apply(this,arguments),this.commodityCode="yundisk",this.purchaseConfig={sessionStorageKey:"aliyun.buy.clouddisk.orderConfirm.v2",orderConfirmPage:"clouddiskOrderConfirm",orderConfirmRiskCode:"YUNDISK_SELECT",sessionStorageCacheKey:""},this.components=[{code:"vm_region_no"},{code:"vm_iz"},{code:"datadisk_category"}]}return __extends(t,e),t.prototype.getPrice=function(e,t,r){var i=this.$injector.get("base64"),o=this.$injector.get("aliyunBuyEcsRemoteService"),u=!0,a=this.getOrderParam(e,u),f={data:i.encode(n.toJson(a))};return r?o.describePrice(f).then(s.SubtotalHelper.getPurchaseTipMiddle(e,t,r),s.SubtotalHelper.getHandlePriceError(e,t,r)):o.describePrice(f)},t.prototype.getOrderParam=function(e,t){return r.OrderDataHelper.getOrderParam4Yundisk(e,t)},t.prototype.purchase=function(e,t,r,i){var s=this.getOrderParam(e),o=this.$injector.get("aliyunBuyEcsCacheService"),u=this.$injector.get("aliyunBuyEcsOrderConfirmService");o.sessionStorageSet(this.purchaseConfig.sessionStorageKey,n.toJson({orderData:s}));var a=i.getScope();a.$emit("aliyunBuyEcs:purchase",this.purchaseConfig)},t.prototype.beforeAddToCart=function(e,t){var n=this.$injector.get("aliyunBuyMsg"),r=t.getCartOrders(),s=e.getOrder(),o=this.beforePurchase(s,e,"cart",t),u=i.CartHelper.cartNumbersValidation(n,r);return o&&u},t.prototype.onBeforeConstraintHandled=function(e){o.RegionHelper.hijackFinanceRegionname(e);var t=this.$injector.get("ecsBuyRegionService");return t.initRegionSetting(e),e},t}(u.EcsBaseFramework);t.DiskFramework=a});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/base/models/disk/clouddisk/ecs.buy.clouddisk.framework",["require","exports","common/modelSystem/modelFactory","../base/virtualClass/diskBaseFramework"],function(e,t,n,r){var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(r.DiskFramework);t.ClouddiskFramework=i,n.regist("ecs.buy.clouddisk.frameworkModel","BuyFrameworkModel",["$injector","$q","base64","aliyunBuyMsg","aliyunBuyEcsRemoteService","aliyunBuyEcsCacheService","aliyunBuyEcsOrderConfirmService",function(e){var t=new i(e);return t.makeFrameworkFactory()}])}),define("ecsbuy/base/models/disk/clouddisk/ecs.buy.clouddisk.subtotal",["require","exports","common/modelSystem/modelFactory","common/helper/i18nHelper","../../../helpers/subtotalHelper"],function(e,t,n,r,i){n.regist("ecs.buy.clouddisk.subtotalModel","BuySubtotalModel",["$q","aliyunBuyEcsRemoteService","base64",function(e,t,n){var s=i.SubtotalHelper.getSubtotalConfigText();return s.rightTip=undefined,{options:{spm:"subtotal",purchaseButtonText:r.i18n("ecs.buy.component.purchase.buynow"),addToCartButtonText:r.i18n("ecs.buy.component.purchase.addToCart"),priceUnit:r.i18n("ECS_UNIT_PER_HOUR"),texts:s},formatSubtotalData:function(e,t,n){return i.SubtotalHelper.getSubtotalViewItems4Disk(e,t,null,null,null)}}}])}),define("ecsbuy/base/models/disk/clouddisk/ecs.buy.clouddisk.cart",["require","exports","common/modelSystem/modelFactory","common/helper/i18nHelper","../../../helpers/subtotalHelper"],function(e,t,n,r,i){n.regist("ecs.buy.clouddisk.cartModel","BuyCartModel",["$q","aliyunBuyEcsRemoteService","aliyunBuyEcsBlockListService","base64",function(e,t,n,s){if(n.inBlockList("ecsBuyAddToCart"))return;var o={options:{spm:"cart",productName:"",amountUnit:"",batchPurchaseButtonText:"",texts:i.SubtotalHelper.getCartConfigText()},formatCartItemData:function(e,t,n){var s=n&&n.data&&n.data.trade,o=i.SubtotalHelper.getSubtotalViewItems4Disk(e,t,null,null,null);o=o.concat([{label:r.i18n("ECS_CONFIG_FEE"),text:""+s+"/",textCss:"bk-orange"}]);var u=parseInt(e.amount);return{amount:u,items:o}}};return o}])}),define("ecsbuy/base/models/disk/clouddisk/ecs.buy.clouddisk.ui",["require","exports","common/helper/i18nHelper","common/modelSystem/modelFactory","../../../helpers/buyTipsHelper","../../../helpers/homeConfigHelper"],function(e,t,n,r,i,s){r.regist("ecs.buy.clouddisk.ui","BuyUiModel",{id:"clouddiskPostpay",fields:[{id:"regionConfig",type:"group",spmId:"region",intro:i.BuyTipsHelper.getBlockTip("CLOUDDISK_REGION",[s.HomeConfigHelper.getUrlConfig("chooseRegionTips"),"_blank"]),title:"<i class='bk-group-title-icon glyphicon glyphicon-map-marker'></i>"+n.i18n("ecs.buy.component.label.region"),children:[{id:"vm_region_no",type:"customField",template:"<div aliyun-buy-buttontab-with-select parent-value='rawData.vm_region_no' child-value='rawData.vm_iz' options='options' ng-model='rawData.vm_region_no'></div>",fieldWraperCls:"bk-label-non vm-region-no",noLabel:!0,attributes:[]},{id:"vm_iz",type:"newBrickTabs",fieldWraperCls:"bk-label-non",noLabel:!0}]},{id:"storageConfig",type:"group",spmId:"storage",title:"<i class='bk-group-title-icon glyphicon glyphicon-hdd'></i>"+n.i18n("ecs.buy.label.disk.clouddisk"),children:[{id:"datadisk_category",type:"customField",fieldWraperCls:"bk-label-non bk-form-row-pb0",noLabel:!0,template:"<span aliyun-buy-ecs-clouddisk-select\n                       value='rawData.datadisk_category'\n                       snapshot-id='rawData.snapshotId'\n                       snapshot-size = 'rawData.snapshotSize'\n                       size='rawData.datadisk_size'\n                       encrypted=\"rawData.encrypted\"\n                       options='options'></span>"},{id:"datadisk_size",type:"customField",template:"<input value='rawData.datadisk_size' />"},{id:"snapshotId",type:"customField",template:"<input value='rawData.snapshotId' />"},{id:"snapshotSize",type:"customField",template:"<input value='rawData.snapshotSize' />"},{id:"diskEncrypted",type:"customField",template:"<input value='rawData.snapshotSize' />"}]},{id:"amountConfig",type:"group",spmId:"amount",title:"<i class='bk-group-title-icon icon-buy-amount'></i>"+n.i18n("ecs.buy.component.label.amount"),children:[{id:"amount",type:"amount",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]}]}]})}),define("ecsbuy/base/models/disk/base/bizModel/baseDiskField",["require","exports","../../../../helpers/buyTipsHelper","../../../../helpers/homeConfigHelper"],function(e,t,n,r){var i=function(){function e(){this.componentConfig={commodityCode:"yundisk",componentKey:"datadisk",componentCategoryKey:"datadisk_category",componentSizeKey:"datadisk_size",purchaseEventKey:"aliyunBuyEcsYundiskResize:purchase",diskCategoryIntro:"clouddisk_category_introduce"}}return e.prototype.getSizeKey=function(){return this.componentConfig.componentSizeKey},e.prototype.getCategoryKey=function(){return this.componentConfig.componentCategoryKey},e.prototype.getDiskCategoryIntro=function(){return n.BuyTipsHelper.getBlockTip(this.componentConfig.diskCategoryIntro,[r.HomeConfigHelper.getUrlConfig("clouddiskCategoryIntroduce"),"_blank"])},e}();t.BaseDiskField=i});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/base/models/disk/base/bizModel/diskCategoryField",["require","exports","dominator/base/helpers/moduleHelper","../../../../helpers/commodityHelper","./baseDiskField","../../../../helpers/buyBizHelper"],function(e,t,n,r,i,s){var o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.get=function(){var e=this.getSizeKey(),t=this.getCategoryKey(),i=this.getDiskCategoryIntro();return{id:t,initData:{options:{editable:!0,tip:i}},controller:function(t,n,i,s){var o=i.getDominator(),u=r.CommodityHelper.isLogin(o.getOriginConstraintData());i.setOptionsAttr("loggedIn",u);var a="rawData."+e;t.$watch(a,function(t){if(!t)return;var n=o.getFieldById(e);n.setFieldValue(t)}),t.$watch("rawData.snapshotId",function(e){var t=o.getFieldById("snapshotId");t.setFieldValue(e)}),t.$watch("rawData.snapshotSize",function(e){var t=o.getFieldById("snapshotSize");t.setFieldValue(e)}),t.$watch("rawData.encrypted",function(e){var t=o.getFieldById("diskEncrypted");t.setFieldValue(e)})},constraints:[{id:"sizeRangeConstraints",watches:[t,"snapshotId","snapshotSize"],action:function(r,i,o,u,a){var f=u.getFieldValueById(t,u),l=u.getOptionsFromConstraints(e,{datadisk_category:f},"range"),c=u.getFieldValueById("snapshotId",u),h=s.BuyBizHelper.getFieldValue("snapshotSize",u),p=o.getOptions(),d=p&&p.min;c&&h&&(l.min=l.min>h?l.min:h),n.config(p,l)}},{id:"regionConstraints",watches:["vm_region_no"],action:function(e,t,n,i,s){var o=i.getOriginConstraintData();if(!e)return;var u=r.CommodityHelper.getTextFromCollection(e,r.CommodityHelper.getProperties(o,"vm_region_no","vm_region_no"));n.setOptionsAttr("regionId",e),n.setOptionsAttr("regionName",u);var a=i.getFieldById("snapshotId");a.setFieldValue(null)}}]}},t}(i.BaseDiskField);t.DiskCategoryField=o});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/base/models/disk/base/bizModel/diskSizeField",["require","exports","./baseDiskField"],function(e,t,n){var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.get=function(){var e=this.getSizeKey();return{id:e,controller:function(e,t,n,r){n.hide()}}},t}(n.BaseDiskField);t.DiskSizeField=r});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/base/models/disk/base/bizModel/diskSnapshotField",["require","exports","./baseDiskField"],function(e,t,n){var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.get=function(){return[{id:"snapshotId",controller:function(e,t,n,r){n.hide()}},{id:"snapshotSize",controller:function(e,t,n,r){n.hide()}},{id:"diskEncrypted",controller:function(e,t,n,r){n.hide()}}]},t}(n.BaseDiskField);t.DiskSnapshotField=r}),define("ecsbuy/base/models/disk/clouddisk/ecs.buy.clouddisk.biz",["require","exports","common/modelSystem/modelFactory","../../../helpers/buyBizHelper","../base/bizModel/diskCategoryField","../base/bizModel/diskSizeField","../base/bizModel/diskSnapshotField"],function(e,t,n,r,i,s,o){n.regist("ecs.buy.clouddisk.biz","BizModel",["$state","$injector","$rootScope","modelFactory",function(e,t,n,u){var a=u.getModel("ecs.buy.biz","BizModel"),f={id:"test",fields:[(new i.DiskCategoryField).get(),(new s.DiskSizeField).get()].concat((new o.DiskSnapshotField).get())},l=r.BuyBizHelper.extendFieldModel(f,a,["vm_region_no","vm_iz","amount","datadisk"]);return l}])}),define("ecsbuy/base/models/disk/clouddisk/_base",["require","exports","./ecs.buy.clouddisk.framework","./ecs.buy.clouddisk.subtotal","./ecs.buy.clouddisk.cart","./ecs.buy.clouddisk.ui","./ecs.buy.clouddisk.biz"],function(e,t){});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/base/models/disk/volume/ecs.buy.volume.framework",["require","exports","common/modelSystem/modelFactory","../../../helpers/orderDataHelper","../base/virtualClass/diskBaseFramework"],function(e,t,n,r,i){var s=function(e){function t(){e.apply(this,arguments),this.commodityCode="san",this.purchaseConfig={sessionStorageKey:"aliyun.buy.volume.orderConfirm.v2",orderConfirmPage:"volumeOrderConfirm",orderConfirmRiskCode:"VOLUME_SELECT",sessionStorageCacheKey:""},this.components=[{code:"vm_region_no"},{code:"vm_iz"},{code:"volume_category"}]}return __extends(t,e),t.prototype.getOrderParam=function(e,t){return r.OrderDataHelper.getOrderParam4Volume(e,t)},t}(i.DiskFramework);t.VolumeFramework=s,n.regist("ecs.buy.volume.frameworkModel","BuyFrameworkModel",["$injector","$q","base64","aliyunBuyMsg","aliyunBuyEcsRemoteService","aliyunBuyEcsCacheService","aliyunBuyEcsOrderConfirmService",function(e,t,n,r,i,o,u){var a=new s(e);return a.makeFrameworkFactory()}])}),define("ecsbuy/base/models/disk/volume/ecs.buy.volume.subtotal",["require","exports","common/modelSystem/modelFactory","common/helper/i18nHelper","../../../helpers/subtotalHelper"],function(e,t,n,r,i){n.regist("ecs.buy.volume.subtotalModel","BuySubtotalModel",["$q","aliyunBuyEcsRemoteService","base64",function(e,t,n){var s=i.SubtotalHelper.getSubtotalConfigText();return s.rightTip=undefined,{options:{spm:"subtotal",purchaseButtonText:r.i18n("ecs.buy.component.purchase.buynow"),addToCartButtonText:r.i18n("ecs.buy.component.purchase.addToCart"),priceUnit:r.i18n("ECS_UNIT_PER_HOUR"),texts:s},formatSubtotalData:function(e,t,n){return i.SubtotalHelper.getSubtotalViewItems4Disk(e,t,r.i18n("ecs.buy.label.disk.volume"),"volume_category","volume_size")}}}])}),define("ecsbuy/base/models/disk/volume/ecs.buy.volume.cart",["require","exports","common/modelSystem/modelFactory","common/helper/i18nHelper","../../../helpers/subtotalHelper"],function(e,t,n,r,i){n.regist("ecs.buy.volume.cartModel","BuyCartModel",["$q","aliyunBuyEcsRemoteService","aliyunBuyEcsBlockListService","base64",function(e,t,n,s){if(n.inBlockList("ecsBuyAddToCart"))return;var o={options:{spm:"cart",productName:"",amountUnit:"",batchPurchaseButtonText:"",texts:i.SubtotalHelper.getCartConfigText()},formatCartItemData:function(e,t,n){var s=n&&n.data&&n.data.trade,o=i.SubtotalHelper.getSubtotalViewItems4Disk(e,t,r.i18n("ecs.buy.label.disk.volume"),"volume_category","volume_size");o=o.concat([{label:r.i18n("ECS_CONFIG_FEE"),text:""+s+"/",textCss:"bk-orange"}]);var u=parseInt(e.amount);return{amount:u,items:o}}};return o}])}),define("ecsbuy/base/models/disk/volume/ecs.buy.volume.ui",["require","exports","common/helper/i18nHelper","common/modelSystem/modelFactory","../../../helpers/buyTipsHelper","../../../helpers/homeConfigHelper"],function(e,t,n,r,i,s){r.regist("ecs.buy.volume.ui","BuyUiModel",{id:"volumePostpay",fields:[{id:"regionConfig",type:"group",spmId:"region",intro:i.BuyTipsHelper.getBlockTip("VOLUME_REGION",[s.HomeConfigHelper.getUrlConfig("chooseRegionTips"),"_blank"]),title:"<i class='bk-group-title-icon glyphicon glyphicon-map-marker'></i>"+n.i18n("ecs.buy.component.label.region"),children:[{id:"vm_region_no",type:"customField",template:"<div aliyun-buy-buttontab-with-select parent-value='rawData.vm_region_no' child-value='rawData.vm_iz' options='options' ng-model='rawData.vm_region_no'></div>",fieldWraperCls:"bk-label-non vm-region-no",noLabel:!0,attributes:[]},{id:"vm_iz",type:"newBrickTabs",fieldWraperCls:"bk-label-non",noLabel:!0}]},{id:"storageConfig",type:"group",spmId:"storage",title:"<i class='bk-group-title-icon glyphicon glyphicon-hdd'></i>"+n.i18n("ecs.buy.label.disk.volume"),children:[{id:"volume_category",type:"customField",fieldWraperCls:"bk-label-non bk-form-row-pb0",noLabel:!0,template:"<span aliyun-buy-ecs-clouddisk-select\n                       value='rawData.volume_category'\n                       snapshot-id='rawData.snapshotId'\n                       size='rawData.volume_size'\n                       encrypted=\"rawData.encrypted\"\n                       snapshot-size = 'rawData.snapshotSize'\n                       options='options'></span>"},{id:"volume_size",type:"customField",template:"<input value='rawData.volume_size' />"},{id:"snapshotId",type:"customField",template:"<input value='rawData.snapshotId' />"},{id:"snapshotSize",type:"customField",template:"<input value='rawData.snapshotSize' />"},{id:"diskEncrypted",type:"customField",template:"<input value='rawData.snapshotSize' />"}]},{id:"amountConfig",type:"group",spmId:"amount",title:"<i class='bk-group-title-icon icon-buy-amount'></i>"+n.i18n("ecs.buy.component.label.amount"),children:[{id:"amount",type:"amount",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]}]}]})});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/base/models/disk/volume/bizModel/volumeCategoryField",["require","exports","../../base/bizModel/diskCategoryField","../../../../helpers/buyTipsHelper","../../../../helpers/homeConfigHelper"],function(e,t,n,r,i){var s=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.getCategoryKey=function(){return t.volumeComponentConfig.componentCategoryKey},t.prototype.getSizeKey=function(){return t.volumeComponentConfig.componentSizeKey},t.prototype.getDiskCategoryIntro=function(){return r.BuyTipsHelper.getBlockTip(t.volumeComponentConfig.diskCategoryIntro,[i.HomeConfigHelper.getUrlConfig("volumeCategoryIntroduce"),"_blank"])},t.volumeComponentConfig={commodityCode:"san",componentKey:"volume",componentCategoryKey:"volume_category",componentSizeKey:"volume_size",purchaseEventKey:"aliyunBuyEcsVolumeResize:purchase",diskCategoryIntro:"volume_category_introduce"},t}(n.DiskCategoryField);t.VolumeCategoryField=s});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/base/models/disk/volume/bizModel/volumeSizeField",["require","exports","../../base/bizModel/diskSizeField","./volumeCategoryField"],function(e,t,n,r){var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.getSizeKey=function(){return r.VolumeCategoryField.volumeComponentConfig.componentSizeKey},t}(n.DiskSizeField);t.VolumeSizeField=i}),define("ecsbuy/base/models/disk/volume/ecs.buy.volume.biz",["require","exports","common/modelSystem/modelFactory","../../../helpers/buyBizHelper","./bizModel/volumeCategoryField","./bizModel/volumeSizeField","../base/bizModel/diskSnapshotField"],function(e,t,n,r,i,s,o){n.regist("ecs.buy.volume.biz","BizModel",["$state","$injector","$rootScope","modelFactory",function(e,t,n,u){var a=u.getModel("ecs.buy.biz","BizModel"),f={id:"test",fields:[(new i.VolumeCategoryField).get(),(new s.VolumeSizeField).get()].concat((new o.DiskSnapshotField).get())};return r.BuyBizHelper.extendFieldModel(f,a,["vm_region_no","vm_iz","amount","datadisk"])}])}),define("ecsbuy/base/models/disk/volume/_base",["require","exports","./ecs.buy.volume.framework","./ecs.buy.volume.subtotal","./ecs.buy.volume.cart","./ecs.buy.volume.ui","./ecs.buy.volume.biz"],function(e,t){}),define("ecsbuy/base/models/disk/_base",["require","exports","./clouddisk/_base","./volume/_base"],function(e,t){}),define("ecsbuy/base/models/_base",["require","exports","./base/buy/_base","./base/bizModel/_base","./simple/_base","./prepay/_base","./postpay/_base","./spotPostpay/_base","./disk/_base"],function(e,t){}),define("ecsbuy/base/services/serviceModule",["require","exports","angular","common/modelSystem/modelSystemBaseController"],function(e,t,n,r){var i=n.module("aliyunBuyEcsServices",[]);return i.controller=r.wrapController(r),i}),define("ecsbuy/base/helpers/HttpHelper",["require","exports","dominator/base/helpers/moduleHelper"],function(e,t,n){var r=function(){function e(){}return e.setHttp=function(e){this.http=e},e.getHttp=function(){var e=this.http;if(!e)throw new Error("$http must be set!");return e},e.jsonp=function(){var e=this.getHttp(),t=this.wrap(arguments,1,"GET");return e.jsonp.apply(e,t)},e.post=function(){var e=this.getHttp(),t=this.wrap(arguments,2,"POST");return e.post.apply(e,t)},e.urlEndpointRegionalized=function(e,t){var n=e;return t.invoke(["regionService",function(e){var t=e.getRegionIdFromDomain(),r="";!t||(r="-"+t),n=n.replace("{regionalSuffix}",r)}]),n},e.wrap=function(e,t,r){e=Array.prototype.slice.call(e,0);var i=e[t]||{};return typeof i=="object"&&n.config(i,{headers:{"Business-Tag":"aliyun-buy"}}),e[t]=i,e},e}();t.HttpHelper=r}),define("ecsbuy/base/services/remote/remoteService",["require","exports","angular","../serviceModule","../../helpers/HttpHelper","../../helpers/errorCodeHelper"],function(e,t,n,r,i,s){var o=function(){function e(){}return e.REGISTER="register",e.REGISTER_AGAIN="registerAgain",e}();return r.provider("aliyunBuyEcsRemoteService",function(){var e=this,t={},r={};e[o.REGISTER]=function(e,t){r[e]=t},e[o.REGISTER_AGAIN]=function(e,n){t[e]=n},e.registerPost=function(t,r,i,u){if(!n.isString(t)||!n.isString(r))return;u||(u=o.REGISTER),e[u](t,function(e,t,o,u,a){var f="",l=[];for(var c in t)t[c]!=undefined&&l.push(c+"="+t[c]);return l.length>0&&(f=l.join("&")),a.post(a.urlEndpointRegionalized(r,u),f).success(function(t){if(n.isFunction(i)){var r=i(t,u);r&&(t=r)}o||t.code!="200"?(s.ErrorCodeHelper.amendErrorMessage(t),e.resolve(t)):e.resolve(t.data)}).error(function(t){s.ErrorCodeHelper.amendErrorMessage(t);if(n.isFunction(i)){var r=i(t,u);r&&(t=r)}e.reject(t)}),e.promise})},e.registerJsonp=function(t,r,i,u){if(!n.isString(t)||!n.isString(r))return;u||(u=o.REGISTER),e[u](t,function(e,t,o,u,a){return a.jsonp(a.urlEndpointRegionalized(r,u),{params:t}).success(function(t){if(n.isFunction(i)){var r=i(t,u);r&&(t=r)}o||t.code!="200"?(s.ErrorCodeHelper.amendErrorMessage(t),e.resolve(t)):e.resolve(t.data)}).error(function(t){s.ErrorCodeHelper.amendErrorMessage(t);if(n.isFunction(i)){var r=i(t,u);r&&(t=r)}e.reject(t)}),e.promise})},e.registerLink=function(t,n,r){e.register(t,function(e,t,i,s){r||t&&t.isBlank==1?window.open(n(t)):window.location.href=n(t)})},e.registerPostAgain=function(t,n,r){e.registerPost(t,n,r,o.REGISTER)},e.registerJsonpAgain=function(t,n,r){e.registerJsonp(t,n,r,o.REGISTER_AGAIN)},e.$get=["$q","$http","$injector",function(e,n,s){function o(e){return t[e]instanceof Function?t[e]:r[e]}function u(t){return function(n,r){var u=e.defer(),a=o(t);return a instanceof Function&&a(u,n,r,s,i.HttpHelper),u.promise}}i.HttpHelper.setHttp(n);var a={};for(var f in r)a[f]=u(f);return a}]}),r}),define("ecsbuy/base/services/remote/remoteServiceConfig",["require","exports","./remoteService","../../cons/remoteActions","../../cons/urlConfig","../../helpers/homeConfigHelper","../../helpers/remoteConfigHelper"],function(e,t,n,r,i,s,o){n.config(["aliyunBuyEcsRemoteServiceProvider",function(e){e.registerJsonp(r.RemoteActions.GET_COMMODITY,o.RemoteConfigHelper.getJsonpUrl("/api/ecsCommodity/getCommodity"),o.RemoteConfigHelper.callbackShowDialog),e.registerJsonp(r.RemoteActions.GET_COMMODITY_4_RECYCLE_BIN,o.RemoteConfigHelper.getJsonpUrl("/api/recycleBin/getCommodity"),o.RemoteConfigHelper.callbackShowDialog),e.registerJsonp(r.RemoteActions.GET_COMMODITY_WITH_INSTANCE_INFO,o.RemoteConfigHelper.getJsonpUrl("/api/ecsCommodity/getCommodityWithInstanceInfo"),o.RemoteConfigHelper.callbackShowDialog),e.registerJsonp(r.RemoteActions.GET_RESIZE_DISK_COMMODITY,o.RemoteConfigHelper.getJsonpUrl("/api/diskCommodity/getCommodity"),o.RemoteConfigHelper.callbackShowDialog),e.registerJsonp(r.RemoteActions.GET_SIMPLE_BUY_COMMODITY,o.RemoteConfigHelper.getJsonpUrl("/api/ecsCommodity/getSimpleBuyCommodity"),o.RemoteConfigHelper.callbackShowDialog),e.registerJsonp(r.RemoteActions.GET_FREETIER_COMMODITY,o.RemoteConfigHelper.getJsonpUrl("/api/ecsCommodity/getFreeTrialCommodity"),o.RemoteConfigHelper.callbackShowDialog),e.registerJsonp(r.RemoteActions.GET_ENTERPRISE_FREETIER_COMMODITY,o.RemoteConfigHelper.getJsonpUrl("/api/ecsCommodity/getEnterpriseFreeTrialCommodity"),o.RemoteConfigHelper.callbackShowDialog),e.registerJsonp(r.RemoteActions.GET_COMPONENTS,o.RemoteConfigHelper.getJsonpUrl("/api/ecsCommodity/getComponents")),e.registerJsonp(r.RemoteActions.DESCRIBE_IMAGES,o.RemoteConfigHelper.getJsonpUrl("/api/ecsImage/describeImages")),e.registerJsonp(r.RemoteActions.QUERY_MARKET_IMAGE_CATEGORY,o.RemoteConfigHelper.getJsonpUrl("/api/ecsImage/queryMarketImageCategory")),e.registerJsonp(r.RemoteActions.QUERY_MARKET_IMAGES,o.RemoteConfigHelper.getJsonpUrl("/api/ecsImage/queryMarketImages")),e.registerJsonp(r.RemoteActions.QUERY_ECS_SNAPSHOT,o.RemoteConfigHelper.getJsonpUrl("/api/ecsSnapshot/querySnapshots")),e.registerJsonp(r.RemoteActions.QUERY_LIMITATION,o.RemoteConfigHelper.getJsonpUrl("/security/queryLimitation")),e.registerJsonp(r.RemoteActions.QUERY_SECURITY_GROUP_LIST,o.RemoteConfigHelper.getJsonpUrl("/security/queryEcsSecurityGroupList")),e.registerJsonp(r.RemoteActions.QUERY_VPCS,o.RemoteConfigHelper.getJsonpUrl("/api/ecsVpc/describeVpcs")),e.registerJsonp(r.RemoteActions.QUERY_VSWITCH,o.RemoteConfigHelper.getJsonpUrl("/api/ecsVpc/describeVSwitches")),e.registerPost(r.RemoteActions.CHECK_TOKEN_4_ECS,o.RemoteConfigHelper.getPostUrl("/risk/checkToken")),e.registerPost(r.RemoteActions.ECS_RISK_PUSH_DATA,o.RemoteConfigHelper.getPostUrl("/risk/pushData")),e.registerJsonp(r.RemoteActions.LIST_IMAGE_BY_IMAGE_IDS,o.RemoteConfigHelper.getJsonpUrl("/api/ecsImage/listImageByImageIds")),e.registerJsonp(r.RemoteActions.LIST_BANDWIDTH_PRICE_MAP,o.RemoteConfigHelper.getJsonpUrl("/api/ecsPrice/listBandwidthPriceMap")),e.registerJsonp(r.RemoteActions.QUERY_IMAGE_BY_IMAGE_ID,o.RemoteConfigHelper.getJsonpUrl("/api/ecsImage/queryImageByImageId")),e.registerJsonp(r.RemoteActions.QUERY_NEED_KEEP_USING_OFFLINE_IMAGE,o.RemoteConfigHelper.getJsonpUrl("/api/ecsImage/queryNeedKeepUsingOfflineImage")),e.registerPost(r.RemoteActions.KEEP_USING_OFFLINE_IMAGE,o.RemoteConfigHelper.getPostUrl("/api/ecsImage/keepUsingOfflineImage")),e.registerJsonp(r.RemoteActions.QUERY_ALL_IZ_NAME,o.RemoteConfigHelper.getJsonpUrl("/api/ecsIz/queryAllIzName")),e.registerJsonp(r.RemoteActions.CPS_AJAX,"https://buy.aliyun.com/ajax/OrderConfirmAjax/syncAlimama.jsonp?callback=JSON_CALLBACK"),e.registerPost(r.RemoteActions.CREATE_POSTPAY_INSTANCES,o.RemoteConfigHelper.getPostUrl("/api/ecsOrder/createPostPayInstance")),e.registerPost(r.RemoteActions.CREATE_BUY_ORDER,o.RemoteConfigHelper.getPostUrl("/api/ecsOrder/createBuyOrder")),e.registerPost(r.RemoteActions.CREATE_FREETIER_ORDER,o.RemoteConfigHelper.getPostUrl("/api/ecsOrder/createFreeTrialOrder")),e.registerPost(r.RemoteActions.CREATE_ENTERPRISE_FREETIER_ORDER,o.RemoteConfigHelper.getPostUrl("/api/ecsOrder/createEnterpriseFreeTrialOrder")),e.registerPost(r.RemoteActions.CREATE_CHANGE_OS_ORDER,o.RemoteConfigHelper.getPostUrl("api/diskOrder/createChangeOsOrder")),e.registerPost(r.RemoteActions.BATCH_CREATE_RESIZE_DISK_ORDER,o.RemoteConfigHelper.getPostUrl("api/diskOrder/batchCreateDiskResizeOrder")),e.registerPost(r.RemoteActions.CREATE_DISKS,o.RemoteConfigHelper.getPostUrl("/api/diskOrder/createDisks")),e.registerPost(r.RemoteActions.CREATE_VOLUMES,o.RemoteConfigHelper.getPostUrl("/api/diskOrder/createVolumes")),e.registerJsonp(r.RemoteActions.WHITELIST_FOR_USERDATA,o.RemoteConfigHelper.getJsonpUrl("/abTest/inWhiteListForUserData")),e.registerJsonp(r.RemoteActions.QUERY_ECS_INSTANCE_INFO,o.RemoteConfigHelper.getJsonpUrl("/api/ecsInstances/listEcsInstanceOrderInfo")),e.registerJsonp(r.RemoteActions.QUERY_ECS_DISK_INFO,o.RemoteConfigHelper.getJsonpUrl("/api/diskCommodity/listEcsDiskCommodityInfo")),e.registerJsonp(r.RemoteActions.LIST_MARKET_PLATFORM,"https://market.aliyun.com/api/image/component/queryPlatformList.jsonp?callback=JSON_CALLBACK"),e.registerJsonp(r.RemoteActions.GET_COPY_WRITER,o.RemoteConfigHelper.getJsonpUrl("/api/config/getCopywriter")),e.registerJsonp(r.RemoteActions.CHECK_IMAGE_SUPPORT_CLOUDINIT,o.RemoteConfigHelper.getJsonpUrl("/api/ecsImage/checkImageSupportCloudinit")),e.registerPost(r.RemoteActions.RELEASE_INSTANCE,o.RemoteConfigHelper.getPostUrl("/api/ecsRelease/releaseInstance")),e.registerPost(r.RemoteActions.CANCEL_RELEASE_INSTANCE,o.RemoteConfigHelper.getPostUrl("/api/ecsRelease/cancelReleaseInstance")),e.registerJsonp(r.RemoteActions.DESCRIBE_RELEASE_PRICE,o.RemoteConfigHelper.getJsonpUrl("/api/ecsRelease/describeReleasePrice"),o.RemoteConfigHelper.callBackFormatPriceRules),e.registerJsonp(r.RemoteActions.DESCRIBE_PRICE_4_SUBTOTAL,o.RemoteConfigHelper.getJsonpUrl("/api/ecsPrice/describePrice"),o.RemoteConfigHelper.callBackFormatPriceResponse),e.registerPost(r.RemoteActions.DESCRIBE_PRICE_POST,o.RemoteConfigHelper.getPostUrl("/api/ecsPrice/describePrice"),o.RemoteConfigHelper.callBackFormatPriceResponse),e.registerJsonp(r.RemoteActions.DESCRIBE_FREETIER_PRICE,o.RemoteConfigHelper.getJsonpUrl("/api/ecsPrice/describeFreeTrialPrice"),o.RemoteConfigHelper.callBackFormatPriceRules),e.registerJsonp(r.RemoteActions.DESCRIBE_ENTERPRISE_FREETIER_PRICE,o.RemoteConfigHelper.getJsonpUrl("/api/ecsPrice/describeEnterpriseFreeTrialPrice"),o.RemoteConfigHelper.callBackFormatPriceRules),e.registerJsonp(r.RemoteActions.DESCRIBE_PRICE,o.RemoteConfigHelper.getJsonpUrl("/api/ecsPrice/describePrice"),o.RemoteConfigHelper.callBackFormatPriceRules),e.registerJsonp(r.RemoteActions.IN_WHITE_UID_LIST,o.RemoteConfigHelper.getJsonpUrl("/abTest/inWhiteUidList")),e.registerJsonp(r.RemoteActions.IN_WHITE_UID_LIST_2,o.RemoteConfigHelper.getJsonpUrl("/abTest/inWhiteUidList2")),e.registerJsonp(r.RemoteActions.IN_WHITE_UID_LIST_COMMON,o.RemoteConfigHelper.getJsonpUrl("/abTest/inWhiteUidListCommon")),e.registerJsonp(r.RemoteActions.IN_WHITE_LIST_4_VOLUME_BUY,o.RemoteConfigHelper.getJsonpUrl("/abTest/inWhiteListForVolumeBuy")),e.registerJsonp(r.RemoteActions.DESCRIBE_KEYPAIRS,o.RemoteConfigHelper.getJsonpUrl("/api/keypair/describeKeyPairs")),e.registerJsonp(r.RemoteActions.IN_WHITE_LIST_4_DOWNGRADE,o.RemoteConfigHelper.getJsonpUrl("/abTest/inWhiteListForDowngrade")),e.registerJsonp(r.RemoteActions.IS_PREPAID_EIP_ADDRESS,o.RemoteConfigHelper.getJsonpUrl("/api/eip/isPrepaidEipAddress")),e.registerJsonp(r.RemoteActions.QUERY_BUY_HISTORY,o.RemoteConfigHelper.getJsonpUrl("/api/ecsRecentBuy/getRecentBuyRecord"),o.RemoteConfigHelper.callBackFormatBuyHistoryResponse),e.registerJsonp(r.RemoteActions.QUERY_ECS_BANDWIDTH_HISTORY,o.RemoteConfigHelper.getJsonpUrl("/api/bandwidth/queryBandwidthHistory"),o.RemoteConfigHelper.callBackFormatEcsBandwidthHistoryResponse),e.registerJsonp(r.RemoteActions.QUERY_MARKET_IMAGE_INSTANCES,o.RemoteConfigHelper.getJsonpUrl("/api/ecsImage/queryMarketImageInstances")),e.registerJsonp(r.RemoteActions.QUERY_ORDER_NOT_PAID,o.RemoteConfigHelper.getJsonpUrl("/api/ecsInstances/queryOrderNotPaid")),e.registerJsonp(r.RemoteActions.IN_WHITE_LIST_4_NETWORK_INTERFACE,o.RemoteConfigHelper.getJsonpUrl("/abTest/inWhiteListForNetworkInterface")),e.registerJsonp(r.RemoteActions.CHECK_RISK_SECURITY_GROUP,o.RemoteConfigHelper.getEcsConsoleJsonpUrl("/sg/securityGroup/checkRiskSecurityGroup")),e.registerJsonp(r.RemoteActions.CLONE_SECURITY_GROUP_SAFETY,o.RemoteConfigHelper.getEcsConsoleJsonpUrl("/sg/operator/cloneSecurityGroupSafety")),e.registerJsonp(r.RemoteActions.GET_SEC_TOKEN,o.RemoteConfigHelper.getJsonpUrl("/risk/getToken")),e.registerJsonp(r.RemoteActions.CHECK_START_PACKAGE_INSTANCE,"https://ecs-buy-intl.aliyun.com/api/ecsInst/checkBindInstance.jsonp?callback=JSON_CALLBACK"),e.registerJsonp(r.RemoteActions.IS_KMS_ACTIVATED,o.RemoteConfigHelper.getJsonpUrl("/api/kms/isActivated")),e.registerPost(r.RemoteActions.ACTIVATE_KSM,o.RemoteConfigHelper.getPostUrl("/api/kms/activate")),e.registerJsonp(r.RemoteActions.CHECK_WEB_APPLICATION_PACKAGE_INSTANCE,"https://solution-intl.aliyun.com/api/packOrders/findByInstanceIds.jsonp?callback=JSON_CALLBACK"),e.registerJsonp(r.RemoteActions.GET_RECOMMEND_INSTANCE_TYPE,o.RemoteConfigHelper.getJsonpUrl("/api/ecsCommodity/getRecommendInstanceType")),e.registerPost(r.RemoteActions.SIGN_RECYCLE_BIN_AGREEMENT,o.RemoteConfigHelper.getPostUrl("/api/agreement/signRecycleBinAgreement")),e.registerJsonp(r.RemoteActions.IS_SIGNED_RECYCLE_BIN_AGREEMENT,o.RemoteConfigHelper.getJsonpUrl("/api/agreement/isSignedRecycleBinAgreement")),e.registerJsonp(r.RemoteActions.DESCRIBE_HPC_CLUSTERS,o.RemoteConfigHelper.getJsonpUrl("/api/hpc/describeHpcClusters")),e.registerJsonp(r.RemoteActions.GET_SPOT_REGION_QUOTA,o.RemoteConfigHelper.getJsonpUrl("/api/quota/getSpotRegionQuota")),e.registerJsonp(r.RemoteActions.GET_ECS_REGION_QUOTA,o.RemoteConfigHelper.getJsonpUrl("/api/quota/getEcsRegionQuota")),e.registerLink(r.RemoteActions.LINK_TO_ORDER_PAGE,function(e){return(s.HomeConfigHelper.getUrlConfig("payOrder")||o.RemoteConfigHelper.getPayLinkUrl("/order/pay?order_id="))+e.orderId}),e.registerLink(r.RemoteActions.LINK_TO_MARKET_IMAGE_BUY,function(e){return i.UrlConfig.marketImageBuyUrl+e.param}),e.registerLink(r.RemoteActions.LOGIN,function(){var e=window.location.href;return o.RemoteConfigHelper.getLoginUrl("/login/login.htm?oauth_callback=")+encodeURIComponent(e)}),e.registerLink(r.RemoteActions.LINK_TO_ECS_INSTANCE_PAGE,function(){return s.HomeConfigHelper.getUrlConfig("ecsInstanceList")}),e.registerLink(r.RemoteActions.LINK_TO_ECS_DISK_PAGE,function(){return s.HomeConfigHelper.getUrlConfig("diskList")}),e.registerLink(r.RemoteActions.LINK_TO_ECS_CERTIFIED_PAGE,function(){return s.HomeConfigHelper.getUrlConfig("userAuthentication")}),e.registerLink(r.RemoteActions.LINK_TO_ECS_SECURITY_GROUP_RULE_PAGE,function(e){return s.HomeConfigHelper.getUrlConfig("securityGroupRule",e.regionAlias,e.securityGroupId,e.direction)},!0)}])}),define("ecsbuy/base/services/validation/validateService",["require","exports","angular","../serviceModule","../../helpers/commodityHelper"],function(e,t,n,r,i){return r.provider("aliyunBuyEcsValidateService",function(){function t(e){return"dominator:{field}:anchor".replace("{field}",e)}var e=this;e.validationRules=[],e.$get=["$injector",function(e){function s(e,s){var o=e.getOriginConstraintData(),u=i.CommodityHelper.getCommodityCode(o),a=i.CommodityHelper.getOrderType(o),f=!0;for(var l=0;l<r.validationRules.length;l++){var c=r.validationRules[l];if(!n.isFunction(c))continue;var h=c(e,s,u,a,o);if(h==1||h==undefined)continue;var p=h.field,d=e.getFieldMap();if(!d[p])continue;var v=e.getFieldById(p),m=h.message,g=t(p),y=v.getScope();f&&y.$broadcast(g),v.setOptionsAttr("state","error"),m&&v.setOptionsAttr("stateMessage",m),f=!1}return f}var r=this;return{validate:s}}]}),r}),define("ecsbuy/console/cons/cons",["require","exports"],function(e,t){var n=function(){function e(){}return e.VIEW_PATH="scripts/ecsbuy/console/views/",e.PARTIALS_PATH="scripts/ecsbuy/console/partials/",e.COOKIE_RENEW_INSTANCEID_KEY="ecs-buy-renew-instance-id",e.WEB_APPLICATION_PACKAGE_KEY="isWebApplicationPackage",e.START_PACKAGE_KEY="isStartPackage",e}();t.ConsoleConstant=n}),define("ecsbuy/console/helpers/instanceDetailHelper",["require","exports","common/helper/i18nHelper","../../base/helpers/buyUtils","../../base/helpers/commodityHelper","../../base/helpers/dateParseHelper","./commonConsoleHelper","../cons/cons"],function(e,t,n,r,i,s,o,u){var a=function(){function e(){}return e.getInstanceIdValue=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.instanceId")},e.getBandwidthTypeValue=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.vm_bandwidth.0.vm_is_flow_type")},e.getNetworkType=function(e){var t=r.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.vm_web_type");return i.CommodityHelper.getNetworkType(t)},e.getIoOptimized=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.iooptimized")},e.getBandwidthInstanceTypeConstraint=function(e){return r.BuyUtils.getMapProperty(e,"constraint.vm_bandwidth.instance_type")},e.getBaseBandwidthValue=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.baseBandWidth")},e.getMaxBandwidthValue=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.maxBandWidth")},e.getEipInstanceId=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.eipInstanceId")},e.getRegionId=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.regionId")},e.getPublicIp=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.vmPublicIp")},e.getDataDisk=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.datadisk")},e.getInstanceType=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.instance_type.0.instance_type")},e.getInstanceTypeFamily=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.instance_type.0.instance_type_family")},e.getVmIz=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.vm_iz")},e.getInstanceExpireTime=function(e){var t=r.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo"),n=r.BuyUtils.getMapProperty(t,"chargeType"),i=r.BuyUtils.getMapProperty(t,"instanceExpireTime");if(o.CommonConsoleHelper.isPrepay(n))return i?s.DateParseHelper.format(i,"yyyy-MM-dd hh:00"):undefined},e.getInstanceRenewRestartStartTime=function(e){var t=r.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo"),n=r.BuyUtils.getMapProperty(t,"chargeType"),i=r.BuyUtils.getMapProperty(t,"renewRestartStartTime");if(o.CommonConsoleHelper.isPrepay(n))return i?s.DateParseHelper.format(i,"yyyy-MM-dd hh:00"):undefined},e.getInstanceRenewRestartEndTime=function(e){var t=r.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo"),n=r.BuyUtils.getMapProperty(t,"chargeType"),i=r.BuyUtils.getMapProperty(t,"renewRestartEndTime");if(o.CommonConsoleHelper.isPrepay(n))return i?s.DateParseHelper.format(i,"yyyy-MM-dd hh:00"):undefined},e.getImageId=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.vm_os.0.vm_os")},e.getOsKind=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.vm_os.0.vm_os_kind")},e.getIsLocalOfSystemDisk=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.isLocalOfSystemDisk")},e.getInstanceCreatedTime=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.instanceCreatedTime")},e.isWeekly=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.saleCycle")=="Week"},e.isFromMarket=function(e){return!!r.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.vm_os.0.vm_os_imageProductCode")},e.isStartPackage=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo."+u.ConsoleConstant.START_PACKAGE_KEY)},e.isWebApplicationPackage=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo."+u.ConsoleConstant.WEB_APPLICATION_PACKAGE_KEY)},e.isInstanceExpire=function(e){var t=r.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo"),n=s.DateParseHelper.getDateFromISOString(t.currentTime).getTime(),i=s.DateParseHelper.getDateFromISOString(t.instanceExpireTime).getTime();return n>i},e.getInstanceVpcId=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.vm_vpc_id")},e.getInstanceSystemdiskCategory=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.systemdisk.0.systemdisk_category")},e.getUpgradeMigrateHasStock=function(e,t){var n=r.BuyUtils.getMapProperty(e,"constraint.instance_type.vm_region_no|vm_iz|upgrade_type");return n?n[t]:{}},e.isAvoidExpire=function(e){if(!e||!e.instanceDetail||!e.instanceDetail.instanceInfo)return!1;var t=e.instanceDetail.instanceInfo;return t.isRenewChangeAvailableOfNotExpire==0?!0:!1},e.fillDiskCategoryName=function(e){var t=r.BuyUtils.getMapProperty(e,"components.datadisk.datadisk_category");if(!angular.isArray(t))return;t.push({value:"cloud_ssd",text:"SSD "}),t.push({value:"cloud_efficiency",text:""}),t.push({value:"cloud",text:""})},e.appendExtraInfoPromiseForBuyIntl=function(t,n,r){var i=e,s=r.get("aliyunBuyEcsRemoteService"),o=r.get("base64"),u=n.instanceIds,a=n.orderType;if(!u)return t;var f=[];return f.push(i.checkStartPackageInstancePromise(t,u,a,s)),f.push(i.checkWebApplicationPackageInstancePromise(t,u,s,o)),r.get("$q").allSettled(f).then(function(){return t})},e.checkStartPackageInstancePromise=function(t,n,i,s){return s.checkStartPackageInstance({instanceIds:n,regionId:e.getRegionId(t),orderType:i}).then(function(e){var i=n.split(",");if(i.length==1){var s=r.BuyUtils.getMapProperty(e,n+".binding"),o=r.BuyUtils.getMapProperty(t,"instanceDetail.instanceInfo");!o||(o[u.ConsoleConstant.START_PACKAGE_KEY]=!!s)}})},e.checkWebApplicationPackageInstancePromise=function(e,t,n,i){var s={instanceIds:t};return n.checkWebApplicationPackageInstance({data:i.encode(angular.toJson(s))}).then(function(n){var i=t.split(",");if(i.length==1){var s=r.BuyUtils.getMapProperty(n,t+".binding"),o=r.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo");!o||(o[u.ConsoleConstant.WEB_APPLICATION_PACKAGE_KEY]=!!s)}})},e.validate=function(t,u,a){var f=e,l=r.BuyUtils.getMapProperty(t,"instanceDetail.instanceInfo"),c=i.CommodityHelper.getOrderType(t);if(!l)return;var h=function(e){if(l.isRenewChange){var t=s.DateParseHelper.format(l.vmRenewChangeEffectiveTime,"yyyy-MM-dd 00:00");throw u.dialog(n.i18n("ECS_PROMPT"),e||n.i18n("ECS_ERRORTIP_MODIFY_RENEW_CHANGE",t),a.linkToEcsInstancePage()),Error(e||n.i18n("ECS_ERRORTIP_MODIFY_RENEW_CHANGE",t))}},p=function(e){if(!f.isInstanceExpire(t)){var r=s.DateParseHelper.format(l.instanceExpireTime,"yyyy-MM-dd hh:mm:ss"),i=f.isStartPackage(t),o=f.isWebApplicationPackage(t),c=n.i18n("ECS_ERRORTIP_RENEW_LIMITATION",r);i?c=n.i18n("ECS_ERRORTIP_RENEW_LIMITATION_FOR_START_PACKAGE",r):o&&(c=n.i18n("ECS_ERRORTIP_RENEW_LIMITATION_FOR_WEB_APPLICATION_PACKAGE",r));if(i||o)throw u.dialog(n.i18n("ECS_PROMPT"),e||c,a.linkToEcsInstancePage()),Error(e||c)}},d=function(e){if(o.CommonConsoleHelper.isPostpay(l.chargeType))throw u.dialog(n.i18n("ECS_PROMPT"),e||n.i18n("ECS_ERRORTIP_AFTER_PAY_CANNOT_CHANGE"),a.linkToEcsInstancePage()),Error(e||n.i18n("ECS_ERRORTIP_AFTER_PAY_CANNOT_CHANGE"))},v=function(e){if(l.isProdFromYunMarket)throw u.dialog(n.i18n("ECS_PROMPT"),e||n.i18n("ECS_ERRORTIP_MODIFY_YUNMARKET_INSTANCE"),a.linkToEcsInstancePage()),Error(e||n.i18n("ECS_ERRORTIP_MODIFY_YUNMARKET_INSTANCE"))},m=function(e){if(f.isAvoidExpire(t))throw u.dialog(n.i18n("ECS_PROMPT"),e||n.i18n("ECS_AVOID_EXPIRE"),a.linkToEcsInstancePage()),Error(e||n.i18n("ECS_AVOID_EXPIRE"))},g=function(e){if(f.isWeekly(t))throw u.dialog(n.i18n("ECS_PROMPT"),e||n.i18n("ECS_DOWNGRADE_UNSUPPORTED_WEEKLY"),a.linkToEcsInstancePage()),Error(e||n.i18n("ECS_DOWNGRADE_UNSUPPORTED_WEEKLY"))},y=function(e){if(f.isStartPackage(t))throw u.dialog(n.i18n("ECS_PROMPT"),e||n.i18n("ECS_START_PACKAGE_INSTANCE_UNSUPPORT"),a.linkToEcsInstancePage()),Error(e||n.i18n("ECS_START_PACKAGE_INSTANCE_UNSUPPORT"))},b=function(e){if(f.isWebApplicationPackage(t))throw u.dialog(n.i18n("ECS_PROMPT"),e||n.i18n("ECS_WEB_APPLICATION_PACKAGE_INSTANCE_UNSUPPORT"),a.linkToEcsInstancePage()),Error(e||n.i18n("ECS_WEB_APPLICATION_PACKAGE_INSTANCE_UNSUPPORT"))};switch(c){case"RENEW":d(n.i18n("ECS_ERRORTIP_AFTER_PAY_CANNOT_RENEW")),p();break;case"DOWNGRADE":h(),d(),v(),m(),g(),b();break;case"DOWNGRADE_NOW":h(),d(),v(),m(),b();break;case"UPGRADE":h(),d(),v(),m(),b();break;default:}},e}();t.InstanceDetailHelper=a}),define("ecsbuy/console/helpers/downgradeHelper",["require","exports","angular","../../base/helpers/commodityHelper","../../base/helpers/orderDataHelper","../../base/helpers/buyUtils","./instanceDetailHelper","../../base/cons/buyBizCons","../../base/helpers/buyBizHelper"],function(e,t,n,r,i,s,o,u,a){var f=function(){function e(){}return e.getSelectedDatadiskIds=function(e){var t=[];return n.forEach(e,function(e,n){if(e.datadisk){var r=i.OrderDataHelper.getConvertSelectedDiskId(e.datadisk);t=t.concat(r)}}),t.join(",")},e.getSelectedDatadiskCategory=function(e,t){var n=e[0]||{};if(n.datadisk)return i.OrderDataHelper.getConvertSelectedDiskCategory(n.datadisk,t)},e.getDowngradeOrderParams=function(t,r,s){if(!t||!n.isArray(t))return;var o=this,u=[];return n.forEach(t,function(t,o){if(!t)return;var a=i.OrderDataHelper.getConvertSelectedDiskIdString(t.datadisk,null),f={instanceType:t.instance_type,toPayByTraffic:e.getToPayByTraffic(t,r.originBandwidthType),internetMaxBandwidthOut:t.vm_bandwidth,instanceId:r.instanceId,diskInstanceIds:a},l={orderType:"instance-downgrade-now",regionId:t.vm_region_no};s?l.commodity=f:n.extend(l,f),u.push(l)}),u},e.getUpgradeOrderParams=function(t,r,i){if(!t||!n.isArray(t))return;var s=t[0];if(!s)return;var o={instanceType:s.instance_type,bandwidthConvertToPayByBandwidth:e.getToPayByBandwidth(s,r.originBandwidthType),instanceIds:r.instanceId};s.upgrade_type=="migrate"&&s.migrate_ip&&(o.canMigrateAcrossZone=!0,s.systemdisk_category&&(o.systemDiskCategory=s.systemdisk_category));if(r.vmBandwidthSwitch&&r.originBandwidthValue!=s["vm_bandwidth"]||o.bandwidthConvertToPayByBandwidth)o.internetMaxBandwidthOut=s.vm_bandwidth;r.selectedDatadiskIds&&(o.convertDiskInstanceIds=r.selectedDatadiskIds.split(","));var u={orderType:"instance-upgrade",regionId:r.regionId,couponNo:r.couponNo||"default"};return u.commodity=o,i?[u]:u},e.getOrderParamsForDowngradeWithRenew=function(e,t,s){if(!e||!n.isArray(e))return;var o=[];return n.forEach(e,function(e,a){var f=r.CommodityHelper.getBandwidthType(e.vm_is_flow_type),l=r.CommodityHelper.getVmRestartTime(e.vmRestartTime),c=i.OrderDataHelper.getDuration(e,t.commodityCode),h=i.OrderDataHelper.getConvertSelectedDiskIdString(e.datadisk,null),p={instanceIds:t.instanceId,rebootTime:l,instanceType:e.instance_type,internetChargeType:f,internetMaxBandwidthOut:e.vm_bandwidth,priceUnit:c.priceUnit,periodType:c.periodType,period:c.period,convertDiskIds:h};n.isArray(s)&&n.forEach(s,function(e,t){p[e]=undefined}),o.push({orderType:"instance-downgrade",couponNo:t.couponNo||u.BuyBizCons.COUPON_DEFAULT,regionId:e.vm_region_no,commodity:p})}),o},e.getDowngradeWithRenewOrderParams=function(e,t,n){var r=this,i=[];return n?i=["periodType"]:i=["priceUnit"],r.getOrderParamsForDowngradeWithRenew(e,t,i)},e.getToPayByTraffic=function(e,t){return e["vm_is_flow_type"]==undefined?undefined:t=="PayByTraffic"?!1:e["vm_is_flow_type"]==1},e.getToPayByBandwidth=function(e,t){return e["vm_is_flow_type"]==undefined?!1:t=="PayByBandwidth"?!1:e["vm_is_flow_type"]==5},e.amendOrderData=function(e,t){var n=t[0]||{},s=o.InstanceDetailHelper.getInstanceType(e),u=o.InstanceDetailHelper.getBaseBandwidthValue(e)/1024,a=r.CommodityHelper.getBandwidthType(o.InstanceDetailHelper.getBandwidthTypeValue(e)),f=o.InstanceDetailHelper.getPublicIp(e),l=o.InstanceDetailHelper.getEipInstanceId(e),c=r.CommodityHelper.getBandwidthType(n.vm_is_flow_type),h=n.vm_bandwidth,p=n.instance_type,d;f&&s==p&&a==c&&u==h?d=!1:f&&s==p?(n.instance_type=undefined,d=!0):f&&a==c&&u==h?(n.vm_bandwidth=undefined,n.vm_is_flow_type=undefined,d=!0):s==p&&!f?(d=!1,n.vm_bandwidth=undefined,n.vm_is_flow_type=undefined):f?d=!0:(n.vm_bandwidth=undefined,n.vm_is_flow_type=undefined,d=!0);if(n.datadisk){var v=i.OrderDataHelper.getConvertSelectedDiskId(n.datadisk);v&&v.length>0&&(d=!0)}return d},e.upgradeAmendOrderData=function(e,t){var n=t[0]||{},s=o.InstanceDetailHelper.getInstanceType(e),u=o.InstanceDetailHelper.getBaseBandwidthValue(e)/1024,a=r.CommodityHelper.getBandwidthType(o.InstanceDetailHelper.getBandwidthTypeValue(e)),f=r.CommodityHelper.getBandwidthType(n.vm_is_flow_type),l=n.vm_bandwidth,c=n.instance_type,h=n.vm_bandwidth_switch,p;s!=c&&c!=undefined||a!=f||u!=l&&h!=0?s==c||c==undefined?(n.instance_type=undefined,p=!0):a==f&&u==l?(n.vm_bandwidth=undefined,n.vm_is_flow_type=undefined,p=!0):p=!0:p=!1;if(n.datadisk){var d=i.OrderDataHelper.getConvertSelectedDiskId(n.datadisk);d&&d.length>0&&(p=!0)}return p},e.isNeedToSetVmRestartTime=function(e){var t=e.getOriginConstraintData(),n=o.InstanceDetailHelper.getInstanceType(t),i=a.BuyBizHelper.getFieldValue("instance_type",e),u=a.BuyBizHelper.getFieldValue("vm_web_type",e),f=a.BuyBizHelper.getFieldValue("vm_bandwidth",e);if(!s.BuyUtils.hasUndefined(n,i,u,f)){var l=r.CommodityHelper.getNetworkType(u),c=o.InstanceDetailHelper.getPublicIp(t);if(n!=i||l=="classic"&&!c&&f>0)return!0}return!1},e}();t.DownAndUpgradeHelper=f}),define("ecsbuy/base/services/validation/validateServiceConfig",["require","exports","angular","./validateService","dominator/base/helpers/moduleHelper","common/helper/i18nHelper","../../helpers/commodityHelper","../../helpers/buyBizHelper","../../helpers/imageHelper","../../cons/cons","../../../console/helpers/downgradeHelper","../../helpers/instanceTypeHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c){r.config(["aliyunBuyEcsValidateServiceProvider",function(e){e.validationRules.push(function(e,t,r,i,s){if(r=="ecs"&&i=="BUY"||r=="vm"&&i=="BUY"){var a=e.getFieldMap();if(!a.amount||!a.vm_web_type||!a.vm_vpc)return!0;var f=u.BuyBizHelper.getFieldValue("amount",e),l=u.BuyBizHelper.getFieldValue("vm_web_type",e),c=u.BuyBizHelper.getFieldValue("vm_vpc",e),h,p,d,v;c&&(h=n.fromJson(c),p=h[1],d=h[0],v=h[4]);if(o.CommodityHelper.getNetworkType(l)=="vpc"){if(!d||v===!0)return{field:"vm_vpc"};if(typeof p=="number"&&f>p)return{field:"amount",message:"IP"+p+""+p+""}}return!0}return!0}),e.validationRules.push(function(e,t,r,i,s){if(r!="ecs"&&r!="vm")return!0;var o=e.getFieldMap();if(!o.securityGroup||!o.vm_web_type)return!0;var a=n.fromJson(u.BuyBizHelper.getFieldValue("securityGroup",e))||"",f=a[0],l=a[2];return f=="2"&&l==null?{field:"securityGroup"}:f=="1"&&l==null?{field:"securityGroup"}:!0}),e.validationRules.push(function(e,t,r,i,s){if(r=="ecs"&&i=="BUY"||r=="vm"&&i=="BUY"){var o=u.BuyBizHelper.getFieldValue("instance_type",e);if(c.InstanceTypeHelper.isHpcInstanceType(s,o)){if(u.BuyBizHelper.getFieldValue("hpcClusterId",e))return!0;var a=u.BuyBizHelper.getFieldValue("hpcClusterName",e),f=u.BuyBizHelper.getFieldValue("hpcClusterDescription",e);if(!a)return{field:"hpcClusterName"};var l=n.fromJson(a)[1],h=n.fromJson(a)[0];if(!l||!h)return{field:"hpcClusterName"};if(f){var p=n.fromJson(f)[0];if(!p)return{field:"hpcClusterDescription"}}}return!0}return!0}),e.validationRules.push(function(e,t,n,r,i){if(n!="ecs"&&n!="vm")return!0;var s=e.getFieldMap();if(!s.imageType)return!0;var o=u.BuyBizHelper.getFieldValue("imageType",e);if(!o)return!0;var a=u.BuyBizHelper.getFieldValue(o+"Image",e);if(!a)return{field:o+"Image"}}),e.validationRules.push(function(e,t,n,r,i){if(n!="ecs"&&n!="vm"&&r!="UPGRADE")return!0;var s=e.getFieldMap();if(!s.migrate_ip||!s.upgrade_type)return!0;var o=u.BuyBizHelper.getFieldValue("upgrade_type",e);if(!o||o=="none")return!0;var a=u.BuyBizHelper.getFieldValue("migrate_ip",e);return a?!0:{field:"migrate_ip"}}),e.validationRules.push(function(e,t,n,r,i){var o=a.ImageHelper.getImageValue(e),l=u.BuyBizHelper.getFieldValue("imageType",e);if(o.platform==f.Constant.WINDOWS_SERVER_2003&&l=="public"){var c=u.BuyBizHelper.getFieldValue("systemdisk_size",e);if(typeof c!="undefined"&&c>40)return{field:"publicImage",message:s.i18n("YUNDISK_WINDOWS_2003_RESIZE")}}return!0}),e.validationRules.push(function(e,t,n,r,i){if(r!="CHANGEOS")return!0;var o=u.BuyBizHelper.getFieldValue("imageType",e),f=a.ImageHelper.getImageValue(e),l=f.deviceMaping;return l instanceof Array&&l.length>1?{field:o+"Image",message:s.i18n("YUNDISK_CHANGEOS_NOT_SUPPORT_DEVICE_MAP")}:!0}),e.validationRules.push(function(e,t,n,r,i){if(n=="ecs"&&r=="BUY"||n=="vm"&&r=="BUY"||n=="vm"&&r=="CHANGEOS"){var o=e.getFieldMap();if(!o.imageOffline)return!0;var a=u.BuyBizHelper.getFieldValue("imageOffline",e);return a=="show"?{field:"imageOffline",message:s.i18n("ECS_IMAGE_OFFLINE_AGREEMENT_CHECKED")}:!0}return!0}),e.validationRules.push(function(e,t,n,r,i){if(n=="ecs"&&r=="BUY"||n=="vm"&&r=="BUY"){var s=e.getFieldMap();if(!s.systemdisk_category)return!0;var o=e.getFieldById("systemdisk_category");if(o&&o["_show"]==0)return!0;var a=u.BuyBizHelper.getFieldValue("systemdisk_category",e);return a?!0:{field:"systemdisk_category",message:"   I/O"}}return!0}),e.validationRules.push(function(e,t,r,s,o){if(r!="ecs"&&r!="vm")return!0;var a=e.getFieldMap();if(!a.datadisk)return!0;var f=u.BuyBizHelper.getFieldValue("datadisk",e);if(!f)return!0;var l=i.parseJsonSafe(f),c=!0;return n.forEach(l,function(e){e=i.parseJsonSafe(e);var t;e&&(t=e[1]),t||(c={field:"datadisk"})}),c}),e.validationRules.push(function(e,t,r,i,s){if(r!="ecs"&&r!="vm"&&(r!="vm"||i!="CHANGEOS"))return!0;var o=e.getFieldMap();if(!o.password||!o.setupPassword)return!0;var a=u.BuyBizHelper.getFieldValue("password",e),f=u.BuyBizHelper.getFieldValue("instanceName",e),l=u.BuyBizHelper.getFieldValue("setupPassword",e),c=u.BuyBizHelper.getFieldValue("keyPair",e);a=a?n.fromJson(a):undefined,f=f?n.fromJson(f):undefined;if(l=="keyPair"&&!c)return{field:"keyPair"};if(a&&l=="setupNow"&&!a[0])return{field:"password"};if(a&&l=="setupNow"&&a[1]===!1)return{field:"password"};if(f&&f[0]&&f[1]===!1)return{field:"instanceName"}}),e.validationRules.push(function(e,t,n,r,i){if(n=="ecs"&&r=="BUY"||n=="vm"&&r=="BUY"){var o=e.getFieldMap();if(!o.userdata||!o.userdata_select)return!0;var u=e.getFieldById("userdata_select"),a=u.getFieldValue();if(!a||a=="empty")return!0;var f=e.getFieldById("userdata"),l=f.getOptionsAttr("state");if(l=="error")return{field:"userdata"};var c=f.getFieldValue();return c==null?{field:"userdata",message:s.i18n("ECS_USER_DATA_NOT_EMPTY")}:!0}return!0}),e.validationRules.push(function(e,t,n,r,i){if(n!="vm"||r!="DOWNGRADE")return!0;var a=u.BuyBizHelper.getFieldValue("vmRestartTime",e);return l.DownAndUpgradeHelper.isNeedToSetVmRestartTime(e)&&!a?{field:"vmRestartTime",message:s.i18n("ECS_VM_RESTART_TIME_NOT_VALID_FOR_REQUIRED")}:o.CommodityHelper.checkPublishConflictForVmRestartTime(a)?{field:"vmRestartTime",message:s.i18n("ECS_VM_RESTART_TIME_NOT_VALID_FOR_PUBLISH")}:!0})}])}),define("ecsbuy/base/services/imageService",["require","exports","angular","./serviceModule","../helpers/imageHelper"],function(e,t,n,r,i){r.factory("aliyunBuyEcsImageService",["aliyunBuyEcsRemoteService","$q",function(e,t){function r(r){var s=t.defer(),o,u=r.imageType,a={system:r.os,shared:r.sharedImage,custom:r.customImage,market:r.marketImage};o=a[u];if(!o)return;var f=i.ImageHelper.parseValue(o),l=f.imageId,c=r.region,h=r.iooptimized,p=r.chargeType=="prepay"?"Prepaid":"AfterPay";if(!f||!c||!l)return;return e.queryImageByImageId({regionId:c,imageIds:l,supportIoOptimized:h=="optimized"?!0:undefined,chargeType:p}).then(function(e){var t=e[l];if(!t||t.isOffline){s.reject();return}if(!t.imageProductCode){s.reject();return}var r=n.fromJson(o),i=t.osTypeModel&&t.osTypeModel.kind,u=t.osTypeModel.osBit;n.isString(i)&&(i=i.toLowerCase()),n.isNumber(u)&&(u=u.toString()),r[0]||(r[0]=t.imageId),r[1]||(r[1]=i),r[2]||(r[2]=u),r[4]||(r[4]=t.imageSize),r[9]||(r[9]=t.imageProductCode),r[5]=t.imageCategory,r[6]=t.capacity||0,r[7]=t.used||0,r[8]=t.quota||0,r[10]=t.skuCodes&&t.skuCodes[0],r[11]=t.version;var a=n.toJson(r),f={};f.value=n.copy(a),f.text=t.displayName,f.version=t.version,s.resolve({value:a,detail:f})}),s.promise}return{completeImageMarketInfo:r}}])}),define("ecsbuy/base/services/common/cacheService",["require","exports","../serviceModule"],function(e,t,n){return n.factory("aliyunBuyEcsCacheService",["$cacheFactory",function(e){var t="testLocalStorage",n,r=!0;try{localStorage.setItem(t,"value"),localStorage.removeItem(t)}catch(i){r=!1}if(r)n={localStorageGet:function(e){return localStorage.getItem(e)},localStorageSet:function(e,t){return localStorage.setItem(e,t)},localStorageRemove:function(e){return localStorage.removeItem(e)},sessionStorageGet:function(e){return sessionStorage.getItem(e)},sessionStorageSet:function(e,t){return sessionStorage.setItem(e,t)},sessionStorageRemove:function(e){return sessionStorage.removeItem(e)}};else{var s=e("ecsBuyLocalCache"),o=e("ecsBuySessionCache");n={localStorageGet:s.get,localStorageSet:s.put,localStorageRemove:s.remove,sessionStorageGet:o.get,sessionStorageSet:o.put,sessionStorageRemove:o.remove}}return n}]),n}),define("ecsbuy/base/services/orderConfirm/orderConfirmService",["require","exports","../serviceModule","dominator/base/helpers/moduleHelper","common/helper/i18nHelper","../../helpers/homeConfigHelper"],function(e,t,n,r,i,s){return n.factory("aliyunBuyEcsOrderConfirmService",["$state","aliyunBuyMsg","aliyunBuyEcsRemoteService","aliyunBuyEcsDialogButtonConfigService","$filter",function(e,t,n,o,u){function a(u,a){var f=s.HomeConfigHelper.getValue("CSRF_TOKEN"),l=s.HomeConfigHelper.getUmid(),c=s.HomeConfigHelper.getUA();n.ecsRiskPushData({_csrf_token:f,umid:l,collina:c,eventCode:a}).then(function(){}),n.checkToken4Ecs({_csrf_token:f}).then(function(t){var n=u.split("?");if(n[1]){var i=r.parseQueryString(n[1]);e.go(n[0],i);return}e.go(n[0])},function(e){e.code=="ConsoleNeedLogin"?t.dialog(i.i18n("ECS_PROMPT"),e.message,o.login()):t.dialog(i.i18n("ECS_PROMPT"),e.message,o.refresh())})}return{gotoOrderConfirmPage:a}}]),n}),define("ecsbuy/base/services/common/dialogButtonConfigService",["require","exports","common/helper/i18nHelper","../serviceModule"],function(e,t,n,r){return r.factory("aliyunBuyEcsDialogButtonConfigService",["aliyunBuyEcsRemoteService",function(e){function t(){return{buttons:[{text:n.i18n("ECS_REFRESH"),theme:"blue",handler:function(){window.location.reload()}}]}}function r(){return{buttons:[{text:n.i18n("ECS_LOGIN"),theme:"blue",handler:function(){e.login()}}]}}function i(){return{buttons:[{text:n.i18n("ECS_BACK_TO_ECS_LIST"),theme:"blue",handler:function(){this.close(),e.linkToEcsInstancePage()}}]}}function s(){return{buttons:[{text:n.i18n("ECS_CERTIFY"),theme:"blue",handler:function(){e.linkToCertifiedPage()}}]}}function o(){return{buttons:[{text:n.i18n("ECS_BACK_TO_DISK_LIST"),theme:"blue",handler:function(){this.close(),e.linkToEcsDiskPage()}}]}}return{login:r,refresh:t,linkToEcsInstancePage:i,linkToEcsDiskPage:o,linkToCertifiedPage:s}}]),r}),define("ecsbuy/base/services/common/orderResultService",["require","exports","angular","common/helper/i18nHelper","../serviceModule"],function(e,t,n,r,i){return i.factory("aliyunBuyEcsOrderResultService",[function(){var e={},t={success:{isSuccess:!0,title:r.i18n("ECS_ORDER_RESULT_SUCCESS_TITLE"),info:r.i18n("ECS_ORDER_RESULT_SUCCESS_INFO"),infoMore:r.i18n("ECS_ORDER_RESULT_SUCCESS_INFO_MORE"),commodityCode:"yundisk"},error:{isSuccess:!1,title:r.i18n("ECS_ORDER_RESULT_FAILED_TITLE"),info:r.i18n("ECS_ORDER_RESULT_FAILED_INFO"),infoMore:r.i18n("ECS_ORDER_RESULT_FAILED_INFO_MORE")}};return e.yundisk={success:{infoMore:r.i18n("ECS_YUNDISK_ORDER_RESULT_SUCCESS_INFO_MORE")},error:{failedTip:"ECS_ORDER_RESULT_ECS_FAILD_TIP"}},e.volume={success:{infoMore:r.i18n("ECS_VOLUME_ORDER_RESULT_SUCCESS_INFO_MORE")},error:{info:"ECS_ORDER_RESULT_ECS_INFO",failedTip:"ECS_ORDER_RESULT_ECS_FAILD_TIP"}},e.ecs={success:{title:r.i18n("ECS_ECS_ORDER_RESULT_SUCCESS_TITLE"),infoMore:r.i18n("ECS_ORDER_RESULT_SUCCESS_INFO_MORE")},error:{info:"ECS_ORDER_RESULT_ECS_INFO",failedTip:"ECS_ORDER_RESULT_ECS_FAILD_TIP"}},e.vm={success:{infoMore:r.i18n("ECS_ORDER_RESULT_SUCCESS_INFO_MORE")},error:{title:r.i18n("ECS_VM_ORDER_RESULT_FAILED_TITLE"),info:"ECS_ORDER_RESULT_VM_INFO",failedTip:"ECS_ORDER_RESULT_VM_FAILD_TIP"}},e.getOrderResultBycommodityCode=function(r){var i=t.success,s=e[r].success;return n.extend(i,s)},e.getOrderErrorResultBycommodityCode=function(r,i){var s=t.error,o=e[r].error;return i&&(o.info=i),n.extend(s,o)},e}]),i}),define("ecsbuy/base/services/common/buyDefaultValueService",["require","exports","angular","../serviceModule","dominator/base/helpers/moduleHelper","dominator/base/helpers/constraintHelper","../../helpers/buyUtils","../../helpers/buyBizHelper","../../helpers/commodityHelper","../../helpers/diskHelper","../../helpers/orderDataHelper"],function(e,t,n,r,i,s,o,u,a,f,l){return r.factory("buyDefaultValueService",["$q","$timeout","$location","base64","regionService","aliyunBuyEcsCacheService","aliyunBuyEcsRemoteService",function(e,t,r,c,h,p,d){function g(e,t){var n=r.search();if(!n)return;if(t==0)return n[e];var i=n[e],s=null;if(!i)return;try{var o=c.decode(i);s=JSON.parse(o)}catch(u){console.error(u)}return s}function y(){var t=g("inst",!1);if(!t)return;var n=e.defer();return d.queryEcsInstanceInfo({instanceIds:t,orderType:"BUY"}).then(function(e){var t=e&&e[0]&&e[0].code,r=e&&e[0]&&e[0].instanceDetail,i=r&&r.orderInfo||{};n.resolve(i)},function(e){n.resolve({})}),n.promise}function b(){var e=g("data",!0);if(!e)return;var t=n.copy(e.data),r=n.copy(e.components);return r||(r={}),t||(t={}),n.extend(r,t),{components:r,data:t}}function w(e,n,r){n.isLoading=!0;var i=e.$on("dominator:ready",function(e,i){t(function(){n.$emit("initialized")},10),E(i,r)}),s=e.$on("dominator:remoteCommodityLoaded",function(e,t){n.isLoading=!1});return[i,s]}function E(e,t){var r=i.parseJsonSafe(p.sessionStorageGet("aliyun.buy.ecs.cache.orderData")),s;r&&(s=l.OrderDataHelper.formatToLXOrderParam(r,t)[0],h.isRegionlizeDomain()&&(s=undefined));var u=e.getOriginConstraintData(),f=b(),c=a.CommodityHelper.getDefaultConfig(u);if(s&&!o.BuyUtils.getMapProperty(f,"components.hpcClusterId"))x(e,s,t);else if(f)x(e,f,t);else{var d=y();d&&n.isFunction(d.then)?d.then(function(n){x(e,{components:n},t)}):c&&x(e,c,t)}}function x(e,t,r){t&&n.forEach(m,function(n,i){if(S[r]&&!s.contains(S[r],n.fieldId))return;if(n.type==v&&n.customHandler){n.customHandler(n,t,e,m);return}var a=o.BuyUtils.getMapProperty(t,n.defaultValueKey);a!==undefined&&u.BuyBizHelper.setFieldValue(n.fieldId,a,e)})}var v="custom",m=[{fieldId:"vm_region_no",type:v,customHandler:function(e,t,n,r){var i=n.getOriginConstraintData(),s=o.BuyUtils.getMapProperty(t,"components.vm_region_no"),f=a.CommodityHelper.getRegionId(i,s)||s;u.BuyBizHelper.setFieldValue(e.fieldId,f,n)}},{defaultValueKey:"components.vm_iz",fieldId:"vm_iz"},{defaultValueKey:"components.iooptimized",fieldId:"defaultIooptimized"},{defaultValueKey:"components.instance_type.0.instance_type",fieldId:"defaultInstanceType"},{defaultValueKey:"components.vm_web_type",fieldId:"vm_web_type"},{defaultValueKey:"components.vm_vpc_id",fieldId:"defaultValueVpcId"},{defaultValueKey:"components.vm_vpc_switch_id",fieldId:"defaultValueVswitchId"},{defaultValueKey:"components.securityGroupId",fieldId:"defaultSecurityGroupId"},{type:v,defaultValueKey:"components.groupRules",fieldId:"groupRule",customHandler:function(e,t,r,i){var s=o.BuyUtils.getMapProperty(t,e.defaultValueKey);if(!n.isArray(s))return;var a=[];n.forEach(s,function(e){e&&e.ipProtocol&&a.push(e.ipProtocol+":"+e.portRange)}),a.length>0&&u.BuyBizHelper.setFieldValue(e.fieldId,a.join(","),r)}},{defaultValueKey:"components.hpcClusterId",fieldId:"hpcClusterId"},{defaultValueKey:"components.vm_bandwidth.0.vm_is_flow_type",fieldId:"vm_is_flow_type"},{type:v,defaultValueKey:"components.vm_bandwidth.0.vm_bandwidth",fieldId:"vm_bandwidth",customHandler:function(e,n,r,i){var s=o.BuyUtils.getMapProperty(n,e.defaultValueKey);if(o.BuyUtils.hasUndefined(s))return;var a=s/1024;t(function(){u.BuyBizHelper.setFieldValue(e.fieldId,a,r)},300)}},{defaultValueKey:"components.imageType",fieldId:"imageType"},{type:v,fieldId:"{%s}DefaultValueImageId",customHandler:function(e,n,r,i){var s=o.BuyUtils.getMapProperty(n,"components.imageId"),a=o.BuyUtils.getMapProperty(n,"components.imageType");if(o.BuyUtils.hasUndefined(a,s))return;var f=e.fieldId.replace("{%s}",a);t(function(){u.BuyBizHelper.setFieldValue(f,s,r)},300)}},{defaultValueKey:"components.systemdisk.0.systemdisk_category",fieldId:"systemdisk_category"},{defaultValueKey:"components.systemdisk.0.systemdisk_size",fieldId:"systemdisk_size"},{type:v,fieldId:"datadisk",customHandler:function(e,t,r,i){var s=o.BuyUtils.getMapProperty(t,"components.datadisk"),a=[];n.forEach(s,function(e){var t=f.DiskHelper.covertDiskDataList(e);a.push(t)}),u.BuyBizHelper.setFieldValue(e.fieldId,n.toJson(a),r)}},{type:v,fieldId:"order_time",customHandler:function(e,t,n,r){var i=o.BuyUtils.getMapProperty(t,"data.duration"),s=o.BuyUtils.getMapProperty(t,"data.pricingCycle");if(o.BuyUtils.hasUndefined(i,s))return;var f=a.CommodityHelper.transformDurationValue(i,s);u.BuyBizHelper.setFieldValue(e.fieldId,f,n)}},{defaultValueKey:"data.quantity",fieldId:"amount"},{type:v,customHandler:function(e,n,r,i){var s=o.BuyUtils.getMapProperty(n,"components.setupPassword");t(function(){u.BuyBizHelper.setFieldValue(e.fieldId,s,r)},10)},fieldId:"setupPassword"},{defaultValueKey:"data.orderSource",fieldId:"orderSource"},{defaultValueKey:"data.activityId",fieldId:"activityId"}],S={vm_simple:["vm_region_no","defaultInstanceType","vm_web_type","order_time"],yundisk:["vm_region_no","vm_iz"]};return{setDefaultValue:E,dominatorReadyHandler:w}}]),r}),define("ecsbuy/base/services/common/ecsBuyRegionService",["require","exports","angular","common/helper/i18nHelper","../serviceModule","../../helpers/homeConfigHelper","../../helpers/commodityHelper","../../helpers/buyUtils"],function(e,t,n,r,i,s,o,u){var a="ecs-buy",f={options:{productId:a,regionSetting:s.HomeConfigHelper.getRegionSetting(),regionList:[]},$get:function(){return this},extend:!1,setOptions:function(e){n.extend(this.options,e),this.extend=!0},getOptions:function(){return this.options}};i.provider("aliyunBuyRegionalizationService",function(){return f}),i.factory("ecsBuyRegionService",["base64","$rootScope","regionService","aliyunBuyEcsCacheService","aliyunBuyRegionalizationService",function(e,t,i,s,a){function p(e){return e&&i.redirectHandler(e,!0)}function d(t,r){var o=i.productId,u=i.getDomainFromRegionId(t,o),a=window.location.hash.split("?")[0],f=n.toJson({components:{vm_region_no:r}}),l;i.regionSettingSimpleProduct&&i.regionSettingSimpleProduct[t]?l="":l="?data="+encodeURIComponent(e.encode(f));var c="//"+u+"/"+a+l;s.sessionStorageRemove("aliyun.buy.ecs.cache.orderData"),window.location.href=c,i.loading(null,v)}function v(e,t){return r.i18n("ECS_GOTO_REGION_LOADING",t)}var f={},l={},c=function(e){f=o.CommodityHelper.getConfigProperty(e,"region_map")||{},l=u.BuyUtils.reverseMap(f)||{};if(!a.extend){var t=o.CommodityHelper.getComponentDeep(e,"vm_region_no.vm_region_no"),r=[];n.forEach(t,function(e){var t=e.regionAlias||f[e.value];r.push({regionId:t,name:e.text})}),a.setOptions({regionList:r})}i.setOptions(a.getOptions())},h=function(e){var n=f[e]||e;i.setActiveRegionId(n,!0),t.selectedRegionId=n,p(n)&&d(n,e)};return{initRegionSetting:c,changeRegionHandler:h}}])}),define("ecsbuy/base/services/common/dynamicDictService",["require","exports","angular","../serviceModule"],function(e,t,n,r){r.factory("aliyunBuyEcsDynamicDictService",["aliyunBuyEcsRemoteService","$q",function(e,t){function o(n){var o=t.defer();return i.push({key:n,defer:o,resolved:!1}),r&&u(r),s||(s=!0,e.getCopywriter().then(function(e){r=e,u(r)},function(){s=!1,o.resolve(undefined)})),o.promise}function u(e){n.forEach(i,function(t){if(!t.resolved){var n=t.key;t.defer.resolve(e[n]),t.resolved=!0}})}var r=null,i=[],s=!1;return{getCopywriter:o}}])}),define("ecsbuy/base/services/common/blockListService",["require","exports","../serviceModule","dominator/base/helpers/constraintHelper"],function(e,t,n,r){n.provider("aliyunBuyEcsBlockListService",function(){var e=this;e.blockList=[],e.$get=["$injector",function(){function t(t){if(t)return r.contains(e.blockList,t)}return{inBlockList:t}}]})}),define("ecsbuy/base/services/_base",["require","exports","./serviceModule","./remote/remoteService","./remote/remoteServiceConfig","./validation/validateService","./validation/validateServiceConfig","./imageService","./common/cacheService","./orderConfirm/orderConfirmService","./common/dialogButtonConfigService","./common/orderResultService","./common/buyDefaultValueService","./common/ecsBuyRegionService","./common/dynamicDictService","./common/blockListService"],function(e,t){}),define("ecsbuy/base/filters/filters",["require","exports","angular","common/modelSystem/modelSystemBaseController"],function(e,t,n,r){var i=n.module("ecsbuyFilters",[]);return i.controller=r.wrapController(i),i}),define("ecsbuy/base/filters/commonDateFilter",["require","exports","./filters"],function(e,t,n){n.filter("commonDateFilter",["$filter",function(e){var t="yyyy-MM-dd HH:mm:ss",n=e("date");return function(e,r){var r=r||t,i=e;if(i==undefined)return"";if(typeof e=="string"||typeof e=="number")e*1==e*1?i=new Date(e*1):i=new Date(e);if(i.toString()=="Invalid Date"||i.toString()=="NaN"){var s=e.match(/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})/);s==null&&(s=e.match(/(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})/)),s!=null&&(s=s.slice(1,7),s[3]=s[1]/1-(new Date).getTimezoneOffset()/60,i=new Date(s[0],s[1],s[2],s[3],s[4],s[5]))}return Object.prototype.toString.call(e)=="[object Date]"&&(i=e),Object.prototype.toString.call(i)=="[object Date]"&&(i=n(i,r)),i}}])}),define("ecsbuy/base/filters/_base",["require","exports","./commonDateFilter"],function(e,t){}),define("ecsbuy/base/helpers/fields/UIModelHelper",["require","exports","angular"],function(e,t,n){var r=function(){function e(){}return e.appendGroupTip=function(e,t,r){if(e&&n.isArray(e))for(var i=e.length-1;i>=0;i--){var s=e[i];s.id==t&&(s.tip=r)}},e}();t.UIModelHelper=r}),define("ecsbuy/base/dominatorHijack",["require","exports","dominator/driver/services/dominator/dominator"],function(e,t,n){n.prototype.getOrder=function(){var e=this._fieldsCache.list,t={},n=null;for(var r=0,i=null;i=e[r];r++)n=i._getVM(),t[i.componentCode]=n.getOrderValue();return t},n.prototype.getComponents=function(){var e=this._fieldsCache.list,t=null,n={};for(var r=0,i=null;i=e[r];r++)t=i._getVM(),n[i.componentCode]=t.getComponents();return n}}),define("ecsbuy/console/directives/directives",["require","exports","angular","common/modelSystem/modelSystemBaseController"],function(e,t,n,r){var i=n.module("ecsbuyConsoleDirectives",[]);return i.controller=r.wrapController(i),i}),define("ecsbuy/console/models/base/batchActionClass/EcsBaseBatchUi",["require","exports"],function(e,t){(function(e){e[e.valid=0]="valid",e[e.invalid=1]="invalid"})(t.BatchUiNamespace||(t.BatchUiNamespace={}));var n=t.BatchUiNamespace,r=function(){function e(e){this.$injector=e}return e.prototype.formatBatchViewData=function(e,t,n,r){var i=this;return{viewInfos:i.formatBatchViewRowItems(e,t,n,r),viewInfoHeads:i.formatBatchViewHeads(e,t,n,r)}},e.prototype.formatBatchViewRowItems=function(e,t,n,r){var i=this,s=[];return e instanceof Array&&angular.forEach(e,function(e,o){var u=i.formatBatchViewRowItem(e,o,t,n,r);!u||s.push(u)}),s},e.prototype.formatBatchViewRowItem=function(e,t,n,r,i){var s=this;return{colItems:s.formatBatchViewColItems(e,t,n,r,i),_isRemoved:null}},e.prototype.convertToBindFn=function(e){if(!e)return null;var t=this;return function(){var n=Array.prototype.slice.call(arguments);return e.apply(t,n)}},e.prototype.getTemplateKeys=function(e){return[]},e.prototype.formatBatchViewColItems=function(t,n,r,i,s){var o=this,u=e,a=o.getColItemsTemplateMap(t,n,r,s),f=o.getTemplateKeys(i);return u.getArrayFromMapByKeyList(a,f)},e.prototype.getColItemsTemplateMap=function(e,t,n,r){return{}},e.prototype.formatBatchViewHeads=function(t,n,r,i){var s=this,o=e,u=s.getHeadsTemplateMap(t,n,i),a=s.getTemplateKeys(r);return o.getArrayFromMapByKeyList(u,a)},e.prototype.getHeadsTemplateMap=function(e,t,n){return{}},e.getArrayFromMapByKeyList=function(e,t){var n=[];return t instanceof Array&&angular.forEach(t,function(t,r){typeof e[t]!="undefined"&&n.push(e[t])}),n},e.prototype.makeBatchUiFactory=function(){var e={formatBatchViewData:this.convertToBindFn(this.formatBatchViewData)};return e},e}();t.EcsBaseBatchUi=r}),define("ecsbuy/console/directives/common/batchActionView",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","common/helper/i18nHelper","../../cons/cons","../../../base/helpers/buyUtils","../../models/base/batchActionClass/EcsBaseBatchUi"],function(e,t,n,r,i,s,o,u,a){r.directive("aliyunBuyEcsBatchViewNew",["$q","$filter","$injector","$compile","$timeout","$sce","$rootScope","aliyunBuyEcsRemoteService","aliyunBuyPriceQuerier",function(e,t,r,f,l,c,h,p,d){function v(t,r,o){function H(){E=S(m,u),k=S(C,u)}function B(){C=n.copy(c),H()}function q(){var e,r=u.priceService;if(n.isFunction(r.queryPrice)){var s=function(e){var t=r.queryPrice;if(n.isFunction(t))return t.call(r,e)};e=new d(s),e.promise.then(null,null,function(e){if(e.pending)t.viewModel.priceResult={pending:!0},t.priceResult={calculating:!0};else{if(e.success){var s=i.formatPriceRules(e.data),o=r.formatQueryPriceResponse(n.copy(s),O(),n.copy(t.saveOptions),{viewModel:n.copy(t.viewModel)});t.viewModel.priceResult={pending:!1,success:!0,result:o},t.priceResult={calculating:!1,success:!0,data:s}}else t.viewModel.priceResult={pending:!1,success:!1,code:e.code,message:e.message},t.priceResult={calculating:!1,success:!1,data:{message:e.message}};t.$emit("aliyunBuyEcsBatchView:queryPriceFinished")}})}return e}var u=y(t),f=b(t),c=[],p={},v=[],m=[],E=[],C=[],k=[],L={},A=!1,O=function(){return{activeBatchInfoIds:n.copy(k),exludeBatchInfoIds:n.copy(E),allBatchInfoIds:n.copy(v),activeBatchInfos:n.copy(C),exludeBatchInfos:n.copy(m),allBatchInfos:n.copy(c),allComponents:n.copy(p)}};t.viewModel.change=function(){var e=u.showBatchDialog;n.isFunction(e)&&e(O())};var M=[],_=u.queryService;if(n.isFunction(_.queryBatchInfos)&&n.isFunction(_.queryComponents)){t.isLoading=!0;var D=_.queryBatchInfos(),P=_.queryComponents();M.push(D),M.push(P),e.all(M).then(function(e){var n=e[0],r=e[1],i=w(n,u);t.invalidBatchInfosLength=i.invalidBatchInfos.length,t.wholeBatchInfosLength=n.length,t.validBatchInfosLength=i.validBatchInfos.length,t.invalidBatchInfosTip=s.i18n("ecs.buy.console.batch.invalid.tip",t.wholeBatchInfosLength,t.invalidBatchInfosLength),p=r,c=i.validBatchInfos,v=S(i.validBatchInfos,u),B(),L=f.formatBatchViewData(i.validBatchInfos,r,a.BatchUiNamespace.valid,{scope:t}),t.viewData=L,i.invalidBatchInfos.length>0&&(t.viewDataForInvalid=f.formatBatchViewData(i.invalidBatchInfos,r,a.BatchUiNamespace.invalid,{scope:t}))})["finally"](function(){t.isLoading=!1})}B();var j=q();t.remove=function(e){e!=undefined&&(N(L,e,!0),x(m,c[e],u),T(C,c[e],u),H(),A&&g(j,O(),t,u))},t.undoRemove=function(e){e!=undefined&&(N(L,e,!1),x(C,c[e],u),T(m,c[e],u),H(),A&&g(j,O(),t,u))};var F=h.$on("aliyunBuyEcsBatchView:batchSubmit",function(e){var r=u.submitService;n.isFunction(r.batchSubmit)&&r.batchSubmit(O(),n.copy(t.saveOptions),{viewModel:n.copy(t.viewModel)})}),I=h.$on("aliyunBuyEcsBatchView:queryPrice",function(e){l(function(){A=!0,g(j,O(),t,u)},100)});t.$on("$destroy",function(){n.isFunction(F)&&F(),n.isFunction(I)&&I()})}function m(e){e.priceResult=undefined,e.viewModel.priceResult=undefined}function g(e,t,r,i){var s=i.priceService;if(n.isFunction(s.getQueryPriceParams)&&!!e&&n.isFunction(e.query)){var o=s.getQueryPriceParams(t,n.copy(r.saveOptions),{viewModel:n.copy(r.viewModel)});!n.isFunction(s.getQueryPriceParams)||s.beforeQueryPrice(o)?(r.$emit("aliyunBuyEcsBatchView:queryPriceStarted"),e.query.call(e,o)):m(r)}}function y(e){var t=e.batchActionModel;if(!t)throw new Error("batchActionModel");return t}function b(e){var t=e.batchUiModel;if(!t)throw new Error("batchUiModel");return t}function w(e,t){var r={validBatchInfos:[],invalidBatchInfos:[]},i=t.isInvalidInfo;return n.isFunction(i)||(r.validBatchInfos=e),n.forEach(e,function(e,t){var n=i(e);n?(e._invalidMsg=n,r.invalidBatchInfos.push(e)):r.validBatchInfos.push(e)}),r}function E(e,t,r){var i=r.getUniqueId;if(n.isFunction(i))for(var s=0;s<e.length;s++){var o=e[s];if(i(o)===i(t))return s}return-1}function S(e,t){var r=[],i=t.getUniqueId;return e instanceof Array&&n.isFunction(i)&&n.forEach(e,function(e,t){r.push(i(e))}),r}function x(e,t,n){var r=E(e,t,n);r==-1&&e.push(t)}function T(e,t,n){var r=E(e,t,n);r>-1&&e.splice(r,1)}function N(e,t,r){if(!u.BuyUtils.hasUndefined(e,t,r)){var i=e.viewInfos;if(n.isArray(i)){var s=i[t];s&&(s._isRemoved=r)}}}function C(e,t,r){var i=r.get("$rootScope"),s,o=i.$on("aliyunBuyEcsBatchView:changedContent",function(e,t){!t||(s=t)}),u=i.$on("aliyunBuyEcsBatchView:saveOptions",function(e,n){t.saveOptions=n||{},t.viewModel.changedContent=s});t.$on("$destroy",function(){n.isFunction(o)&&o(),n.isFunction(u)&&u()}),t.viewModel={batchOperationTitle:e.getBatchOperationTitle(),changedContent:"-",changedFormCache:{},priceResult:{}}}return{restrict:"AE",templateUrl:o.ConsoleConstant.PARTIALS_PATH+"common/batchActionView.html",scope:{batchActionModel:"=",batchUiModel:"=",priceResult:"=?"},compile:function(e,t){return{pre:function(e){var t=y(e);C(t,e,r)},post:v}}}}])}),define("ecsbuy/console/directives/common/renderDynamicHtml",["require","exports","../directives"],function(e,t,n){n.directive("aliyunBuyRenderDynamicHtml",["$compile",function(e){return{restrict:"AE",scope:{bindScope:"=?"},template:"<span></span>",link:function(t,n,r){function s(){var s=r.template;if(i||!s)return;i=!0,n.append(s),e(n.contents())(t.bindScope||t.$parent)}var i=!1;s()}}}])}),define("ecsbuy/console/directives/common/commonIntro",["require","exports","../directives","../../cons/cons"],function(e,t,n,r){n.directive("aliyunBuyCommonIntro",["$compile",function(e){return{restrict:"AE",scope:{options:"=?"},templateUrl:r.ConsoleConstant.PARTIALS_PATH+"common/commonIntro.html",link:function(e,t,n){}}}])}),define("ecsbuy/console/directives/common/_base",["require","exports","./batchActionView","./renderDynamicHtml","./commonIntro"],function(e,t){}),define("ecsbuy/console/helpers/buyAgainHelper",["require","exports","angular","dominator/base/helpers/constraintHelper","../../base/helpers/commodityHelper","../../base/helpers/orderDataHelper","../../base/cons/diskCategory","./instanceDetailHelperNew","../../base/cons/spotStrategy"],function(e,t,n,r,i,s,o,u,a){var f=function(){function e(){}return e.getOrderParams=function(e,t,f){if(!e||!t||!n.isArray(t))return;var l=[o.DiskCategory.LOCAL_HDD_PRO,o.DiskCategory.LOCAL_SSD_PRO],c=e.instanceDetail||{},h=i.CommodityHelper.getCommodityCode(e),p="BUY",d=t[0].recommend_instance_type,v=t[0].systemdisk_category,m=s.OrderDataHelper.getOrderParam(t,h,p,f,e),g=m&&m[0]||{},y=u.InstanceDetailHelperNew.getSystemDiskSize(e),b=c.InstanceType;g.regionId=u.InstanceDetailHelperNew.getRegionAlias(e),n.extend(g.commodity,{zoneId:c.ZoneId,instanceType:d?d:b,imageId:c.ImageId,systemDisk:{size:y<40?40:y,category:v||u.InstanceDetailHelperNew.getSystemDiskCategory(e)},dataDisks:function(){var t=u.InstanceDetailHelperNew.getDataDiskList(e),i=[];return t&&n.isArray(t)&&n.forEach(t,function(e){if(r.contains(l,e.Category))return;i.push({category:e.Category,size:e.Size,device:e.Device,snapshotId:e.SourceSnapshotId,encrypted:e.SourceSnapshotId?undefined:e.Encrypted,deleteWithInstance:e.DeleteWithInstance})}),i}(),networkType:u.InstanceDetailHelperNew.getNetworkType(e),vSwitchId:u.InstanceDetailHelperNew.getVSwitchId(e),ioOptimized:d?!0:c.IoOptimized});var w=u.InstanceDetailHelperNew.getEipInstanceId(e);return w&&(g.commodity.internetChargeType="PayByBandwidth",g.commodity.internetMaxBandwidthOut=0),f||(g.businessInfo={orderSource:"buyAgain"},d&&(g.businessInfo.recommend_from=b)),g.commodity.securityGroupId||(g.commodity.securityGroupId=u.InstanceDetailHelperNew.getSecurityGroupId(e)),g.commodity.internetChargeType||(g.commodity.internetChargeType=u.InstanceDetailHelperNew.getBandwidthType(e)),!g.commodity.internetMaxBandwidthOut&&g.commodity.internetMaxBandwidthOut!=0&&(g.commodity.internetMaxBandwidthOut=u.InstanceDetailHelperNew.getBandwidthValue(e)),c.SpotStrategy&&c.SpotStrategy!=a.SpotStrategy.NO_SPOT&&(g.commodity.spotStrategy=c.SpotStrategy,g.commodity.spotPriceLimit=c.SpotPriceLimit),[g]},e.hijackBandwidthDefaultValue=function(e){var t=i.CommodityHelper.getComponent(e,"default_buy"),n=i.CommodityHelper.getConstraints(e),r=u.InstanceDetailHelperNew.getVmFlowType(e),s=u.InstanceDetailHelperNew.getBandwidthValue(e),o=i.CommodityHelper.getRegionId(e,u.InstanceDetailHelperNew.getRegionAlias(e));t.default_vm_is_flow_type=[{value:r}],t.default_bandwidth.push({value:s}),n.default_bandwidth.vm_is_flow_type[r]=[s];var a={};a[o]=[r],n.default_vm_is_flow_type={vm_region_no:a}},e.hijackInstanceDisplay=function(e){var t=e.instanceDetail||{};t.ExpiredTime=undefined,t.InnerIpAddress=undefined,t.PublicIpAddress=undefined,t.EipAddress&&t.EipAddress.IpAddress&&(t.EipAddress.IpAddress=undefined)},e}();t.BuyAgainHelper=f}),define("ecsbuy/console/directives/buyAgain/buyAgain",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","../../cons/cons","../../helpers/buyAgainHelper","../../../base/helpers/fields/regionHelper","../../../base/helpers/purchaseHelper","../../../base/cons/remoteActions","../../../base/helpers/homeConfigHelper","../../helpers/instanceDetailHelperNew"],function(e,t,n,r,i,s,o,u,a,f,l,c){r.directive("aliyunBuyEcsBuyAgain",["aliyunBuyEcsRemoteService","aliyunBuyEcsValidateService","$rootScope","modelFactory","base64","$state",function(e,t,r,h,p,d){return{restrict:"EA",templateUrl:s.ConsoleConstant.PARTIALS_PATH+"buyAgain/buyAgain.html",scope:{options:"=",commodityCode:"@",instanceId:"@",regionId:"@",isLoading:"=?"},replace:!0,compile:function(s,h){return i.require(["options","value","detail"],h),{pre:function(i){function s(){var t=i.instanceId,n=i.commodityCode,r=i.regionId;return e[f.RemoteActions.GET_COMMODITY_WITH_INSTANCE_INFO]({commodityCode:n,orderType:"BUY",regionId:r,instanceId:t}).then(function(e){return i.isLoading=!1,e})}function h(e){o.BuyAgainHelper.hijackBandwidthDefaultValue(e),o.BuyAgainHelper.hijackInstanceDisplay(e),u.RegionHelper.hijackFinanceRegionname(e),i.raw=e;var t=c.InstanceDetailHelperNew.hasEncryptedDisk(e);return i.kmsTermUrl=t&&l.HomeConfigHelper.getUrlConfig("kmsTermUrl"),e}function v(t){var r=o.BuyAgainHelper.getOrderParams(i.raw,t,!0),s=r[0];s&&s.commodity.internetChargeType=="PayByTraffic"&&(r=[{orderType:"traffic-bandwidth",regionId:s.regionId}].concat(r));var u={data:p.encode(n.toJson(r))};return y(!0),e[f.RemoteActions.DESCRIBE_PRICE](u).then(function(e){y(!1),e&&e.children&&n.forEach(e.children,function(t){t&&t.orderType=="traffic-bandwidth"&&(e.flowPrice=t.trade,e.flowPriceUnit="/GB"),t&&t.orderType=="instance-buy"&&(e.origin=t.origin,e.discount=t.discount,e.trade=t.trade,e.rules=t.rules,e.strategies=t.strategies,t.isPostpay&&(e.basePriceUnit="/"))}),e.isPostpay&&(e.basePriceUnit="/");var t=a.PurchaseHelper.getInsufficientBalanceTip(e.code,null);return!t||(i.payOrderTip=t,y(!0)),e},function(e){return e})["finally"](function(){})}function m(e,n,r,i){return t.validate(n,e)}function g(e,t){var n=o.BuyAgainHelper.getOrderParams(i.raw,e,!1);i.$emit("aliyunBuyEcsBuyAgain:purchase",{order:n})}function y(e){i.payDisabled=e}i.isLoading=!0,i.priceViewConfig={priceService:{getPrice:v}},i.purchase=function(e){if(!i.checked||!!i.payDisabled)return;i.$broadcast("aliyunBuySubtotal:purchase")},i.frameworkSetting={constraintService:{getConstraints:s,onBeforeConstraintHandled:h},orderService:{purchase:g,beforePurchase:m},components:[{code:"vm_web_type"},{code:"vm_is_flow_type"},{code:"vm_bandwidth"},{code:"iooptimized"},{code:"systemdisk_category"}]},i.checked=!0,i.buttonText=i.commodityCode=="vm"?"":"",i.visitEcsBuy=function(){i.commodityCode=="ecs"?d.go("buy.postpay",{inst:i.instanceId}):d.go("buy.prepay",{inst:i.instanceId})};var b=r.$on("aliyunBuySubtotal:queryPrice",function(e,t){i.$broadcast("aliyunBuyPriceView:queryPrice",t)});i.$on("$destroy",function(){n.isFunction(b)&&b()})}}}}}])}),define("ecsbuy/console/helpers/renewHelper",["require","exports","../../base/helpers/commodityHelper","../../base/helpers/dateParseHelper","../../base/cons/buyBizCons","../../base/helpers/imageHelper","./commonConsoleHelper"],function(e,t,n,r,i,s,o){var u=function(){function e(){}return e.getOrderParam=function(e,t){if(!e||!angular.isArray(e))return;var r=[];return angular.forEach(e,function(e,u){if(!e)return;var a=n.CommodityHelper.getDuration(e.order_time);r.push({orderType:"instance-renewal",couponNo:t.couponNo||i.BuyBizCons.COUPON_DEFAULT,commodity:{period:a.period,priceUnit:a.priceUnit,periodType:a.periodType,instanceIds:t.instanceIds}});if(t.imageProductCode&&o.CommonConsoleHelper.isImageOnSale(t.imageStatus)){var f={imageProductCode:t.imageProductCode,imageId:t.imageId},l;if(o.CommonConsoleHelper.isImagePrepay(t.imageChargeType))l=s.ImageHelper.getPriceParamFromValue(f,1,e.vm_region_no,t.instanceType,null,a.period,a.priceUnit),l[0].orderType="marketplace-image-renew";else{var c=n.CommodityHelper.getPostpayDuration();l=s.ImageHelper.getPriceParamFromValue(f,1,e.vm_region_no,t.instanceType,null,c.period,c.priceUnit)}r=l.concat(r)}}),r},e.getRenewStartTime=function(e){if(!e||!e.instanceDetail||!e.instanceDetail.instanceInfo)return;var t=e.instanceDetail.instanceInfo,n=r.DateParseHelper.getDateFromISOString(t.currentTime).getTime(),i=r.DateParseHelper.getDateFromISOString(t.instanceExpireTime).getTime();return n>i?n:i},e.calculateNewExpirationTime=function(e,t){if(!e||!t)return;var n=new Date(t),r=n.setMonth(n.getMonth()+parseInt(e)),i=new Date(r);return i.getDate()!=n.getDate()&&(r=(new Date((new Date(i.getFullYear(),i.getMonth(),1)).getTime()-864e5)).getTime()),e=="0.25"&&(r=n.setDate(n.getDate()+7)),r},e}();t.RenewHelper=u}),define("ecsbuy/console/directives/renew/renew",["require","exports","angular","../directives","common/helper/i18nHelper","../../cons/cons","../../../base/helpers/commodityHelper","../../helpers/renewHelper","../../../base/helpers/fields/regionHelper","../../../base/helpers/buyUtils","../../helpers/commonConsoleHelper","../../helpers/instanceDetailHelper","../../../base/helpers/purchaseHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){r.directive("aliyunBuyEcsRenewV2",["$rootScope","base64","$injector","aliyunBuyEcsRemoteService","aliyunBuyEcsDialogButtonConfigService","aliyunBuyMsg",function(e,t,r,p,d,v){return{restrict:"EA",templateUrl:s.ConsoleConstant.PARTIALS_PATH+"renew/renew.html",scope:{instanceId:"@",purchaseEventId:"=",isLoading:"=?"},compile:function(s,m){return{pre:function(e){},post:function(s){function m(e){var r=f.BuyUtils.getMapProperty(s.raw,"instanceDetail.orderInfo.instance_type.0.instance_type"),i=f.BuyUtils.getMapProperty(s.raw,"instanceDetail.orderInfo.vm_os.0.vm_os"),o=f.BuyUtils.getMapProperty(s.raw,"instanceDetail.orderInfo.vm_os.0.vm_os_imageProductCode"),a=f.BuyUtils.getMapProperty(s.raw,"instanceDetail.instanceInfo.marketImageChargeType"),l=f.BuyUtils.getMapProperty(s.raw,"instanceDetail.instanceInfo.marketImageStatus"),c=u.RenewHelper.getOrderParam(e,{instanceIds:s.instanceId,couponNo:s.couponNo,imageProductCode:o,imageChargeType:a,imageStatus:l,imageId:i,instanceType:r}),d={data:t.encode(n.toJson(c))};return b(!0),p.describePrice4Subtotal(d).then(function(e){b(!1);var t=f.BuyUtils.getMapProperty(e,"code");if(t){var n=h.PurchaseHelper.getUserAuthenticationTip(t,null);n&&(s.payOrderTip=n,b(!0))}return e})}function g(){var e=s.instanceId;return s.isLoading=!0,p.getCommodity({commodityCode:"vm",orderType:"RENEW",instanceId:e}).then(function(t){return o.CommodityHelper.isBuyChannelIntl(t)&&!o.CommodityHelper.isBuyChannel4Service(t)?c.InstanceDetailHelper.appendExtraInfoPromiseForBuyIntl(t,{instanceIds:e,orderType:"RENEW"},r):t})["finally"](function(){s.isLoading=!1})}function y(e){a.RegionHelper.hijackFinanceRegionname(e),c.InstanceDetailHelper.validate(e,v,d),s.raw=e;var t=f.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.vm_os.0.vm_os_imageProductCode");return typeof t!="undefined"&&(s.imageOrderTermUrl=l.CommonConsoleHelper.getImageOrderTermUrl(t)),e}function b(e){s.payDisabled=e}function w(e){var t=u.RenewHelper.getOrderParam(e,{instanceIds:s.instanceId,couponNo:s.couponNo}),n=s.purchaseEventId;n||(n="aliyunBuyEcsRenew:purchase"),s.$emit(n,{order:t[0]})}var E=[];s.priceViewConfig={priceService:{getPrice:m},texts:{payment:i.i18n("ECS_CHECKOUT_AMOUNT"),currentConfiguration:i.i18n("ECS_PLEASE_SELECT_CONFIG"),calculatingPrice:i.i18n("ECS_CALCULATING_PRICE"),priceSave:i.i18n("ECS_REDUCE"),calculatingPriceFailed:i.i18n("ECS_PRICE_ERROR")}},s.frameworkSetting={constraintService:{getConstraints:g,onBeforeConstraintHandled:y},orderService:{purchase:w},components:[]},s.purchase=function(){s.$broadcast("aliyunBuySubtotal:purchase")},s.checked=!0,e.$on("dominator:ready",function(){s.$emit("initialized"),s.$apply()});var S=e.$on("aliyunBuySubtotal:queryPrice",function(e,t){E=t,s.$broadcast("aliyunBuyPriceView:queryPrice",t)});s.$watch("priceResult",function(e){var t=l.CommonConsoleHelper.getCouponsFromPriceResult(e);s.priceForCoupon={data:{coupons:t}}}),s.$watch("couponNo",function(e){e&&s.$broadcast("aliyunBuyPriceView:queryPrice",E)}),s.$on("$destroy",function(){n.isFunction(S)&&S()})}}}}}])}),define("ecsbuy/console/helpers/changeOsHelper",["require","exports","../../base/helpers/commodityHelper","../../base/helpers/orderDataHelper","../../base/helpers/buyUtils","../../base/helpers/businessInfoHelper","./commonConsoleHelper","../../base/cons/buyBizCons"],function(e,t,n,r,i,s,o,u){var a=function(){function e(){}return e.getPriceParam=function(e,t,a){if(!e||!angular.isArray(e)||!t)return;var f=[],l=this;return angular.forEach(e,function(e,c){if(!e)return;var h=n.CommodityHelper.getCommodityCode(t),p=r.OrderDataHelper.getImageValue(e,e.imageType),d=r.OrderDataHelper.getSystemdisk(e),v=l.getDurationForImageMarket(t),m=s.BusinessInfoHelper.getBusinessInfo(e),g=r.OrderDataHelper.getImageMarket(e,p.imageId,m,v),y=i.BuyUtils.getMapProperty(t,"instanceDetail.instanceInfo.chargeType");angular.isArray(g)&&(l.isSameMarketImage(t,e)||(f=f.concat(g))),f.push({regionId:e.vm_region_no,orderType:"replace-system-disk",couponNo:a.couponNo||u.BuyBizCons.COUPON_BLANK,chargeType:o.CommonConsoleHelper.transformChargeType(y),commodity:{size:d&&d.size,imageId:p&&p.imageId,instanceId:a.instanceIds}})}),f},e.getOrderParam=function(e,t,n){if(!e||!angular.isArray(e)||!t)return;var i=[];return angular.forEach(e,function(e,t){var s=r.OrderDataHelper.getImageValue(e,e.imageType),o=r.OrderDataHelper.getSystemdisk(e),a=r.OrderDataHelper.getPassword(e.password,e.setupPassword),f=r.OrderDataHelper.getKeyPairName(e.keyPair,e.setupPassword),l=r.OrderDataHelper.getSecurityEnhancementStrategy(e);i.push({orderType:"replace-system-disk",regionId:e.vm_region_no,couponNo:n.couponNo||u.BuyBizCons.COUPON_BLANK,commodity:{size:o&&o.size,imageId:s&&s.imageId,instanceId:n.instanceIds,password:a.password,keyPairName:f,securityEnhancementStrategy:l}})}),i},e.getOrderParamForBatch=function(e,t){var n=t&&t.orderData,i=e.activeBatchInfoIds;if(!n||!angular.isArray(n)||!angular.isArray(i)||i.length==0)return;var s=[];return angular.forEach(n,function(e,t){var n=r.OrderDataHelper.getImageValue(e,e.imageType),o=r.OrderDataHelper.getSecurityEnhancementStrategy(e),u=r.OrderDataHelper.getPassword(e.password,e.setupPassword),a=r.OrderDataHelper.getKeyPairName(e.keyPair,e.setupPassword);s.push({instanceIds:i.join(","),regionId:e.vm_region_no,imageId:n.imageId,productCode:n.imageProductCode,password:u.password,keyPairName:a,securityEnhancementStrategy:o})}),s},e.getDurationForImageMarket=function(e){var t=i.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.chargeType");if(o.CommonConsoleHelper.isPostpay(t))return n.CommodityHelper.getPostpayDuration();var r=i.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.currentTime"),s=i.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.instanceExpireTime"),u=new Date(r),a=new Date(s);return{period:Math.floor(Math.abs(u-a)/864e5),priceUnit:"Day"}},e.isSameMarketImage=function(e,t){var n=this,s=i.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.vm_os.0.vm_os_imageProductCode"),o=r.OrderDataHelper.getImageValue(t,t.imageType);return n.isSameMarketImageByProductCode(o.imageProductCode,s)},e.isSameMarketImageByProductCode=function(e,t){return t!=undefined&&t==e},e.isNeedBuyWindow=function(e,t){if(!e||!angular.isArray(e)||!t)return;var n=this,u=!1;return angular.forEach(e,function(e,a){var f=r.OrderDataHelper.getSystemdisk(e),l=f&&f.size,c=i.BuyUtils.getMapProperty(t,"instanceDetail.orderInfo.systemdisk.0.systemdisk_size"),h=i.BuyUtils.getMapProperty(t,"instanceDetail.instanceInfo.chargeType"),p=n.getDurationForImageMarket(t),d=r.OrderDataHelper.getImageValue(e,e.imageType),v=s.BusinessInfoHelper.getBusinessInfo(e),m=r.OrderDataHelper.getImageMarket(e,d.imageId,v,p),g=o.CommonConsoleHelper.isPrepay(h);g&&(angular.isArray(m)&&(u=!n.isSameMarketImage(t,e)),l>Math.max(c,40)&&(u=!0))}),u},e.getImageOrderTermUrl=function(e){var t=e&&e.imageProductCode;if(typeof t!="undefined")return o.CommonConsoleHelper.getImageOrderTermUrl(e&&e.imageProductCode)},e}();t.ChangeOsHelper=a}),define("ecsbuy/console/directives/changeOs/changeOs",["require","exports","angular","../directives","common/helper/i18nHelper","../../cons/cons","../../../base/helpers/fields/regionHelper","../../helpers/changeOsHelper","../../../base/helpers/purchaseHelper","../../helpers/commonConsoleHelper","../../../base/helpers/buyUtils"],function(e,t,n,r,i,s,o,u,a,f,l){r.directive("aliyunBuyEcsChangeOsV2",["$rootScope","base64","$injector","aliyunBuyEcsRemoteService",function(e,t,r,c){return{restrict:"EA",templateUrl:s.ConsoleConstant.PARTIALS_PATH+"changeOs/changeOs.html",scope:{instanceId:"@",purchaseEventId:"=",isLoading:"=?"},compile:function(s,h){return{pre:function(e){},post:function(s){function h(e){y(e);var r=u.ChangeOsHelper.getPriceParam(e,s.raw,{instanceIds:s.instanceId,couponNo:s.couponNo}),i={data:t.encode(n.toJson(r))};return v(!0),c.describePrice4Subtotal(i).then(function(e){v(!1);var t=a.PurchaseHelper.getInsufficientBalanceTip(e.code,"money_lessthan_100_in_use");return!t||(s.payOrderTip=t,v(!0)),e})}function p(){var e=s.instanceId;return s.isLoading=!0,c.getCommodity({commodityCode:"vm",orderType:"CHANGEOS",instanceId:e}).then(function(e){return e})["finally"](function(){s.isLoading=!1})}function d(e){return o.RegionHelper.hijackFinanceRegionname(e),s.raw=e,e}function v(e){s.payDisabled=e}function m(e,t,n,i){var s=r.get("aliyunBuyEcsValidateService");return s.validate(t,e)}function g(e){var t=u.ChangeOsHelper.getOrderParam(e,s.raw,{instanceIds:s.instanceId,couponNo:s.couponNo}),n=s.purchaseEventId;n||(n="aliyunBuyEcsChangeOs:purchase");var r=u.ChangeOsHelper.isNeedBuyWindow(e,s.raw);s.$emit(n,{order:t[0],needBuyWindow:r})}function y(e){var t=u.ChangeOsHelper.isNeedBuyWindow(e,s.raw);t?s.buttonText=i.i18n("ECS_PAY"):s.buttonText=i.i18n("ECS_ENSURE_CHANGEOS")}var b=[];s.priceViewConfig={priceService:{getPrice:h}},s.frameworkSetting={constraintService:{getConstraints:p,onBeforeConstraintHandled:d},orderService:{purchase:g,beforePurchase:m},components:[{code:"systemdisk_category"},{code:"vm_os_kind"}]},s.purchase=function(){s.$broadcast("aliyunBuySubtotal:purchase")},s.buttonText=i.i18n("ECS_ENSURE_CHANGEOS"),s.checked=!0,e.$on("dominator:ready",function(){s.$emit("initialized"),s.$apply()});var w=e.$on("aliyunBuySubtotal:queryPrice",function(e,t){b=t;var n=s.raw,r=l.BuyUtils.getMapProperty(n,"instanceDetail.instanceInfo.isRenewChange"),i=l.BuyUtils.getMapProperty(n,"instanceDetail.instanceInfo.chargeType");(!f.CommonConsoleHelper.isPrepay(i)||!r)&&s.$broadcast("aliyunBuyPriceView:queryPrice",t)}),E=e.$on("aliyunBuyEcsChangeOs:imageFromMarket",function(e,t){s.imageOrderTermUrl=u.ChangeOsHelper.getImageOrderTermUrl(t)||""});s.$watch("priceResult",function(e){!e||(s.priceForCoupon={data:e})}),s.$watch("couponNo",function(e){e&&s.$broadcast("aliyunBuyPriceView:queryPrice",b)}),s.$on("$destroy",function(){n.isFunction(w)&&w(),n.isFunction(E)&&E()})}}}}}])}),define("ecsbuy/console/directives/changeOs/changeOsOptions",["require","exports","angular","../directives","../../cons/cons","../../../base/helpers/fields/regionHelper"],function(e,t,n,r,i,s){r.directive("aliyunBuyEcsChangeOsOptionsV2",["$rootScope","base64","$injector","aliyunBuyEcsRemoteService",function(e,t,r,o){return{restrict:"EA",templateUrl:i.ConsoleConstant.PARTIALS_PATH+"changeOs/changeOsOptions.html",scope:{instanceId:"@",exportOptionsEventId:"@",saveOptionsEventId:"@",isLoading:"=?"},compile:function(t,i){return{pre:function(e){},post:function(t){function i(){var e=t.instanceId;return t.isLoading=!0,o.getCommodity({commodityCode:"vm",orderType:"CHANGEOS",instanceId:e}).then(function(e){return e})["finally"](function(){t.isLoading=!1})}function u(e){return s.RegionHelper.hijackFinanceRegionname(e),t.raw=e,e}function a(e,t,n,i){var s=r.get("aliyunBuyEcsValidateService");return s.validate(t,e)}function f(e){var n=t.saveOptionsEventId;n||(n="aliyunBuyEcsChangeOsOptions:saveOptions"),t.$emit(n,{orderData:e})}t.frameworkSetting={constraintService:{getConstraints:i,onBeforeConstraintHandled:u},orderService:{purchase:f,beforePurchase:a},components:[{code:"systemdisk_category"},{code:"vm_os_kind"}]};var l=e.$on(t.exportOptionsEventId||"aliyunBuyEcsChangeOsOptions:exportOptions",function(e){t.$broadcast("aliyunBuySubtotal:purchase")});e.$on("dominator:ready",function(){t.$emit("initialized"),t.$apply()}),t.$on("$destroy",function(){n.isFunction(l)&&l()})}}}}}])}),define("ecsbuy/console/directives/changeOs/batchChangeOs",["require","exports","angular","../directives","common/helper/i18nHelper","../../cons/cons","../../helpers/changeOsHelper"],function(e,t,n,r,i,s,o){r.directive("aliyunBuyEcsBatchChangeOsV2",["$rootScope","base64","$injector","aliyunBuyEcsRemoteService","modelFactory","modelSystemCacheContextService",function(e,t,r,u,a,f){return{restrict:"EA",templateUrl:s.ConsoleConstant.PARTIALS_PATH+"changeOs/batchChangeOs.html",scope:{instanceIds:"@",purchaseEventId:"@",isLoading:"=?"},compile:function(t,r){return{pre:function(e){},post:function(t){function s(e){t.payDisabled=e}var r=(t.instanceIds||"").split(",");f.setCacheContext("ecs.buy.changeOs.batch.bizModel.cacheContext",{changeOsCache:{instanceIds:r}},!0),t.batchActionModel=a.getModel("ecs.buy.changeOs.batchActionModel","BizModel"),t.batchUiModel=a.getModel("ecs.buy.changeOs.batchUiModel","BizModel"),t.buttonText=i.i18n("ECS_ENSURE_CHANGEOS"),t.checked=!0,t.purchase=function(){t.$emit("aliyunBuyEcsBatchView:batchSubmit")};var u=e.$on("aliyunBuyBatchAction:submit",function(e,n,r){var i=t.purchaseEventId;i||(i="aliyunBuyEcsBatchChangeOs:purchase");var s=o.ChangeOsHelper.getOrderParamForBatch(n,r);s&&t.$emit(i,{order:s[0]})});s(!0);var l=e.$on("aliyunBuyEcsBatchView:saveOptions",function(e){s(!1)}),c=e.$on("aliyunBuyEcsChangeOs:imageFromMarket",function(e,n){t.imageOrderTermUrl=o.ChangeOsHelper.getImageOrderTermUrl(n)||""});t.$on("$destroy",function(){n.isFunction(u)&&u(),n.isFunction(l)&&l(),n.isFunction(c)&&c()})}}}}}])}),define("ecsbuy/console/directives/changeOs/_base",["require","exports","./changeOs","./changeOsOptions","./batchChangeOs"],function(e,t){}),define("ecsbuy/console/directives/release/release",["require","exports","angular","../directives","common/helper/i18nHelper","../../cons/cons"],function(e,t,n,r,i,s){r.directive("aliyunBuyEcsPrePaidReleaseV2",["$rootScope","$cookieStore","base64","aliyunBuyEcsRemoteService",function(e,t,r,o){return{restrict:"EA",templateUrl:s.ConsoleConstant.PARTIALS_PATH+"release/releasePrePaid.html",scope:{instanceId:"@",regionId:"@",isLoading:"=?",releaseEventId:"="},replace:!0,compile:function(t,r){return{pre:function(e){},post:function(t){function r(e){var n={regionId:t.regionId,instanceId:t.instanceId};return u(!0),o.describeReleasePrice(n).then(function(e){return u(!1),e})}function s(){var e=t.instanceId;return o.getCommodity({commodityCode:"vm",orderType:"BUY",instanceId:e})}function u(e){t.payDisabled=e}function a(e){var n={regionId:t.regionId,instanceId:t.instanceId},r=t.releaseEventId;r||(r="aliyunBuyEcsRelease:release"),t.$emit(r,{order:n})}t.priceViewConfig={priceService:{getPrice:r},texts:{calculatingPriceFailed:i.i18n("ECS_REFUND_FIALED"),calculatingPrice:i.i18n("ECS_REFUND_LOADING"),payment:i.i18n("ECS_REFUND_PRICE")}},t.frameworkSetting={constraintService:{getConstraints:s},orderService:{purchase:a},components:[]},t.purchase=function(){a()},t.buttonText=i.i18n("ECS_ORDER_GORELEASE"),t.isLoading=!0,t.checked=!0,e.$on("dominator:ready",function(){t.$emit("initialized"),t.isLoading=!1,t.$apply()}),u(!0),e.$on("dominator:ready",function(){t.$emit("initialized"),t.isLoading=!1,t.$apply()});var f=e.$on("aliyunBuySubtotal:queryPrice",function(e,n){t.$broadcast("aliyunBuyPriceView:queryPrice",n)});t.$on("$destroy",function(){n.isFunction(f)&&f()})}}}}}])}),define("ecsbuy/console/directives/downgrade/downgrade",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","common/helper/i18nHelper","../../cons/cons","../../helpers/downgradeHelper","../../../base/helpers/commodityHelper","../../../base/helpers/fields/regionHelper","../../helpers/instanceDetailHelper","../../../base/helpers/instanceTypeHelper","../../../base/helpers/purchaseHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){r.directive("aliyunBuyEcsDowngradeNow",["aliyunBuyEcsDialogButtonConfigService","aliyunBuyEcsRemoteService","aliyunBuyEcsValidateService","aliyunBuyMsg","$rootScope","$injector","modelFactory","base64","$state",function(e,t,r,p,d,v,m,g,y){return{restrict:"EA",templateUrl:o.ConsoleConstant.PARTIALS_PATH+"downgrade/downgrade.html",scope:{options:"=",commodityCode:"@",instanceId:"@",isLoading:"=?"},replace:!0,compile:function(o,m){return i.require(["options","value","detail"],m),{pre:function(i){function o(){var e=i.instanceId,n=i.commodityCode;return t.getCommodity({commodityCode:n,orderType:"DOWNGRADE_NOW",instanceId:e}).then(function(t){return a.CommodityHelper.isBuyChannelIntl(t)&&!a.CommodityHelper.isBuyChannel4Service(t)?l.InstanceDetailHelper.appendExtraInfoPromiseForBuyIntl(t,{instanceIds:e,orderType:"DOWNGRADE_NOW"},v):t})["finally"](function(){i.isLoading=!1})}function m(t){return f.RegionHelper.hijackFinanceRegionname(t),c.InstanceTypeHelper.mergeFamilyName(t),l.InstanceDetailHelper.validate(t,p,e),i.raw=t,t}function y(e){var r=i.raw,o=a.CommodityHelper.getBandwidthType(l.InstanceDetailHelper.getBandwidthTypeValue(r)),f=u.DownAndUpgradeHelper.getDowngradeOrderParams(e,{instanceId:i.instanceId,originBandwidthType:o},!0),c=f[0];c&&c.commodity.toPayByTraffic&&(f=[{orderType:"traffic-bandwidth",regionId:c.regionId}].concat(f));var p=c.commodity&&c.commodity.diskInstanceIds;if(p){var d=p.split(","),v=d[0];f=f.concat({orderType:"disk-buy",regionId:c.regionId,commodity:{dataDisk:{category:u.DownAndUpgradeHelper.getSelectedDatadiskCategory(e,v),size:40},amount:1}})}var m={data:g.encode(n.toJson(f))};return E(!0),t.describePrice(m).then(function(e){E(!1),e&&e.children&&n.forEach(e.children,function(t){t&&t.orderType=="traffic-bandwidth"&&(e.flowPrice=t.trade,e.flowPriceUnit="/GB"),t&&t.orderType=="instance-buy"&&(e.origin=t.origin,e.discount=t.discount,e.trade=t.trade,e.rules=t.rules,e.strategies=t.strategies,t.isPostpay&&(e.basePriceUnit="/")),t&&t.code=="HAS_UNFINISHED_PURCHASE"&&(e.code="HAS_UNFINISHED_PURCHASE",e.message=s.i18n("HAS_UNFINISHED_PURCHASE"),e.success=!1,E(!0))});var t=h.PurchaseHelper.getInsufficientBalanceTip(e.code,"money_lessthan_100_in_use");return!t||(i.payOrderTip=t,E(!0)),e.isPostpay&&(e.basePriceUnit="/"),e},function(e){if(e&&e.code!="200"&&e.message){var t=e.message.split("message");t&&t.length==2&&(e.message=t[1])}return e})["finally"](function(){})}function b(e,t,n,i){return r.validate(t,e)}function w(e,t){var n=i.raw;u.DownAndUpgradeHelper.amendOrderData(n,e);var r=a.CommodityHelper.getBandwidthType(l.InstanceDetailHelper.getBandwidthTypeValue(n)),s=u.DownAndUpgradeHelper.getDowngradeOrderParams(e,{instanceId:i.instanceId,originBandwidthType:r,selectedDatadiskIds:u.DownAndUpgradeHelper.getSelectedDatadiskIds(e)},!1);i.$emit("aliyunBuyEcsDowngrade:purchase",{order:s})}function E(e){i.payDisabled=e}function S(e){i.priceResult&&(i.priceResult.state=e)}i.isLoading=!0,i.priceViewConfig={priceService:{getPrice:y},texts:{payment:s.i18n("ECS_REFUND_PRICE"),currentConfiguration:s.i18n("ECS_PLEASE_SELECT_CONFIG"),calculatingPrice:s.i18n("ECS_REFUND_LOADING"),priceSave:s.i18n("ECS_REDUCE"),calculatingPriceFailed:s.i18n("ECS_REFUND_FIALED")}},i.purchase=function(e){if(!i.checked||!!i.payDisabled)return;i.$broadcast("aliyunBuySubtotal:purchase")},i.frameworkSetting={constraintService:{getConstraints:o,onBeforeConstraintHandled:m},orderService:{purchase:w,beforePurchase:b},components:[{code:"vm_region_no"},{code:"instance_type"},{code:"vm_is_flow_type"},{code:"vm_bandwidth"}]},i.checked=!0,i.buttonText=s.i18n("ECS_ORDER_GODOWNGRADE");var x=d.$on("aliyunBuySubtotal:queryPrice",function(e,t){var n=i.raw,r=t[0]||{};if(!n)return;var s=u.DownAndUpgradeHelper.amendOrderData(n,t);s?(i.$broadcast("aliyunBuyPriceView:queryPrice",t),S(""),E(!1)):(S("currentConfiguration"),E(!0))});i.$on("$destroy",function(){n.isFunction(x)&&x()})}}}}}])}),define("ecsbuy/console/directives/downgrade/_base",["require","exports","./downgrade"],function(e,t){}),define("ecsbuy/console/directives/downgradeWithRenew/downgradeWithRenew",["require","exports","angular","../directives","common/helper/i18nHelper","../../cons/cons","../../../base/helpers/commodityHelper","../../../base/helpers/fields/regionHelper","../../../base/helpers/buyUtils","../../helpers/commonConsoleHelper","../../helpers/instanceDetailHelper","../../helpers/downgradeHelper","../../../base/helpers/instanceTypeHelper","../../../base/helpers/purchaseHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){r.directive("aliyunBuyEcsDowngradeWithRenewV2",["$rootScope","$injector","base64","aliyunBuyEcsRemoteService","aliyunBuyEcsDialogButtonConfigService","aliyunBuyEcsValidateService","aliyunBuyMsg",function(e,t,r,d,v,m,g){return{restrict:"EA",templateUrl:s.ConsoleConstant.PARTIALS_PATH+"downgradeWithRenew/downgradeWithRenew.html",scope:{instanceId:"@",purchaseEventId:"=",isLoading:"=?"},compile:function(s,y){return{pre:function(e){},post:function(s){function y(e){var t=s.instanceId,i=s.raw,o=c.DownAndUpgradeHelper.getDowngradeWithRenewOrderParams(e,{commodityCode:"vm",instanceId:t,couponNo:s.couponNo},!0),u=a.BuyUtils.getMapProperty(o,"0"),l=a.BuyUtils.getMapProperty(u,"commodity.internetChargeType");l&&f.CommonConsoleHelper.isPayByTraffic(l)&&(o=[{orderType:"traffic-bandwidth",regionId:u.regionId}].concat(o));var h={data:r.encode(n.toJson(o))};E(!0);var v;return o instanceof Array&&o.length>1?v=d.describePrice4Subtotal:v=d.describePrice,v(h).then(function(e){E(!1);var t=a.BuyUtils.getMapProperty(e,"code");if(t){var n=p.PurchaseHelper.getUserAuthenticationTip(t,null);n&&(s.payOrderTip=n,E(!0))}return e})}function b(){var e=s.instanceId;return s.isLoading=!0,d.getCommodity({commodityCode:"vm",orderType:"DOWNGRADE",instanceId:e}).then(function(n){return o.CommodityHelper.isBuyChannelIntl(n)&&!o.CommodityHelper.isBuyChannel4Service(n)?l.InstanceDetailHelper.appendExtraInfoPromiseForBuyIntl(n,{instanceIds:e,orderType:"DOWNGRADE"},t):n})["finally"](function(){s.isLoading=!1})}function w(e){u.RegionHelper.hijackFinanceRegionname(e),h.InstanceTypeHelper.mergeFamilyName(e),l.InstanceDetailHelper.validate(e,g,v),s.raw=e;var t=a.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.vm_os.0.vm_os_imageProductCode");return typeof t!="undefined"&&(s.imageOrderTermUrl=f.CommonConsoleHelper.getImageOrderTermUrl(t)),e}function E(e){s.payDisabled=e}function S(e,t,n,r){return m.validate(t,e)}function x(e,t){var n=s.instanceId,r=c.DownAndUpgradeHelper.getDowngradeWithRenewOrderParams(e,{commodityCode:"vm",instanceId:n,couponNo:s.couponNo},!1),i=s.purchaseEventId;i||(i="aliyunBuyEcsDowngradeWithRenew:purchase");var o=f.CommonConsoleHelper.getVmRestartTime(r);s.$emit(i,{order:r,vmRestartTime:o})}var T=[];s.priceViewConfig={priceService:{getPrice:y},texts:{payment:i.i18n("ECS_CHECKOUT_AMOUNT"),currentConfiguration:i.i18n("ECS_PLEASE_SELECT_CONFIG"),calculatingPrice:i.i18n("ECS_CALCULATING_PRICE"),priceSave:i.i18n("ECS_REDUCE"),calculatingPriceFailed:i.i18n("ECS_PRICE_ERROR")}},s.frameworkSetting={constraintService:{getConstraints:b,onBeforeConstraintHandled:w},orderService:{purchase:x,beforePurchase:S},components:[{code:"vm_region_no"},{code:"instance_type"},{code:"vm_is_flow_type"},{code:"vm_bandwidth"}]},s.purchase=function(){s.$broadcast("aliyunBuySubtotal:purchase")},s.checked=!0,e.$on("dominator:ready",function(){s.$emit("initialized"),s.$apply()});var N=e.$on("aliyunBuySubtotal:queryPrice",function(e,t){T=t,s.$broadcast("aliyunBuyPriceView:queryPrice",t)});s.$watch("priceResult",function(e){var t=f.CommonConsoleHelper.getCouponsFromPriceResult(e);s.priceForCoupon={data:{coupons:t}}}),s.$watch("couponNo",function(e){e&&s.$broadcast("aliyunBuyPriceView:queryPrice",T)}),s.$on("$destroy",function(){n.isFunction(N)&&N()})}}}}}])}),define("ecsbuy/console/directives/downgradeWithRenew/_base",["require","exports","./downgradeWithRenew"],function(e,t){}),define("ecsbuy/console/directives/instanceDetail",["require","exports","angular","./directives","common/helper/i18nHelper","../cons/cons","../../base/helpers/commodityHelper","../../base/helpers/dateParseHelper","../../base/helpers/buyUtils","../../base/cons/buyBizCons"],function(e,t,n,r,i,s,o,u,a,f){r.directive("aliyunBuyEcsInstanceDetailNew",["$filter","aliyunBuyEcsRemoteService",function(e,t){function r(e){e.$watch("data()",function(t){if(!t)return;l(e,t)})}function l(e,r){var s=r.components,l=r.instanceDetail;if(!l)return;var c=l.instanceInfo,h=l.orderInfo,p={},d=e.context={};h.instance_type&&(p=h.instance_type&&n.isArray(h.instance_type)&&h.instance_type[0]);var v=s.iooptimized?s.iooptimized.iooptimized:s.instance_type.iooptimized;d.instanceId=c.instanceId,d.instanceName=c.instanceName,d.region=o.CommodityHelper.getTextFromCollection(h.vm_region_no,s.vm_region_no.vm_region_no),d.instanceTypeText=o.CommodityHelper.getTextFromCollection(p.instance_type,s.instance_type.instance_type),d.instanceTypeValue=p.instance_type,d.instanceTypeFamily=o.CommodityHelper.getTextFromCollection(p.instance_type_family,s.instance_type.instance_type_family),d.instanceGeneration=o.CommodityHelper.getTextFromCollection(p.instance_generation,s.instance_type.instance_generation),d.iooptimized=h.iooptimized=="optimized"?i.i18n("ecs.buy.component.iooptimized.optimized"):i.i18n("ecs.buy.component.iooptimized.none"),d.networkType=o.CommodityHelper.getTextFromCollection(h.vm_web_type,s.vm_web_type.vm_web_type)||"ECS_CLASSICAL_NETWORK",d.networkTypeValue=o.CommodityHelper.getNetworkType(h.vm_web_type),d.privateIp=c.vmPrivateIp,d.publicIp=c.vmPublicIp,d.eipAddress=c.eipAddress,d.eipChargeType=c.eipChargeType,d.os=c.osName,d.expiration=c.chargeType=="Prepaid"?c.instanceExpireTime?u.DateParseHelper.format(c.instanceExpireTime,"yyyy-MM-dd 00:00"):undefined:undefined,d.imageProduct=h.vm_os[0]?h.vm_os[0].vm_os_imageProductCode:undefined,d.imageChargeType=f.BuyBizCons.CHARGE_TYPE_MAP_REVERT[c.marketImageChargeType],d.imageStatus=c.marketImageStatus,d.baseBandWidth=c.baseBandWidth,d.instanceChargeTypeText=function(){return c.saleCycle=="Week"?"ECS_BUY_WEEKLY":c.chargeType=="Prepaid"?"ECS_BUY_YEARMONTH":"ECS_BUY_POSTPAY"}();var m=h.vm_bandwidth&&h.vm_bandwidth[0]?h.vm_bandwidth[0]:"";d.bandwidth=function(){var e=o.CommodityHelper.getNetworkType(h.vm_web_type);return e=="vpc"&&c.eipInstanceId?c.eipBandwidth*1024:m&&m.vm_bandwidth}(),d.bandwidthType=function(){var e="1",t="0",n,r=o.CommodityHelper.getNetworkType(h.vm_web_type);return r=="vpc"&&c.eipChargeType?n=c.eipChargeType:c.eipChargeType||(n=m&&m.vm_is_flow_type=="1"?"PayByTraffic":"PayByBandwidth"),n=="PayByBandwidth"?"ECS_VIA_FIXED_BANDWIDTH":n=="PayByTraffic"?"ECS_VIA_FLOW":undefined}(),d.bandwidthByFlow=d.bandwidthType=="ECS_VIA_FLOW",d.zoneName=c.vmIzName,d.datadisk=function(){var e=[];return n.forEach(h.datadisk,function(t){var n="";n+=t.datadisk_size+"GB ",n+=o.CommodityHelper.getTextFromCollection(t.datadisk_category,s.datadisk.datadisk_category),t.datadisk_instanceId&&(n+=""+i.i18n("ECS_SNAP_SNAPID")+""+t.datadisk_instanceId+""),e.push(n)}),e}(),d.systemdiskSize=a.BuyUtils.getMapProperty(h,"systemdisk.0.systemdisk_size"),d.systemdiskCategoryName=o.CommodityHelper.getTextFromCollection(a.BuyUtils.getMapProperty(h,"systemdisk.0.systemdisk_category"),s.systemdisk.systemdisk_category);var g=h.vm_vpc_switch_id;g&&t.describeVSwitches({vpcId:h.vm_vpc_id,vSwitchId:g}).then(function(e){var t=a.BuyUtils.getMapProperty(e,"VSwitches.VSwitch");if(!t||!n.isArray(t))return;n.forEach(t,function(e){e.VSwitchId==g&&(d.vSwitcheId=e.VSwitchId,e.VSwitchId!=e.VSwitchName&&(d.vSwitcheName=e.VSwitchName))})});var y=h.securityGroupId;y&&t.queryEcsSecurityGroupList({regionId:h.vm_region_no,securityGroupId:y}).then(function(e){var t=a.BuyUtils.getMapProperty(e,"SecurityGroups.SecurityGroup");if(!t||!n.isArray(t))return;n.forEach(t,function(e){e.SecurityGroupId==y&&(d.securityGroupId=e.SecurityGroupId,e.SecurityGroupId!=e.SecurityGroupName&&(d.securityGroupName=e.SecurityGroupName))})});var b=a.BuyUtils.getMapProperty(h,"vm_os.0.vm_os");b&&d.imageProduct&&d.imageStatus==f.BuyBizCons.IMAGE_SELL_STATUS.onSale&&t.queryImageByImageId({regionId:h.vm_region_no,imageIds:b,chargeType:d.imageChargeType=="prepay"?"Prepaid":"AfterPay"}).then(function(e){if(e&&e[b]){var t=e[b]||{};d.supplierName=t.supplierName,d.displayName=t.displayName,d.version=t.version}})}return{restrict:"EA",templateUrl:s.ConsoleConstant.PARTIALS_PATH+"instanceDetail.html",scope:{data:"&"},replace:!0,link:r}}])}),define("ecsbuy/console/directives/instanceDetailV2",["require","exports","angular","./directives","common/helper/i18nHelper","../cons/cons","../../base/helpers/commodityHelper","../../base/helpers/dateParseHelper","../../base/helpers/buyUtils","../helpers/instanceDetailHelperNew","../helpers/commonConsoleHelper","../../base/cons/fieldCons","../../base/cons/remoteActions","../../base/cons/spotStrategy"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){r.directive("aliyunBuyEcsInstanceDetailV2",["$filter","aliyunBuyEcsRemoteService",function(e,t){function r(e){e.$watch("data()",function(t){if(!t)return;d(e,t)})}function d(e,r){var s=r.components,d=r.instanceDetail;if(!d)return;var v=e.context={},m=f.InstanceDetailHelperNew.getRegionAlias(r),g=o.CommodityHelper.getRegionId(r,m),y=l.CommonConsoleHelper.isPrepay(d.InstanceChargeType);v.instanceId=d.InstanceId,v.instanceName=d.InstanceName,v.region=o.CommodityHelper.getTextFromCollection(g,s.vm_region_no.vm_region_no),v.instanceTypeText=o.CommodityHelper.getTextFromCollection(d.InstanceType,s.instance_type.instance_type),v.instanceTypeValue=d.InstanceType,v.instanceTypeFamily=o.CommodityHelper.getTextFromCollection(d.InstanceTypeFamily,s.instance_type.instance_type_family),v.iooptimized=d.IoOptimized?i.i18n("ecs.buy.component.iooptimized.optimized"):i.i18n("ecs.buy.component.iooptimized.none"),v.networkType=o.CommodityHelper.getTextFromCollection(f.InstanceDetailHelperNew.getVmWebType(r),s.vm_web_type.vm_web_type)||"ECS_CLASSICAL_NETWORK",v.networkTypeValue=f.InstanceDetailHelperNew.getNetworkType(r),v.privateIp=f.InstanceDetailHelperNew.getPrivateIp(r),v.publicIp=f.InstanceDetailHelperNew.getPublicIP(r),v.eipAddress=f.InstanceDetailHelperNew.getEipAddress(r),v.eipChargeType=f.InstanceDetailHelperNew.getEipChargeType(r),v.expiration=y?d.ExpiredTime?u.DateParseHelper.format(d.ExpiredTime,"yyyy-MM-dd 00:00"):undefined:undefined,v.spotStrategyText=d.SpotStrategy==p.SpotStrategy.SPOT_WITH_PRICE_LIMIT?"ECS_SPOT_STRATEGY_SPOT_WITH_PRICE_LIMIT":undefined,v.spotPriceLimit=d.SpotPriceLimit,v.instanceChargeTypeText=function(){return d.SaleCycle=="Week"?"ECS_BUY_WEEKLY":y?"ECS_BUY_YEARMONTH":d.SpotStrategy==p.SpotStrategy.SPOT_WITH_PRICE_LIMIT?"ECS_BUY_SPOT_POSTPAY":"ECS_BUY_POSTPAY"}(),v.bandwidth=function(){var e=f.InstanceDetailHelperNew.getNetworkType(r);return e==c.FieldCons.FIELD_NETWORK_TYPE_VPC&&f.InstanceDetailHelperNew.getEipInstanceId(r)?f.InstanceDetailHelperNew.getEipBandwidth(r)*1024:d.InternetMaxBandwidthOut*1024}(),v.bandwidthType=function(){var e,t=f.InstanceDetailHelperNew.getNetworkType(r);return t=="vpc"&&f.InstanceDetailHelperNew.getEipInstanceId(r)?e=f.InstanceDetailHelperNew.getEipChargeType(r):e=d.InternetChargeType,e=="PayByBandwidth"?"ECS_VIA_FIXED_BANDWIDTH":e=="PayByTraffic"?"ECS_VIA_FLOW":undefined}(),v.bandwidthByFlow=v.bandwidthType=="ECS_VIA_FLOW",v.datadisk=function(){var e=[],t=f.InstanceDetailHelperNew.getDataDiskList(r);return n.forEach(t,function(t){var n="";n+=t.Size+"GB ",n+=o.CommodityHelper.getTextFromCollection(t.Category,s.datadisk.datadisk_category),t.Encrypted!=undefined&&(n+=t.Encrypted?" "+i.i18n("ecs.buy.component.disk.data.encrypted"):" "+i.i18n("ecs.buy.component.disk.data.unencrypted")),t.SourceSnapshotId&&(n+=""+i.i18n("ECS_SNAP_SNAPID")+""+t.SourceSnapshotId+""),e.push(n)}),e}(),v.systemdiskSize=f.InstanceDetailHelperNew.getSystemDiskSize(r),v.systemdiskCategoryName=o.CommodityHelper.getTextFromCollection(f.InstanceDetailHelperNew.getSystemDiskCategory(r),s.systemdisk.systemdisk_category);var b=f.InstanceDetailHelperNew.getVSwitchId(r),w=f.InstanceDetailHelperNew.getVpcId(r);b&&t.describeVSwitches({vpcId:w,vSwitchId:b}).then(function(e){var t=a.BuyUtils.getMapProperty(e,"VSwitches.VSwitch");if(!t||!n.isArray(t))return;n.forEach(t,function(e){e.VSwitchId==b&&(v.vSwitcheId=e.VSwitchId,e.VSwitchId!=e.VSwitchName&&(v.vSwitcheName=e.VSwitchName))})});var E=f.InstanceDetailHelperNew.getSecurityGroupId(r);E&&t.queryEcsSecurityGroupList({regionId:m,securityGroupId:E}).then(function(e){var t=a.BuyUtils.getMapProperty(e,"SecurityGroups.SecurityGroup");if(!t||!n.isArray(t))return;n.forEach(t,function(e){e.SecurityGroupId==E&&(v.securityGroupId=e.SecurityGroupId,e.SecurityGroupId!=e.SecurityGroupName&&(v.securityGroupName=e.SecurityGroupName))})});var S=d.ZoneId;t[h.RemoteActions.QUERY_ALL_IZ_NAME]().then(function(e){e&&(v.zoneName=e[S])});var x=d.ImageId;t[h.RemoteActions.DESCRIBE_IMAGES]({imageId:x,regionId:m}).then(function(e){v.os=a.BuyUtils.getMapProperty(e,"Images.Image.0.OSName")})}return{restrict:"EA",templateUrl:s.ConsoleConstant.PARTIALS_PATH+"instanceDetailV2.html",scope:{data:"&"},replace:!0,link:r}}])}),define("ecsbuy/console/directives/upgrade/upgrade",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","common/helper/i18nHelper","../../cons/cons","../../helpers/downgradeHelper","../../../base/helpers/commodityHelper","../../../base/helpers/fields/regionHelper","../../helpers/instanceDetailHelper","../../../base/helpers/instanceTypeHelper","../../../base/helpers/orderDataHelper","../../../base/helpers/buyTipsHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){r.directive("aliyunBuyEcsUpgradeNew",["aliyunBuyEcsDialogButtonConfigService","aliyunBuyEcsRemoteService","aliyunBuyEcsValidateService","aliyunBuyEcsBlockListService","aliyunBuyMsg","$rootScope","$injector","modelFactory","base64","$state",function(e,t,r,d,v,m,g,y,b,w){return{restrict:"EA",templateUrl:o.ConsoleConstant.PARTIALS_PATH+"upgrade/upgrade.html",scope:{options:"=",commodityCode:"@",instanceId:"@",regionId:"@",isLoading:"=?"},replace:!0,compile:function(o,d){return i.require(["options","value","detail"],d),{pre:function(o){function w(){var e=o.instanceId,n=o.commodityCode;return t.getCommodity({commodityCode:n,orderType:"UPGRADE",instanceId:e}).then(function(t){return a.CommodityHelper.isBuyChannelIntl(t)&&!a.CommodityHelper.isBuyChannel4Service(t)?l.InstanceDetailHelper.appendExtraInfoPromiseForBuyIntl(t,{instanceIds:e,orderType:"UPGRADE"},g):t}).then(function(e){return o.isLoading=!1,e})}function E(t){return f.RegionHelper.hijackFinanceRegionname(t),c.InstanceTypeHelper.mergeFamilyName(t),p.BuyTipsHelper.mergeItemTip(t),l.InstanceDetailHelper.fillDiskCategoryName(t),l.InstanceDetailHelper.validate(t,v,e),c.InstanceTypeHelper.formatUpgradeType(t),o.raw=t,t}function S(e){o.priceForCoupon=null;var r=o.raw,i=a.CommodityHelper.getBandwidthType(l.InstanceDetailHelper.getBandwidthTypeValue(r)),f=l.InstanceDetailHelper.getBaseBandwidthValue(r)/1024,c=l.InstanceDetailHelper.getRegionId(r),h=e[0]&&a.CommodityHelper.getBandwidthType(e[0].vm_is_flow_type),p=u.DownAndUpgradeHelper.getUpgradeOrderParams(e,{instanceId:o.instanceId,regionId:c,originBandwidthType:i,selectedDatadiskIds:k(e),vmBandwidthSwitch:e[0].vm_bandwidth_switch,originBandwidthValue:f,couponNo:o.couponNo},!0),d=p[0];d&&h=="PayByTraffic"&&(p=[{orderType:"traffic-bandwidth",regionId:d.regionId}].concat(p));var v={data:b.encode(n.toJson(p))};return N(!0),t.describePrice(v).then(function(e){return N(!1),e&&e.children&&n.forEach(e.children,function(t){t&&t.orderType=="traffic-bandwidth"&&(e.flowPrice=t.trade,e.flowPriceUnit="/GB"),t&&t.orderType=="instance-buy"&&(e.origin=t.origin,e.discount=t.discount,e.trade=t.trade,e.rules=t.rules,e.strategies=t.strategies,t.isPostpay&&(e.basePriceUnit="/")),t&&t.code=="HAS_UNFINISHED_PURCHASE"&&(e.code="HAS_UNFINISHED_PURCHASE",e.message=s.i18n("HAS_UNFINISHED_PURCHASE"),e.success=!1,N(!0))}),e.isPostpay&&(e.basePriceUnit="/"),e},function(e){if(e&&e.code!="200"&&e.message){var t=e.message.split("message");t&&t.length==2&&(e.message=t[1])}return e})["finally"](function(){})}function x(e,t,n,i){return r.validate(t,e)}function T(e,t){var n=o.raw;u.DownAndUpgradeHelper.upgradeAmendOrderData(n,e);var r=a.CommodityHelper.getBandwidthType(l.InstanceDetailHelper.getBandwidthTypeValue(n)),f=l.InstanceDetailHelper.getBaseBandwidthValue(n)/1024,c=u.DownAndUpgradeHelper.getUpgradeOrderParams(e,{instanceId:o.instanceId,regionId:o.regionId,originBandwidthType:r,selectedDatadiskIds:k(e),vmBandwidthSwitch:e[0].vm_bandwidth_switch,originBandwidthValue:f,couponNo:o.couponNo},!1);if(c&&c.commodity&&c.commodity.canMigrateAcrossZone){var h="",p=l.InstanceDetailHelper.getInstanceVpcId(n);p||(h=s.i18n("ECS_UPGRADE_MIGRATE_IP_TIP")),c.commodity.systemDiskCategory&&(h&&(h+="<div><br /></div>"),h+=s.i18n("ECS_UPGRADE_MIGRATE_IP_AND_SYSTEM_DISK_CATEGORY_TIP")),h="<div class='bk-upgrade-migrate-dialog-msg'>"+h+"</div>";var d=v.dialog(s.i18n("ECS_PROMPT"),h,i.config({buttons:[{text:s.i18n("ECS_UPGRADE_CONFIRM"),theme:"blue",handler:function(){d.close(),o.$emit("aliyunBuyEcsUpgrade:purchase",{order:c})}}]}))}else o.$emit("aliyunBuyEcsUpgrade:purchase",{order:c})}function N(e){o.payDisabled=e}function C(e){o.priceResult&&(o.priceResult.state=e)}function k(e){var t=e[0]||{};if(t.datadisk){var n=h.OrderDataHelper.getConvertSelectedDiskId(t.datadisk);return n&&n.join(",")}}o.isLoading=!0,o.checked=!0,o.buttonText=s.i18n("ECS_UPGRADE_CONFIRM"),o.priceViewConfig={priceService:{getPrice:S},texts:{payment:s.i18n("ECS_CHECKOUT_AMOUNT"),currentConfiguration:s.i18n("ECS_PLEASE_SELECT_CONFIG"),calculatingPrice:s.i18n("ECS_CALCULATING_PRICE"),priceSave:s.i18n("ECS_REDUCE"),calculatingPriceFailed:s.i18n("ECS_PRICE_ERROR"),flowPrice:s.i18n("ECS_FLOW_FEE")}},o.frameworkSetting={constraintService:{getConstraints:w,onBeforeConstraintHandled:E},orderService:{purchase:T,beforePurchase:x},components:[{code:"vm_region_no"},{code:"iooptimized"},{code:"upgrade_type"},{code:"instance_type_family"},{code:"instance_type"},{code:"systemdisk_category"},{code:"vm_is_flow_type"},{code:"vm_bandwidth",style:"intersectionRange"}]},o.purchase=function(e){if(!o.checked||!!o.payDisabled)return;o.$broadcast("aliyunBuySubtotal:purchase")};var d=[],y=m.$on("aliyunBuySubtotal:queryPrice",function(e,t){var n=o.raw;d=t;var r=t[0]||{};if(!n)return;var i=u.DownAndUpgradeHelper.upgradeAmendOrderData(n,t);i?(o.$broadcast("aliyunBuyPriceView:queryPrice",t),C(""),N(!1)):(C("currentConfiguration"),N(!0))});o.$watch("priceResult",function(e){!e||(o.priceForCoupon={data:e})}),o.$watch("couponNo",function(e){e&&o.$broadcast("aliyunBuyPriceView:queryPrice",d)}),o.$on("$destroy",function(){n.isFunction(y)&&y()})}}}}}])}),define("ecsbuy/console/directives/upgrade/bandwidthHistory",["require","exports","../directives","../../cons/cons"],function(e,t,n,r){n.directive("aliyunBuyEcsBandwidthHistoryNew",["aliyunBuyEcsDialogButtonConfigService","aliyunBuyEcsRemoteService","aliyunBuyEcsValidateService","aliyunBuyMsg","$rootScope","modelFactory","base64","$state","aliyunBuyDialog","$timeout",function(e,t,n,i,s,o,u,a,f,l){function c(e){var n={chart:{type:"column",fillColor:"#FF6600"},title:{text:""},xAxis:{tickWidth:!1,lineWidth:1,gridLineWidth:0},yAxis:{min:0,title:{text:"(M)",style:{color:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"0099cc"],[1,"rgba(2,0,0,0)"]]}}},lineWidth:1,gridLineWidth:1,gridLineDashStyle:"solid"},legend:{enabled:!1},nvd3Options:{chart:{tooltip:{keyFormatter:function(e){return(new Date(e)).toLocaleDateString()},valueFormatter:function(e){return parseInt(e).toFixed(1)+" M"}}}},tooltip:{formatter:function(){return"<b>"+this.x+"</b><br/>"+parseInt(this.y).toFixed(1)+" M"}},series:[{labels:!1,dataLabels:!1}],plotOptions:{column:{groupPadding:0,pointPadding:0,borderWidth:0,shadow:!1},series:{color:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#B0DFFF"],[1,"rgba(255,255,255,0)"]]},shadow:!1,cursor:"pointer",allowPointSelect:!0,dataLabels:{enabled:!0,y:-10}}},credits:{enabled:!1}};e.openDialog=function(){var i=e.instanceId(),s;if(e.bandWidthDialog!=undefined)return;e.bandWidthDialog=f.open({backdrop:!1,templateUrl:r.ConsoleConstant.PARTIALS_PATH+"upgrade/aliyunBuyEcsBandwidthHistory.html",controller:["$scope","$http","$timeout",function(e,r,o){e.isLoading=!1,e.isReady=!1,e.settings={},e.allData=[],e.index=0,e.options=null,e.settings={},e.loadWrongMsg="",e.title="",e.loadingWrong=!1;var u=function(e){var t=[];for(var r in e){var i={};i.data=[],i.categories=[];var s={year:r};for(var o in e[r])i.data.push([e[r][o].datestamp,parseInt(e[r][o].bandwidth,10)/1024]),i.categories.push(e[r][o].date);s.data=jQuery.extend(!0,{xAxis:{},series:[{data:i.data}]},n),t.push(s)}return t},a=function(){e.allData.length>0&&(e.options=e.allData[e.index].data,e.isLoading=!1,e.isReady=!0)},f=function(){e.allData=u(s),a()},l=function(){e.loadingWrong=!0},c=function(e,n){s&&s instanceof Object?e():t.queryBandwidthHistory({instanceId:i}).then(function(t){t&&t instanceof Object&&(s=t,e())},function(){n()})};e.checkIndex=function(t){e.allData.length>t&&e.index!=t&&(e.index=t,e.options=e.allData[t].data)},c(f,l)}]});var o=function(t){var n=jQuery(t.target);n.parents(".bk-dialog-box").length<=0&&!n.hasClass("bk-dialog-box")&&e.bandWidthDialog.close()};l(function(){jQuery(document).on("click",o)},0),e.bandWidthDialog.result.then(function(){jQuery(document).off("click",o),e.bandWidthDialog=undefined})}}return{restrict:"EA",template:'<a href="javascript;" ng-click="openDialog()" onclick="return false;"></a>',scope:{instanceId:"&"},replace:!0,compile:function(e,t){return{post:c}}}}])}),define("ecsbuy/console/helpers/changeBandwidthHelper",["require","exports"],function(e,t){var n=function(){function e(){}return e.getOrderParamForBatch=function(e,t,n){var r=t&&t.orderData,i=e.activeBatchInfoIds,s=n.regionId;if(!r||!angular.isArray(r)||!angular.isArray(i))return;var o=[];return angular.forEach(r,function(e,t){var n=e.vm_bandwidth,r=e["vm_is_flow_type"]=="1"?"PayByTraffic":"PayByBandwidth";o.push({regionId:s,instanceId:i.join(","),internetMaxBandwidthOut:n,networkChargeType:r,allocatePublicIp:!0})}),o},e}();t.ChangeBandwidthHelper=n}),define("ecsbuy/console/directives/changeBandwidth/batchChangeBandwidthPayByTraffic",["require","exports","angular","../directives","common/helper/i18nHelper","../../cons/cons","../../helpers/changeBandwidthHelper"],function(e,t,n,r,i,s,o){r.directive("aliyunBuyEcsBatchChangeBandwidthPayByTraffic",["$rootScope","base64","$injector","aliyunBuyEcsRemoteService","modelFactory","modelSystemCacheContextService",function(e,t,r,u,a,f){return{restrict:"EA",templateUrl:s.ConsoleConstant.PARTIALS_PATH+"changeBandwidth/batchChangeBandwidthPayByTraffic.html",scope:{instanceIds:"@",purchaseEventId:"@",regionId:"@",isLoading:"=?"},compile:function(t,r){return{pre:function(e){},post:function(t){function u(e){t.payDisabled=e}var r=(t.instanceIds||"").split(","),s=t.regionId;f.setCacheContext("ecs.buy.changeBandwidth.batch.bizModel.cacheContext",{changeBandwidthCache:{instanceIds:r}},!0),t.batchActionModel=a.getModel("ecs.buy.changeBandwidthPayByTraffic.batchActionModel","BizModel"),t.batchUiModel=a.getModel("ecs.buy.changeBandwidth.batchUiModel","BizModel"),t.buttonText=i.i18n("ECS_OK"),t.checked=!0,t.purchase=function(){t.$emit("aliyunBuyEcsBatchView:batchSubmit")};var l=e.$on("aliyunBuyBatchAction:submit",function(e,n,r){var i=t.purchaseEventId;i||(i="aliyunBuyEcsBatchChangeBandwidth:purchase");var u={regionId:s},a=o.ChangeBandwidthHelper.getOrderParamForBatch(n,r,u);t.$emit(i,{order:a[0]})});u(!0);var c=e.$on("aliyunBuyEcsBatchView:saveOptions",function(e){u(!1)});t.$on("$destroy",function(){n.isFunction(l)&&l(),n.isFunction(c)&&c()})}}}}}])}),define("ecsbuy/console/directives/changeBandwidth/changeBandwidthOptions",["require","exports","angular","../directives","../../cons/cons","../../../base/helpers/fields/regionHelper"],function(e,t,n,r,i,s){r.directive("aliyunBuyEcsChangeBandwidthOptions",["$rootScope","base64","$injector","aliyunBuyEcsRemoteService",function(e,t,r,o){return{restrict:"EA",templateUrl:i.ConsoleConstant.PARTIALS_PATH+"changeBandwidth/batchChangeBandwidthPayByTrafficOptions.html",scope:{instanceId:"@",exportOptionsEventId:"@",saveOptionsEventId:"@",isLoading:"=?"},compile:function(t,i){return{pre:function(e){},post:function(t){function i(){var e=t.instanceId;return t.isLoading=!0,o.getCommodity({commodityCode:"ecs",orderType:"UPGRADE",instanceId:e}).then(function(e){return e})["finally"](function(){t.isLoading=!1})}function u(e){return s.RegionHelper.hijackFinanceRegionname(e),t.raw=e,e}function a(e,t,n,i){var s=r.get("aliyunBuyEcsValidateService");return s.validate(t,e)}function f(e){var n=t.saveOptionsEventId;n||(n="aliyunBuyEcsChangeBandwidthOptions:saveOptions"),t.$emit(n,{orderData:e})}t.frameworkSetting={constraintService:{getConstraints:i,onBeforeConstraintHandled:u},orderService:{purchase:f,beforePurchase:a},components:[{code:"vm_bandwidth"}]};var l=e.$on(t.exportOptionsEventId||"aliyunBuyEcsChangeBandwidthOptions:exportOptions",function(e){t.$broadcast("aliyunBuySubtotal:purchase")});e.$on("dominator:ready",function(){t.$emit("initialized"),t.$apply()}),t.$on("$destroy",function(){n.isFunction(l)&&l()})}}}}}])}),define("ecsbuy/console/directives/changeBandwidth/_base",["require","exports","./batchChangeBandwidthPayByTraffic","./changeBandwidthOptions"],function(e,t){}),define("ecsbuy/console/helpers/recycleBinHelper",["require","exports","angular","../../base/helpers/commodityHelper","../../base/helpers/buyUtils","../../base/helpers/orderDataHelper"],function(e,t,n,r,i,s){var o=function(){function e(){}return e.getOrderParams=function(e,t,i){if(!e||!t||!n.isArray(t))return;var o=r.CommodityHelper.getCommodityCode(e),u="BUY",a=s.OrderDataHelper.getOrderParam(t,o,u,i),f=a&&a[0]||{};i||(f.businessInfo={orderSource:"recycleBin"});var l=f.commodity,c=this.getSystemDiskInfo(e);return l&&c&&(l.systemDisk=undefined,l.recycleBinResourceId=this.getResourceId(e),l.maxAmount=l.amount=1),l.instanceName||(l.instanceName="Recovered_from_"+this.getResourceId(e)),[f]},e.getResourceId=function(e){return i.BuyUtils.getMapProperty(e,"recycleBinDetail.0.resourceId")},e.getRegionId=function(e){var t=i.BuyUtils.getMapProperty(e,"recycleBinDetail.0.regionId");return r.CommodityHelper.getRegionId(e,t)},e.getZoneId=function(e){return i.BuyUtils.getMapProperty(e,"recycleBinDetail.0.relationResources.relationResource.0.relationResourceDetail.ZoneId")},e.getSystemDiskInfo=function(e){var t=i.BuyUtils.getMapProperty(e,"recycleBinDetail.0.relationResources.relationResource");if(!n.isArray(t))return;for(var r=0;r<t.length;r++){var s=t[r];if(i.BuyUtils.getMapProperty(s,"relationResourceDetail.Type")=="system")return s.relationResourceDetail}},e.getDataDiskInfo=function(e){var t=i.BuyUtils.getMapProperty(e,"recycleBinDetail.0.relationResources.relationResource");if(!n.isArray(t))return;var r=[];for(var s=0;s<t.length;s++){var o=t[s];i.BuyUtils.getMapProperty(o,"relationResourceDetail.Type")=="data"&&r.push(o.relationResourceDetail)}return r},e}();t.RecycleBinHelper=o}),define("ecsbuy/console/directives/recycleBin/createInstance",["require","exports","angular","dominator/base/helpers/moduleHelper","common/helper/i18nHelper","../directives","../../cons/cons","../../helpers/buyAgainHelper","../../../base/helpers/buyUtils","../../../base/helpers/fields/regionHelper","../../../base/helpers/purchaseHelper","../../../base/cons/remoteActions","../../helpers/recycleBinHelper","../../../base/helpers/instanceTypeHelper","../../../base/cons/diskCategory","../../../base/cons/fieldCons"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){s.directive("aliyunBuyEcsRecycleBinCreateInstance",["aliyunBuyEcsRemoteService","aliyunBuyEcsValidateService","aliyunBuyEcsDialogButtonConfigService","aliyunBuyMsg","$rootScope","modelFactory","base64","$state",function(e,t,s,m,g,y,b,w){return{restrict:"EA",templateUrl:o.ConsoleConstant.PARTIALS_PATH+"recycleBin/createInstance.html",scope:{regionId:"@",recycleBinResourceId:"@",isLoading:"=?"},replace:!0,compile:function(s,o){return r.require(["options","value","detail"],o),{pre:function(r){function s(){var t=r.recycleBinResourceId,n="ecs",i=r.regionId;return e[c.RemoteActions.GET_COMMODITY_4_RECYCLE_BIN]({commodityCode:n,orderType:"BUY",regionId:i,recycleBinResourceId:t}).then(function(e){return r.isLoading=!1,e})}function o(e){return p.InstanceTypeHelper.mergeFamilyName(e),u.BuyAgainHelper.hijackBandwidthDefaultValue(e),f.RegionHelper.hijackFinanceRegionname(e),r.raw=e,e}function y(t){var i=h.RecycleBinHelper.getOrderParams(r.raw,t,!0),s=i[0];s&&s.commodity.internetChargeType=="PayByTraffic"&&(i=[{orderType:"traffic-bandwidth",regionId:s.regionId}].concat(i));var o={data:b.encode(n.toJson(i))};return x(!0),e[c.RemoteActions.DESCRIBE_PRICE](o).then(function(e){x(!1),e&&e.children&&n.forEach(e.children,function(t){t&&t.orderType=="traffic-bandwidth"&&(e.flowPrice=t.trade,e.flowPriceUnit="/GB"),t&&t.orderType=="instance-buy"&&(e.origin=t.origin,e.discount=t.discount,e.trade=t.trade,e.rules=t.rules,e.strategies=t.strategies,t.isPostpay&&(e.basePriceUnit="/"))}),e.isPostpay&&(e.basePriceUnit="/");var t=l.PurchaseHelper.getInsufficientBalanceTip(e.code,null);return!t||(r.payOrderTip=t,x(!0)),e},function(e){return e})["finally"](function(){})}function E(e,n,r,s){var o=n.getOriginConstraintData(),u=h.RecycleBinHelper.getSystemDiskInfo(o);return u&&u.Category==d.DiskCategory.CLOUD&&a.BuyUtils.getMapProperty(e,"0.iooptimized")==v.FieldCons.FIELD_IO_OPTIMIZED?(m.dialog(i.i18n("ECS_PROMPT"),i.i18n("ECS_OPTIMIZED_NOT_SUPPORTED_CLOUD_SYSTEM_DISK"),{buttons:[{text:i.i18n("ECS_OK"),theme:"blue",handler:function(){this.close()}}]}),!1):u&&u.Category!=d.DiskCategory.CLOUD&&a.BuyUtils.getMapProperty(e,"0.iooptimized")==v.FieldCons.FIELD_NON_IO_OPTIMIZED?(m.dialog(i.i18n("ECS_PROMPT"),i.i18n("ECS_NONE_OPTIMIZED_ONLY_SUPPORTED_CLOUD_SYSTEM_DISK"),{buttons:[{text:i.i18n("ECS_OK"),theme:"blue",handler:function(){this.close()}}]}),!1):t.validate(n,e)}function S(e,t){var n=h.RecycleBinHelper.getOrderParams(r.raw,e,!1);r.$emit("aliyunBuyEcsRecycleBinCreateInstance:purchase",{order:n})}function x(e){r.payDisabled=e}r.isLoading=!0,r.priceViewConfig={priceService:{getPrice:y}},r.purchase=function(e){if(!r.checked||!!r.payDisabled)return;r.$broadcast("aliyunBuySubtotal:purchase")},r.frameworkSetting={constraintService:{getConstraints:s,onBeforeConstraintHandled:o},orderService:{purchase:S,beforePurchase:E},components:[{code:"vm_region_no"},{code:"vm_iz"},{code:"vm_web_type"},{code:"instance_type"},{code:"vm_is_flow_type"},{code:"vm_bandwidth"},{code:"systemdisk_category"}]},r.checked=!0,r.buttonText="",r.visitEcsBuy=function(){w.go("buy.postpay",{inst:r.instanceId})};var T=g.$on("aliyunBuySubtotal:queryPrice",function(e,t){r.$broadcast("aliyunBuyPriceView:queryPrice",t)});r.$on("$destroy",function(){n.isFunction(T)&&T()})}}}}}])}),define("ecsbuy/console/directives/recycleBin/instanceDetail",["require","exports","angular","../directives","../../cons/cons","../../../base/helpers/commodityHelper","../../../base/helpers/buyUtils","../../helpers/recycleBinHelper"],function(e,t,n,r,i,s,o,u){r.directive("aliyunBuyEcsRecycleBinInstanceDetail",["$filter",function(e){function t(e){e.$watch("data()",function(t){if(!t)return;r(e,t)})}function r(e,t){var r=t.components,i=t.recycleBinDetail;if(!i)return;var a=e.context={},f=u.RecycleBinHelper.getRegionId(t),l=u.RecycleBinHelper.getZoneId(t),c=u.RecycleBinHelper.getSystemDiskInfo(t)||{},h=u.RecycleBinHelper.getDataDiskInfo(t)||[];a.regionName=s.CommodityHelper.getTextFromCollection(f,o.BuyUtils.getMapProperty(t,"components.vm_region_no.vm_region_no")),a.zoneName=s.CommodityHelper.getTextFromCollection(l,o.BuyUtils.getMapProperty(t,"components.vm_iz.vm_iz")),a.instanceChargeTypeText="ECS_BUY_POSTPAY",a.systemdiskSize=c.Size,a.systemdiskCategoryName=s.CommodityHelper.getTextFromCollection(c.Category,o.BuyUtils.getMapProperty(t,"components.systemdisk.systemdisk_category")),a.systemdiskName=c.DiskName,a.datadisk=function(){var e=[];return n.forEach(h,function(n){var r="";r+=n.Size+"GB ",r+=s.CommodityHelper.getTextFromCollection(n.Category,o.BuyUtils.getMapProperty(t,"components.datadisk.datadisk_category")),e.push({text:r,diskName:n.DiskName,snapshotId:n.SourceSnapshotId})}),e}()}return{restrict:"EA",templateUrl:i.ConsoleConstant.PARTIALS_PATH+"recycleBin/instanceDetail.html",scope:{data:"&"},replace:!0,link:t}}])}),define("ecsbuy/console/directives/recycleBin/_base",["require","exports","./createInstance","./instanceDetail"],function(e,t){}),define("ecsbuy/console/directives/hpcCluster/hpcClusterScaling",["require","exports","angular","../directives","dominator/base/helpers/moduleHelper","../../cons/cons","../../helpers/buyAgainHelper","../../../base/helpers/fields/regionHelper","../../../base/helpers/purchaseHelper","../../../base/cons/remoteActions","../../../base/helpers/hpcClusterHelper"],function(e,t,n,r,i,s,o,u,a,f,l){r.directive("aliyunBuyEcsHpcClusterScaling",["aliyunBuyEcsRemoteService","aliyunBuyEcsValidateService","$rootScope","modelFactory","base64","$state",function(e,t,r,c,h,p){return{restrict:"EA",templateUrl:s.ConsoleConstant.PARTIALS_PATH+"hpcCluster/hpcClusterScaling.html",scope:{regionId:"@",hpcClusterId:"@",commodityCode:"@",isLoading:"=?"},replace:!0,compile:function(s,c){return i.require(["options","value","detail"],c),{pre:function(i){function s(){var t=i.commodityCode,n=i.regionId,r=i.hpcClusterId;return e[f.RemoteActions.GET_COMMODITY_WITH_INSTANCE_INFO]({commodityCode:t,orderType:"BUY",regionId:n,hpcClusterId:r}).then(function(e){return i.isLoading=!1,e})}function c(e){return o.BuyAgainHelper.hijackBandwidthDefaultValue(e),u.RegionHelper.hijackFinanceRegionname(e),i.raw=e,e}function d(t){var r=l.HpcClusterHelper.getOrderParams(i.raw,t,!0),s=r[0];s&&s.commodity.internetChargeType=="PayByTraffic"&&(r=[{orderType:"traffic-bandwidth",regionId:s.regionId}].concat(r));var o={data:h.encode(n.toJson(r))};return g(!0),e[f.RemoteActions.DESCRIBE_PRICE](o).then(function(e){g(!1),e&&e.children&&n.forEach(e.children,function(t){t&&t.orderType=="traffic-bandwidth"&&(e.flowPrice=t.trade,e.flowPriceUnit="/GB"),t&&t.orderType=="instance-buy"&&(e.origin=t.origin,e.discount=t.discount,e.trade=t.trade,e.rules=t.rules,e.strategies=t.strategies,t.isPostpay&&(e.basePriceUnit="/"))}),e.isPostpay&&(e.basePriceUnit="/");var t=a.PurchaseHelper.getInsufficientBalanceTip(e.code,null);return!t||(i.payOrderTip=t,g(!0)),e},function(e){return e})["finally"](function(){})}function v(e,n,r,i){return t.validate(n,e)}function m(e,t){var n=l.HpcClusterHelper.getOrderParams(i.raw,e,!1);i.$emit("aliyunBuyEcsBuyAgain:purchase",{order:n})}function g(e){i.payDisabled=e}i.isLoading=!0,i.priceViewConfig={priceService:{getPrice:d}},i.purchase=function(e){if(!i.checked||!!i.payDisabled)return;i.$broadcast("aliyunBuySubtotal:purchase")},i.frameworkSetting={constraintService:{getConstraints:s,onBeforeConstraintHandled:c},orderService:{purchase:m,beforePurchase:v},components:[{code:"vm_region_no"},{code:"vm_iz"},{code:"vm_web_type"},{code:"vm_is_flow_type"},{code:"vm_bandwidth"},{code:"systemdisk_category"}]},i.checked=!0,i.buttonText="",i.visitEcsBuy=function(){p.go("buy.postpay",{inst:i.instanceId})};var y=r.$on("aliyunBuySubtotal:queryPrice",function(e,t){i.$broadcast("aliyunBuyPriceView:queryPrice",t)});i.$on("$destroy",function(){n.isFunction(y)&&y()})}}}}}])}),define("ecsbuy/console/helpers/resizeDiskHelper",["require","exports","../../base/helpers/buyUtils","./commonConsoleHelper"],function(e,t,n,r){var i=function(){function e(){}return e.getOrderParamForBatch=function(e,t,i){var s=n.BuyUtils.getMapProperty(e,"activeBatchInfoIds"),o=n.BuyUtils.getMapProperty(e,"activeBatchInfos"),u=n.BuyUtils.getMapProperty(i,"viewModel.changedFormCache");if(!s||!angular.isArray(s)||s.length==0)return;var a=[];return angular.forEach(s,function(e,t){var s=o[t],f=n.BuyUtils.getMapProperty(s,"instanceDetail.DiskChargeType"),l=r.CommonConsoleHelper.filterStringForAngualrBindingKey(e),c=n.BuyUtils.getMapProperty(u,l+".value");a.push({orderType:"disk-resize",chargeType:r.CommonConsoleHelper.transformChargeType(f),regionId:i.regionId,commodity:{diskIds:e,newSize:c}})}),a},e}();t.ResizeDiskHelper=i}),define("ecsbuy/console/directives/resizeDisk/batchResizeDisk",["require","exports","angular","../directives","common/helper/i18nHelper","../../cons/cons","../../helpers/commonConsoleHelper","../../helpers/resizeDiskHelper"],function(e,t,n,r,i,s,o,u){r.directive("aliyunBuyEcsBatchResizeDiskV2",["$rootScope","base64","$injector","aliyunBuyEcsRemoteService","modelFactory","modelSystemCacheContextService",function(e,t,r,a,f,l){return{restrict:"EA",templateUrl:s.ConsoleConstant.PARTIALS_PATH+"resizeDisk/batchResizeDisk.html",scope:{diskIds:"@",regionId:"@",purchaseEventId:"@",isLoading:"=?"},compile:function(t,r){return{pre:function(e){},post:function(t){function a(e){t.payDisabled=e}var r=(t.diskIds||"").split(","),s=t.regionId;l.setCacheContext("ecs.buy.resizeDisk.batch.bizModel.cacheContext",{resizeDiskCache:{diskIds:r,regionId:s}},!0),t.batchActionModel=f.getModel("ecs.buy.resizeDisk.batchActionModel","BizModel"),t.batchUiModel=f.getModel("ecs.buy.resizeDisk.batchUiModel","BizModel"),t.buttonText=i.i18n("ECS_ENSURE_RESIZEDISK"),t.checked=!0,t.priceConfig={feeText:{text:i.i18n("ECS_CHECKOUT_AMOUNT"),visible:!0,cls:"bk-mr2",style:"font-size: 16px;color:#000;"},trade:{style:"font-size: 30px;"}},t.purchase=function(){t.$emit("aliyunBuyEcsBatchView:batchSubmit")};var c=e.$on("aliyunBuyBatchAction:submit",function(e,r,i,a){var f=t.purchaseEventId;f||(f="aliyunBuyEcsBatchResizeDisk:purchase"),n.extend(a,{regionId:s});var l=u.ResizeDiskHelper.getOrderParamForBatch(r,i,a),c=o.CommonConsoleHelper.hasPrepayOrder(l);l&&t.$emit(f,{order:l,hasPrepayOrder:c})});a(!0);var h=e.$on("aliyunBuyEcsBatchView:queryPriceStarted",function(e){a(!0)}),p=e.$on("aliyunBuyEcsBatchView:queryPriceFinished",function(e){a(!1)});t.$on("$destroy",function(){n.isFunction(c)&&c(),n.isFunction(h)&&h(),n.isFunction(p)&&p()})}}}}}])}),define("ecsbuy/console/directives/resizeDisk/resizeDiskOptions",["require","exports","angular","../directives","../../cons/cons","../../../base/helpers/fields/regionHelper"],function(e,t,n,r,i,s){r.directive("aliyunBuyEcsResizeDiskOptionsV2",["$rootScope","base64","$injector","aliyunBuyEcsRemoteService",function(e,t,r,o){return{restrict:"EA",templateUrl:i.ConsoleConstant.PARTIALS_PATH+"resizeDisk/resizeDiskOptions.html",scope:{diskId:"@",regionId:"@",exportOptionsEventId:"@",saveOptionsEventId:"@",isLoading:"=?"},compile:function(t,i){return{pre:function(e){},post:function(t){function i(){var e=t.diskId,n=t.regionId;return t.isLoading=!0,o.getResizeDiskCommodity({commodityCode:"yundisk",orderType:"RESIZE",instanceId:e,regionId:n}).then(function(e){return e})["finally"](function(){t.isLoading=!1})}function u(e){return s.RegionHelper.hijackFinanceRegionname(e),t.raw=e,e}function a(e,t,n,i){var s=r.get("aliyunBuyEcsValidateService");return s.validate(t,e)}function f(e){var n=t.saveOptionsEventId;n||(n="aliyunBuyEcsResizeDiskOptions:saveOptions"),t.$emit(n,{orderData:e})}t.frameworkSetting={constraintService:{getConstraints:i,onBeforeConstraintHandled:u},orderService:{purchase:f,beforePurchase:a},components:[{code:"datadisk_size"}]};var l=e.$on(t.exportOptionsEventId||"aliyunBuyEcsResizeDiskOptions:exportOptions",function(e){t.$broadcast("aliyunBuySubtotal:purchase")});e.$on("dominator:ready",function(){t.$emit("initialized"),t.$apply()}),t.$on("$destroy",function(){n.isFunction(l)&&l()})}}}}}])}),define("ecsbuy/console/directives/resizeDisk/_base",["require","exports","./batchResizeDisk","./resizeDiskOptions"],function(e,t){}),define("ecsbuy/console/directives/_base",["require","exports","./directives","./common/_base","./buyAgain/buyAgain","./renew/renew","./changeOs/_base","./release/release","./downgrade/_base","./downgradeWithRenew/_base","./instanceDetail","./instanceDetailV2","./upgrade/upgrade","./upgrade/bandwidthHistory","./changeBandwidth/_base","./recycleBin/_base","./hpcCluster/hpcClusterScaling","./resizeDisk/_base"],function(e,t){}),define("ecsbuy/console/filter/filters",["require","exports","angular","common/modelSystem/modelSystemBaseController"],function(e,t,n,r){var i=n.module("ecsbuyConsoleFilters",[]);return i.controller=r.wrapController(i),i}),define("ecsbuy/console/filter/componentFilter",["require","exports","./filters"],function(e,t,n){function r(e,t){if(t=="bandwidth")return i(e);if(t=="cpu")return s(e);if(t=="memory")return o(e);if(t=="duration")return a(e);if(t=="diskSize")return u(e)}function i(e){var t=parseInt(e);return isNaN(t)?"- Mbps":l(t,1024)+"Mbps"}function s(e){return e+""}function o(e){return e=parseInt(e),isNaN(e)?"- MB":e<1024?e+"MB":l(e,1024)+"GB"}function u(e){return e=parseInt(e),isNaN(e)?"- MB":e<1024?e+"GB":l(e,1024)+"TB"}function a(e){if(!e)return"";var t=angular.fromJson(e);return t[1]=="year"?t[0]+" ":t[1]=="month"?t[0]+" ":""}function f(e){var t=e.replace("T"," ").replace("Z"," ");return t}function l(e,t){if(typeof e=="number"){if(typeof t=="number"){var n=e/t;if(e%t==0)return n.toString();var r=e/t;return r.toFixed(2).toString()}return e.toString()}return"-"}n.filter("aliyunBuyEcsShowComponent",[function(){return r}]),n.filter("replaceTimeString",[function(){return f}])}),define("ecsbuy/console/filter/_base",["require","exports","./filters","./componentFilter"],function(e,t){}),define("ecsbuy/console/models/buyAgain/ecs.buy.buyAgain.ui",["require","exports","common/modelSystem/modelFactory","common/helper/i18nHelper"],function(e,t,n,r){n.regist("ecs.buy.buyAgain.ui","BuyUiModel",{id:"ecsBuyAgain",fields:[{id:"instanceDetail",type:"group",groupStyle:"none",children:[{id:"customConfig",type:"customField",fieldCls:"bk-pb5",noLabel:!0,template:'<div aliyun-buy-ecs-instance-detail-v2 data="raw" ></div>'}]},{id:"recommendConfig",type:"group",spmId:"recommend",groupClass:"bk-group-pt30",groupStyle:"none",children:[{id:"recommend_instance_type",type:"customField",label:"",template:'<div class="bk-form-row-cell">\n          <div aliyun-buy-ecs-recommend-instance-type options="options" value="rawData.recommend_instance_type"></div>\n        </div>'},{id:"iooptimizedConfig",type:"group",spmId:"iooptimized",groupStyle:"none",children:[{id:"iooptimized",type:"newBrickTabs"}]},{id:"systemdisk_category",clientField:!0,type:"customField",label:r.i18n("ecs.buy.label.disk.system"),template:'\n        <div class="bk-form-row-cell bk-sysdisk">\n          <div class="bk-form-row-li">\n            <span aliyun-buy-select class="bk-disk-cell bk-select"\n                  option="options.items"\n                  spm="sysdisk"\n                  short="true"\n                  detail="detail"\n                  ng-model="rawData.systemdisk_category">\n            </span>\n          </div>\n          <div aliyun-buy-block-tips></div>\n        </div>\n        '}]},{id:"amountConfig",type:"group",spmId:"quantity",groupClass:"bk-group-pt5",groupStyle:"none",children:[{id:"order_time",type:"newBrickTabs",label:"",attributes:[]},{id:"amount",type:"amount",label:"",attributes:[]}]},{id:"viewMoreConfig",type:"group",spmId:"viewMore",groupStyle:"none",groupClass:"bk-group-pt5",children:[{id:"viewMore",type:"checkbox",label:"",fieldCls:"bk-pt0",clientField:!0}]},{id:"chargeTypeConfig",type:"group",groupClass:"bk-group-pt5",spmId:"chargeType",groupStyle:"none",children:[{id:"chargeType",type:"newBrickTabs",label:""}]},{id:"regionConfig",type:"group",spmId:"region",groupStyle:"none",children:[{id:"vm_region_no",type:"newBrickTabs"}]},{id:"networkConfig",type:"group",spmId:"network",groupClass:"bk-group-pt5",groupStyle:"none",children:[{id:"vm_web_type",type:"newBrickTabs"},{id:"securityGroup",type:"customField",label:"",clientField:!0,template:"<div aliyun-buy-ecs-security-group\n                      value='rawData.securityGroup'\n                      options='options'\n                      value-all='valueAll'\n                      raw='raw'\n                      detail='rawData.$detail'\n                      default-value-sg-id=\"rawData.defaultSecurityGroupId\"></div>"}]},{id:"bandwidthConfig",type:"group",spmId:"bandwidth",groupClass:"bk-group-pt5",groupStyle:"none",children:[{id:"vm_is_flow_type",type:"newBrickTabs",label:"",attributes:[]},{id:"vm_bandwidth",type:"buySliderWithNumber",label:"",attributes:[]}]},{id:"passwordConfig",type:"group",spmId:"login",groupClass:"bk-group-pt5",groupStyle:"none",children:[{id:"setupPassword",type:"newBrickTabs",clientField:!0,label:"",attributes:[]},{id:"password",clientField:!0,fieldWraperCls:"bk-form-row-pb0",type:"customField",noLabel:!0,template:'<span  aliyun-buy-ecs-password\n                        aliyun-buy-anchor="dominator:password:anchor"\n                        options="options"\n                        value="rawData.password"></span>'},{id:"keyPair",clientField:!0,label:"",type:"customField",template:'<span  aliyun-buy-ecs-setting-key-pair\n                        aliyun-buy-anchor="dominator:keyPair:anchor"\n                        options="options"\n                        value-all="valueAll"\n                        value="rawData.keyPair"></span>'},{id:"instanceName",clientField:!0,fieldWraperCls:"bk-form-row-pb30",label:r.i18n("ecs.buy.component.password.instanceName"),type:"customField",template:'<span  aliyun-buy-ecs-instance-name\n                        aliyun-buy-anchor="dominator:instanceName:anchor"\n                        options="options"\n                        value="rawData.instanceName"></span>'}]}]})}),define("ecsbuy/console/models/constraints/buyAgain/display4EipConstraint",["require","exports","../../../helpers/instanceDetailHelperNew"],function(e,t,n){var r={id:"display4EipConstraint",watches:["vm_region_no","viewMore"],action:function(e,t,r,i,s){var o=i.getOriginConstraintData(),u=n.InstanceDetailHelperNew.getEipInstanceId(o),a=i.getFieldValueById("viewMore");u?r.hide():a?r.show():r.hide()}};return r}),define("ecsbuy/console/models/constraints/buyAgain/display4ViewMoreConstraint",["require","exports"],function(e,t){var n={id:"display4ViewMoreConstraint",watches:["viewMore"],action:function(e,t,n,r,i){e?n.show():n.hide()}};return n}),define("ecsbuy/console/models/constraints/buyAgain/display4SetupPwdItemsConstraint",["require","exports","../../../../base/helpers/buyUtils","../../../../base/cons/buyBizCons"],function(e,t,n,r){var i={id:"display4SetupPwdItemsConstraint",watches:["viewMore"],action:function(e,t,i,s,o){if(e){var u=s.getOriginConstraintData(),a=n.BuyUtils.getMapProperty(u,"instanceDetail.orderInfo.iooptimized"),f=n.BuyUtils.getMapProperty(u,"instanceDetail.orderInfo.vm_os.0.vm_os_kind"),l=r.BuyBizCons.SETTING_PASSWORD_ITEMS;f=="linux"&&a=="optimized"&&(l=[r.BuyBizCons.SETTING_KEYPAIR_ITEM].concat(l)),i.setOptionsAttr("items",l)}}};return i}),define("ecsbuy/console/models/buyAgain/ecs.buy.buyAgain.biz",["require","exports","angular","common/modelSystem/modelFactory","../../../base/models/constraints/fieldDynamicTipConstraintsFn","../constraints/buyAgain/display4EipConstraint","../constraints/buyAgain/display4ViewMoreConstraint","../constraints/buyAgain/display4SetupPwdItemsConstraint","common/helper/i18nHelper","../../../base/helpers/buyBizHelper","../../../base/helpers/buyTipsHelper","../../../base/cons/buyBizCons","../../../base/helpers/homeConfigHelper","../../../base/cons/remoteActions","../../../base/helpers/buyUtils","../../helpers/instanceDetailHelperNew"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){r.regist("ecs.buy.buyAgain.biz","BizModel",["$state","$injector","$rootScope","aliyunBuyEcsRemoteService","$timeout","modelFactory",function(e,t,r,m,g,y){var b=y.getModel("ecs.buy.biz","BizModel"),w={id:"ecsBuyAgain",fields:[{id:"customConfig",initData:{},controller:function(e,t,n,r){e.raw=n.getDominator().getOriginConstraintData()}},{id:"viewMore",initData:{display:""}},{id:"chargeType",initData:{options:{items:c.BuyBizCons.CHARGE_TYPE_ITEMS}},controller:function(t,n,r,i){t.$watch("rawData.chargeType",function(t){e.includes("buyAgain.prepay")?r.setFieldValue("prepay"):e.includes("buyAgain.postpay")&&r.setFieldValue("postpay"),t=="prepay"?e.go("buyAgain.prepay"):t=="postpay"&&e.go("buyAgain.postpay")})},constraints:[o]},{id:"vm_region_no",controller:function(e,t,n,r){var i=n.getDominator().getOriginConstraintData(),s=d.BuyUtils.getMapProperty(i,"instanceDetail.RegionId");n.hide(),n.setFieldValue(s)}},{id:"vm_web_type",controller:function(e,t,n,r){var i=n.getDominator().getOriginConstraintData(),s=v.InstanceDetailHelperNew.getVmWebType(i);n.hide(),n.setFieldValue(s)}},{id:"securityGroup",initData:{options:{askTip:l.BuyTipsHelper.getAskTip("securityGroup")}},controller:function(e,t,r,i){var s=r.getDominator();e.raw=s.getOriginConstraintData();var o=v.InstanceDetailHelperNew.getNetworkType(e.raw),u=v.InstanceDetailHelperNew.getVpcId(e.raw),a=v.InstanceDetailHelperNew.getVSwitchId(e.raw),f=v.InstanceDetailHelperNew.getRegionAlias(e.raw);e.valueAll={region:f,networkType:o,vpc:n.toJson([a,null,u])},e.rawData.defaultSecurityGroupId=v.InstanceDetailHelperNew.getSecurityGroupId(e.raw)},constraints:[o]},{id:"setupPassword",initData:{options:{items:[]}},constraints:[i("setupPasswordConstraint",["setupPassword"],{translateValues:[h.HomeConfigHelper.getUrlConfig("keypairHelper")]}),o,u]},{id:"instanceName",constraints:[o]},{id:"recommend_instance_type",initData:{options:{items:[]}},controller:function(e,t,n,r){function s(t){var n=t.order,r=t.payType,i=t.instanceId,s=n[0],o=s.commodity,u={networkType:o.networkType,instanceType:o.instanceType,regionId:s.regionId};m[p.RemoteActions.GET_RECOMMEND_INSTANCE_TYPE](u).then(function(t){e.options.items=v.InstanceDetailHelperNew.formatRecommendInstanceType(t,o.instanceType,e.raw),e.options.tip=a.i18n("ECS_RECOMMEND_NONE_TIP",r,i,o.instanceType)})}var i=n.getDominator();e.raw=i.getOriginConstraintData(),n.hide(),e.$on("ecsConsole:buyAgain:createOrder:fail",function(e,t){n.show(),s(t)})}},{id:"iooptimized",controller:function(e,t,n,r){var i=n.getDominator().getOriginConstraintData(),s=v.InstanceDetailHelperNew.getIoOptimized(i);n.hide(),n.setFieldValue(s?"optimized":"none")},constraints:[{id:"recommendIooptimizedConstraints",watches:["recommend_instance_type"],action:function(e,t,n,r,i){e&&n.setFieldValue("optimized")}}]},{id:"systemdisk_category",initData:{options:{tip:a.i18n("ECS_RECOMMEND_SYSTEMDISK_CATEGORY_TIP")}},controller:function(e,t,n,r){n.hide()},constraints:[{id:"recommendSystemDiskCategoryConstraints",watches:["recommend_instance_type"],action:function(e,t,n,r,i){var s=r.getOriginConstraintData(),o=v.InstanceDetailHelperNew.getSystemDiskInfo(s);n.hide(),e&&o.Category=="cloud"?n.show():n.hide()}}]}]};return f.BuyBizHelper.extendConstrainsForBizModel(b,{vm_bandwidth:s,vm_is_flow_type:s,password:o,keyPair:o}),f.BuyBizHelper.extendFieldModelNew(w,b,["vm_is_flow_type","vm_bandwidth","order_time","amount","setupPassword","password","keyPair"],null)}])}),define("ecsbuy/console/models/buyAgain/_base",["require","exports","./ecs.buy.buyAgain.ui","./ecs.buy.buyAgain.biz"],function(e,t){}),define("ecsbuy/console/models/changeOs/uiModel/commonUi",["require","exports"],function(e,t){var n=[{id:"imageConfig",type:"group",groupStyle:"none",groupClass:"bk-group-pt30",spmId:"image",children:[{id:"imageType",type:"newBrickTabs",label:"",attributes:[]},{id:"publicImage",type:"customField",template:"<span aliyun-buy-select-linkage\n                       aliyun-buy-anchor=\"dominator:publicImage:anchor\"\n                       options='options'\n                       value='rawData.allValue'\n                       detail='rawData.allDetail'\n                       root-value='rawData.rootValue'\n                       root-detail=\"options.rootDetail\"\n                       children-value='rawData.publicImage'\n                       children-detail='options.childDetail'></span>",label:"",attributes:[]},{id:"customImage",type:"customField",template:"<span  aliyun-buy-ecs-image\n                        aliyun-buy-anchor=\"dominator:customImage:anchor\"\n                        options='options'\n                        value='rawData.customImage'\n                        detail='rawData.$detail'\n                        image-type='custom'\n                        value-all='valueAll'></span>",label:"",attributes:[]},{id:"sharedImage",type:"customField",template:"<span  aliyun-buy-ecs-image\n                        aliyun-buy-anchor=\"dominator:sharedImage:anchor\"\n                        options='options'\n                        value='rawData.sharedImage'\n                        detail='rawData.$detail'\n                        image-type='shared'\n                        value-all='valueAll'></span>",label:"",attributes:[]},{id:"marketImage",type:"customField",template:"<span  aliyun-buy-ecs-image-market\n                        aliyun-buy-anchor=\"dominator:marketImage:anchor\"\n                        options='options'\n                        detail='rawData.$detail'\n                        value='rawData.marketImage'\n                        value-all='valueAll'\n                        raw='raw'></span>",label:"",attributes:[]},{id:"imageOffline",fieldWraperCls:"bk-form-row-pb0 ",type:"customField",template:"<span  aliyun-buy-ecs-image-offline\n                        aliyun-buy-anchor=\"dominator:imageOffline:anchor\"\n                        options='options'\n                        value='rawData.imageOffline'\n                        value-all='valueAll'>",noLabel:!0},{id:"imageFromMarket",type:"customField",fieldWraperCls:"bk-form-row-pb0 ",template:"<span  aliyun-buy-ecs-image-from-market\n                        options='options'\n                        detail=\"rawData.$detail\"\n                        value='rawData.imageFromMarket'\n                        value-all='valueAll'>",noLabel:!0},{id:"publicDefaultValueImageId",type:"buyText"},{id:"customDefaultValueImageId",type:"buyText"},{id:"sharedDefaultValueImageId",type:"buyText"},{id:"marketDefaultValueImageId",type:"buyText"},{id:"securityEnhancementStrategy",type:"checkbox",noLabel:!0,fieldWraperCls:"bk-security-enhancement",fieldCls:"bk-ecs-security-enhancement ",clientField:!0}]},{id:"hideConfig",type:"group",groupStyle:"none",children:[{id:"chargeType",type:"buyText"},{id:"vm_region_no",type:"customField",template:"<div aliyun-buy-buttontab-with-select parent-value='rawData.vm_region_no' child-value='rawData.vm_iz' options='options' ng-model='rawData.vm_region_no'></div>",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]},{id:"instance_type",type:"newBrickRemarkTabs",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]},{id:"iooptimized",type:"customField",template:"<div ecs-io-select ng-model='rawData.iooptimized' options='options'></div>",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]},{id:"vm_web_type",type:"newBrickTabs",fieldWraperCls:"bk-label-non",noLabel:!0},{id:"vm_os_kind",type:"buyText"}]}];return n}),define("ecsbuy/console/models/changeOs/uiModel/instanceDetailUi",["require","exports"],function(e,t){var n=[{id:"currentConfig",type:"group",groupStyle:"none",children:[{id:"customConfig",type:"customField",noLabel:!0,template:'<div aliyun-buy-ecs-instance-detail-new data="raw" ></div>'}]}];return n}),define("ecsbuy/console/models/changeOs/uiModel/securityConfigUi",["require","exports","common/helper/i18nHelper"],function(e,t,n){var r=[{id:"securityConfig",type:"group",groupStyle:"none",groupClass:"bk-group-pt30",spmId:"login",children:[{id:"setupPassword",type:"newBrickTabs",clientField:!0,label:"",attributes:[]},{id:"password",clientField:!0,noLabel:!0,fieldWraperCls:"bk-form-row-pb0",type:"customField",template:'<span  aliyun-buy-ecs-password\n                        aliyun-buy-anchor="dominator:password:anchor"\n                        options="options"\n                        value="rawData.password"></span>'},{id:"keyPair",clientField:!0,label:n.i18n("ecs.buy.label.keypair"),type:"customField",template:'<span  aliyun-buy-ecs-setting-key-pair\n                        aliyun-buy-anchor="dominator:keyPair:anchor"\n                        options="options"\n                        value-all="valueAll"\n                        value="rawData.keyPair"></span>'}]}];return r}),define("ecsbuy/console/models/changeOs/uiModel/storageConfigUi",["require","exports","common/helper/i18nHelper"],function(e,t,n){var r=[{id:"storageConfig",type:"group",groupStyle:"none",groupClass:"bk-group-pt30",spmId:"storage",children:[{id:"systemdisk_category",type:"customField",label:n.i18n("ecs.buy.label.disk.system"),template:"<span  aliyun-buy-ecs-sysdisk\n                        aliyun-buy-anchor=\"dominator:systemdisk_category:anchor\"\n                        options='options'\n                        category='rawData.systemdisk_category'\n                        size='rawData.systemdisk_size'></span>"},{id:"systemdisk_size",type:"customField",template:"<input value='rawData.systemdisk_size'/>"}]}];return r}),define("ecsbuy/console/models/changeOs/ecs.buy.changeOs.ui",["require","exports","common/modelSystem/modelFactory","./uiModel/commonUi","./uiModel/instanceDetailUi","./uiModel/securityConfigUi","./uiModel/storageConfigUi"],function(e,t,n,r,i,s,o){var u=[].concat(i,r,o,s);n.regist("ecs.buy.changeOs.ui","BuyUiModel",{id:"ecsChangeOs",fields:u})}),define("ecsbuy/console/models/constraints/changeOs/changeOsSDCategoryConstraint",["require","exports","../../../../base/helpers/buyUtils","common/helper/i18nHelper","../../../helpers/commonConsoleHelper","../../../../base/helpers/imageHelper","../../../../base/cons/cons"],function(e,t,n,r,i,s,o){var u=[{id:"changeOsSDCategoryConstraint",watches:["systemdisk_category"],action:function(e,t,r,i,s){var o=i.getOriginConstraintData(),u=n.BuyUtils.getMapProperty(o,"instanceDetail.orderInfo.systemdisk.0.systemdisk_category"),a=i.getOptionsFromConstraints(t),f=a&&a.filter(function(e){if(e.value==u)return!0});r.setOptionsAttr("items",f)}},{id:"changeOsSDSizeRangeConstraint",watches:["systemdisk_category","publicImage","customImage","sharedImage","marketImage"],action:function(e,t,u,a,f){var l=a.getOriginConstraintData(),c=u.getFieldValue(),h=s.ImageHelper.getImageValue(a),p=a.getOptionsFromConstraints("systemdisk_size",{systemdisk_category:c},"range"),d=n.BuyUtils.getMapProperty(l,"instanceDetail.orderInfo.systemdisk.0.systemdisk_size"),v=n.BuyUtils.getMapProperty(l,"instanceDetail.instanceInfo.isRenewChange"),m=n.BuyUtils.getMapProperty(l,"instanceDetail.instanceInfo.chargeType"),g=h.imageSize||40;if(p){var y=Math.max(d,g,p.min,40);u.setOptionsAttr("min",y),u.setOptionsAttr("max",p.max)}u.setOptionsAttr("showWindows2003Tip",!1),u.setOptionsAttr("systemDiskHoverTip","");if(h.platform==o.Constant.WINDOWS_SERVER_2003){var b=Math.max(40,g,d);u.setOptionsAttr("max",b),u.setOptionsAttr("showWindows2003Tip",!0),u.setOptionsAttr("systemDiskHoverTip",r.i18n("ecs.buy.component.systemdisk.tipForWindows2003"))}if(i.CommonConsoleHelper.isPrepay(m)&&!!v){var b=Math.max(40,d),y=Math.max(40,d);u.setOptionsAttr("max",b),u.setOptionsAttr("min",y),u.setOptionsAttr("systemDiskHoverTip",r.i18n("ecs.buy.component.systemdisk.hoverTip.nosupportForChangeOs")),g>b?(u.setOptionsAttr("state","error"),u.setOptionsAttr("stateMessage",r.i18n("ecs.buy.component.systemdisk.renew.change.notSupportForChangeOsSystemDiskSize",g))):(u.setOptionsAttr("state",""),u.setOptionsAttr("stateMessage",""))}}}];return u}),define("ecsbuy/console/models/constraints/changeOs/changeOsImageFromMarketConstraint",["require","exports","../../../../base/helpers/imageHelper"],function(e,t,n){var r=[{id:"changeOsImageFromMarketConstraint",watches:["imageFromMarket"],action:function(e,t,r,i,s){var o=i.getFieldById(t),u=o.$scope,a=n.ImageHelper.parseValue(e);u.$emit("aliyunBuyEcsChangeOs:imageFromMarket",a)}}];return r}),define("ecsbuy/console/models/constraints/changeOs/changeOsMarketImageTipConstraint",["require","exports","common/helper/i18nHelper","../../../../base/helpers/imageHelper","../../../../base/helpers/buyUtils","../../../helpers/changeOsHelper","../../../helpers/commonConsoleHelper"],function(e,t,n,r,i,s,o){var u=[{id:"changeOsMarketImageTipConstraint",watches:["imageFromMarket"],action:function(e,t,u,a,f){if(!e)return;var l=a.getOriginConstraintData(),c=i.BuyUtils.getMapProperty(l,"instanceDetail.instanceInfo.marketImageChargeType"),h=i.BuyUtils.getMapProperty(l,"instanceDetail.instanceInfo.marketImageStatus"),p=i.BuyUtils.getMapProperty(l,"instanceDetail.orderInfo.vm_os.0.vm_os_imageProductCode"),d=r.ImageHelper.parseValue(e);o.CommonConsoleHelper.isImagePrepay(c)&&o.CommonConsoleHelper.isImageOnSale(h)&&!s.ChangeOsHelper.isSameMarketImageByProductCode(d.imageProductCode,p)?u.setOptionsAttr("tip",n.i18n("ECS_CHANGEOS_MARKET_IMAGE_TIP")):u.setOptionsAttr("tip","")}}];return u}),define("ecsbuy/console/models/changeOs/ecs.buy.changeOs.biz",["require","exports","angular","common/modelSystem/modelFactory","../../../base/helpers/buyBizHelper","../../../base/helpers/buyUtils","../../../base/cons/buyBizCons","../../../base/helpers/buyTipsHelper","../../../base/helpers/homeConfigHelper","../../../base/helpers/commodityHelper","../../../base/helpers/imageHelper","../constraints/changeOs/changeOsSDCategoryConstraint","../constraints/changeOs/changeOsImageFromMarketConstraint","../../../base/models/constraints/fieldDynamicTipConstraintsFn","../../../base/models/constraints/common/InnerFieldWatchConstraintFn","../constraints/changeOs/changeOsMarketImageTipConstraint","../../../base/helpers/methodHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){r.regist("ecs.buy.changeOs.biz","BizModel",["$state","$injector","$rootScope","aliyunBuyEcsRemoteService","$timeout","modelFactory",function(e,t,r,g,y,b){var w=b.getModel("ecs.buy.biz","BizModel"),E={id:"ecsChangeOs",fields:[{id:"customConfig",initData:{},controller:function(e,t,n,r){var i=n.getDominator();e.raw=i.getOriginConstraintData()}},{id:"chargeType",initData:{},controller:function(e,t,n,r){n.hide();var i=n.getDominator(),u=i.getOriginConstraintData(),a=s.BuyUtils.getMapProperty(u,"instanceDetail.instanceInfo.chargeType"),f=o.BuyBizCons.CHARGE_TYPE_MAP_REVERT[a];n.setFieldValue(f)}},{id:"vm_region_no",initData:{},controller:function(e,t,n,r){n.hide();var i=n.getDominator(),o=i.getOriginConstraintData(),u=s.BuyUtils.getMapProperty(o,"instanceDetail.instanceInfo.regionId");n.setFieldValue(u)}},{id:"instance_type",initData:{},controller:function(e,t,n,r){n.hide();var i=n.getDominator(),o=i.getOriginConstraintData(),u=s.BuyUtils.getMapProperty(o,"instanceDetail.orderInfo.instance_type.0.instance_type");n.setFieldValue(u)}},{id:"iooptimized",initData:{},controller:function(e,t,n,r){n.hide();var i=n.getDominator(),o=i.getOriginConstraintData(),u=s.BuyUtils.getMapProperty(o,"instanceDetail.orderInfo.iooptimized");n.setFieldValue(u)}},{id:"vm_web_type",initData:{},controller:function(e,t,n,r){n.hide();var i=n.getDominator(),o=i.getOriginConstraintData(),u=s.BuyUtils.getMapProperty(o,"instanceDetail.orderInfo.vm_web_type");n.setFieldValue(u)}},{id:"setupPassword",initData:{options:{items:[]}},constraints:[p("setupPasswordConstraint",["setupPassword"],{translateValues:[a.HomeConfigHelper.getUrlConfig("keypairHelper")]}),{id:"keypairDiskplayConstraint",watches:["imageType","publicImage","sharedImage","customImage","marketImage","iooptimized"],action:function(e,t,n,r,i){var u=l.ImageHelper.getImageValue(r),a=[o.BuyBizCons.SETTING_PASSWORD_NOW_ITEM],f=r.getFieldValueById("iooptimized");u&&u.osKind=="linux"&&f=="optimized"&&(a=[o.BuyBizCons.SETTING_KEYPAIR_ITEM].concat(a)),a.length>1?(n.show(),n.setOptionsAttr("items",a),n.setFieldValue(s.BuyUtils.getMapProperty(o.BuyBizCons.SETTING_KEYPAIR_ITEM,"value"))):a.length==1&&(n.hide(),n.setFieldValue(s.BuyUtils.getMapProperty(a,"0.value")))}}]},{id:"amount",initData:{},controller:function(e,t,n,r){n.hide();var i=n.getDominator(),o=i.getOriginConstraintData(),u=s.BuyUtils.getMapProperty(o,"value");n.setFieldValue(u)}},{id:"systemdisk_category",initData:{options:{tip:u.BuyTipsHelper.getBlockTip("clouddisk_category_introduce",[a.HomeConfigHelper.getUrlConfig("clouddiskCategoryIntroduce"),"_blank"])}},controller:function(e,t,r,o){var u=r.getDominator(),a=u.getOriginConstraintData(),l=f.CommodityHelper.getProperties(a,"systemdisk","systemdisk_device"),c=s.BuyUtils.getMapProperty(a,"instanceDetail.orderInfo.systemdisk.0.systemdisk_device"),h=[];n.isArray(l)&&(h=l.filter(function(e){if(e.value==c)return!0})),h.length>0?r.setOptionsAttr("mount",h[0]):r.setOptionsAttr("mount",l[0]),e.$watch("rawData.systemdisk_size",function(e){if(!e)return;i.BuyBizHelper.setFieldValue("systemdisk_size",e,u)})},constraints:[d("systemdisk_size")]},{id:"vm_os_kind",initData:{},controller:function(e,t,n,r){n.hide(),e.$watch("options",function(e){e&&e.items&&e.items instanceof Array&&n.setFieldValue(m.MethodHelper.getArrayFromListMapByKey(e.items,"value"))})}}]};return i.BuyBizHelper.extendConstrainsForBizModel(E,{systemdisk_category:c}),i.BuyBizHelper.extendConstrainsForBizModel(w,{marketImage:v,imageFromMarket:h}),i.BuyBizHelper.extendFieldModelNew(E,w,["imageType","publicImage","customImage","sharedImage","marketImage","imageOffline","publicDefaultValueImageId","customDefaultValueImageId","sharedDefaultValueImageId","marketDefaultValueImageId","imageFromMarket","securityEnhancementStrategy","systemdisk_size","password","keyPair"],null)}])}),define("ecsbuy/console/models/constraints/changeOs/changeOsOptionsImageDetailConstaintFn",["require","exports","../../../../base/helpers/buyBizHelper"],function(e,t,n){var r=function(e){return{id:"changeOsOptionsImageDetailConstraint",watches:[e+"Image"],action:function(t,r,i,s,o){if(!t)return;var u=n.BuyBizHelper.getFieldValue("imageType",s);if(u==e){var a=i.$scope;a.rawData&&a.rawData.$detail&&a.rawData.$detail.text&&a.$emit("aliyunBuyEcsBatchView:changedContent",a.rawData.$detail.text),a.options&&a.options.childDetail&&a.options.childDetail.fullText&&a.$emit("aliyunBuyEcsBatchView:changedContent",a.options.childDetail.fullText)}}}};return r}),define("ecsbuy/console/models/constraints/changeOs/changeOsOptionsMarketImageDetailConstraint",["require","exports","../../../../base/helpers/buyBizHelper"],function(e,t,n){var r=[{id:"changeOsOptionsImageDetailConstraint",watches:["imageFromMarket"],action:function(e,t,r,i,s){if(!e)return;var o=n.BuyBizHelper.getFieldValue("imageType",i),u=i.getFieldById(t);if(o=="market"){var a=u.$scope;a.rawData&&a.rawData.$detail&&a.rawData.$detail.text&&a.$emit("aliyunBuyEcsBatchView:changedContent",a.rawData.$detail.text)}}}];return r}),define("ecsbuy/console/models/changeOs/ecs.buy.changeOs.options.biz",["require","exports","common/modelSystem/modelFactory","../../../base/helpers/buyBizHelper","../constraints/changeOs/changeOsOptionsImageDetailConstaintFn","../constraints/changeOs/changeOsOptionsMarketImageDetailConstraint","../../../base/models/constraints/fieldDynamicTipConstraintsFn","../../../base/helpers/imageHelper","../../../base/cons/buyBizCons","../../../base/helpers/buyUtils","../../../base/helpers/homeConfigHelper"],function(e,t,n,r,i,s,o,u,a,f,l){n.regist("ecs.buy.changeOs.options.biz","BizModel",["$state","$injector","$rootScope","aliyunBuyEcsRemoteService","$timeout","modelFactory",function(e,t,n,c,h,p){var d=p.getModel("ecs.buy.changeOs.biz","BizModel"),v={id:"ecsChangeOsOptions",fields:[{id:"customConfig",initData:{},controller:function(e,t,n,r){n.hide()}},{id:"setupPassword",initData:{options:{items:[]}},constraints:[o("setupPasswordConstraint",["setupPassword"],{translateValues:[l.HomeConfigHelper.getUrlConfig("keypairHelper")]}),{id:"keypairDiskplayConstraint",watches:["imageType","publicImage","sharedImage","customImage","marketImage","iooptimized"],action:function(e,t,n,r,i){var s=u.ImageHelper.getImageValue(r),o=[a.BuyBizCons.SETTING_PASSWORD_NOW_ITEM,a.BuyBizCons.SETTING_PASSWORD_LATER_ITEM],l=r.getFieldValueById("iooptimized");s&&s.osKind=="linux"&&l=="optimized"&&(o=[a.BuyBizCons.SETTING_KEYPAIR_ITEM].concat(o)),o.length>1?(n.show(),n.setOptionsAttr("items",o),n.setFieldValue(f.BuyUtils.getMapProperty(a.BuyBizCons.SETTING_KEYPAIR_ITEM,"value"))):o.length==1&&(n.hide(),n.setFieldValue(f.BuyUtils.getMapProperty(o,"0.value")))}}]}]};return r.BuyBizHelper.extendConstrainsForBizModel(d,{publicImage:i("public"),customImage:i("custom"),sharedImage:i("shared"),marketImage:s}),r.BuyBizHelper.extendFieldModelNew(v,d,null,["systemdisk_category","systemdisk_size"])}])}),define("ecsbuy/console/models/changeOs/ecs.buy.changeOs.options.ui",["require","exports","angular","common/modelSystem/modelFactory","./uiModel/commonUi","./uiModel/instanceDetailUi","./uiModel/securityConfigUi"],function(e,t,n,r,i,s,o){var u=[].concat(s,i,o);n.forEach(u,function(e,t){var n=e.type,r=e.groupClass;n=="group"&&r=="bk-group-pt30"&&(e.groupClass="bk-group-pt0")}),r.regist("ecs.buy.changeOs.options.ui","BuyUiModel",{id:"ecsChangeOsOptions",fields:u})}),define("ecsbuy/console/models/base/batchActionClass/EcsBaseBatchAction",["require","exports","common/helper/i18nHelper","../../../../base/helpers/buyUtils","../../../../base/helpers/errorCodeHelper"],function(e,t,n,r,i){var s=function(){function e(e){this.$injector=e}return e.prototype.validateBatchInfo=function(e){return!0},e.prototype.errorHandlerCallback=function(e){var t=this;i.ErrorCodeHelper.amendErrorMessage(e);var r=e&&e.message||n.i18n("ecs.buy.console.error_desc"),s=t.$injector.get("aliyunBuyMsg"),o=t.$injector.get("aliyunBuyEcsDialogButtonConfigService");switch(e&&e.code){case"ConsoleNeedLogin":s.dialog(n.i18n("ECS_PROMPT"),r,o.login());break;default:s.dialog(n.i18n("ecs.buy.console.error_title"),r,o.refresh())}},e.prototype.queryBatchInfos=function(){var e=this,t=e.$injector.get("aliyunBuyEcsRemoteService"),n=e.$injector.get("$q"),r=n.defer(),i=r.promise,s=e.getBatchInfoParams(),o=e.getQueryBatchInfoService();return angular.isFunction(o)?o(s).then(function(t){angular.isFunction(e.validateBatchInfo)&&!e.validateBatchInfo(t)&&r.notify("batch info validate failed"),r.resolve(t)},function(t){e.errorHandlerCallback(t)}):r.notify("queryBatchInfos service no valid"),i},e.prototype.queryComponents=function(){var e=this,t=e.$injector.get("aliyunBuyEcsRemoteService"),n=e.$injector.get("$q"),r=n.defer(),i=r.promise,s=e.getComponentsParams();return t&&t.getComponents(s).then(function(e){r.resolve(e)},function(t){e.errorHandlerCallback(t)}),i},e.prototype.getQueryBatchInfoService=function(){var e=this,t=e.$injector.get("aliyunBuyEcsRemoteService");return t.queryEcsInstanceInfo},e.prototype.getBatchInfoParams=function(){},e.prototype.getComponentsParams=function(){return{commodityCode:"vm",orderType:"BUY"}},e.prototype.showBatchDialog=function(e){},e.prototype.isInvalidInfo=function(e){return},e.prototype.queryPrice=function(e){var t=this.$injector.get("aliyunBuyEcsRemoteService"),n=this.$injector.get("base64"),r={data:n.encode(angular.toJson(e))};return t&&t.describePrice4Subtotal(r)},e.prototype.getQueryPriceParams=function(e,t,n){},e.prototype.beforeQueryPrice=function(e){return!0},e.prototype.formatQueryPriceResponse=function(e,t,n,r){return e},e.prototype.batchSubmit=function(e,t,n){var r=this.$injector.get("$rootScope");r.$broadcast("aliyunBuyBatchAction:submit",e,t,n)},e.prototype.beforeBatchSubmit=function(){return!0},e.prototype.convertToBindFn=function(e){if(!e)return null;var t=this;return function(){var n=Array.prototype.slice.call(arguments);return e.apply(t,n)}},e.prototype.getUniqueId=function(e){return r.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.instanceId")},e.prototype.getBatchOperationTitle=function(){return n.i18n("ecs.buy.console.batch.table.th.batch_edit")},e.prototype.makeBatchActionFactory=function(){var e={queryService:{getBatchInfoParams:this.convertToBindFn(this.getBatchInfoParams),queryBatchInfos:this.convertToBindFn(this.queryBatchInfos),queryComponents:this.convertToBindFn(this.queryComponents)},priceService:{getQueryPriceParams:this.convertToBindFn(this.getQueryPriceParams),formatQueryPriceResponse:this.convertToBindFn(this.formatQueryPriceResponse),queryPrice:this.convertToBindFn(this.queryPrice),beforeQueryPrice:this.convertToBindFn(this.beforeQueryPrice)},submitService:{batchSubmit:this.convertToBindFn(this.batchSubmit),beforeBatchSubmit:this.convertToBindFn(this.beforeBatchSubmit)},getBatchOperationTitle:this.convertToBindFn(this.getBatchOperationTitle),showBatchDialog:this.convertToBindFn(this.showBatchDialog),isInvalidInfo:this.convertToBindFn(this.isInvalidInfo),getUniqueId:this.convertToBindFn(this.getUniqueId)};return e},e}();t.EcsBaseBatchAction=s});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/console/models/changeOs/ecs.buy.changeOs.batch.action",["require","exports","common/modelSystem/modelFactory","common/helper/i18nHelper","../base/batchActionClass/EcsBaseBatchAction","../../../base/helpers/buyUtils","../../cons/cons"],function(e,t,n,r,i,s,o){var u=function(e){function t(t){e.call(this,t)}return __extends(t,e),t.prototype.getBatchOperationTitle=function(){return r.i18n("ecs.buy.console.batch.table.th.change_os")},t.prototype.showBatchDialog=function(e){var t=this.$injector.get("aliyunDialog"),n=o.ConsoleConstant.PARTIALS_PATH+"changeOs/dialog/batchChangeOsDialog.html",r=e.activeBatchInfoIds;r instanceof Array&&r.length>0&&t.showDialogByUrl(n,function(e){e.instanceId=r[0],e.submit=function(){e.$emit("aliyunBuyEcsChangeOsOptions:exportOptions")},e.$on("aliyunBuyEcsChangeOsOptions:saveOptions",function(t,n){e.$emit("aliyunBuyEcsBatchView:saveOptions",n),e.close()})},{windowClass:"batch-changeOs-dialog dialog-size-bg"})},t.prototype.isInvalidInfo=function(e){var t=s.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.status");if(["Shutted","Stopped"].indexOf(t)==-1)return r.i18n("ecs.buy.console.batch.change_os.invalid_msg.is_stopped")},t.prototype.getBatchInfoParams=function(){var e=this.$injector.get("modelSystemCacheContextService"),t=e.getCacheContext("ecs.buy.changeOs.batch.bizModel.cacheContext").get("changeOsCache.instanceIds");return{orderType:"CHANGEOS",instanceIds:t.join(",")}},t}(i.EcsBaseBatchAction);n.regist("ecs.buy.changeOs.batchActionModel","BizModel",["$injector",function(e){var t=new u(e);return t.makeBatchActionFactory()}])});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/console/models/base/batchActionClass/EcsInstanceBatchUi",["require","exports","common/helper/i18nHelper","./EcsBaseBatchUi","../../../../base/helpers/buyUtils","../../../../base/helpers/commodityHelper","../../../../base/helpers/dateParseHelper"],function(e,t,n,r,i,s,o){var u=function(e){function t(t){e.call(this,t)}return __extends(t,e),t.prototype.getHeadsTemplateMap=function(e,r,i){var s=this,o=t;return{instanceName:{text:n.i18n("ecs.buy.console.batch.table.th.instance_name")},ip:{text:n.i18n("ecs.buy.console.batch.table.th.ip")},expireDate:{text:n.i18n("ecs.buy.console.batch.table.th.expire_date")},instanceType:{text:n.i18n("ecs.buy.console.batch.table.th.instanceType")},bandwidth:{html:o.generateBandwidthHeadHtml(e,r),bindScope:i.scope},internetChargeType:{text:n.i18n("ecs.buy.console.batch.table.th.internetChargeType")},osName:{text:n.i18n("ecs.buy.console.batch.table.th.os_name")},price:{text:n.i18n("ecs.buy.console.batch.table.th.price")},action:{text:n.i18n("ecs.buy.console.batch.table.th.action")},batchAction:{html:o.generateBatchActionHeadHtml(e,r),bindScope:i.scope},reason:{text:n.i18n("ecs.buy.console.batch.table.th.reason")}}},t.prototype.getColItemsTemplateMap=function(e,n,r,i){var s=this,o=t;return{instanceName:{html:o.generateInstanceNameItemHtml(e,r),bindScope:i.scope},ip:{html:o.generateIpItemHtml(e,r),bindScope:i.scope},expireDate:{html:o.generateExpireDateItemHtml(e,r),bindScope:i.scope},instanceType:{html:o.generateInstanceTypeItemHtml(e,r),bindScope:i.scope},bandwidth:{html:s.generateBandwidthItemHtml(e,r),bindScope:i.scope},internetChargeType:{html:o.generateInternetChargeTypeItemHtml(e,r),bindScope:i.scope},osName:{html:o.generateOsNameItemHtml(e,r),bindScope:i.scope},action:{html:o.generateActionItemHtml()},batchAction:{html:o.generateBatchActionItemHtml(),bindScope:i.scope},reason:{html:o.generateInvalidReasonItemHtml(e,r),bindScope:i.scope}}},t.generateBandwidthHeadHtml=function(e,t){var r=this,s=!1;return e instanceof Array&&angular.forEach(e,function(e,t){var n=i.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.vm_bandwidth.0.vm_bandwidth"),o=i.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.baseBandWidth");r.isBandwidthUpgrade(n,o)&&(s=!0)}),s?["<span>"+n.i18n("ecs.buy.console.batch.table.th.bandwidth_current_and_base")+"</span>"].join(""):["<span>"+n.i18n("ecs.buy.console.batch.table.th.bandwidth")+"</span>"].join("")},t.generateBatchActionHeadHtml=function(e,t){return["<span >{{viewModel.batchOperationTitle}}</span>",'<button class="btn btn-xs btn-primary margin-left-1" ng-click="viewModel.change()" ng-bind="\'ecs.buy.console.batch.table.th.batch_edit\'|translate">'," </button>"].join("")},t.generateInstanceNameItemHtml=function(e,t){var n=i.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.instanceName"),r=i.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.instanceId"),o=i.BuyUtils.getMapProperty(t,"vm_region_no.vm_region_no"),u=i.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.regionId"),a=(n||"-")+" / "+(r||"-"),f=s.CommodityHelper.getTextFromCollection(u,o)||"-";return['<strong aliyun-truncate-text source-text="'+a+'" text-length="23" copy-text="true"></strong><br/>',"<span>"+f+"</span>"].join("")},t.generateIpItemHtml=function(e,t){var n=i.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.vmPublicIp"),r=i.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.eipAddress"),s=i.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.vmPrivateIp"),o=n||r||"-",u=s||"-";return["<span>"+o+'</span><span class="text-muted" ng-bind="\'ecs.buy.console.batch.table.td.ip_internet\' | translate"></span><br/>',"<span>"+u+"</span><span ng-bind=\"'ecs.buy.console.batch.table.td.ip_intranet'| translate\"></span>"].join("")},t.generateExpireDateItemHtml=function(e,t){var n=i.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.instanceExpireTime"),r=o.DateParseHelper.format(n,"yyyy-MM-dd hh:mm")||"-";return["<span>"+r+"</span>"].join("")},t.generateInstanceTypeItemHtml=function(e,t){var n=this,r=i.BuyUtils.getMapProperty(t,"instance_type"),o=i.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.instance_type.0"),u=s.CommodityHelper.getTextFromCollection(o.instance_generation,r.instance_generation),a=s.CommodityHelper.getTextFromCollection(o.instance_type,r.instance_type),f=s.CommodityHelper.getTextFromCollection(o.instance_type_family,r.instance_type_family),l=a+n.wrapByparentheses(o.instance_type),c=u+","+f;return["<span>"+l+"</span><br/>","<span >"+c+"</span>"].join("")},t.prototype.generateBandwidthItemHtml=function(e,r){var s=this,o=t,u=i.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.vm_bandwidth.0.vm_bandwidth"),a=i.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.baseBandWidth"),f=s.$injector.get("$filter"),l=f("aliyunBuyEcsShowComponent")(u,"bandwidth"),c=f("aliyunBuyEcsShowComponent")(a,"bandwidth");return o.isBandwidthUpgrade(u,a)?["<span>"+l+'</span><span class="text-muted">'+n.i18n("ecs.buy.console.batch.table.td.bandwidth_current")+"</span><br/>","<span>"+c+'</span><span class="text-muted" >'+n.i18n("ecs.buy.console.batch.table.td.bandwidth_base")+"</span>"].join(""):["<span>"+l+"</span>"].join("")},t.generateInternetChargeTypeItemHtml=function(e,t){var n=this,r=i.BuyUtils.getMapProperty(t,"vm_bandwidth"),o=i.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.vm_bandwidth.0"),u=s.CommodityHelper.getTextFromCollection(o.vm_is_flow_type,r.vm_is_flow_type);return["<span>"+u+"</span>"].join("")},t.generateOsNameItemHtml=function(e,t){var n=this,r=i.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.osName")||"-";return['<strong aliyun-truncate-text source-text="'+r+'" text-length="20" copy-text="true"></strong>'].join("")},t.generateInvalidReasonItemHtml=function(e,t){var n=i.BuyUtils.getMapProperty(e,"_invalidMsg")||"-";return['<strong aliyun-truncate-text source-text="'+n+'" text-length="20" copy-text="true"></strong>'].join("")},t.generateActionItemHtml=function(){return'<a href="javascript:;" ng-click="remove(viewInfoIndex)" ng-bind="\'ecs.buy.console.batch.table.td.action_del\'|translate"></a>'},t.generateBatchActionItemHtml=function(){return'<strong aliyun-truncate-text source-text="{{viewModel.changedContent || \'-\'}}" text-length="20" copy-text="true" ></strong>'},t.isBandwidthUpgrade=function(e,t){return e!=t},t.wrapByparentheses=function(e){return"%s".replace("%s",e)},t}(r.EcsBaseBatchUi);t.EcsInstanceBatchUi=u});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/console/models/changeOs/ecs.buy.changeOs.batch.ui",["require","exports","common/modelSystem/modelFactory","../base/batchActionClass/EcsInstanceBatchUi","../base/batchActionClass/EcsBaseBatchUi"],function(e,t,n,r,i){var s=function(e){function t(t){e.call(this,t)}return __extends(t,e),t.prototype.getTemplateKeys=function(e){return e==i.BatchUiNamespace.invalid?["instanceName","ip","expireDate","instanceType","osName","reason"]:["instanceName","ip","expireDate","instanceType","bandwidth","batchAction","osName","action"]},t}(r.EcsInstanceBatchUi);n.regist("ecs.buy.changeOs.batchUiModel","BizModel",["$injector",function(e){var t=new s(e);return t.makeBatchUiFactory()}])}),define("ecsbuy/console/models/changeOs/_base",["require","exports","./ecs.buy.changeOs.ui","./ecs.buy.changeOs.biz","./ecs.buy.changeOs.options.biz","./ecs.buy.changeOs.options.ui","./ecs.buy.changeOs.batch.action","./ecs.buy.changeOs.batch.ui"],function(e,t){});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/console/models/changeBandwidth/ecs.buy.changeBandwidthPayByTraffic.batch.action",["require","exports","common/modelSystem/modelFactory","common/helper/i18nHelper","../base/batchActionClass/EcsBaseBatchAction","../../../base/helpers/buyUtils","../../cons/cons"],function(e,t,n,r,i,s,o){var u=function(e){function t(t){e.call(this,t)}return __extends(t,e),t.prototype.getBatchOperationTitle=function(){return r.i18n("ecs.buy.console.batch.change_bandwidth")},t.prototype.getComponentsParams=function(){return{commodityCode:"ecs",orderType:"BUY"}},t.prototype.showBatchDialog=function(e){var t=this.$injector.get("aliyunDialog"),n=o.ConsoleConstant.PARTIALS_PATH+"changeBandwidth/dialog/batchChangeBandwidthPayByTrafficDialog.html",r=e.activeBatchInfoIds;r instanceof Array&&r.length&&t.showDialogByUrl(n,function(e){e.instanceId=r[0],e.submit=function(){e.$emit("aliyunBuyEcsChangeBandwidthOptions:exportOptions")},e.$on("aliyunBuyEcsChangeBandwidthOptions:saveOptions",function(t,n){e.$emit("aliyunBuyEcsBatchView:saveOptions",n),e.close()})},{windowClass:"dialog-size-bg"})},t.prototype.isInvalidInfo=function(e){var t=s.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.chargeType"),n=s.BuyUtils.getMapProperty(e,"instanceDetail.orderInfo.vm_web_type"),i=s.BuyUtils.getMapProperty(e,"instanceDetail.instanceInfo.eipAddress");if(["PostPaid","AfterPay"].indexOf(t)==-1)return r.i18n("ecs.buy.console.batch.change_bandwidth.invalid_msg.is_prepaid");if(i)return r.i18n("ecs.buy.console.batch.change_bandwidth.invalid_msg.eip")},t.prototype.getBatchInfoParams=function(){var e=this.$injector.get("modelSystemCacheContextService"),t=e.getCacheContext("ecs.buy.changeBandwidth.batch.bizModel.cacheContext").get("changeBandwidthCache.instanceIds");return{orderType:"UPGRADE",instanceIds:t.join(",")}},t}(i.EcsBaseBatchAction);n.regist("ecs.buy.changeBandwidthPayByTraffic.batchActionModel","BizModel",["$injector",function(e){var t=new u(e);return t.makeBatchActionFactory()}])});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/console/models/changeBandwidth/ecs.buy.changeBandwidth.batch.ui",["require","exports","common/modelSystem/modelFactory","../base/batchActionClass/EcsInstanceBatchUi","../base/batchActionClass/EcsBaseBatchUi"],function(e,t,n,r,i){var s=function(e){function t(t){e.call(this,t)}return __extends(t,e),t.prototype.getTemplateKeys=function(e){return e==i.BatchUiNamespace.invalid?["instanceName","ip","instanceType","internetChargeType","reason"]:["instanceName","ip","instanceType","internetChargeType","bandwidth","batchAction","action"]},t}(r.EcsInstanceBatchUi);n.regist("ecs.buy.changeBandwidth.batchUiModel","BizModel",["$injector",function(e){var t=new s(e);return t.makeBatchUiFactory()}])}),define("ecsbuy/console/models/changeBandwidth/ecs.buy.changeBandwidth.options.ui",["require","exports","common/modelSystem/modelFactory"],function(e,t,n){n.regist("ecs.buy.changeBandwidth.options.ui","BuyUiModel",{id:"ecsBuyChangeBandwidth",fields:[{id:"bandwidthConfig",type:"group",spmId:"bandwidth",groupStyle:"none",groupClass:"bk-group-pt0",children:[{id:"vm_is_flow_type",type:"newBrickTabs",fieldWraperCls:"bk-label-non",label:"",attributes:[]},{id:"vm_bandwidth",type:"buySliderWithNumber",attributes:[]}]}]})}),define("ecsbuy/base/models/constraints/bandwidth/bandwidthFormatValueConstraint",["require","exports"],function(e,t){var n={id:"bandwidthFormatValueConstraint",watches:["vm_is_flow_type"],action:function(e,t,n,r,i){n.setOptionsAttr("min",n.getOptionsAttr("min")/1024),n.setOptionsAttr("max",n.getOptionsAttr("max")/1024),n.setOptionsAttr("step",n.getOptionsAttr("step")/1024),n.setOptionsAttr("spm","type"+e)}};return n}),define("ecsbuy/console/models/constraints/changeBandwidth/changeBandwidthOptionsBandwidthDetailConstaint",["require","exports","../../../../base/helpers/buyBizHelper","../../../../base/helpers/commodityHelper","../../../../base/helpers/buyUtils"],function(e,t,n,r,i){var s={id:"changeBandwidthOptionsBandwidthDetailConstraint",watches:["vm_bandwidth","vm_is_flow_type"],action:function(e,t,s,o,u){if(e==undefined)return;var a=n.BuyBizHelper.getFieldValue("vm_is_flow_type",o),f=n.BuyBizHelper.getFieldValue("vm_bandwidth",o),l=o&&o.getOriginConstraintData(),c=i.BuyUtils.getMapProperty(l,"components.vm_bandwidth.vm_is_flow_type"),h=r.CommodityHelper.getTextFromCollection(a,c);s.$scope.$emit("aliyunBuyEcsBatchView:changedContent",f+"Mbps"+"("+h+")")}};return s}),define("ecsbuy/console/models/changeBandwidth/ecs.buy.changeBandwidth.options.biz",["require","exports","common/modelSystem/modelFactory","../../../base/helpers/buyUtils","../../../base/models/constraints/bandwidth/bandwidthFormatValueConstraint","../constraints/changeBandwidth/changeBandwidthOptionsBandwidthDetailConstaint"],function(e,t,n,r,i,s){n.regist("ecs.buy.changeBandwidth.options.biz","BizModel",["$state","$injector","$rootScope","aliyunBuyEcsRemoteService","$timeout","modelFactory",function(e,t,n,o,u,a){return{id:"changeBandwidthOptionsBiz",fields:[{id:"vm_is_flow_type",controller:function(e,t,n,i){var s=n.getDominator().getOriginConstraintData(),o=r.BuyUtils.getMapProperty(s,"instanceDetail.orderInfo.vm_bandwidth.0.vm_is_flow_type"),u=r.BuyUtils.getMapProperty(s,"components.vm_bandwidth.vm_is_flow_type");n.setFieldValue(o),n.setOptionsAttr("items",u)}},{id:"vm_bandwidth",initData:{options:{unit:"M",numberUnit:"Mbps"}},controller:function(e,t,n,i){var s=n.getDominator().getOriginConstraintData(),o=r.BuyUtils.getMapProperty(s,"instanceDetail.orderInfo.vm_bandwidth.0.vm_bandwidth");n.setFieldValue(o/1024)},constraints:[i,s]}]}}])}),define("ecsbuy/console/models/changeBandwidth/_base",["require","exports","./ecs.buy.changeBandwidthPayByTraffic.batch.action","./ecs.buy.changeBandwidth.batch.ui","./ecs.buy.changeBandwidth.options.ui","./ecs.buy.changeBandwidth.options.biz"],function(e,t){}),define("ecsbuy/console/models/release/ecs.buy.release.ui",["require","exports","common/modelSystem/modelFactory"],function(e,t,n){n.regist("ecs.buy.release.ui","BuyUiModel",{id:"ecsRelease",fields:[{id:"currentConfig",type:"group",groupStyle:"none",children:[{id:"customConfig",type:"customField",noLabel:!0,template:'<div aliyun-buy-ecs-instance-detail-new data="raw" ></div>'}]}]})}),define("ecsbuy/console/models/release/ecs.buy.release.biz",["require","exports","common/modelSystem/modelFactory","../../../base/helpers/buyBizHelper"],function(e,t,n,r){n.regist("ecs.buy.release.biz","BizModel",["$state","$injector","$rootScope","aliyunBuyEcsRemoteService","$timeout","modelFactory",function(e,t,n,i,s,o){var u=o.getModel("ecs.buy.biz","BizModel"),a={id:"ecsRelease",fields:[{id:"customConfig",initData:{},controller:function(e,t,n,i){var s=n.getDominator(),o=s.getOriginConstraintData();e.raw=o,r.BuyBizHelper.setFieldValue("customConfig",o,s)}}]};return r.BuyBizHelper.extendFieldModelNew(a,u,[])}])}),define("ecsbuy/console/models/release/_base",["require","exports","./ecs.buy.release.ui","./ecs.buy.release.biz"],function(e,t){}),define("ecsbuy/console/models/renew/ecs.buy.renew.ui",["require","exports","common/modelSystem/modelFactory","common/helper/i18nHelper"],function(e,t,n,r){n.regist("ecs.buy.renew.ui","BuyUiModel",{id:"ecsRenew",fields:[{id:"regionConfig",type:"group",groupStyle:"none",children:[{id:"vm_region_no",type:"customField",template:"<div aliyun-buy-buttontab-with-select parent-value='rawData.vm_region_no' child-value='rawData.vm_iz' options='options' ng-model='rawData.vm_region_no'></div>",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]}]},{id:"currentConfig",type:"group",groupStyle:"none",children:[{id:"customConfig",type:"customField",noLabel:!0,template:'<div aliyun-buy-ecs-instance-detail-new data="raw" ></div>'}]},{id:"amountConfig",type:"group",spmId:"quantity",groupStyle:"none",groupClass:"bk-group-pt30",children:[{id:"order_time",type:"newBrickTabs",label:r.i18n("ecs.buy.label.order_time"),attributes:[]}]}]})}),define("ecsbuy/console/models/constraints/renew/renewTipConstraint",["require","exports","../../../helpers/renewHelper","../../../../base/helpers/dateParseHelper","common/helper/i18nHelper","../../../../base/helpers/buyUtils","../../../helpers/commonConsoleHelper"],function(e,t,n,r,i,s,o){var u={id:"RenewTipConstraint",watches:["order_time"],action:function(e,t,u,a,f){if(!!e){var l=a.getOriginConstraintData(),c=n.RenewHelper.getRenewStartTime(l),h=n.RenewHelper.calculateNewExpirationTime(e,c),p=s.BuyUtils.getMapProperty(l,"instanceDetail.orderInfo.vm_os.0.vm_os_imageProductCode"),d=s.BuyUtils.getMapProperty(l,"instanceDetail.instanceInfo.marketImageChargeType"),v=s.BuyUtils.getMapProperty(l,"instanceDetail.instanceInfo.marketImageStatus"),m=i.i18n("ECS_RENEW_EXPIRE_TIME",r.DateParseHelper.format(h,null)),g=i.i18n("ECS_RENEW_BANDWIDTH_PRICE_TIP"),y="";p&&o.CommonConsoleHelper.isImagePrepay(d)&&o.CommonConsoleHelper.isImageOnSale(v)&&(y="<br/>"+i.i18n("ECS_RENEW_IMAGE_TIP")),u.setOptionsAttr("tip",m+"<br/>"+g+y)}}};return u}),define("ecsbuy/console/models/renew/ecs.buy.renew.biz",["require","exports","common/modelSystem/modelFactory","../../../base/helpers/buyBizHelper","../../../base/cons/buyBizCons","../../../base/helpers/commodityHelper","../../../base/models/constraints/amount/orderTimeConstraints","../../../base/models/constraints/amount/discountTipConstraints","../constraints/renew/renewTipConstraint","../../../base/helpers/buyUtils","../../helpers/instanceDetailHelper"],function(e,t,n,r,i,s,o,u,a,f,l){n.regist("ecs.buy.renew.biz","BizModel",["$state","$injector","$rootScope","aliyunBuyEcsRemoteService","$timeout","modelFactory",function(e,t,n,c,h,p){var d=p.getModel("ecs.buy.biz","BizModel"),v={id:"ecsRenew",fields:[{id:"vm_region_no",initData:{},controller:function(e,t,n,r){n.hide();var i=n.getDominator(),s=i.getOriginConstraintData(),o=f.BuyUtils.getMapProperty(s,"instanceDetail.instanceInfo.regionId");n.setFieldValue(o)},constraints:[]},{id:"customConfig",initData:{},controller:function(e,t,n,r){var i=n.getDominator();e.raw=i.getOriginConstraintData()}},{id:"order_time",initData:{options:{spm:"duration-",theme:"mini",items:i.BuyBizCons.DEFAULT_ORDERTIME_ITEMS}},controller:function(e,t,n,r){n.setFieldValue("12");var o=n.getDominator().getOriginConstraintData(),u=s.CommodityHelper.getOrderTimeOptionsItems(o);u instanceof Array&&u.length>0&&n.setOptionsAttr("items",u);var a=s.CommodityHelper.getCommodityCode(o);a=="vm"?n.show():n.hide();var f=n.getOptionsAttr("items"),c=l.InstanceDetailHelper.isWeekly(o);c&&s.CommodityHelper.addItemToCollection(i.BuyBizCons.DURATION_WEEK_ITEM,f,"value",0),n.setOptionsAttr("items",f)},constraints:[o,u,a]}]};return r.BuyBizHelper.extendFieldModelNew(v,d,[],null)}])}),define("ecsbuy/console/models/renew/_base",["require","exports","./ecs.buy.renew.ui","./ecs.buy.renew.biz"],function(e,t){}),define("ecsbuy/console/models/constraints/downgrade/downgradeBandwidthTipConstraint",["require","exports","../../../helpers/instanceDetailHelper","common/helper/i18nHelper"],function(e,t,n,r){var i={id:"downgradeBandwithTipConstraint",watches:["vm_bandwidth"],action:function(e,t,i,s,o){var u=s.getOriginConstraintData(),a=n.InstanceDetailHelper.getBaseBandwidthValue(u),f=n.InstanceDetailHelper.getMaxBandwidthValue(u),l="";f&&f>a&&(l=r.i18n("TIP__TEXT__BANDWIDTH_UPGRADE_TEMP_4_DOWNGRADE")),e===0&&(l+=r.i18n("TIP__TEXT__BANDWIDTH_UPGRADE_0")),i.setOptionsAttr("tip",l)}};return i}),define("ecsbuy/console/models/constraints/downgrade/downgradeDatadiskConvertTipConstraint",["require","exports","../../../../base/helpers/buyTipsHelper","../../../../base/helpers/homeConfigHelper","../../../../base/helpers/orderDataHelper"],function(e,t,n,r,i){var s={id:"downgradeDatadiskConvertTipConstraint",watches:["datadisk"],action:function(e,t,s,o,u){var a=o.getOriginConstraintData();if(e){var f=i.OrderDataHelper.getConvertSelectedDiskId(e);if(f&&f.length>0){var l=n.BuyTipsHelper.getBlockTip("convert_to_postpay_disk"),c=n.BuyTipsHelper.getBlockTip("postpay_disk",[r.HomeConfigHelper.getUrlConfig("datadiskPostpayReleaseRule"),"_blank"]),h=[l,c],p=h.join("<br/>");s.setOptionsAttr("tip",p)}}}};return s}),define("ecsbuy/console/models/constraints/downgrade/downgradeBandwidthRangeFormatConstraint",["require","exports","../../../helpers/instanceDetailHelper","../../../../base/helpers/commodityHelper"],function(e,t,n,r){var i={id:"DowngradeBandwidthRangeFormatConstraint",watches:["vm_is_flow_type"],action:function(e,t,i,s,o){var u=s.getOriginConstraintData(),a=n.InstanceDetailHelper.getBaseBandwidthValue(u),f=r.CommodityHelper.getBandwidthType(e);f=="PayByBandwidth"?i.setOptionsAttr("max",a/1024):i.setOptionsAttr("max",i.getOptionsAttr("max")/1024),i.setOptionsAttr("min",i.getOptionsAttr("min")/1024),i.setOptionsAttr("step",i.getOptionsAttr("step")/1024),i.setOptionsAttr("spm","type"+e)}};return i}),define("ecsbuy/console/models/downgrade/ecs.buy.downgrade.biz",["require","exports","angular","common/modelSystem/modelFactory","common/helper/i18nHelper","../../../base/models/constraints/datadiskConstraints","../constraints/downgrade/downgradeBandwidthTipConstraint","../../../base/models/constraints/bandwidth/bandwidthTypeTipConstraints","../constraints/downgrade/downgradeDatadiskConvertTipConstraint","../constraints/downgrade/downgradeBandwidthRangeFormatConstraint","../../../base/helpers/buyBizHelper","../../../base/helpers/buyTipsHelper","../../../base/helpers/commodityHelper","../../../base/cons/buyBizCons","../../../base/helpers/buyUtils","../../helpers/instanceDetailHelper","../../../base/helpers/diskHelper","../../helpers/commonConsoleHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){r.regist("ecs.buy.downgrade.biz","BizModel",["$state","$injector","$rootScope","aliyunBuyEcsRemoteService","$timeout","modelFactory",function(e,t,r,y,b,w){var E=w.getModel("ecs.buy.biz","BizModel"),S={id:"ecsBuyDowngrade",fields:[{id:"customConfig",initData:{},controller:function(e,t,n,r){e.raw=n.getDominator().getOriginConstraintData()}},{id:"downgradeIntro",controller:function(e,t,n,r){e.options={items:[{html:"1. "+i.i18n("REFUND_TIP")},{html:"2. "+i.i18n("DOWNGRADE_NOW_STATUS_TIP")},{html:"3. "+i.i18n("DOWNGRADE_NOW_FREQUENCE_TIP")},{html:"4. "+i.i18n("NO_POUNDAGE_TIP")}]}}},{id:"chargeType",initData:{options:{items:p.BuyBizCons.CHARGE_TYPE_ITEMS}},controller:function(e,t,n,r){n.hide();var i=n.getDominator(),s=i.getOriginConstraintData(),o=d.BuyUtils.getMapProperty(s,"instanceDetail.instanceInfo.chargeType"),u=p.BuyBizCons.CHARGE_TYPE_MAP_REVERT[o];n.setFieldValue(u)}},{id:"vm_region_no",controller:function(e,t,n,r){n.hide();var i=n.getDominator(),s=i.getOriginConstraintData(),o=d.BuyUtils.getMapProperty(s,"instanceDetail.orderInfo.vm_region_no");n.setFieldValue(o)}},{id:"vm_web_type",initData:{},controller:function(e,t,n,r){n.hide();var i=n.getDominator(),s=i.getOriginConstraintData(),o=d.BuyUtils.getMapProperty(s,"instanceDetail.orderInfo.vm_web_type");n.setFieldValue(o)}},{id:"instance_type",initData:{options:{theme:"remarkClass",transclude:!0}},controller:function(e,t,n,r){var i=n.getDominator(),s=i.getOriginConstraintData(),o=v.InstanceDetailHelper.getInstanceType(s),u=v.InstanceDetailHelper.getIsLocalOfSystemDisk(s);u&&n.hide(),n.setFieldValue(o)}},{id:"vm_bandwidth",initData:{options:{unit:"M",numberUnit:"Mbps"}},controller:function(e,t,n,r){var i=n.getDominator(),s=i.getOriginConstraintData(),o=v.InstanceDetailHelper.getBaseBandwidthValue(s),u=h.CommodityHelper.getBandwidthType(v.InstanceDetailHelper.getBandwidthTypeValue(s)),a=v.InstanceDetailHelper.getEipInstanceId(s),f=v.InstanceDetailHelper.getPublicIp(s);(a||!f&&!a||u=="PayByTraffic")&&n.hide(),n.setFieldValue(o/1024)},constraints:[o,f]},{id:"vm_is_flow_type",initData:{spm:"type",options:{askTip:c.BuyTipsHelper.getAskTip("bandwidth")}},controller:function(e,t,n,r){var i=n.getDominator(),s=i.getOriginConstraintData(),o=h.CommodityHelper.getBandwidthType(v.InstanceDetailHelper.getBandwidthTypeValue(s)),u=v.InstanceDetailHelper.getEipInstanceId(s),a=v.InstanceDetailHelper.getPublicIp(s);(u||!a&&!u||o=="PayByTraffic")&&n.hide(),n.setFieldValue(v.InstanceDetailHelper.getBandwidthTypeValue(s))},constraints:[u]},{id:"datadisk",initData:{spm:"type"},controller:function(e,t,r,i){var s=r.getDominator(),o=s.getOriginConstraintData(),u=v.InstanceDetailHelper.getDataDisk(o),a=[];n.forEach(u,function(e){if(g.CommonConsoleHelper.isPrepay(e.datadisk_chargeType)&&m.DiskHelper.inConvertableDiskCategory(e.datadisk_category)){var t=m.DiskHelper.covertDiskDataList(e);a.push(t)}}),b(function(){l.BuyBizHelper.setFieldValue("datadisk",n.toJson(a),s)},0),(!a||a.length==0)&&r.hide()},constraints:[s,a]}]};return S}])}),define("ecsbuy/console/models/downgrade/ecs.buy.downgrade.ui",["require","exports","common/modelSystem/modelFactory","common/helper/i18nHelper"],function(e,t,n,r){n.regist("ecs.buy.downgrade.ui","BuyUiModel",{id:"ecsBuyDowngrade",fields:[{id:"instanceDetail",type:"group",groupStyle:"none",children:[{id:"customConfig",type:"customField",fieldCls:"bk-pb5",noLabel:!0,template:'<div aliyun-buy-ecs-instance-detail-new data="raw" ></div>'}]},{id:"instanceTypeConfig",type:"group",spmId:"instanceType",groupClass:"bk-group-pt30",groupStyle:"none",children:[{id:"downgradeIntro",type:"customField",label:r.i18n("ecs.buy.console.downgradeNow.know"),template:'<div aliyun-buy-common-intro options="options"></div>'},{id:"instance_type",type:"newBrickRemarkTabs",label:r.i18n("ecs.buy.label.instanceType"),attributes:[]}]},{id:"diskConfig",type:"group",spmId:"disk",groupStyle:"none",children:[{id:"datadisk",type:"customField",label:r.i18n("ecs.buy.label.disk.data"),template:"<span  aliyun-buy-ecs-datadisk\n                        aliyun-buy-anchor=\"dominator:datadisk:anchor\"\n                        options='options'\n                        value='rawData.datadisk'\n                        ></span>"}]},{id:"bandwidthConfig",type:"group",spmId:"bandwidth",groupClass:"bk-group-pt5",groupStyle:"none",children:[{id:"vm_is_flow_type",type:"newBrickTabs",label:r.i18n("ecs.buy.label.bandwidth.type"),attributes:[]},{id:"vm_bandwidth",type:"buySliderWithNumber",label:r.i18n("ecs.buy.label.bandwidth"),attributes:[]}]},{id:"hideConfig",type:"group",groupStyle:"none",children:[{id:"chargeType",type:"buyText"},{id:"vm_region_no",type:"customField",template:"<div aliyun-buy-buttontab-with-select parent-value='rawData.vm_region_no' child-value='rawData.vm_iz' options='options' ng-model='rawData.vm_region_no'></div>",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]},{id:"vm_web_type",type:"newBrickTabs",fieldWraperCls:"bk-label-non",noLabel:!0}]}]})}),define("ecsbuy/console/models/downgrade/_base",["require","exports","./ecs.buy.downgrade.biz","./ecs.buy.downgrade.ui"],function(e,t){}),define("ecsbuy/console/models/constraints/downgrade/downgradeShowVmRestartSettingConstraint",["require","exports","../../../helpers/downgradeHelper"],function(e,t,n){var r={id:"downgradeVmRestartSettingShowConstraint",watches:["instance_type","vm_bandwidth","vm_web_type"],action:function(e,t,r,i,s){n.DownAndUpgradeHelper.isNeedToSetVmRestartTime(i)?r.show():(r.hide(),r.setFieldValue(undefined))}};return r}),define("ecsbuy/console/models/downgradeWithRenew/ecs.buy.downgradeWithRenew.biz",["require","exports","common/modelSystem/modelFactory","common/helper/i18nHelper","../../../base/helpers/buyBizHelper","../../../base/helpers/buyTipsHelper","../../../base/helpers/buyUtils","../../helpers/instanceDetailHelper","../constraints/downgrade/downgradeBandwidthTipConstraint","../../../base/models/constraints/bandwidth/bandwidthTypeTipConstraints","../constraints/downgrade/downgradeShowVmRestartSettingConstraint","../../../base/models/constraints/clearStateErrorConstraintsFn","../constraints/downgrade/downgradeBandwidthRangeFormatConstraint"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){n.regist("ecs.buy.downgradeWithRenew.biz","BizModel",["$state","$injector","$rootScope","aliyunBuyEcsRemoteService","$timeout","modelFactory",function(e,t,n,p,d,v){var m=v.getModel("ecs.buy.biz","BizModel"),g=v.getModel("ecs.buy.renew.biz","BizModel"),y=v.getModel("ecs.buy.downgrade.biz","BizModel"),b={id:"ecsBuyDowngradeWithRenew",fields:[{id:"downgradeWithRenewIntro",controller:function(e,t,n,i){e.options={items:[{html:"1. "+r.i18n("DOWNGRADE_WITH_RENEW_FREQUENCE_TIP")},{html:"2. "+r.i18n("DOWNGRADE_WITH_RENEW_INTRO_TIP")}]}}},{id:"vm_bandwidth",initData:{options:{unit:"M",numberUnit:"Mbps"}},controller:function(e,t,n,r){var i=n.getDominator(),s=i.getOriginConstraintData(),o=u.InstanceDetailHelper.getBaseBandwidthValue(s),a=u.InstanceDetailHelper.getEipInstanceId(s);a&&n.hide(),n.setFieldValue(o/1024)},constraints:[a,h]},{id:"vm_is_flow_type",initData:{spm:"type",options:{askTip:s.BuyTipsHelper.getAskTip("bandwidth")}},controller:function(e,t,n,r){var i=n.getDominator(),s=i.getOriginConstraintData(),o=u.InstanceDetailHelper.getEipInstanceId(s);o&&n.hide(),n.setFieldValue(u.InstanceDetailHelper.getBandwidthTypeValue(s))},constraints:[f]},{id:"vmRestartTime",initData:{spm:"vmRestartTime",options:{}},controller:function(e,t,n,i){var s=n.getDominator(),a=s.getOriginConstraintData();e.config={placeholder:r.i18n("ECS_VM_RESTART_TIME_PLACEHOLDER"),date:{showWeeks:!1,showButtonBar:!1},time:{showMeridian:!1,readonlyInput:!0,hideIncrementMinutes:!0}};var f=u.InstanceDetailHelper.getInstanceRenewRestartStartTime(a),l=u.InstanceDetailHelper.getInstanceRenewRestartEndTime(a);o.BuyUtils.hasUndefined(f,l)||(n.setOptionsAttr("min",f),n.setOptionsAttr("max",l),n.setOptionsAttr("hourStep",1),n.setOptionsAttr("minuteStep",60)),n.hide()},constraints:[l,c("vmRestartTime")]}]};return b=i.BuyBizHelper.extendFieldModelNew(b,g,["order_time"],null),b=i.BuyBizHelper.extendFieldModelNew(b,y,["customConfig","chargeType","vm_region_no","vm_web_type","instance_type","datadisk"],null),b}])}),define("ecsbuy/console/models/downgradeWithRenew/ecs.buy.downgradeWithRenew.ui",["require","exports","common/modelSystem/modelFactory","common/helper/i18nHelper"],function(e,t,n,r){n.regist("ecs.buy.downgradeWithRenew.ui","BuyUiModel",{id:"ecsBuyDowngradeWithRenew",fields:[{id:"instanceDetail",type:"group",groupStyle:"none",children:[{id:"customConfig",type:"customField",fieldCls:"bk-pb5",noLabel:!0,template:'<div aliyun-buy-ecs-instance-detail-new data="raw" ></div>'}]},{id:"instanceTypeConfig",type:"group",spmId:"instanceType",groupClass:"bk-group-pt30",groupStyle:"none",children:[{id:"downgradeWithRenewIntro",type:"customField",label:r.i18n("ecs.buy.console.downgradeNow.know"),template:'<div aliyun-buy-common-intro options="options"></div>'},{id:"instance_type",type:"newBrickRemarkTabs",label:r.i18n("ecs.buy.label.instanceType"),attributes:[]},{id:"vmRestartTime",type:"customField",label:r.i18n("ecs.buy.label.restart_time"),template:'<div aliyun-buy-ecs-date-time-picker \n                      aliyun-buy-anchor="dominator:vmRestartTime:anchor" \n                      options="options" config="config" value="rawData.vmRestartTime"></div>'}]},{id:"diskConfig",type:"group",spmId:"disk",groupStyle:"none",children:[{id:"datadisk",type:"customField",label:r.i18n("ecs.buy.label.disk.data"),template:"<span  aliyun-buy-ecs-datadisk\n                        aliyun-buy-anchor=\"dominator:datadisk:anchor\"\n                        options='options'\n                        value='rawData.datadisk'\n                        ></span>"}]},{id:"bandwidthConfig",type:"group",spmId:"bandwidth",groupClass:"bk-group-pt5",groupStyle:"none",children:[{id:"vm_is_flow_type",type:"newBrickTabs",label:r.i18n("ecs.buy.label.bandwidth.type"),attributes:[]},{id:"vm_bandwidth",type:"buySliderWithNumber",label:r.i18n("ecs.buy.label.bandwidth"),attributes:[]}]},{id:"amountConfig",type:"group",spmId:"quantity",groupStyle:"none",groupClass:"bk-group-pt30",children:[{id:"order_time",type:"newBrickTabs",label:r.i18n("ecs.buy.label.order_time"),attributes:[]}]},{id:"hideConfig",type:"group",groupStyle:"none",children:[{id:"chargeType",type:"buyText"},{id:"vm_region_no",type:"customField",template:"<div aliyun-buy-buttontab-with-select parent-value='rawData.vm_region_no' child-value='rawData.vm_iz' options='options' ng-model='rawData.vm_region_no'></div>",fieldWraperCls:"bk-label-non",noLabel:!0,attributes:[]},{id:"vm_web_type",type:"newBrickTabs",fieldWraperCls:"bk-label-non",noLabel:!0}]}]})}),define("ecsbuy/console/models/downgradeWithRenew/_base",["require","exports","./ecs.buy.downgradeWithRenew.biz","./ecs.buy.downgradeWithRenew.ui"],function(e,t){}),define("ecsbuy/console/models/constraints/upgrade/upgradeWithBandwidthTempUpgradeConstraints",["require","exports","../../../helpers/instanceDetailHelper"],function(e,t,n){var r={id:"upgradeWithBandwidthTempUpgradeConstraints",watches:["vm_bandwidth_switch"],action:function(e,t,r,i,s){var i=r.getDominator(),o=i.getOriginConstraintData(),u=n.InstanceDetailHelper.getEipInstanceId(o);u?r.hide():e?r.show():r.hide()}};return r}),define("ecsbuy/console/models/upgrade/ecs.buy.upgrade.biz",["require","exports","angular","common/modelSystem/modelFactory","common/helper/i18nHelper","../../../base/models/constraints/datadiskConstraints","../../../base/helpers/buyBizHelper","../../../base/helpers/buyTipsHelper","../../../base/helpers/commodityHelper","../../../base/helpers/buyUtils","../../helpers/instanceDetailHelper","../../../base/helpers/diskHelper","../constraints/upgrade/upgradeWithBandwidthTempUpgradeConstraints"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){r.regist("ecs.buy.upgrade.biz","BizModel",["$state","$injector","$rootScope","aliyunBuyEcsRemoteService","$timeout","modelFactory",function(e,t,r,p,d,v){return{id:"ecsBuyUpgrade",fields:[{id:"customConfig",initData:{},controller:function(e,t,n,r){e.raw=n.getDominator().getOriginConstraintData()}},{id:"upgradeDiscountIntro",controller:function(e,t,n,r){n.hide();var i=n.getDominator().getOriginConstraintData(),s=f.BuyUtils.getMapProperty(i,"config.hasUpgradeDiscount");s&&n.show()}},{id:"instance_type_tip",initData:{},controller:function(e,t,n,r){var i=n.getDominator().getOriginConstraintData(),s=l.InstanceDetailHelper.getIsLocalOfSystemDisk(i);s||n.hide()}},{id:"vm_region_no",controller:function(e,t,n,r){var i=n.getDominator().getOriginConstraintData(),s=a.CommodityHelper.getOrderInfo(i)||{};n.hide(),n.setFieldValue(s.vm_region_no)}},{id:"vm_iz",controller:function(e,t,n,r){var i=n.getDominator().getOriginConstraintData(),s=a.CommodityHelper.getOrderInfo(i)||{};n.hide(),n.setFieldValue(s.vm_iz)}},{id:"image_id",controller:function(e,t,n,r){var i=n.getDominator().getOriginConstraintData(),s=l.InstanceDetailHelper.getImageId(i);n.hide(),s&&n.setFieldValue(s)}},{id:"iooptimized",controller:function(e,t,n,r){var i=n.getDominator().getOriginConstraintData(),s=a.CommodityHelper.getOrderInfo(i)||{};n.hide(),n.setFieldValue(s.iooptimized)},constraints:[{id:"iooptimizedMigrateConstraints",watches:["upgrade_type"],action:function(e,t,n,r,i){d(function(){if(t==="upgrade_type")if(e=="migrate")n.setFieldValue("optimized");else{var i=r.getOriginConstraintData(),s=a.CommodityHelper.getOrderInfo(i)||{};n.setFieldValue(s.iooptimized)}})}}]},{id:"upgrade_type",initData:{},controller:function(e,t,n,r){n.setFieldValue("none");var i=n.getDominator(),s=i.getOriginConstraintData(),o=a.CommodityHelper.getOrderInfo(s)||{},u=l.InstanceDetailHelper.getInstanceVpcId(s),f=l.InstanceDetailHelper.getIoOptimized(s),c=l.InstanceDetailHelper.getOsKind(s),h=l.InstanceDetailHelper.getInstanceSystemdiskCategory(s),p=[o.vm_region_no,o.vm_iz,"migrate"].join("|"),d=l.InstanceDetailHelper.getUpgradeMigrateHasStock(s,p);u&&h!="cloud"||!(d&&d.length>0)?n.hide():n.show()},constraints:[{id:"upgradeTypeAndInstanceTypeConstraint",watches:["vm_region_no","vm_iz","iooptimized","image_id","instance_type_family"],action:function(e,t,n,r,i){var s=r.getFieldValueById("vm_region_no"),o=r.getFieldValueById("vm_iz"),u={},a=r.getOptionsFromConstraints("instance_type_family"),f=!1;a.forEach(function(e){u.instance_type_family=e.value,u.upgrade_type="migrate",u.vm_region_no=s,u.vm_iz=o;var t=r.getOptionsFromConstraints("instance_type",u);t.length>0&&(f=!0)}),f||n.hide()}}]},{id:"migrate_ip",initData:{options:{tip:i.i18n("ECS_UPGRADE_MIGRATE_IP_TIP")}},controller:function(e,t,n,r){e.readOnly=!1;var s=n.getDominator(),o=s.getOriginConstraintData(),u=l.InstanceDetailHelper.getInstanceSystemdiskCategory(o);u=="cloud"?(n.setOptionsAttr("tip",i.i18n("ECS_UPGRADE_MIGRATE_IP_TIP")+"<br />"+i.i18n("ECS_UPGRADE_MIGRATE_IP_AND_SYSTEM_DISK_CATEGORY_TIP")),e.display=i.i18n("ECS_UPGRADE_MIGRATE_IP_AND_SYSTEM_DISK_CATEGORY")):e.display=i.i18n("ECS_UPGRADE_MIGRATE_IP"),n.setFieldValue(!1)},constraints:[{id:"upgradeMigrateIpConstraints",watches:["upgrade_type"],action:function(e,t,n,r,i){var s=r.getOriginConstraintData(),o=l.InstanceDetailHelper.getInstanceVpcId(s);o?(n.setFieldValue(!0),n.hide()):e&&e=="migrate"?n.show():n.hide()}}]},{id:"systemdisk_category",initData:{options:{}},controller:function(e,t,n,r){},constraints:[{id:"upgradeMigrateConstraints",watches:["upgrade_type"],action:function(e,t,n,r,i){var s=r.getOriginConstraintData(),o=l.InstanceDetailHelper.getInstanceSystemdiskCategory(s);o!="cloud"?n.hide():e&&e=="migrate"?n.show():n.hide()}}]},{id:"instance_type_family",initData:{options:{spm:"family-"}},controller:function(e,t,n,r){var i=n.getDominator().getOriginConstraintData(),s=l.InstanceDetailHelper.getInstanceTypeFamily(i),o=l.InstanceDetailHelper.getIsLocalOfSystemDisk(i);o&&n.hide(),n.setFieldValue(s)},constraints:[{id:"instanceTypeFamilyFormatConstraint",watches:["vm_region_no","vm_iz","instance_type_family","iooptimized","upgrade_type"],action:function(e,t,r,i,s){var o=r.getField().getId(),u=i.getOptionsFromConstraints(o);if(!n.isArray(u))return;var f=i.getFieldValueById("vm_region_no"),l=i.getFieldValueById("vm_iz");for(var c=0;c<u.length;c++){var h=u[c],p={};p[o]=h.value,p.vm_region_no=f,p.vm_iz=l;var d=i.getOptionsFromConstraints("instance_type",p);if(!d||d.length==0)a.CommodityHelper.removeItemFromCollection(h.value,u),c--}r.setOptionsAttr("items",u)}}]},{id:"instance_type",initData:{options:{theme:"remarkClass",transclude:!0}},controller:function(e,t,n,r){var i=n.getDominator().getOriginConstraintData(),s=l.InstanceDetailHelper.getInstanceType(i),o=l.InstanceDetailHelper.getIsLocalOfSystemDisk(i);o&&n.hide(),n.setFieldValue(s)}},{id:"instance_type_reboot_notice",controller:function(e,t,n,r){n.hide()},constraints:[{id:"instanceTypeRebootNoticeConstraint",watches:["instance_type"],action:function(e,t,n,r,i){var s=r.getOriginConstraintData(),o=l.InstanceDetailHelper.getInstanceType(s);e!==o?n.show():n.hide()}}]},{id:"vm_bandwidth",initData:{options:{unit:"M",numberUnit:"Mbps",askTip:u.BuyTipsHelper.getAskTip("BANDWIDTH_TYPE")}},controller:function(e,t,n,r){var s=n.getDominator(),o=s.getOriginConstraintData(),u=l.InstanceDetailHelper.getBaseBandwidthValue(o),a=l.InstanceDetailHelper.getMaxBandwidthValue(o),f=l.InstanceDetailHelper.getEipInstanceId(o),c=l.InstanceDetailHelper.getPublicIp(o);f&&n.hide(),n.setFieldValue(u/1024),e.$watch("rawData.vm_bandwidth",function(e){var t="";a&&a>u&&(t=i.i18n("TIP__TEXT__BANDWIDTH_UPGRADE_TEMP")),e===0?t+=i.i18n("TIP__TEXT__BANDWIDTH_UPGRADE_0"):u==0&&!c&&(t+=i.i18n("TIP__TEXT__BANDWIDTH_UPGRADE_MORE")),n.setOptionsAttr("tip",t)})},constraints:[{id:"bandwidthFormatConstraint",watches:["vm_is_flow_type","instance_type"],action:function(e,t,n,r,i){var r=n.getDominator(),s=r.getOriginConstraintData(),o=l.InstanceDetailHelper.getBaseBandwidthValue(s),u=l.InstanceDetailHelper.getMaxBandwidthValue(s),f=u>o?u:o,c=a.CommodityHelper.getBandwidthType(e),h=a.CommodityHelper.getBandwidthType(l.InstanceDetailHelper.getBandwidthTypeValue(s));if(t=="instance_type"){var p=l.InstanceDetailHelper.getBandwidthInstanceTypeConstraint(s);if(!p)return}n.setOptionsAttr("max",n.getOptionsAttr("max")/1024),c=="PayByBandwidth"&&h!="PayByTraffic"?n.setOptionsAttr("min",f/1024):n.setOptionsAttr("min",n.getOptionsAttr("min")/1024),n.setOptionsAttr("step",n.getOptionsAttr("step")/1024),n.setOptionsAttr("spm","type"+e)}},h]},{id:"vm_is_flow_type",initData:{spm:"type",options:{askTip:u.BuyTipsHelper.getAskTip("bandwidth")}},controller:function(e,t,n,r){var i=n.getDominator(),s=i.getOriginConstraintData();n.setFieldValue(l.InstanceDetailHelper.getBandwidthTypeValue(s))},constraints:[h]},{id:"vm_bandwidth_history",initData:{},controller:function(e,t,n,r){var i=n.getDominator(),s=i.getOriginConstraintData(),o=l.InstanceDetailHelper.getEipInstanceId(s),u=l.InstanceDetailHelper.getPublicIp(s),f=a.CommodityHelper.getBandwidthType(l.InstanceDetailHelper.getBandwidthTypeValue(s));(o||!u&&!o||f=="PayByTraffic")&&n.hide(),e.instanceId=l.InstanceDetailHelper.getInstanceIdValue(s)},constraints:[{id:"vmBandwidthHistoryConstraints",watches:["vm_bandwidth_switch"],action:function(e,t,n,r,i){var r=n.getDominator(),s=r.getOriginConstraintData(),o=l.InstanceDetailHelper.getEipInstanceId(s),u=l.InstanceDetailHelper.getPublicIp(s),f=a.CommodityHelper.getBandwidthType(l.InstanceDetailHelper.getBandwidthTypeValue(s));o||!u&&!o||f=="PayByTraffic"?n.hide():e?n.show():n.hide()}}]},{id:"vm_bandwidth_switch",initData:{options:{askTip:u.BuyTipsHelper.getAskTip("bandwidth_type")},display:i.i18n("ECS_BANWIDTH_UPGRADE_FOREVER_INTRODUCE")},controller:function(e,t,n,r){var i=n.getDominator(),s=i.getOriginConstraintData(),o=l.InstanceDetailHelper.getEipInstanceId(s),u=l.InstanceDetailHelper.getPublicIp(s),f=a.CommodityHelper.getBandwidthType(l.InstanceDetailHelper.getBandwidthTypeValue(s));o?(n.setFieldValue(!1),n.hide()):f=="PayByTraffic"?(n.setFieldValue(!0),n.hide()):n.setFieldValue(!1)}},{id:"datadisk",initData:{spm:"type"},controller:function(e,t,r,i){var s=r.getDominator(),u=s.getOriginConstraintData(),a=l.InstanceDetailHelper.getDataDisk(u),f=[];n.forEach(a,function(e){if(e["datadisk_chargeType"]=="AfterPay"){var t=c.DiskHelper.covertDiskDataList(e);f.push(t)}}),d(function(){o.BuyBizHelper.setFieldValue("datadisk",n.toJson(f),s)},0),(!f||f.length==0)&&r.hide()},constraints:[s]}]}}])}),define("ecsbuy/console/models/upgrade/ecs.buy.upgrade.ui",["require","exports","common/modelSystem/modelFactory","common/helper/i18nHelper"],function(e,t,n,r){n.regist("ecs.buy.upgrade.ui","BuyUiModel",{id:"ecsBuyUpgrade",fields:[{id:"instanceDetail",type:"group",groupStyle:"none",children:[{id:"customConfig",type:"customField",fieldCls:"bk-pb5",noLabel:!0,template:'<div aliyun-buy-ecs-instance-detail-new data="raw" ></div>'}]},{id:"instanceTypeConfig",type:"group",spmId:"instanceType",groupClass:"bk-group-pt30",groupStyle:"none",children:[{id:"upgradeDiscountIntro",type:"customField",fieldWraperCls:"bk-form-row-pb0",label:"",template:'<div class="bk-form-row-cell bk-light-gray bk-form-row-txt bk-upgrade-intro"> <span class="bk-orange">50%</span></div>'},{id:"upgradeIntro",type:"customField",label:r.i18n("ecs.buy.label.upgrade_info"),template:'<div class="bk-form-row-cell bk-upgrade-intro">'+r.i18n("ECS_UPGRADE_TIP")+"</div>"},{id:"upgrade_type",clientField:!0,type:"newBrickTabs",label:r.i18n("ecs.buy.label.upgradeType"),attributes:[]},{id:"instance_type_family",clientField:!0,type:"newBrickTabs",label:r.i18n("ecs.buy.label.instanceType"),attributes:[]},{id:"instance_type_tip",clientField:!0,type:"customField",label:r.i18n("ecs.buy.label.instanceType"),template:'<div class="bk-form-row-cell bk-light-gray bk-form-row-txt bk-upgrade-instance-type-tip"><span ng-bind="\'ECS_NOT_ALLOW_UPGRADE_WHEN_LOCAL_SYSTEMDISK\'|translate"></span></div>'},{id:"image_id",type:"buyText",attributes:[]},{id:"instance_type",type:"newBrickRemarkTabs",label:"",attributes:[]},{id:"instance_type_reboot_notice",type:"customField",noLabel:!0,template:'<div class="bk-form-row-cell bk-upgrade-reboot-notice">'+r.i18n("ECS_UPGRADE_REBOOT_TIP")+"</div>"},{id:"systemdisk_category",clientField:!0,type:"customField",label:r.i18n("ecs.buy.label.migrateSystemDiskCategory"),template:'\n        <div class="bk-form-row-cell bk-sysdisk">\n          <div class="bk-form-row-li">\n            <span aliyun-buy-select class="bk-disk-cell bk-select"\n                  option="options.items"\n                  spm="sysdisk"\n                  short="true"\n                  detail="detail"\n                  ng-model="rawData.systemdisk_category">\n            </span>\n          </div>\n          <div class="bk-form-row-txt bk-mt2">{{\'ECS_UPGRADE_MIGRATE_SYSTEM_DISK_CATEGORY\'|translate}}</div>\n         </div>\n        '},{id:"migrate_ip",clientField:!0,type:"customField",label:r.i18n("ecs.buy.label.migrateIp"),template:'<div class="bk-form-row-cell" aliyun-buy-anchor="dominator:upgrade_migrate_ip:anchor">\n          <div class="bk-form-row-li">\n            <div class="bk-upgrade-migrate-ip" ng-class="{\'bk-rect-select-txt-error\': options.state==\'error\'}" aliyun-buy-checkbox ng-model="rawData.migrate_ip" display="display" read-only="readOnly"></div>\n            <div class="bk-form-row-txt ng-binding bk-form-row-txt" ng-bind-html="options.tip" ng-show="options.tip" aliyun-buy-field-row-tip></div>\n            <div class="bk-form-status bk-form-error bk-form-row-txt" ng-if="options.state===\'error\' && options.stateMessage">\n              <i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message"\n                                                                       ng-bind-html="options.stateMessage"></span>\n            </div>\n          </div></div>',fieldCls:"bk-ecs-bandwidth-switch"}]},{id:"regionConfig",type:"group",spmId:"region",groupStyle:"none",children:[{id:"vm_region_no",type:"newBrickTabs"},{id:"vm_iz",type:"newBrickTabs"}]},{id:"iooptimizedConfig",type:"group",spmId:"iooptimized",groupStyle:"none",children:[{id:"iooptimized",type:"newBrickTabs"}]},{id:"diskConfig",type:"group",spmId:"disk",groupStyle:"none",children:[{id:"datadisk",type:"customField",label:r.i18n("ecs.buy.label.disk.data"),template:"<span aliyun-buy-ecs-datadisk\n                        aliyun-buy-anchor=\"dominator:datadisk:anchor\"\n                        options='options'\n                        value='rawData.datadisk'\n                        ></span>"}]},{id:"bandwidthConfig",type:"group",spmId:"bandwidth",groupClass:"bk-ecs-upgrade-bandwidth-group",groupStyle:"none",children:[{id:"vm_bandwidth_switch",type:"checkbox",noLabel:!0,fieldCls:"bk-ecs-bandwidth-switch"},{id:"vm_is_flow_type",type:"newBrickTabs",label:r.i18n("ECS_BANDWIDTH_TYPE"),attributes:[]},{id:"vm_bandwidth",type:"buySliderWithNumber",label:r.i18n("ECS_BANDWIDTH"),attributes:[]},{id:"vm_bandwidth_history",type:"customField",noLabel:!0,template:'\n        <div class="bk-form-row-cell">\n              <div aliyun-buy-ecs-bandwidth-history-new instance-id="instanceId"></div>\n              <div class="bk-form-row-txt" aliyun-buy-ecs-threshold></div>\n        </div>\n      '}]}]})}),define("ecsbuy/console/models/upgrade/_base",["require","exports","./ecs.buy.upgrade.biz","./ecs.buy.upgrade.ui"],function(e,t){}),define("ecsbuy/console/models/recycleBin/ecs.buy.create.ui",["require","exports","common/modelSystem/modelFactory","common/helper/i18nHelper","../changeOs/uiModel/commonUi","../changeOs/uiModel/storageConfigUi"],function(e,t,n,r,i,s){var o=function(){for(var e=0;e<i.length;e++){var t=i[e];if(t&&t.id=="imageConfig")return t}}(),u=function(){for(var e=0;e<s.length;e++){var t=s[e];if(t&&t.id=="storageConfig")return t}}();n.regist("ecs.buy.recycleBin.createInstance.ui","BuyUiModel",{id:"ecsBuyRecycleBinCreateInstanceUI",fields:[{id:"instanceDetail",type:"group",groupStyle:"none",children:[{id:"customConfig",type:"customField",fieldCls:"bk-pb5",noLabel:!0,template:'<div aliyun-buy-ecs-recycle-bin-instance-detail data="raw" ></div>'}]},{id:"chargeTypeConfig",type:"group",groupClass:"bk-group-pt30",spmId:"chargeType",groupStyle:"none",children:[{id:"chargeType",type:"newBrickTabs",label:""}]},{id:"regionConfig",type:"group",spmId:"region",groupStyle:"none",children:[{id:"vm_region_no",type:"newBrickTabs"},{id:"vm_iz",type:"newBrickTabs"}]},{id:"networkConfig",type:"group",spmId:"network",groupClass:"bk-group-pt30",groupStyle:"none",children:[{id:"vm_web_type",type:"newBrickTabs",label:""},{id:"vm_vpc",type:"customField",template:"<div aliyun-buy-ecs-vpc\n                      aliyun-buy-anchor=\"dominator:vm_vpc:anchor\"\n                      options='options'\n                      value='rawData.vm_vpc'\n                      detail='rawData.detail'\n                      value-all='valueAll'\n                      raw='raw'\n                      default-value-vpc-id='rawData.defaultValueVpcId'\n                      default-value-vswitch-id='rawData.defaultValueVswitchId'></div>",label:""},{id:"allocatePublicIP",type:"bricksSelect",label:r.i18n("ecs.buy.label.publicIp")},{id:"securityGroup",type:"customField",label:"",clientField:!0,template:"<div aliyun-buy-ecs-security-group\n                      value='rawData.securityGroup'\n                      options='options'\n                      value-all='valueAll'\n                      raw='raw'\n                      detail='rawData.$detail'\n                      default-value-sg-id=\"rawData.defaultSecurityGroupId\"></div>"},{id:"groupRule",type:"customField",clientField:!0,template:"<input value='rawData.groupRule' />"}]},{id:"instanceConfig",type:"group",spmId:"instance",groupClass:"bk-group-pt30",groupStyle:"none",children:[{id:"iooptimized",type:"customField",template:"<div ecs-io-select ng-model='rawData.iooptimized' options='options'></div>",label:"I/O ",attributes:[]},{id:"instance_type",type:"customField",template:"<span aliyun-buy-ecs-instance-types\n                       value='rawData.instance_type'\n                       options='options'\n                       raw=\"raw\"\n                       detail=\"rawData.$detail\"\n                       value-all='valueAll'></span>",label:"",attributes:[]}]},{id:"bandwidthConfig",type:"group",spmId:"bandwidth",groupClass:"bk-group-pt30",groupStyle:"none",children:[{id:"vm_is_flow_type",type:"newBrickTabs",label:"",attributes:[]},{id:"vm_bandwidth",type:"buySliderWithNumber",label:"",attributes:[]}]},o,u,{id:"passwordConfig",type:"group",spmId:"login",groupClass:"bk-group-pt30",groupStyle:"none",children:[{id:"setupPassword",type:"newBrickTabs",clientField:!0,label:"",attributes:[]},{id:"password",clientField:!0,fieldWraperCls:"bk-form-row-pb0",type:"customField",noLabel:!0,template:'<span  aliyun-buy-ecs-password\n                        aliyun-buy-anchor="dominator:password:anchor"\n                        options="options"\n                        value="rawData.password"></span>'},{id:"keyPair",clientField:!0,label:"",type:"customField",template:'<span  aliyun-buy-ecs-setting-key-pair\n                        aliyun-buy-anchor="dominator:keyPair:anchor"\n                        options="options"\n                        value-all="valueAll"\n                        value="rawData.keyPair"></span>'},{id:"instanceName",clientField:!0,fieldWraperCls:"bk-form-row-pb30",label:r.i18n("ecs.buy.component.password.instanceName"),type:"customField",template:'<span  aliyun-buy-ecs-instance-name\n                        aliyun-buy-anchor="dominator:instanceName:anchor"\n                        options="options"\n                        value="rawData.instanceName"></span>'}]}]})}),define("ecsbuy/console/models/constraints/recycleBin/display4SystemDiskConstraint",["require","exports","../../../helpers/recycleBinHelper"],function(e,t,n){var r={id:"Display4SystemDiskConstraint",watches:["vm_region_no"],action:function(e,t,r,i,s){var o=i.getOriginConstraintData(),u=n.RecycleBinHelper.getSystemDiskInfo(o);u?(r.setFieldValue(undefined),r.hide()):r.show()}};return r}),define("ecsbuy/console/models/recycleBin/ecs.buy.create.biz",["require","exports","common/modelSystem/modelFactory","../constraints/recycleBin/display4SystemDiskConstraint","dominator/base/helpers/constraintHelper","../../../base/helpers/buyBizHelper","../../../base/cons/buyBizCons","../../helpers/recycleBinHelper","../../../base/cons/diskCategory"],function(e,t,n,r,i,s,o,u,a){n.regist("ecs.buy.recycleBin.createInstance.biz","BizModel",["$state","$injector","$rootScope","aliyunBuyEcsRemoteService","$timeout","modelFactory",function(e,t,n,f,l,c){function d(e,t,n,r){var s=n.getDominator().getOriginConstraintData();e.$watch("options.items",function(e){if(i.contains(e,"none","value")){var t=u.RecycleBinHelper.getSystemDiskInfo(s);t&&t.Category==a.DiskCategory.CLOUD&&n.setFieldValue("none")}})}var h=c.getModel("ecs.buy.biz","BizModel"),p={id:"ecsBuyRecycleBinCreateInstanceBiz",fields:[{id:"customConfig",initData:{},controller:function(e,t,n,r){e.raw=n.getDominator().getOriginConstraintData()}},{id:"chargeType",initData:{options:{items:o.BuyBizCons.CHARGE_TYPE_ITEMS}},controller:function(e,t,n,r){e.$watch("rawData.chargeType",function(e){n.setFieldValue("postpay"),n.hide()})}},{id:"vm_region_no",controller:function(e,t,n,r){var i=n.getDominator().getOriginConstraintData(),s=u.RecycleBinHelper.getRegionId(i);n.hide(),n.setFieldValue(s)}},{id:"vm_iz",controller:function(e,t,n,r){var i=n.getDominator().getOriginConstraintData(),s=u.RecycleBinHelper.getZoneId(i);n.hide(),n.setFieldValue(s)}}]};return s.BuyBizHelper.replaceControllerForBizModel(h,{iooptimized:d}),s.BuyBizHelper.extendConstrainsForBizModel(h,{imageType:r,publicImage:r,customImage:r,sharedImage:r,marketImage:r,securityEnhancementStrategy:r,systemdisk_category:r}),s.BuyBizHelper.extendFieldModelNew(p,h,["vm_web_type","securityGroup","allocatePublicIP","groupRule","vm_vpc","vm_is_flow_type","iooptimized","instance_type","vm_bandwidth","imageType","publicImage","customImage","sharedImage","marketImage","imageOffline","publicDefaultValueImageId","customDefaultValueImageId","sharedDefaultValueImageId","marketDefaultValueImageId","imageFromMarket","securityEnhancementStrategy","systemdisk_category","systemdisk_size","setupPassword","password","keyPair","instanceName"],null)}])}),define("ecsbuy/console/models/recycleBin/_base",["require","exports","./ecs.buy.create.ui","./ecs.buy.create.biz"],function(e,t){}),define("ecsbuy/console/models/hpcCluster/ecs.buy.hpcClusterScaling.biz",["require","exports","common/modelSystem/modelFactory","../../../base/helpers/buyBizHelper","../../../base/cons/buyBizCons","../../helpers/instanceDetailHelperNew"],function(e,t,n,r,i,s){n.regist("ecs.buy.hpcClusterScaling.biz","BizModel",["$state","$injector","$rootScope","aliyunBuyEcsRemoteService","$timeout","modelFactory",function(e,t,n,o,u,a){var f=a.getModel("ecs.buy.biz","BizModel"),l={id:"ecsBuyHpcClusterScalingBiz",fields:[{id:"customConfig",initData:{},controller:function(e,t,n,r){e.raw=n.getDominator().getOriginConstraintData()}},{id:"chargeType",initData:{options:{items:i.BuyBizCons.CHARGE_TYPE_ITEMS}},controller:function(t,n,r,i){t.$watch("rawData.chargeType",function(t){e.includes("hpcClusterScaling.prepay")?r.setFieldValue("prepay"):e.includes("hpcClusterScaling.postpay")&&r.setFieldValue("postpay"),t=="prepay"?e.go("hpcClusterScaling.prepay"):t=="postpay"&&e.go("hpcClusterScaling.postpay")})}},{id:"vm_region_no",controller:function(e,t,n,r){var i=n.getDominator().getOriginConstraintData(),o=s.InstanceDetailHelperNew.getRegionAlias(i);n.hide(),n.setFieldValue(o)}},{id:"vm_iz",controller:function(e,t,n,r){var i=n.getDominator().getOriginConstraintData(),o=s.InstanceDetailHelperNew.getZoneId(i);n.hide(),n.setFieldValue(o)}},{id:"vm_web_type",controller:function(e,t,n,r){var i=n.getDominator().getOriginConstraintData(),o=s.InstanceDetailHelperNew.getVmWebType(i);n.hide(),n.setFieldValue(o)}},{id:"iooptimized",controller:function(e,t,n,r){var i=n.getDominator().getOriginConstraintData(),o=s.InstanceDetailHelperNew.getIoOptimized(i);n.hide(),n.setFieldValue(o?"optimized":"none")}},{id:"instance_type",controller:function(e,t,n,r){var i=n.getDominator().getOriginConstraintData(),o=s.InstanceDetailHelperNew.getInstanceType(i);n.hide(),n.setFieldValue(o)}}]};return r.BuyBizHelper.extendFieldModelNew(l,f,["vm_web_type","securityGroup","allocatePublicIP","groupRule","vm_vpc","vm_is_flow_type","vm_bandwidth","imageType","publicImage","customImage","sharedImage","marketImage","imageOffline","publicDefaultValueImageId","customDefaultValueImageId","sharedDefaultValueImageId","marketDefaultValueImageId","imageFromMarket","securityEnhancementStrategy","systemdisk_category","systemdisk_size","datadisk","setupPassword","password","keyPair","instanceName"],null)}])}),define("ecsbuy/console/models/hpcCluster/ecs.buy.hpcClusterScaling.ui",["require","exports","angular","common/modelSystem/modelFactory","common/helper/i18nHelper","../changeOs/uiModel/commonUi","../changeOs/uiModel/storageConfigUi"],function(e,t,n,r,i,s,o){var u=function(){for(var e=0;e<s.length;e++){var t=s[e];if(t&&t.id=="imageConfig")return t}}(),a=function(){var e=n.copy(o);for(var t=0;t<e.length;t++){var r=e[t];if(r&&r.id=="storageConfig")return n.isArray(r.children)&&r.children.push({id:"datadisk",type:"customField",label:i.i18n("ecs.buy.label.disk.data"),template:"<span  aliyun-buy-ecs-datadisk\n                        aliyun-buy-anchor=\"dominator:datadisk:anchor\"\n                        options='options'\n                        value='rawData.datadisk'></span>"}),r}}();r.regist("ecs.buy.hpcClusterScaling.ui","BuyUiModel",{id:"ecsBuyHpcClusterScalingUI",fields:[{id:"instanceDetail",type:"group",groupStyle:"none",children:[{id:"customConfig",type:"customField",fieldCls:"bk-pb5",noLabel:!0,template:'<div aliyun-buy-ecs-instance-detail-v2 data="raw" ></div>'}]},{id:"chargeTypeConfig",type:"group",groupClass:"bk-group-pt30",spmId:"chargeType",groupStyle:"none",children:[{id:"chargeType",type:"newBrickTabs",label:""}]},{id:"regionConfig",type:"group",spmId:"region",groupStyle:"none",children:[{id:"vm_region_no",type:"newBrickTabs"},{id:"vm_iz",type:"newBrickTabs"},{id:"vm_web_type",type:"newBrickTabs"},{id:"instance_type",type:"newBrickTabs"},{id:"iooptimized",type:"newBrickTabs"}]},{id:"bandwidthConfig",type:"group",spmId:"bandwidth",groupClass:"bk-group-pt30",groupStyle:"none",children:[{id:"vm_is_flow_type",type:"newBrickTabs",label:"",attributes:[]},{id:"vm_bandwidth",type:"buySliderWithNumber",label:"",attributes:[]}]},u,a,{id:"passwordConfig",type:"group",spmId:"login",groupClass:"bk-group-pt30",groupStyle:"none",children:[{id:"setupPassword",type:"newBrickTabs",clientField:!0,label:"",attributes:[]},{id:"password",clientField:!0,fieldWraperCls:"bk-form-row-pb0",type:"customField",noLabel:!0,template:'<span  aliyun-buy-ecs-password\n                        aliyun-buy-anchor="dominator:password:anchor"\n                        options="options"\n                        value="rawData.password"></span>'},{id:"keyPair",clientField:!0,label:"",type:"customField",template:'<span  aliyun-buy-ecs-setting-key-pair\n                        aliyun-buy-anchor="dominator:keyPair:anchor"\n                        options="options"\n                        value-all="valueAll"\n                        value="rawData.keyPair"></span>'},{id:"instanceName",clientField:!0,fieldWraperCls:"bk-form-row-pb30",label:i.i18n("ecs.buy.component.password.instanceName"),type:"customField",template:'<span  aliyun-buy-ecs-instance-name\n                        aliyun-buy-anchor="dominator:instanceName:anchor"\n                        options="options"\n                        value="rawData.instanceName"></span>'}]}]})}),define("ecsbuy/console/models/hpcCluster/_base",["require","exports","./ecs.buy.hpcClusterScaling.biz","./ecs.buy.hpcClusterScaling.ui"],function(e,t){});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/console/models/base/batchActionClass/EcsDiskBatchUi",["require","exports","common/helper/i18nHelper","./EcsBaseBatchUi","../../../../base/helpers/buyUtils","../../../../base/helpers/commodityHelper","../../../../base/cons/buyBizCons","../../../helpers/commonConsoleHelper","../../../../base/helpers/methodHelper"],function(e,t,n,r,i,s,o,u,a){var f=function(e){function t(t){e.call(this,t)}return __extends(t,e),t.prototype.getHeadsTemplateMap=function(e,r,i){var s=this,o=t;return{diskName:{text:n.i18n("ecs.buy.console.batch.table.th.disk_name")},category:{text:n.i18n("ecs.buy.console.batch.table.th.disk_category")},portable:{text:n.i18n("ecs.buy.console.batch.table.th.support_portable")},chargeType:{text:n.i18n("ecs.buy.console.batch.table.th.charge_type")},diskSize:{text:n.i18n("ecs.buy.console.batch.table.th.disk_size")},reason:{text:n.i18n("ecs.buy.console.batch.table.th.reason")},batchAction:{html:s.generateBatchActionHeadHtml(e,r),bindScope:i.scope},price:{text:n.i18n("ecs.buy.console.batch.table.th.price")},tableAction:{text:n.i18n("ecs.buy.console.batch.table.th.action")}}},t.prototype.getColItemsTemplateMap=function(e,n,r,i){var s=this,o=t;return{diskName:{html:o.generateDiskNameItemHtml(e,r),bindScope:i.scope},category:{html:o.generateDiskCategoryItemHtml(e,r),bindScope:i.scope},portable:{html:o.generatePortableItemHtml(e,r),bindScope:i.scope},chargeType:{html:o.generateChargeTypeItemHtml(e,r),bindScope:i.scope},diskSize:{html:s.generateDiskSizeItemHtml(e,r),bindScope:i.scope},reason:{html:o.generateInvalidReasonItemHtml(e,r),bindScope:i.scope},batchAction:{html:o.generateBatchActionItemHtml(e,r),bindScope:o.generateBatchActionItemScope(e,r,i)},price:{html:o.generatePriceItemHtml(e,n,r),style:"min-width:200px;",bindScope:o.generatePriceItemScope(e,n,r,i)},tableAction:{html:o.generateActionItemHtml(),bindScope:undefined}}},t.prototype.generateBatchActionHeadHtml=function(e,t){return["<span >{{viewModel.batchOperationTitle}}</span>",'<button class="btn btn-xs btn-primary margin-left-1" ng-click="viewModel.change()" ng-bind="\'ecs.buy.console.batch.table.th.batch_edit\'|translate">'," </button>"].join("")},t.generateDiskNameItemHtml=function(e,t){var n=i.BuyUtils.getMapProperty(e,"instanceDetail.DiskName"),r=i.BuyUtils.getMapProperty(e,"instanceDetail.DiskId"),s=i.BuyUtils.getMapProperty(t,"vm_region_no.vm_region_no"),o=i.BuyUtils.getMapProperty(e,"instanceDetail.RegionId"),u=(n||"-")+" / "+(r||"-");return['<strong aliyun-truncate-text source-text="'+u+'" text-length="23" copy-text="true"></strong><br/>'].join("")},t.generateDiskCategoryItemHtml=function(e,t){var n=i.BuyUtils.getMapProperty(e,"instanceDetail.Category"),r=i.BuyUtils.getMapProperty(t,"datadisk.datadisk_category"),o=s.CommodityHelper.getTextFromCollection(n,r)||"-";return["<span>"+o+"</span>"].join("")},t.generatePortableItemHtml=function(e,t){var r=i.BuyUtils.getMapProperty(e,"instanceDetail.Portable"),s="-";return r!=undefined&&(s=r?n.i18n("ecs.buy.console.batch.table.td.support"):n.i18n("ecs.buy.console.batch.table.td.no_support")),["<span>"+s+"</span>"].join("")},t.generateChargeTypeItemHtml=function(e,t){var n=i.BuyUtils.getMapProperty(e,"instanceDetail.DiskChargeType"),r=o.BuyBizCons.CHARGE_TYPE_MAP_REVERT[n],u=o.BuyBizCons.CHARGE_TYPE_ITEMS,a=s.CommodityHelper.getTextFromCollection(r,u)||"-";return["<span>"+a+"</span>"].join("")},t.generateInvalidReasonItemHtml=function(e,t){var n=i.BuyUtils.getMapProperty(e,"_invalidMsg")||"-";return['<strong aliyun-truncate-text source-text="'+n+'" text-length="20" copy-text="true"></strong>'].join("")},t.prototype.generateDiskSizeItemHtml=function(e,t){var n=this,r=i.BuyUtils.getMapProperty(e,"instanceDetail.Size"),s=n.$injector.get("$filter"),o=s("aliyunBuyEcsShowComponent")(r,"diskSize");return["<span>"+o+"</span>"].join("")},t.generateBatchActionItemScope=function(e,t,r){var s=this,o=i.BuyUtils.getMapProperty(r,"scope"),a=i.BuyUtils.getMapProperty(e,"instanceDetail.DiskId"),f=i.BuyUtils.getMapProperty(e,"instanceDetail.Category"),l=i.BuyUtils.getMapProperty(e,"instanceDetail.Size"),c=i.BuyUtils.getMapProperty(e,"constraint.datadisk_size.datadisk_category."+f+".0"),h,p,d,v="GB";!c||(h=Math.max(c.min,l),p=c.max,d=c.step);if(!o)return;var m=i.BuyUtils.getMapProperty(o,"viewModel.changedFormCache"),g=u.CommonConsoleHelper.filterStringForAngualrBindingKey(a);return!m||(m[g]={min:h,max:p,unit:v,step:d,tip:n.i18nByMap("ecs.buy.component.systemdisk.tip",{min:h,max:p})}),o.$watch("viewModel.changedContent",function(e,t){if(e&&e!=t){var n=parseInt(e);isNaN(n)||(m[g].value=n)}}),o.$watch("viewModel.changedFormCache."+g+".value",function(e,t){e!=undefined&&t!=undefined&&e!=t&&o.$emit("aliyunBuyEcsBatchView:queryPrice")}),o},t.generateBatchActionItemHtml=function(e,t){var n=this,r=i.BuyUtils.getMapProperty(e,"instanceDetail.DiskId"),s=u.CommonConsoleHelper.filterStringForAngualrBindingKey(r),o="viewModel.changedContent",a="viewModel.changedFormCache."+s+".",f=function(e){return a+e};return["<span aliyun-buy-tooltip=\"{content:'{{"+f("tip")+"}}', theme:'white', trigger:'hover', offsetX: 20}\">",'<span class="bk-number" aliyun-buy-number-stepper value="'+f("value")+'" min="'+f("min")+'" max="'+f("max")+'" step="'+f("step")+'" unit="'+f("unit")+'"></span>',"</span>"].join("")},t.generatePriceItemHtml=function(e,t,n){var r=i.BuyUtils.getMapProperty(e,"instanceDetail.DiskId"),s=u.CommonConsoleHelper.filterStringForAngualrBindingKey(r),o="viewModel.priceResult.resultMap."+s;return['<div aliyun-buy-price-view-light ng-show="'+o+'" data="'+o+'"></div>','<span ng-hide="'+o+'">-</span>'].join("")},t.generatePriceItemScope=function(e,t,n,r){var s=i.BuyUtils.getMapProperty(e,"instanceDetail.DiskId"),o=i.BuyUtils.getMapProperty(r,"scope");if(!o)return;o.$watch("viewModel.priceResult",function(e){if(e!=undefined&&Object.keys(e).length>0){var t=i.BuyUtils.getMapProperty(o,"viewModel.priceResult"),n=u.CommonConsoleHelper.filterStringForAngualrBindingKey(s),r=i.BuyUtils.getMapProperty(t,"result.priceList"),f;if(r instanceof Array){var l=a.MethodHelper.transArrayToMapByKey(r,"resourceId");l[s]?f=(c={},c[n]={calculating:t.pending,success:l[s].success,data:l[s]},c):f=(h={},h[n]=undefined,h)}else f=(p={},p[n]={calculating:t.pending,success:t.success,data:{message:t.message}},p);t.resultMap=angular.extend({},t.resultMap,f)}var c,h,p},!0)},t.generateActionItemHtml=function(){return'<a href="javascript:;" ng-click="remove(viewInfoIndex)" ng-bind="\'ecs.buy.console.batch.table.td.action_del\'|translate"></a>'},t}(r.EcsBaseBatchUi);t.EcsDiskBatchUi=f});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/console/models/resizeDisk/ecs.buy.resizeDisk.batch.ui",["require","exports","common/modelSystem/modelFactory","../base/batchActionClass/EcsBaseBatchUi","../base/batchActionClass/EcsDiskBatchUi"],function(e,t,n,r,i){var s=function(e){function t(t){e.call(this,t)}return __extends(t,e),t.prototype.getTemplateKeys=function(e){return e==r.BatchUiNamespace.invalid?["diskName","category","portable","chargeType","diskSize","reason"]:["diskName","category","portable","chargeType","diskSize","batchAction","price","tableAction"]},t.prototype.generateBatchActionHeadHtml=function(e,t){return e instanceof Array&&e.length<=1?["<span >{{viewModel.batchOperationTitle}}</span>"].join(""):["<span >{{viewModel.batchOperationTitle}}</span>",'<button class="btn btn-xs btn-primary margin-left-1" ng-click="viewModel.change()" ng-bind="\'ecs.buy.console.batch.table.th.batch_edit\'|translate">'," </button>"].join("")},t}(i.EcsDiskBatchUi);n.regist("ecs.buy.resizeDisk.batchUiModel","BizModel",["$injector",function(e){var t=new s(e);return t.makeBatchUiFactory()}])});var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};define("ecsbuy/console/models/resizeDisk/ecs.buy.resizeDisk.batch.action",["require","exports","angular","common/modelSystem/modelFactory","common/helper/i18nHelper","../base/batchActionClass/EcsBaseBatchAction","../../../base/helpers/buyUtils","../../cons/cons","../../helpers/commonConsoleHelper","../../../base/cons/buyBizCons"],function(e,t,n,r,i,s,o,u,a,f){var l=function(e){function t(t){e.call(this,t)}return __extends(t,e),t.prototype.getBatchOperationTitle=function(){return i.i18n("ecs.buy.console.batch.table.th.resize_disk")},t.prototype.showBatchDialog=function(e){var t=this,n=t.$injector.get("aliyunDialog"),r=t.$injector.get("modelSystemCacheContextService"),i=u.ConsoleConstant.PARTIALS_PATH+"resizeDisk/dialog/batchResizeDiskDialog.html",s=e.activeBatchInfoIds,o=r.getCacheContext("ecs.buy.resizeDisk.batch.bizModel.cacheContext").get("resizeDiskCache.regionId");s instanceof Array&&s.length>0&&n.showDialogByUrl(i,function(e){e.diskId=s[0],e.regionId=o,e.submit=function(){e.$emit("aliyunBuyEcsResizeDiskOptions:exportOptions")},e.$on("aliyunBuyEcsResizeDiskOptions:saveOptions",function(t,n){e.$emit("aliyunBuyEcsBatchView:saveOptions",n),e.close()})},{windowClass:"batch-resizeDisk-dialog dialog-size-bg"})},t.prototype.isInvalidInfo=function(e){var t=this,n=o.BuyUtils.getMapProperty(e,"instanceDetail.Category"),r=o.BuyUtils.getMapProperty(e,"constraint.datadisk_size.datadisk_category."+n);if(!!r){var s=o.BuyUtils.getMapProperty(r,"0.max");if(s!=undefined){var u=parseInt(o.BuyUtils.getMapProperty(e,"instanceDetail.Size"));if(u>s){var a=t.$injector.get("$filter"),l=a("aliyunBuyEcsShowComponent")(s,"diskSize");return i.i18n("ecs.buy.console.batch.resize_disk.invalid_msg.beyond_limit",l)}}}var c=o.BuyUtils.getMapProperty(e,"instanceDetail.Type");if(c!==undefined&&c===o.BuyUtils.getMapProperty(f.BuyBizCons.DISK_SYSTEM_ITEM,"value"))return i.i18n("ecs.buy.console.batch.resize_disk.invalid_msg.no_support_system_disk")},t.prototype.getBatchInfoParams=function(){var e=this,t=e.$injector.get("modelSystemCacheContextService"),n=t.getCacheContext("ecs.buy.resizeDisk.batch.bizModel.cacheContext").get("resizeDiskCache"),r=n.diskIds,i=n.regionId;return{orderType:"RESIZE",commodityCode:"yundisk",diskIds:r.join(","),regionId:i}},t.prototype.getQueryBatchInfoService=function(){var e=this,t=e.$injector.get("aliyunBuyEcsRemoteService");return t.queryEcsDiskInfo},t.prototype.getQueryPriceParams=function(e,t,r){var i=this,s=i.$injector.get("modelSystemCacheContextService"),u=s.getCacheContext("ecs.buy.resizeDisk.batch.bizModel.cacheContext").get("resizeDiskCache"),f=u.regionId,l=[],c=o.BuyUtils.getMapProperty(e,"activeBatchInfoIds"),h=o.BuyUtils.getMapProperty(e,"activeBatchInfos"),p=o.BuyUtils.getMapProperty(r,"viewModel.changedFormCache");return n.forEach(c,function(e,t){var n=h[t],r=o.BuyUtils.getMapProperty(n,"instanceDetail.DiskChargeType"),i=a.CommonConsoleHelper.filterStringForAngualrBindingKey(e),s=o.BuyUtils.getMapProperty(p,i+".min"),u=o.BuyUtils.getMapProperty(p,i+".value");!o.BuyUtils.hasUndefined(s,u)&&u>s&&l.push({regionId:f,resourceId:e,chargeType:a.CommonConsoleHelper.transformChargeType(r),orderType:"disk-resize",commodity:{diskIds:e,newSize:u}})}),l},t.prototype.beforeQueryPrice=function(e){return e instanceof Array&&e.length>0},t.prototype.getUniqueId=function(e){return o.BuyUtils.getMapProperty(e,"instanceDetail.DiskId")},t}(s.EcsBaseBatchAction);r.regist("ecs.buy.resizeDisk.batchActionModel","BizModel",["$injector",function(e){var t=new l(e);return t.makeBatchActionFactory()}])}),define("ecsbuy/console/models/constraints/resizeDisk/resizeDiskOptionsDiskSizeDetailConstraint",["require","exports"],function(e,t){var n={id:"resizeDiskOptionsDiskSizeDetailConstraint",watches:["datadisk_size"],action:function(e,t,n,r,i){if(!e)return;var s=r.getFieldById(t),o=s.$scope;o.$emit("aliyunBuyEcsBatchView:changedContent",e)}};return n}),define("ecsbuy/console/models/resizeDisk/ecs.buy.resizeDisk.options.biz",["require","exports","common/modelSystem/modelFactory","../../../base/helpers/buyUtils","../constraints/resizeDisk/resizeDiskOptionsDiskSizeDetailConstraint"],function(e,t,n,r,i){n.regist("ecs.buy.resizeDisk.options.biz","BizModel",["$state","$injector","$rootScope","aliyunBuyEcsRemoteService","$timeout","modelFactory",function(e,t,n,s,o,u){var a={id:"ecsResizeDiskOptions",fields:[{id:"vm_region_no",initData:{},controller:function(e,t,n,i){n.hide();var s=n.getDominator(),o=s.getOriginConstraintData(),u=r.BuyUtils.getMapProperty(o,"instanceDetail.RegionId");n.setFieldValue(u)},constraints:[]},{id:"datadisk_category",initData:{},controller:function(e,t,n,i){n.hide();var s=n.getDominator(),o=s.getOriginConstraintData(),u=r.BuyUtils.getMapProperty(o,"instanceDetail.Category");n.setFieldValue(u)}},{id:"datadisk_size",initData:{},controller:function(e,t,n,r){},constraints:[i]}]};return a}])}),define("ecsbuy/console/models/resizeDisk/ecs.buy.resizeDisk.options.ui",["require","exports","common/helper/i18nHelper","common/modelSystem/modelFactory"],function(e,t,n,r){r.regist("ecs.buy.resizeDisk.options.ui","BuyUiModel",{id:"ecsResizeDiskOptions",fields:[{id:"storageConfig",type:"group",groupStyle:"none",groupClass:"bk-group-pt0",spmId:"storage",children:[{id:"datadisk_size",type:"buySliderWithNumber",fieldWraperCls:"bk-label-non",label:n.i18n("ECS_RESIZE_DISK"),attributes:[]}]},{id:"hideConfig",type:"group",groupStyle:"none",children:[{id:"datadisk_category",type:"buyText"},{id:"vm_region_no",type:"buyText"}]}]})}),define("ecsbuy/console/models/resizeDisk/_base",["require","exports","./ecs.buy.resizeDisk.batch.ui","./ecs.buy.resizeDisk.batch.action","./ecs.buy.resizeDisk.options.biz","./ecs.buy.resizeDisk.options.ui"],function(e,t){}),define("ecsbuy/console/models/_base",["require","exports","./buyAgain/_base","./changeOs/_base","./changeBandwidth/_base","./release/_base","./renew/_base","./downgrade/_base","./downgradeWithRenew/_base","./upgrade/_base","./recycleBin/_base","./hpcCluster/_base","./resizeDisk/_base"],function(e,t){}),define("ecsbuy/console/index",["require","exports","../base/directives/_base","../base/models/_base","../base/services/_base","../base/filters/_base","../base/helpers/fields/UIModelHelper","../base/dominatorHijack","./directives/_base","./filter/_base","./models/_base"],function(e,t){}),define("aliyun-ecsbuy-tpl",["angular"],function(e){e.module("aliyun.console.ecsbuy.base.tpl",[]).run(["$templateCache",function(e){e.put("scripts/ecsbuy/base/views/buy.html",'<div><div data-spm="subheader"><div class="bk-subheader"><div class="y-row"><!--,ng-if--><div class="y-span12 y-last" ng-if="getCommodity() == \'vm\'"><div aliyun-buy-ecs-subheader commodity-code="vm" in-white-list-for-volume-buy="inWhiteListForVolumeBuy"></div></div><div class="y-span12 y-last" ng-if="getCommodity() == \'ecs\'"><div aliyun-buy-ecs-subheader commodity-code="ecs" in-white-list-for-volume-buy="inWhiteListForVolumeBuy"></div></div><div class="y-span12 y-last" ng-if="getCommodity() == \'clouddisk\'"><div aliyun-buy-ecs-subheader commodity-code="clouddisk" in-white-list-for-volume-buy="inWhiteListForVolumeBuy"></div></div><div class="y-span12 y-last" ng-if="getCommodity() == \'freetier\'"><div aliyun-buy-ecs-subheader commodity-code="freetier" in-white-list-for-volume-buy="inWhiteListForVolumeBuy"></div></div><div class="y-span12 y-last" ng-if="getCommodity() == \'enterpriseFreetier\'"><div aliyun-buy-ecs-subheader commodity-code="enterpriseFreetier" in-white-list-for-volume-buy="inWhiteListForVolumeBuy"></div></div><div class="y-span12 y-last" ng-if="getCommodity() == \'volume\'"><div aliyun-buy-ecs-subheader commodity-code="volume" in-white-list-for-volume-buy="inWhiteListForVolumeBuy"></div></div></div></div></div><div class="bk-body"><div class="bk-tab-nav y-row bk-clear"><ul class="bk-tab-nav-list y-span12 y-last"><li ng-repeat="tab in tabs track by tab.id" ng-if="isShow(tab.id)"><a href="javascript:;" ui-sref="{{tab.defaultState}}" ng-class="{\'bk-tab-current\': isActived(tab.id)}" class="bk-tab-nav-item" data-spm-click="gostr=/aliyun;locaid=tab-{{tab.id}}">{{tab.title}}</a></li></ul></div><div ui-view></div></div></div>'),e.put("scripts/ecsbuy/base/views/clouddisk.html",'<div class="bk-theme-generation2" ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div aliyun-buy-dom-cache="{id:\'ecs.buy.clouddisk.v2\', trigger:\'initialized\'}"><div class="bk-scope" aliyun-buy-dominator ui-model-id="ecs.buy.clouddisk.ui" biz-model-id="ecs.buy.clouddisk.biz" cart-config-id="ecs.buy.clouddisk.cartModel" subtotal-config-id="ecs.buy.clouddisk.subtotalModel" framework-setting-id="ecs.buy.clouddisk.frameworkModel" subtotal-align-style="bottom"></div><span aliyun-buy-ecs-data-spm spm-b="clouddiskpostpayv2"></span></div></div>'),e.put("scripts/ecsbuy/base/views/intlSimple.html",'<div class="bk-theme-generation2" ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"></div>'),e.put("scripts/ecsbuy/base/views/orderConfirm/clouddisk.html",'<div class="bk-theme-generation2"><div class="bk-order-confirm" data-spm="orderConfirm"><div><div class="y-page-title"><div class="y-row"><div class="y-span12 y-last"><div class="bk-scope bk-subheader"><div class="bk-subheader-box"><h1>{{\'ECS_RESULT_CONFIRM\'|translate}}</h1><a class="btn btn-sm btn-default bk-subheader-back" href="javascript:void(0);" ui-sref="buy.clouddisk"><span class="icon-goback"></span> <span ng-bind-html="\'ECS_BACK\' | translate"></span></a></div></div></div></div></div></div><div class="y-row y-mt5"><div class="bk-process"><span class="unit current w49">{{\'ECS_RESULT_CONFIRM\'|translate}}</span> <span class="arrow-current"><span class="next"></span> <span class="prev"></span></span> <span class="unit w49">{{\'ECS_PORDER_SUCCESS\'|translate}}</span></div></div><div class="y-row y-mt5"><div aliyun-buy-ecs-clouddisk-order-confirm order-data="orderData" ready="ready"></div></div></div><span aliyun-buy-ecs-data-spm spm-b="clouddiskpostpayv2"></span></div>'),e.put("scripts/ecsbuy/base/views/orderConfirm/postpay.html",'<div class="bk-theme-generation2"><div class="bk-order-confirm" data-spm="orderConfirm"><div><div class="y-page-title"><div class="y-row"><div class="y-span12 y-last"><div class="bk-scope bk-subheader"><div class="bk-subheader-box"><h1 ng-bind-html="\'ECS_PORDER_CONFIRM\'|translate"></h1><span ng-if="$stateParams.type != \'spotInstance\'"><a class="btn btn-sm btn-default bk-subheader-back" href="javascript:void(0);" ui-sref="buy.postpay"><span class="icon-goback"></span> <span ng-bind-html="\'ECS_BACK\' | translate"></span></a></span> <span ng-if="$stateParams.type == \'spotInstance\'"><a class="btn btn-sm btn-default bk-subheader-back" href="javascript:void(0);" ui-sref="buy.spotPostpay"><span class="icon-goback"></span> <span ng-bind-html="\'ECS_BACK\' | translate"></span></a></span></div></div></div></div></div></div><div class="y-row y-mt5"><div class="bk-process"><span class="unit current w49" ng-bind-html="\'ECS_PORDER_CONFIRM\'|translate"></span> <span class="arrow-current"><span class="next"></span> <span class="prev"></span></span> <span class="unit w49" ng-bind-html="\'ECS_PORDER_SUCCESS\'|translate"></span></div></div><div class="y-row y-mt5"><div aliyun-buy-ecs-postpay-order-confirm order-data="orderData" ready="ready"></div></div></div><span aliyun-buy-ecs-data-spm spm-b="ecspostpayv2"></span></div>'),e.put("scripts/ecsbuy/base/views/orderConfirm/prepay.html",'<div class="bk-theme-generation2"><div class="bk-order-confirm" data-spm="orderConfirm"><div><div class="y-page-title"><div class="y-row"><div class="y-span12 y-last"><div class="bk-scope bk-subheader"><div class="bk-subheader-box"><h1>{{\'ECS_PORDER_CONFIRM\'|translate}}</h1><span ng-if="$stateParams.type == \'simple\'"><a class="btn btn-sm btn-default bk-subheader-back" href="javascript:void(0);" ui-sref="buy.simple"><span class="icon-goback"></span> <span ng-bind-html="\'ECS_BACK\' | translate"></span></a></span> <span ng-if="$stateParams.type != \'simple\'"><a class="btn btn-sm btn-default bk-subheader-back" href="javascript:void(0);" ui-sref="buy.prepay"><span class="icon-goback"></span> <span ng-bind-html="\'ECS_BACK\' | translate"></span></a></span></div></div></div></div></div></div><div class="y-row y-mt5"><div class="bk-process"><span class="unit current">{{\'ECS_PORDER_CONFIRM\'|translate}}</span> <span class="arrow-current"><span class="next"></span> <span class="prev"></span></span> <span class="unit">{{\'ECS_PORDER_PAY\'|translate}}</span> <span class="arrow"><span class="next"></span> <span class="prev"></span></span> <span class="unit">{{\'ECS_PORDER_SUCCESS\'|translate}}</span></div></div><div class="y-row y-mt5"><div aliyun-buy-ecs-prepay-order-confirm order-data="orderData" ready="ready"></div></div></div><span ng-if="$stateParams.type == \'simple\'"><span aliyun-buy-ecs-data-spm spm-b="ecssimplebuyv2"></span></span> <span ng-if="$stateParams.type != \'simple\'"><span aliyun-buy-ecs-data-spm spm-b="ecsprepayv2"></span></span></div>'),e.put("scripts/ecsbuy/base/views/orderConfirm/volume.html",'<div class="bk-theme-generation2"><div class="bk-order-confirm" data-spm="orderConfirm"><div><div class="y-page-title"><div class="y-row"><div class="y-span12 y-last"><div class="bk-scope bk-subheader"><div class="bk-subheader-box"><h1>{{\'ECS_RESULT_CONFIRM\'|translate}}</h1><a class="btn btn-sm btn-default bk-subheader-back" href="javascript:void(0);" ui-sref="buy.volume"><span class="icon-goback"></span> <span ng-bind-html="\'ECS_BACK\' | translate"></span></a></div></div></div></div></div></div><div class="y-row y-mt5"><div class="bk-process"><span class="unit current w49">{{\'ECS_RESULT_CONFIRM\'|translate}}</span> <span class="arrow-current"><span class="next"></span> <span class="prev"></span></span> <span class="unit w49">{{\'ECS_PORDER_SUCCESS\'|translate}}</span></div></div><div class="y-row y-mt5"><div aliyun-buy-ecs-volume-order-confirm order-data="orderData" ready="ready"></div></div></div><span aliyun-buy-ecs-data-spm spm-b="volumepostpayv2"></span></div>'),e.put("scripts/ecsbuy/base/views/orderResult.html",'<div style="background: #FBFAF8" data-spm="orderResult"><div aliyun-buy-ecs-order-result-view commodity-code="{{commodityCode}}" config="config"></div><!----><div class="bk-scope y-row"><div class="bk-other-box"><strong>{{\'ECS_RESULT_WARMTIP\'|translate}}</strong><ul><li class="fn-clear"><span>1</span> <span ng-bind-html="\'ECS_RESULT_WTIP1\' | translate"></span></li><li class="fn-clear"><span>2</span><span ng-bind-html="\'ECS_RESULT_WTIP2\' | translate"></span></li><li class="fn-clear"><span>3</span> <span ng-bind-html="\'ECS_RESULT_WTIP3\' | translate"></span></li></ul></div><div style="height:1px"></div></div></div>'),e.put("scripts/ecsbuy/base/views/postpay.html",'<div class="bk-theme-generation2" ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div aliyun-buy-dom-cache="{id:\'ecs.buy.postpay.v2\', trigger:\'initialized\'}"><div class="bk-scope" aliyun-buy-dominator ui-model="ecsBuyPostpayUiModel" biz-model-id="ecs.buy.biz" cart-config-id="ecs.buy.postpay.cartModel" subtotal-config-id="ecs.buy.subtotalModel" framework-setting-id="ecs.buy.postpay.frameworkModel" subtotal-align-style="bottom"></div></div><div aliyun-buy-history-fixed config="ecsBuyPostpayHistoryModel.options" history-service="ecsBuyPostpayHistoryModel.historyService" price-service="ecsBuyPostpayHistoryModel.priceService"></div><span aliyun-buy-ecs-data-spm spm-b="ecspostpayv2"></span></div>'),e.put("scripts/ecsbuy/base/views/prepay.html",'<div class="bk-theme-generation2" ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div aliyun-buy-dom-cache="{id:\'ecs.buy.prepay.v2\', trigger:\'initialized\'}"><div class="bk-scope" aliyun-buy-disable-ng-animate aliyun-buy-dominator ui-model-id="ecs.buy.ui" biz-model-id="ecs.buy.biz" cart-config-id="ecs.buy.cartModel" subtotal-config-id="ecs.buy.subtotalModel" framework-setting-id="ecs.buy.prepay.frameworkModel" subtotal-align-style="bottom"></div></div><div aliyun-buy-history-fixed config="ecsBuyPrepayHistoryModel.options" history-service="ecsBuyPrepayHistoryModel.historyService" price-service="ecsBuyPrepayHistoryModel.priceService"></div><span aliyun-buy-ecs-data-spm spm-b="ecsprepayv2"></span></div>'),e.put("scripts/ecsbuy/base/views/simple.html",'<div class="bk-theme-generation2" ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div aliyun-buy-dom-cache="{id:\'ecs.buy.simple.v2\', trigger:\'initialized\'}"><div class="bk-scope" aliyun-buy-dominator ui-model-id="ecs.buy.simple.ui" biz-model-id="ecs.buy.simple.biz" cart-config-id="ecs.buy.cartModel" subtotal-config-id="ecs.buy.subtotalModel" framework-setting-id="ecs.buy.simple.frameworkModel" subtotal-align-style="bottom"></div></div><span aliyun-buy-ecs-data-spm spm-b="ecssimplebuyv2"></span></div>'),e.put("scripts/ecsbuy/base/views/spotPostpay.html",'<div class="bk-theme-generation2" ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div aliyun-buy-dom-cache="{id:\'ecs.buy.spotPostpay.v2\', trigger:\'initialized\'}"><div class="bk-scope" aliyun-buy-dominator ui-model="ecsBuySpotPostpayUiModel" biz-model-id="ecs.buy.spotPostpay.biz" cart-config-id="ecs.buy.postpay.cartModel" subtotal-config-id="ecs.buy.subtotalModel" framework-setting-id="ecs.buy.spotPostpay.frameworkModel" subtotal-align-style="bottom"></div></div><span aliyun-buy-ecs-data-spm spm-b="ecsspotpostpayv2"></span></div>'),e.put("scripts/ecsbuy/base/views/volume.html",'<div class="bk-theme-generation2" ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div aliyun-buy-dom-cache="{id:\'ecs.buy.volume.v2\', trigger:\'initialized\'}"><div class="bk-scope" aliyun-buy-dominator ui-model-id="ecs.buy.volume.ui" biz-model-id="ecs.buy.volume.biz" cart-config-id="ecs.buy.volume.cartModel" subtotal-config-id="ecs.buy.volume.subtotalModel" framework-setting-id="ecs.buy.volume.frameworkModel" subtotal-align-style="bottom"></div><span aliyun-buy-ecs-data-spm spm-b="volumepostpayv2"></span></div></div>'),e.put("scripts/ecsbuy/base/partials/common/aliyunBuyHistoryFixed.html",'<div class="bk-scope bk-orders-wrap bk-cart bk-history" ng-if="!hideBuyHistory" aliyun-buy-disable-ng-animate><div ng-show="viewData.totalAmount>0" class="bk-cart-bar bk-items bk-mb4 bk-items-cart"><div class="bk-items-title bk-clearfix" style="cursor:pointer" ng-click="openCartDialog()"><i class="glyphicon glyphicon-time"></i><div class="vertical-area"><!----><p class="vertical-area-text">{{config().texts.purchaseCart ||\'COMMON_CART_TITLE\' | aliyunBuyText}}</p></div><span class="bk-items-title-quantity bk-orange bk-ml3">{{viewData.totalAmount}}</span></div></div><div ng-show="viewData.totalAmount==0" class="bk-cart-bar bk-orders-menu bk-orders-menu-no-hover bk-mb4"><span class="bk-orders-menu-name"><i class="glyphicon glyphicon-time"></i><div class="vertical-area"><!----><p class="vertical-area-text">{{config().texts.purchaseCart ||\'COMMON_CART_TITLE\' | aliyunBuyText}}</p></div></span> <span class="bk-orders-menu-quantity bk-pale">{{viewData.totalAmount}}</span></div><div class="bk-orders bk-items" ng-if="viewModel.showOrders"><style>.viewFramework-topbar{z-index:10}</style><div class="bk-cart-backdrop" ng-click="closeCartDialog()"></div><div class="bk-orders-content"><div class="bk-orders-content-bar" role="button" tabindex="0" ng-click="closeCartDialog()" data-spm-click="gostr=/aliyun;locaid=closecart"><div class="bk-items-title bk-clearfix" style="cursor:pointer" ng-click="closeCartDialog()"><i class="glyphicon glyphicon-time"></i><div class="vertical-area"><!----><p class="vertical-area-text">{{config().texts.purchaseCart ||\'COMMON_CART_TITLE\' | aliyunBuyText}}</p></div><span class="bk-items-title-quantity bk-orange bk-ml3">{{viewData.totalAmount}}</span></div></div><div class="bk-orders-title"><span class="bk-orders-title-txt">{{config().texts.purchaseCart ||\'COMMON_CART_TITLE\' | aliyunBuyText}}</span><!-- --></div><!--viewOrders--><div class="bk-orders-list"><div aliyun-buy-history-fixed-item config="config()" view-orders="viewData.viewOrders"></div></div><div ng-show="viewData.viewOrders.length>0" class="bk-orders-price" ng-if="false"><div class="bk-items-price"><div ng-if="config().showTotalPrice"><div class="bk-items-price-title">{{config().texts.priceTotal || (\'COMMON_PRICE_TOTAL\' | aliyunBuyText) + \'\'}}<!----></div><div class="bk-items-price-settle"><div ng-show="calculating" class="bk-items-price-calculating">{{config().texts.calculatingPrice || \'COMMON_CART_CALCULATING\' | aliyunBuyText}}<!--..--></div><div ng-show="!calculating && price==null" class="bk-items-price-calculating">{{config().texts.calculatingPriceFailed ||\'COMMON_CART_CALCULATING_PRICE_FAILED\' | aliyunBuyText}}<!----></div><span ng-show="!calculating && price!=null"><span class="bk-cny" ng-bind-html="config().currency || \'&yen;\'"></span><span class="bk-items-price-money">{{price.trade | aliyunBuyPriceValue}}</span> <span class="bk-items-price-unit">{{priceUnit|aliyunBuyText}}</span></span></div><div class="bk-items-price-offer" ng-if="price.trade < price.origin"><!--<span class="sedi-buy-cart-submit-cost">--><!--{{config().texts.priceOriginal || \'COMMON_PRICE_ORIGIN\' | aliyunBuyText}}&lt;!&ndash;&ndash;&gt;--><!--<span class="bk-cny" ng-bind-html="config().currency || \'&yen;\'"></span><span>{{price.origin | aliyunBuyPriceValue}}</span>--><!--<span>{{priceUnit|aliyunBuyText}}</span>--><!--</span>--><span class="bk-items-price-rebate">{{config().texts.priceSave || \'COMMON_PRICE_SAVE\' | aliyunBuyText}}<!----><span class="bk-cny" ng-bind-html="config().currency || \'&yen;\'"></span><span>{{price.discount | aliyunBuyPriceValue}}</span> <span>{{priceUnit|aliyunBuyText}}</span></span></div></div></div><div class="bk-orders-control"><form class="" target="_self"><input name="" type="hidden" class="orders-data" value=""><div aliyun-buy-button theme="orange-long" data-spm-click="gostr=/aliyun;locaid=batchpurchase" ng-click="purchase()" is-disabled="{{(calculating&&config().priceShow) || price==null}}">{{config().batchPurchaseButtonText || \'COMMON_CART_BATCH_PURCHASE\' | aliyunBuyText}}<!----></div></form></div></div></div></div></div>'),e.put("scripts/ecsbuy/base/partials/common/aliyunBuyHistoryFixedItem.html",'<div class="bk-orders-items-wrapper" style="bottom: 1px"><div ng-repeat="viewOrder in viewOrders track by $index" class="bk-orders-item"><div class="bk-orders-item-title"><span class="bk-orders-item-name">{{config().productName}}</span> <span class="bk-orders-item-delete" ng-click="importConfiguration($index)" data-spm-click="gostr=/aliyun;locaid=importhistoryitem"><i class="glyphicon glyphicon-import"></i> <span ng-bind="\'ECS_IMPORT_CONFIGURATION\' | translate"></span></span><!--<span class="bk-orders-item-quantity" style="float: left">({{viewOrder.amount}}{{config().amountUnit}})</span>--></div><div class="bk-orders-item-items"><ul class="bk-orders-item-ul"><li ng-repeat="item in viewOrder.items"><div class="clearfix" ng-hide="item.hide"><span class="bk-items-item-name {{item.labelCss}}" ng-bind-html="item.label"></span> <span class="bk-items-item-value {{item.textCss}}" ng-bind-html="item.text"></span></div></li></ul></div></div></div>'),e.put("scripts/ecsbuy/base/partials/common/aliyunBuyPriceViewLight.html",'<div bindonce><div aliyun-loading size="16" class="pull-left margin-left-1" ng-show="data().calculating"></div><div ng-hide="data().calculating"><div ng-if="!data().success" style="color: #f60"><span style="{{options.trade.style}}" class="{{options.trade.cls}}">{{data().data.message | translate}}</span></div><div ng-if="data().success"><!--data().data.trade  null/undefined/\'\'--><div style="color: #f60" ng-show="!data().data.trade && data().data.trade !== 0"><span style="{{options.trade.style}}" class="{{options.trade.cls}}">{{\'QUERY_PRICE_ERROR\'| translate}}</span></div><div ng-hide="!data().data.trade && data().data.trade !== 0"><!-- --><div class="" style="color: #f60"><span style="{{options.feeText.style}}" class="{{options.feeText.cls}}" ng-show="options.feeText.visible">{{options.feeText.text}}</span> <span style="{{options.trade.style}}" class="{{options.trade.cls}}"><span ng-bind="data().data.currency |aliyunBuyPriceCurrency"></span> <span ng-bind="data().data.trade | aliyunBuyPriceValue"></span> <span ng-bind="data().data.currency |aliyunBuyPriceCurrencyText"></span> <span class="bk-items-price-unit">{{data().data.priceUnit || data().data.basePriceUnit}}</span></span></div><!-- --><div ng-if="data().data.trade < data().data.origin "><span class="bk-items-price-rebate"><span ng-bind="\'ECS_REDUCE\'|translate"></span> <span class="bk-cny" ng-bind="data().data.currency |aliyunBuyPriceCurrency"></span> <span>{{data().data.discount | aliyunBuyPriceValue}}{{data().data.currency |aliyunBuyPriceCurrencyText}}{{data().data.priceUnit || data().data.basePriceUnit}}</span></span><div class="y-mt3"></div></div><!--strategies  --><div ng-if="data().data.strategies.length > 0"><i class="bk-items-price-tag-title aliyun-icon-giving" style="margin-top: 1px"></i><div class="bk-items-price-tag-list"><span ng-if="data().data.strategies.length >= 3" aliyun-buy-tooltip="{templateUrl:\'scripts/ecsbuy/base/partials/common/priceMoreStrategies.html\', theme:\'white\'}" class="bk-ploy-more"></span> <span ng-if="data().data.strategies.length < 3" ng-repeat="strategy in data().data.strategies" class="bk-ploy" title="{{strategy.title}}">{{strategy.name}}</span></div></div><div ng-if="data().data.strategies.length == 0 && data().data.children[0].strategies.length > 0"><i class="bk-items-price-tag-title aliyun-icon-giving"></i><div class="bk-items-price-tag-list"><span ng-if="data().data.children[0].strategies.length >= 3" class="bk-ploy-more" aliyun-buy-tooltip="{templateUrl:\'scripts/ecsbuy/base/partials/common/priceMoreStrategies.html\', theme:\'white\'}"></span> <span ng-if="data().data.children[0].strategies.length < 3" ng-repeat="strategy in data().data.children[0].strategies" class="bk-ploy" title="{{strategy.title}}">{{strategy.name}}</span></div></div></div></div></div></div>'),e.put("scripts/ecsbuy/base/partials/common/buttontabLight.html",'<span class="buttontab-light"><span ng-repeat="item in items track by $index"><span class="button-light {{value == item.value ? \'selected\':\'\'}}" ng-click="select(item)" data-spm-click="gostr=/aliyun;locaid={{item.value}}">{{item.text}}</span></span></span>'),e.put("scripts/ecsbuy/base/partials/common/description.html",'<div class="bk-form-row"><div class="bk-form-row-cell"><div class="bk-form-row-li"><textarea class="bk-form-input bk-form-input-l3 bk-text-area-description" ng-model="description" style="width: 317px !important" ng-blur="blur()" ng-focus="focus()" ng-class="{\'bk-form-input-error\':!valid}"></textarea></div><div aliyun-buy-block-tips></div><div class="bk-form-row-txt" ng-if="!valid"><span class="bk-form-status bk-form-error"><i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message"> 2-256  http://  https:// </span></span></div></div></div>'),e.put("scripts/ecsbuy/base/partials/common/ecsBuyOrderButton.html",'<div class="bk-mt4"><a href="javascript:;" theme="orange" aliyun-buy-button data-spm-click="gostr=/aliyun;locaid=gotoPay" is-disabled="{{!checked || !!payDisabled}}" ng-click="purchase()">{{buttonText ? buttonText : (\'ECS_ORDER_GOPAY\'|translate)}}</a></div><div class="bk-mt4 clearfix"><div class="pull-right text-left"><div><input id="pact" type="checkbox" ng-model="checked" checked="checked" value="1" style="margin-right: 3px"><label for="pact"><span aliyun-buy-ecs-order-terms></span></label></div><div ng-show="imageOrderTermUrl"><input id="imagePact" type="checkbox" ng-model="checked" checked="checked" value="1" style="margin-right: 3px"><label for="imagePact"><span aliyun-buy-ecs-order-terms order-term-url="{{imageOrderTermUrl}}" order-term-text="IMAGE_ORDER_TERMS"></span></label></div><div ng-show="kmsTermUrl"><input id="kmsPact" type="checkbox" ng-model="checked" checked="checked" value="1" style="margin-right: 3px"><label for="kmsPact"><span aliyun-buy-ecs-order-terms order-term-url="{{kmsTermUrl}}" order-term-text="KMS_TERMS"></span></label></div></div></div>'),e.put("scripts/ecsbuy/base/partials/common/ecsBuyPrice.html",'<div class="bk-order-renew-price-wrap"><div class="bk-scope bk-items-price-settle" style="font-size: 16px;color:#000" ng-show="data().state === \'currentConfiguration\' ">{{ \'ECS_PLEASE_SELECT_CONFIG\' | translate }}</div><div class="bk-scope bk-items-price-settle" style="font-size: 16px;color:#000" ng-show="data().state === \'error\' ">{{ \'ECS_PRICE_ERROR\' | translate }}</div><div class="bk-scope" ng-show="!data().state"><div class="bk-items-price-settle"><div ng-if="data().calculating" class="bk-items-price-calculating">{{\'ECS_CALCULATING_PRICE\'|translate}}</div><div ng-if="!data().calculating && !data().success" class="bk-items-price-calculating">{{data().message | translate}}</div><div ng-if="!data().calculating  && data().success && data().data.trade!==null"><span ng-show="data().data.flow!=undefined"><span ng-show="data().data.flow!=undefined" style="font-size: 16px;color:#000" class="bk-mr2">{{\'ECS_PUBLIC_FLOW\'|translate}}</span><span class="bk-cny" ng-bind-html="(data().data.currency|aliyunBuyPriceCurrency) || \'&yen;\'"></span><span class="bk-items-price-money">{{data().data.flow | aliyunBuyPriceValue}}{{data().data.currency |aliyunBuyPriceCurrencyText}}</span><span class="bk-items-price-unit">/GB</span></span> <span style="font-size: 16px;color:#000" class="bk-mr2">{{options.feeText? options.feeText : \'ECS_CHECKOUT_AMOUNT\'|translate}}</span><span class="bk-cny" ng-bind-html="(data().data.currency|aliyunBuyPriceCurrency) || \'&yen;\'"></span><span class="bk-items-price-money">{{data().data.trade | aliyunBuyPriceValue}}{{data().data.currency |aliyunBuyPriceCurrencyText}}</span><span class="bk-items-price-unit">{{options.basePriceUnit}}</span></div></div><div class="bk-items-price-offer" ng-if="data().data.trade < data().data.origin "><!--<span class="bk-items-price-cost bk-mr1">--><!--<span class="bk-cny">&yen;</span>{{data().data.origin | aliyunBuyPriceValue}}{{options.basePriceUnit}}--><!--</span>--><span class="bk-items-price-rebate"><span ng-bind="\'ECS_REDUCE\'|translate"></span><span class="bk-cny" ng-bind-html="(data().data.currency|aliyunBuyPriceCurrency) || \'&yen;\'"></span>{{data().data.discount | aliyunBuyPriceValue}}{{data().data.currency |aliyunBuyPriceCurrencyText}}{{options.basePriceUnit}}</span><div class="y-mt3"></div></div></div><div class="bk-items-price-tag bk-order-price-tag" ng-if="data().data.trade!==null && data().data.strategies.length > 0"><div class="bk-items-price-tag-list"><i class="bk-order-price-tag-title aliyun-icon-giving"></i> <span ng-repeat="strategy in data().data.strategies" class="bk-order-ploy" title="{{strategy.title}}">{{strategy.name}}</span></div></div><div class="bk-items-price-tag bk-order-price-tag" ng-if="data().data.trade!==null && data().data.strategies.length == 0 && data().data.children[0].strategies.length > 0"><div class="bk-items-price-tag-list"><i class="bk-order-price-tag-title aliyun-icon-giving"></i> <span ng-repeat="strategy in data().data.children[0].strategies" class="bk-order-ploy" title="{{strategy.title}}">{{strategy.name}}</span></div></div></div>'),e.put("scripts/ecsbuy/base/partials/common/ecsBuyTips.html",'<span ng-show="tipType == \'tip\'"><a aliyun-buy-block-tips></a></span> <span ng-show="tipType != \'tip\'"><a class="ecs-buy-inline-tip" aliyun-buy-inline-tips></a></span>'),e.put("scripts/ecsbuy/base/partials/common/ecsCoupon.html",'<div class="bk-theme-mini"><span aliyun-buy-select option="couponList" spm="coupon" detail="detail" placeholder="{{\'ecs.buy.component.coupon.placeholder\' | translate}}" ng-model="value"></span></div>'),e.put("scripts/ecsbuy/base/partials/common/ecsCouponWrapper.html",'<div class="bk-theme-mini bk-form-row" ng-if="options.couponList && options.couponList.length>0"><label class="bk-form-row-name">{{\'ECS_ORDER_COUPON\'|translate}}</label><div class="bk-form-row-cell"><div class="bk-form-row-li"><span aliyun-buy-ecs-coupon-new coupons="options.couponList" value="options.couponNo"></span></div></div></div>'),e.put("scripts/ecsbuy/base/partials/common/ecsLabel.html",'<div class="bk-form-row-cell"><div class="bk-form-row-li" style="line-height: 28px"><span aliyun-truncate-text source-text="{{detail}}" text-length="27" copy-text="true"></span> / {{value}}</div><div aliyun-buy-block-tips></div></div>'),e.put("scripts/ecsbuy/base/partials/common/orderResultView.html",'<div class="" data-spm="orderResult"><!--  --><div><div class="y-page-title" ng-hide="config.hideTitle"><div class="y-row"><div class="y-span12 y-last"><div class="bk-scope bk-subheader"><div class="bk-subheader-box"><h1>{{orderResult.successInfo.title ? orderResult.successInfo.title: orderResult.failInfo.title}}</h1></div></div></div></div></div></div><!----><div class="y-row y-mt5" ng-hide="config.hideProcess"><div class="bk-process"><span class="unit past w49">{{\'ECS_RESULT_CONFIRM\'|translate}}</span> <span class="arrow-complete"><span class="next"></span> <span class="prev"></span></span> <span class="unit current w49" ng-if="orderResult.isSuccess">{{\'ECS_RESULT_SUCCESS\'|translate}}</span> <span class="unit current w49" ng-if="!orderResult.isSuccess">{{\'ECS_ORDER_RESULT\'|translate}}</span></div></div><!----><div ng-if="orderResult.failCount == 0" class="bk-scope y-row"><div class="bk-status-box"><!--  S --><div class="bk-status-row"><i class="bk-icon-yes3 aliyun-icon-yes3"></i><span>{{orderResult.successInfo.info}}</span></div><div class="bk-message-row-spec"><span class="bk-message-row-spec-span" ng-bind-html="orderResult.successInfo.infoMore"></span></div><div><div class="bk-message-row-spec"><a href="{{expenseOrderListUrl}}" target="_blank" class="lnk">{{\'ECS_RESULT_ORDERLIST\'|translate}}</a> <span ng-show="commodityCode == \'ecs\'"><a href="{{ecsConsoleList}}" class="lnk ml10">{{\'ECS_RESULT_CONSOLE\'|translate}}</a></span> <span ng-show="commodityCode == \'yundisk\'"><a href="{{ecsConsoleDiskListUrl}}" class="lnk ml10">{{\'ECS_RESULT_CONSOLE\'|translate}}</a></span> <span ng-show="commodityCode == \'san\' || commodityCode == \'volume\'"><a href="{{ecsConsoleVolumeListUrl}}" class="lnk ml10">{{\'ECS_RESULT_CONSOLE\'|translate}}</a></span></div><!--  E --><div ng-hide="hideAlipayAutoDebitTip" class="bk-message-row-spec" style="font-size: 12px; color: #000; margin: 10px auto; border-top: 1px #999 dashed; width: 45%; line-height: 24px;background: url(https://static.aliyun.com/images/user-center/sign_icon.png) 272px 14px no-repeat;text-align: left;padding: 10px 12% 0 25%">{{\'ECS_RESULT_TIP\'|translate}}&nbsp;&nbsp;<br><a class="y-blue" href="https://help.aliyun.com/knowledge_list/37141.html" target="_blank">{{\'ECS_RESULT_TIPMORE\'|translate}}</a></div></div></div></div><!----><div ng-if="orderResult.failCount > 0 || orderResult.code !=\'200\'" class="bk-scope y-row"><div class="bk-status-box"><div class="bk-status-row"><i class="aliyun-icon-info bk-status-row-icon"></i> <span class="bk-ml2" translate="{{orderResult.failInfo.info}}" translate-values="{successCount:orderResult.successCount,failureCount:orderResult.failCount}"></span></div><div class="bk-message-row-spec"><span class="bk-message-row-spec-span">{{orderResult.failInfo.infoMore}}</span></div><div><div class="bk-message-row-spec"><button ng-if="orderResult.payId" ng-click="continuePay()" class="bk-button bk-button-white bk-button-s bk-mr3" type="button"></button> <a href="{{workorderUrl}}" ng-if="!is4Service" class="link">{{\'ECS_RESULT_TICKET\'|translate}}</a> <a href="{{expenseOrderListUrl}}" target="_blank" class="lnk">{{\'ECS_RESULT_ORDERLIST\'|translate}}</a> <span ng-show="commodityCode == \'ecs\'"><a href="{{ecsConsoleList}}" class="lnk ml10">{{\'ECS_RESULT_CONSOLE\'|translate}}</a></span> <span ng-show="commodityCode == \'yundisk\'"><a href="{{ecsConsoleDiskListUrl}}" class="lnk ml10">{{\'ECS_RESULT_CONSOLE\'|translate}}</a></span> <span ng-show="commodityCode == \'san\' || commodityCode == \'volume\'"><a href="{{ecsConsoleVolumeListUrl}}" class="lnk ml10">{{\'ECS_RESULT_CONSOLE\'|translate}}</a></span></div></div></div></div><!----><div ng-if="orderResult.failCount > 0" class="bk-scope y-row"><div aliyun-buy-preloader="!ready"><div class="bk-status-shadow bk-mb3" translate="{{orderResult.failInfo.failedTip}}" translate-values="{failureCount:orderResult.failCount}"></div><table class="bk-table" id="order-table"><tbody><tr><th width="1%"></th><th ng-bind-html="\'ECS_ORDER_PNAME\' | translate"></th><th ng-bind-html="\'ECS_ORDER_FAIL_REASON\' | translate" class="bk-table-wordbreak"></th><th ng-bind-html="\'ECS_ORDER_PAYMETHOD\' | translate"></th><th ng-bind-html="\'ECS_ORDER_TIME\' | translate"></th><th ng-bind-html="\'ECS_ORDER_QUANTITY\' | translate"></th></tr><tr ng-repeat="orderInfo in failOrdersInfo track by $index"><td><span class="bk-title-span">{{$index + 1}}.</span></td><td><div class="bk-title-span bk-mb3 bk-mt3" style="font-size: 16px;font-weight: bold">{{orderInfo.commodityName}}</div><div ng-repeat="item in orderInfo.items" style="line-height: 22px"><div ng-if="item.name && item.text"><span>{{item.name}}</span><span class="bk-ml1">{{item.text}}</span></div></div></td><td><div class="bk-table-wordbreak" aliyun-buy-preloader="retryResult[$index] == \'processing\'"><span class="bk-title-span" ng-hide="retryResult[$index] == \'successful\'">{{orderInfo.errorMessage}}</span> <span class="bk-title-span bk-green" ng-show="retryResult[$index] == \'successful\'">{{\'ECS_BUY_RETRY_SUCCESS\' | translate}}</span><!-- <div ng-show="orderInfo.isRetry" style="margin-top:10px;">\n                <div ng-hide="retryResult[$index] == \'successful\'">\n                  <button ng-click="retry(commodityCode, orderInfo.requestId, $index)" class="bk-button bk-button-white bk-button-s bk-mr3" type="button">\n                  {{\'ECS_BUY_RETRY\' | translate}}</button>\n                  <span class="bk-title-span bk-red" ng-show="retryResult[$index] == \'failed\'">{{\'ECS_BUY_RETRY_FAILED\' | translate}}</span>\n                </div>\n'+"              </div> --></div></td><td><span ng-if=\"commodityCode == 'ecs' || commodityCode == 'yundisk'\" ng-bind-html=\"'ECS_BUY_POSTPAY' | translate\"></span> <span ng-if=\"commodityCode == 'vm'\" ng-bind-html=\"'ECS_BUY_YEARMONTH' | translate\"></span></td><td><span ng-if=\"commodityCode == 'vm'\">{{orderInfo.periodType == 'Yearly' ? orderInfo.period + '' : (orderInfo.periodType == 'Weekly' ? orderInfo.period + '' : orderInfo.period + '')}}</span> <span ng-if=\"commodityCode == 'ecs' || commodityCode == 'yundisk' || commodityCode == 'volume'\">-</span></td><td><span>{{orderInfo.quantity}} {{'ECS_QUNIT'|translate}}</span></td></tr></tbody></table></div></div></div>"),e.put("scripts/ecsbuy/base/partials/common/priceMoreStrategies.html",'<span ng-show="data().data.strategies.length > 0" ng-repeat="strategy in data().data.strategies" class="bk-ploy" title="{{strategy.title}}">{{strategy.name}}</span> <span ng-show="data().data.strategies.length == 0 && data().data.children[0].strategies.length > 0" ng-repeat="strategy in data().data.children[0].strategies" class="bk-ploy" title="{{strategy.title}}">{{strategy.name}}</span>'),e.put("scripts/ecsbuy/base/partials/common/subheader.html",'<div class="bk-scope bk-subheader"><div class="bk-subheader-box"><h1 ng-bind-html="productNameMap[commodityCode]"></h1><div class="bk-subheader-adinfo"><span aliyun-lego-data="{{legoData[0]}}" style="display:inline-block"></span><span aliyun-lego-data="{{legoData[1]}}" style="display:inline-block"></span></div><div class="bk-subheader-link"><a ng-repeat="headState in headStates" ng-show="headState.id == headStateId" ui-sref="{{headState.state}}">{{headState.title}}</a></div></div></div>'),e.put("scripts/ecsbuy/base/partials/common/timezone.html",'<div ng-if="show">{{timezonetip}}</div>'),e.put("scripts/ecsbuy/base/partials/customBuy/instanceClass.html",'<div class="custombuy-class"><div class="custombuy-class-title">{{classTyleText}}</div><div class="custombuy-class-config"><span class="custombuy-class-config-field" ng-repeat="config in configs"><div class="custombuy-class-config-field-title">{{config.title}}</div><div class="custombuy-class-config-field-value">{{config.text}}</div></span></div></div>'),e.put("scripts/ecsbuy/base/partials/customBuy/selectClass.html",'<div class="bk-form-row-{{config.theme || \'primary\'}}"><div aliyun-new-buy-buttontab class="inline-display" config="config" detail="detail" ng-model="value" options="options"><div custom-buy-instance-class item="item"></div></div><span aliyun-buy-inline-tips></span><!-- <span aliyun-buy-inline-select></span> --><div aliyun-buy-block-tips></div></div>'),e.put("scripts/ecsbuy/base/partials/dialog/recycleBinAgreement.html",'<div data-spm="kms"><div class="bk-dialog-head"><span class="bk-dialog-close bk-dialog-close-thin" data-dismiss="modal" aria-hidden="true" ng-click="$close()"><span class="aliyun-icon-wrong-thin"></span></span><h5 class="bk-dialog-title">{{config.title | translate}}</h5></div><div class="bk-dialog-body" aliyun-buy-preloader="isLoading"><div class="bk-box" style="width: 600px;height:{{config.height}};border:0 none;padding-top:15px"><div><div><div style="line-height: 20px" ng-bind-html="config.content | translate"></div></div><div style="margin-top:15px"><input id="pact" type="checkbox" ng-model="checked" checked="checked" value="1" style="margin-right: 3px"><label for="pact"><span aliyun-buy-ecs-order-terms order-term-url="{{config.termUrl}}" order-term-text="{{config.termText | translate}}"></span></label></div></div></div></div><div class="bk-dialog-foot ng-scope"><span ng-show="activateStatus == \'success\'" class="bk-mr2 bk-green"><i class="icon-yes-2"></i>{{config.successTip | translate}}</span> <span ng-show="activateStatus == \'failed\'" class="bk-mr2 bk-red">{{config.failedTip | translate}}</span><button aliyun-buy-button is-disabled="{{!checked}}" ng-click="signAgreement(checked)" theme="blue">{{config.signText | translate}}</button></div></div>'),e.put("scripts/ecsbuy/base/partials/disk/clouddiskSelect.html",'<div class="bk-form-row yundisk" ng-hide="options.visible===false"><div class="bk-form-row-cell"><div class="bk-form-row-li"><div aliyun-buy-select ng-model="value" detail="detail" option="options.items" state="options.state" short="true" style="float:left"></div><span class="bk-form-row-li-info bk-disk-cell bk-disk-cell-size bk-ml2"><span class="bk-disk-storage"><span ng-show="options.editable"><input aliyun-buy-ecs-datadisk-size-input ng-model="model4placeholder" placeholder="{{sizeRange}}" class="bk-disk-input" ng-class="{\'bk-disk-input-error\': showSizeError}" data-value="size" max="options.max" min="options.min" type="text" short="true" ng-focus="showSizeError=false" aliyun-buy-tooltip="{content:\'{{sizeRange}}\', theme:\'white\', trigger:\'hover\', offsetX: 20}"> <span class="bk-disk-unit">GB</span></span></span></span><!--IOPS--> <span><span class="bk-form-row-li-info bk-disk-cell bk-ml2" style="color: #000">{{iops}}</span> <span class="bk-form-row-li-info bk-disk-cell bk-iops">IOPS</span></span><!----> <span class="bk-form-row-li-info bk-disk-cell bk-ml2 bk-disk-cell-release" ng-show="encryptable"><span aliyun-buy-ecs-disk-encryption value="encrypted" disabled="snapshotId"></span></span> <span class="bk-ml5"><div aliyun-buy-ecs-datadisk-item-snapshot ng-show="options.loggedIn" logged-in="options.loggedIn" size="snapshotSize" id="snapshotId" encrypted="encrypted" name="snapshotName" region-id="options.regionId" region-name="options.regionName" max-size="options.max" editable="options.editable" show-snap-close="true">></div></span></div><div class="bk-form-row-txt" ng-bind-html="options.tip | translate" ng-show="options.tip"></div></div></div>'),e.put("scripts/ecsbuy/base/partials/disk/ecsDatadisk.html",'<div ng-hide="options.visible===false"><div ng-class="{\'bk-disk-show-header\':options.showHeader}"><div class="bk-form-row"><div class="bk-form-row-cell"><div class="bk-form-row-li"><div class="" style="overflow:hidden"><div class="bk-disk-title" ng-show="options.showHeader"><span class="bk-disk-cell bk-disk-cell-id" ng-bind-html="\'ECS_DATADISK_ID\' | translate"></span> <span class="bk-disk-cell bk-disk-cell-name" ng-bind-html="\'ECS_DATADISK_NAME\' | translate"></span> <span class="bk-disk-cell bk-disk-cell-type" ng-bind-html="\'ECS_DATADISK_KINDS\' | translate"></span> <span class="bk-disk-cell bk-disk-cell-size" ng-bind-html="\'ECS_DATADISK_SIZE\' | translate"></span> <span class="bk-disk-cell bk-disk-cell-iops bk-ml2" ng-if="!options.showConvertOption" ng-bind-html="\'ECS_DATADISK_IOPS\' | translate"></span> <span class="bk-disk-cell bk-disk-cell-snapshot" ng-if="!options.showConvertOption" ng-bind-html="\'ECS_DATADISK_SNAPSHOT\' | translate"></span> <span class="bk-disk-cell bk-disk-cell-mount bk-ml2" ng-bind-html="\'ECS_DATADISK_MOUNTPOINT\' | translate"></span> <span class="bk-disk-cell bk-disk-cell-payment bk-ml2" ng-bind-html="\'ECS_DATADISK_PAYMETHOD\' | translate"></span> <span class="bk-disk-cell bk-disk-cell-portable bk-ml2" ng-bind-html="\'ECS_DATADISK_SUPPORTUNMOUNT\' | translate"></span> <span class="bk-disk-cell bk-disk-cell-convert bk-ml2"></span></div></div><div class=""><div ng-repeat="disk in disks" class="bk-form-row-li" style="padding-bottom: 8px"><!-- <div aliyun-buy-ecs-datadisk-item is-exist-Snapshot="data_disk.isExistSnapshot" state="options.state" size="disk.size" types="data_disk.types" quota="data_disk.quotaNum" limit-types="disk.limitTypes" type="disk.type" max="disk.max" min="disk.min" detail="disk.detail" snapshot-id="disk.snapshot_id" snapshot-name="disk.snapshot_name" snapshot-disk-size="disk.snapshot_disk_size" mount-point="disk.mount_point" mount="data_disk.mount" release-with-ecs="disk.release_with_ecs" tag="disk.tag" portable="disk.portable" options="options" index="$index" onremove="removeDisk($index)"></div> --><div aliyun-buy-ecs-datadisk-item logged-in="options.loggedIn" region-id="options.regionId" region-name="options.regionName" show-extra-info="options.showHeader" editable="disk.options.editable" convertable="disk.options.convertable && !disk.inConvertableBlackList" types="disk.options.types" max-size="disk.options.maxSize" min-size="disk.options.minSize" portable="disk.options.portable" removable="disk.options.removable" original-payment-method="disk.options.originalPaymentMethod" mounts="mounts" size="disk.size" show-size-error="disk.showSizeError" type="disk.type" detail="disk.detail" snapshot="disk.snapshot" snapshot-size="disk.snapshotSize" mount="disk.mount" hide-release="options.hideRelease || disk.options.hideRelease" disable-snapshot="disk.options.disableSnapshot" disable-mount="disk.options.disableMount" disable-delete-item="disk.options.disableDeleteItem" release-with-ecs="disk.releaseWithEcs" encrypted="disk.encrypted" encryptable="disk.options.encryptable" payment-method="disk.paymentMethod" convert-charge-type="disk.convertChargeType" instance-id="disk.instanceId" instance-name="disk.instanceName" is-full-image="disk.isFullImage" show-convert-option="options.showConvertOption" onremove="removeDisk($index)"></div></div></div><div class="bk-disk-add-wraper" ng-show="options.addible"><div class="inline-block bk-disk-add" ng-click="addDisk()" data-spm-click="gostr=/aliyun;locaid=addNewDisk"><i class="bk-disk-add-icon" ng-class="{\'bk-disk-add-icon-disabled\':!addible}"><em class="bk-disk-add-icon-line"></em> <em class="bk-disk-add-icon-line-b"></em></i> <span class="bk-disk-add-txt" ng-class="{\'bk-disk-add-txt-disabled\':!addible,\'bk-lnk\':addible}"><span ng-if="addible" ng-bind-html="\'ecs.buy.component.disk.data.add\' | translate"></span><span ng-if="!addible" ng-bind-html="\'ecs.buy.component.disk.data.disableAdd\' | translate"></span></span></div><div class="inline-block bk-form-row-li-info" style="height: auto"><div class="inline-block bk-ml2 bk-mr2" style="vertical-align: top"><span ng-bind-html="\'ECS_DATADISK_UCANSELECT\' | translate"></span> <span class="bk-orange">{{options.diskMaxNumber - disks.length}}</span> <span ng-bind-html="\'ECS_DATADISK_PIECE\' | translate"></span></div><div class="inline-block" style="vertical-align: top"><div ng-repeat="(key,item) in tips"><span ng-repeat="method in options.paymentMethods"><span ng-if="method.value==item.paymentMethod">{{method.text}}&nbsp;</span></span><span></span> <span ng-repeat="type in options.diskTypes"><span ng-if="type.value==item.type">{{type.text}}</span></span><span></span> <span ng-show="item.showRestSize"><span ng-bind-html="\'ECS_DATADISK_REMAIN\' | translate"></span> <span>{{item.restSize}}</span> <span>GB</span></span> <span>{{item.portable?(\'ECS_DATADISK_SUPPORT_UNMOUNT\'| translate):(\'ECS_DATADISK_NOT_SUPPORT_UNMOUNT\' | translate)}}</span></div></div></div></div></div><div class="bk-form-row-txt" ng-if="options.tip"><span ng-bind-html="options.tip | translate"></span></div></div></div></div></div>'),e.put("scripts/ecsbuy/base/partials/disk/ecsDatadiskItem.html",'<div class="ecs-bk-disk"><div class="bk-disk" ng-class="{\'bk-disk-show-extra-info\':showExtraInfo()}"><!--ID--><span class="bk-form-row-li-info bk-disk-cell bk-disk-cell-id" ng-if="convertable()"><span class="bk-form-row-li-info" ng-if="!editable()"><span class="bk-black">{{instanceId}}</span></span></span><!----> <span class="bk-form-row-li-info bk-disk-cell bk-disk-cell-name" ng-if="convertable()"><span class="bk-form-row-li-info" ng-if="!editable()"><span class="bk-black" aliyun-truncate-text="" source-text="{{instanceName || \'-\'}}" text-length="9" copy-text="true"></span></span></span><!----> <span class="bk-form-row-li-info bk-disk-cell bk-disk-cell-type"><span class="bk-form-row-li-info" ng-if="types().length <= 1 || !editable()"><span class="bk-black">{{detail.type.text}}</span></span> <span aliyun-buy-select class="bk-select bk-disk-cell" option="types()" spm="datadisk" detail="detail.type" ng-model="type" short="true" ng-show="types().length >= 2 && editable()"></span></span><!----> <span class="bk-form-row-li-info bk-disk-cell bk-disk-cell-size"><span class="bk-disk-storage"><span ng-show="editable()"><input aliyun-buy-ecs-datadisk-size-input ng-model="model4placeholder" placeholder="{{sizeRange}}" class="bk-disk-input" ng-class="{\'bk-disk-input-error\': showSizeError}" data-value="size" max="maxSize()" min="minSize()" type="text" ng-focus="showSizeError=false" aliyun-buy-tooltip="{content:\'{{sizeHoverTip}}\', theme:\'white\', trigger:\'hover\', offsetX: 20, maxWidth: 510}"> <span class="bk-disk-unit">GB</span></span></span> <span ng-show="!editable()"><span class="bk-disk-size">{{size}}</span> <span class="bk-pale">GB</span></span></span><!--IOPS--> <span ng-hide="iops == \'-\' || showConvertOption"><span class="bk-form-row-li-info bk-disk-cell bk-ml2" style="color: #000">{{iops}}</span> <span class="bk-form-row-li-info bk-disk-cell bk-iops">IOPS</span></span><!----> <span class="bk-form-row-li-info bk-disk-cell bk-ml2 bk-disk-cell-release" ng-show="encryptable()"><span aliyun-buy-ecs-disk-encryption value="encrypted" disabled="snapshot"></span></span><!----> <span ng-hide="showConvertOption" class="bk-form-row-li-info bk-disk-cell bk-disk-cell-snapshot bk-ml2"><div aliyun-buy-ecs-datadisk-item-snapshot ng-show="loggedIn()" logged-in="loggedIn()" size="snapshotSize" encrypted="encrypted" id="snapshot" name="detail.snapshot.name" region-id="regionId()" region-name="regionName" max-size="maxSize()" editable="editable() && !disableSnapshot" show-snap-close="!isFullImage"></div></span><!----> <span class="bk-form-row-li-info bk-disk-cell bk-disk-cell-mount bk-ml2"><div aliyun-buy-ecs-datadisk-item-mount mounts="mounts()" mount="mount" editable="editable() && !disableMount"></div></span><!----> <span ng-if="showExtraInfo()"><span class="bk-form-row-li-info bk-disk-cell bk-disk-cell-payment bk-ml2"><span ng-if="paymentMethod==\'postpay\'">{{\'ECS_BUY_POSTPAY\'|translate}}</span> <span ng-if="paymentMethod==\'prepay\'">{{\'ECS_BUY_YEARMONTH\'|translate}}</span></span> <span class="bk-form-row-li-info bk-disk-cell bk-disk-cell-portable bk-ml2">{{portable()?(\'ecs.buy.console.batch.table.td.support\'|translate):(\'ecs.buy.console.batch.table.td.no_support\'|translate)}}</span></span><!----> <span class="bk-form-row-li-info bk-disk-cell bk-disk-cell-convert bk-ml2" ng-show="convertable()"><label><input class="bk-mr1" type="checkbox" ng-model="convertChargeType"><span ng-bind-html="((originDisk.paymentMethod==\'prepay\')?\'ECS_DATADISK_CONVERT\':\'ECS_DATADISK_CONVERT_TO_PREPAID\') | translate"></span></label></span><!----> <span class="bk-form-row-li-info bk-disk-cell bk-disk-cell-release bk-ml2" ng-show="portable() && !hideRelease()==true"><label class="bk-disk-cell"><input class="bk-mr1" type="checkbox" ng-model="releaseWithEcs"><span ng-bind-html="\'ECS_DATADISK_RELEASE\' | translate"></span></label><a class="bk-ml1" href="javascript:;" aliyun-buy-tooltip="{{\'ECS_RELEASEWITHECS_TIP\' | translate}}"><i class="aliyun-icon-help"></i></a></span><!----> <span ng-show="editable() && !disableDeleteItem" class="bk-disk-delete" data-spm-click="gostr=/aliyun;locaid=deletedisk" ng-click="remove()"><i class="aliyun-icon-wrong-thin"></i></span></div></div>'),e.put("scripts/ecsbuy/base/partials/disk/ecsDatadiskItemMount.html",'<span><a ng-show="editable()" class="bk-disk-mount bk-form-row-li-info" href="javascript:;" data-spm-click="gostr=/aliyun;locaid=diskmount" aliyun-buy-tooltip="{templateUrl:\'scripts/ecsbuy/base/partials/disk/ecsDatadiskItemMountList.html\',handle:\'tipHandle\', offsetY: -2, theme: \'border\'}"><span ng-if="mount">{{mount}}</span> <span ng-if="!mount">{{\'ECS_DATADISK_AUTO\'|translate}}</span></a> <span ng-show="!editable()" class="bk-form-row-li-info">{{mount}}</span></span>'),e.put("scripts/ecsbuy/base/partials/disk/ecsDatadiskItemMountList.html",'<div style="min-width: 100px; height: 192px" ng-hide="true"><ul class="bk-datadisk-mount-list"><li style="padding: 5px 0" ng-class="{\'sedi-text-gray checked\' : item.checked}" ng-repeat="item in mounts()" ng-click="select(item)">{{item.text}}</li></ul></div><div class="bk-disk-snapshot-tipbox" ng-bind-html="\'ASKTIP__TOOLTIP_SNAPSHOT\' | translate"></div>'),e.put("scripts/ecsbuy/base/partials/disk/ecsDatadiskItemSnapshot.html",'<span class="bk-snap-disk"><span class="bk-form-row-li-info bk-disk-snapshot bk-ml2"><a ng-show="editable()" href="javascript:;" data-spm-click="gostr=/aliyun;locaid=disksnapshot" aliyun-buy-tooltip="{templateUrl:\'scripts/ecsbuy/base/partials/disk/ecsDatadiskItemSnapshotList.html\',handle:\'listHandle\', theme:\'blank\', maxWidth :\'500px\', trigger: \'click\'}" ng-show="states.visible"><span ng-click="open()"><span class="bk-ml2" ng-if="id" aliyun-buy-tooltip="{content:\'{{hoverTip}}\', theme:\'white\', trigger:\'hover\', offsetX: 20}">{{\'ECS_SNAP_SNAPNAME\'|translate}}{{name|| \'--\'}}</span> <span ng-if="!id" ng-bind-html="\'ECS_DATADISK_CSNAPSHOT\' | translate"></span></span></a> <span class="bk-ml2" ng-show="!editable()">{{name || id}}</span></span> <span ng-show="id && showSnapClose" class="bk-disk-delete" data-spm-click="gostr=/aliyun;locaid=deleteSnapshot" ng-click="remove()"><i class="aliyun-icon-wrong-thin"></i></span></span>'),e.put("scripts/ecsbuy/base/partials/disk/ecsDatadiskItemSnapshotList.html",'<div class="bk-snpshot-form"><div style=""><div class="bk-title-head">{{\'ECS_SNAP_LIST\'|translate}}[{{regionName}}]<div class="search-box"><input ng-if="searchModel.field==\'snapshotNickName\'" type="text" class="bk-ecs-snap-input" placeholder="{{\'ECS_SNAP_MSEARCH\'|translate}}" ng-model="searchModel.key"> <input ng-if="searchModel.field==\'snapshotId\'" type="text" class="bk-ecs-snap-input" placeholder="{{\'ECS_SNAP_JSEARCH\'|translate}}" ng-model="searchModel.key"> <input ng-if="searchModel.field==\'creationTime\'" type="text" readonly="readonly" class="bk-ecs-snap-input" min="\'{{searchDate.minDate}}\'" max="\'{{searchDate.maxDate}}\'" init-date="searchDate.initDate" show-weeks="false" show-button-bar="false" toggle-weeks-text="{{\'ECS_WEEK\'|translate}}" datepicker-mode current-text="{{\'ECS_TODAY\'|translate}}" clear-text="{{\'ECS_CLEAR\'|translate}}" close-text="{{\'ECS_OK\'|translate}}" aliyun-buy-datepicker-popup="yyyy-MM-dd" placeholder="{{\'ECS_SNPP_CREATETIME_FORMAT\' | translate}}" ng-model="searchModel.key"> <i class="aliyun-icon-wrong-thin bk-snapshot-close-icon" ng-show="!!searchModel.key" ng-click="clearKey()"></i><div class="icon-wrapper" style="background-color: #00c1de; line-height: 28px;height: 28px" ng-click="querySnapshots()"><span class="aliyun-icon-Search"></span></div></div><span class="bk-snapshot-select"><select class="form-control bk-ecs-snap-input" ng-model="searchModel.field" ng-options="obj.value as obj.text for obj in searchFields"></select></span></div><div class="bk-snapshot-table"><div class="table-head"><div class="td td_normal" ng-bind-html="\'ECS_SNAP_SNAPID\' | translate"></div><div class="td td_normal" ng-bind-html="\'ECS_SNAP_SNAPNAME\' | translate"></div><div class="td td_small" ng-bind-html="\'ECS_SNAP_SIZE\' | translate"></div><div class="td td_normal" ng-bind-html="\'ECS_SNAP_CREATETIME\' | translate"></div><div style="clear:both"></div></div></div><div aliyun-buy-preloader="states.searching" aliyun-buy-preloader-msg="states.searchErrorMsg" aliyun-buy-preloader-msg-trigger="states.searchError"><div class="bk-snapshot-list" style="height:200px; padding:8px 0"><div class="bk-snapshot-table"><div class="table-body"><div ng-if="searchModel.total === 0" style="text-align: center; line-height: 143px"><span ng-if="!searchModel.key" ng-bind-html="\'ECS_SNAP_UNSELECT\' | translate"></span> <span ng-if="!!searchModel.key" ng-bind-html="\'ECS_SNAP_NORESULT\' | translate"></span></div><div class="table-row" ng-repeat="item in searchModel.currentPageResult track by $index" ng-click="selectSnapshot(item)" ng-class="{\'sedi-text-gray unit-disabled\':!checkDiskSelectable(item.disk, minSize(), maxSize())}"><div class="td td_normal" title="{{\'ECS_SNAP_SNAPID\'|translate}} : {{item.id}}">{{item.id}}</div><div class="td td_normal" title="{{\'ECS_SNAP_SNAPNAME\'|translate}} : {{item.name}}">{{item.name || ""}}</div><div class="td td_small" title="{{\'ECS_SNAP_SIZE\'|translate}} : {{item.disk}}">{{item.disk}}GB</div><div class="td td_normal" title="{{\'ECS_SNAP_CREATETIME\'|translate}} : {{item.time}}">{{item.time}}</div><div style="clear:both"></div></div></div></div><div style="margin-top: 20px"><span class="bk-paging bk-paging-rn"><span class="bk-paging-list"><span class="bk-paging-prev" ng-class="{\'bk-paging-disabled\':!pagination.previousEnabled}" ng-click="querySnapshots(\'previous\')" ng-bind-html="\'ECS_PREV\' | translate"></span> <span class="bk-paging-next" ng-class="{\'bk-paging-disabled\':!pagination.nextEnabled}" ng-click="querySnapshots(\'next\')" ng-bind-html="\'ECS_NEXT\' | translate"></span></span></span></div></div></div></div></div>'),e.put("scripts/ecsbuy/base/partials/disk/ecsDiskEncryption.html",'<span><label ng-click="clickEncryption(value)" data-spm-click="gostr=/aliyun;locaid=encyrpted"><input class="bk-mr1" type="checkbox" ng-model="value" ng-disabled="disabled"><span ng-bind-html="\'ECS_DATADISK_ENCYPTED\' | translate"></span></label><a class="bk-ml1" href="javascript:;" aliyun-buy-tooltip="{{\'ECS_DATADISK_ENCYPTED_TIP\' | translate}}"><i class="aliyun-icon-help"></i></a></span>'),e.put("scripts/ecsbuy/base/partials/disk/ecsLocalStorage.html",'<div class="bk-form-row"><div class="bk-form-row-cell"><div class="bk-form-row-li"><div class="bk-disk-show-header-localstorage"><span><span class="bk-disk-cell bk-disk-cell-type" ng-bind-html="\'ECS_DATADISK_KINDS\' | translate"></span> <span class="bk-disk-cell bk-disk-cell-size bk-ml2" ng-bind-html="\'ECS_DATADISK_SIZE\' | translate"></span> <span ng-hide="options.hideIOPS" class="bk-disk-cell bk-disk-cell-iops bk-ml2" ng-bind-html="\'ECS_DATADISK_IOPS\' | translate"></span> <span class="bk-disk-cell bk-disk-cell-mount bk-ml2"></span> <span class="bk-disk-cell bk-disk-cell-mount {{options.hideIOPS ? \' bk-ml70\' : \'bk-ml2\'}}" ng-bind-html="\'ECS_DATADISK_MOUNTPOINT\' | translate"></span></span></div><div ng-repeat="disk in options.disks" class="bk-form-row-li" style="padding-bottom: 5px"><div aliyun-buy-ecs-datadisk-item logged-in="options.loggedIn" region-id="options.regionId" region-name="options.regionName" show-extra-info="options.showHeader" editable="options.editable" convertable="disk.options.convertable && !disk.inConvertableBlackList" types="options.types" max-size="options.maxSize" min-size="options.minSize" portable="options.portable" removable="options.removable" original-payment-method="disk.options.originalPaymentMethod" mounts="options.mounts" size="disk.size" show-size-error="disk.showSizeError" type="disk.type" detail="disk.detail" snapshot="disk.snapshot" snapshot-size="disk.snapshotSize" mount="disk.mount" hide-release="options.hideRelease || disk.options.hideRelease" disable-snapshot="disk.options.disableSnapshot" disable-mount="disk.options.disableMount" disable-delete-item="disk.options.disableDeleteItem" release-with-ecs="disk.releaseWithEcs" payment-method="disk.paymentMethod" convert-to-postpay="disk.convertToPostpay" onremove="removeDisk($index)"></div></div></div><div class="bk-form-row-txt" ng-show="options.state==\'error\'"><span class="bk-form-status bk-form-error"><i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message" ng-if="options.stateMessage" ng-bind-html="options.stateMessage"></span></span></div></div></div>'),e.put("scripts/ecsbuy/base/partials/disk/ecsSystemdisk.html",'<div ng-hide="options.visible===false"><div class="bk-form-row-cell bk-sysdisk"><div class="bk-form-row-li"><span aliyun-buy-select class="bk-disk-cell bk-select" option="options.items" spm="sysdisk" short="true" detail="detail" ng-model="category"></span> <span class="bk-form-row-li-info bk-disk-cell bk-disk-cell-size"><span class="bk-disk-storage"><span><input aliyun-buy-ecs-datadisk-size-input ng-model="model4placeholder" placeholder="{{options.sizeRange}}" class="bk-disk-input" ng-class="{\'bk-disk-input-error\': showSizeError}" data-value="size" max="options.max" min="options.min" type="text" ng-focus="showSizeError=false" aliyun-buy-tooltip="{content:\'{{options.sizeHoverTip}}\', theme:\'white\', trigger:\'hover\', offsetX: 20}"> <span class="bk-disk-unit">GB</span></span></span></span> <span class="bk-form-row-li-info bk-ml2" style="color: #000">{{iops}}</span> <span class="bk-form-row-li-info">IOPS</span> <span class="bk-form-row-li-info bk-ml2">{{\'ECS_SYSDISK_DEVICE_AMOUNT\'|translate}}{{options.mount.text}}</span></div><div class="bk-form-row-txt"><div ng-show="options.showWindows2003Tip" ng-bind-html="\'YUNDISK_WINDOWS_2003_RESIZE\' | translate"></div><div ng-bind-html="options.tip" ng-hide="!options.tip"></div></div><div class="bk-form-status bk-form-error bk-form-row-txt" ng-if="options.state===\'error\'"><i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message" ng-bind-html="options.stateMessage"></span></div></div></div>'),e.put("scripts/ecsbuy/base/partials/disk/kmsActivationDialog.html",'<div data-spm="kms"><div class="bk-dialog-head"><span class="bk-dialog-close bk-dialog-close-thin" data-dismiss="modal" aria-hidden="true" ng-click="$close()"><span class="aliyun-icon-wrong-thin"></span></span><h5 class="bk-dialog-title">{{\'ECS_KMS_DIALOG_TITLE\' | translate}}</h5></div><div class="bk-dialog-body" aliyun-buy-preloader="isLoading"><div class="bk-box"><div><div><div style="line-height: 20px" ng-bind-html="\'ECS_KMS_DIALOG_CONTENT\' | translate"></div></div><div style="margin-top:15px"><input id="kmsPact" type="checkbox" ng-model="checked" checked="checked" value="1" style="margin-right: 3px"><label for="kmsPact"><span aliyun-buy-ecs-order-terms order-term-url="{{kmsTermUrl}}" order-term-text="{{\'KMS_TERMS\' | translate}}"></span></label></div></div></div></div><div class="bk-dialog-foot ng-scope"><span ng-show="activateStatus == \'success\'" class="bk-mr2 bk-green"><i class="icon-yes-2"></i>{{\'ECS_RESULT_SUCCESS\' | translate}}</span> <span ng-show="activateStatus == \'failed\'" class="bk-mr2 bk-red">{{\'ECS_KMS_ACTIVATE_FAILED_TIP\'|translate}}</span><button aliyun-buy-button is-disabled="{{!checked}}" ng-click="activateKms(checked)" theme="blue">{{\'ECS_KMS_ACTIVATE\' | translate}}</button></div></div>'),e.put("scripts/ecsbuy/base/partials/image/ecsImage.html",'<div ng-hide="options.visible===false"><div class="bk-form-row-cell"><div class="bk-form-row-li"><div aliyun-buy-select-dynamic ng-model="value" fetch-config="fetchConfig" detail="detail" placeholder="{{options.placeholder}}" option="options.items" state="options.state"></div></div><div class="bk-form-status bk-form-error bk-form-row-txt" ng-if="options.state===\'error\' && options.stateMessage"><i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message" ng-bind-html="options.stateMessage"></span></div></div></div>'),e.put("scripts/ecsbuy/base/partials/image/imageFromMarket.html",'<div ng-hide="options.visible===false"><label class="bk-form-row-name"></label><div class="bk-form-row-cell" style="position:relative;top:-15px;line-height:22px"><div class="bk-form-row-txt" ng-show="options.state==\'error\'"><span class="bk-form-status bk-form-error"><i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message" ng-if="options.errorTip" ng-bind-html="options.errorTip"></span><span class="bk-form-status-message" ng-if="!options.errorTip" ng-bind-html="options.stateMessage"></span></span></div></div></div>'),e.put("scripts/ecsbuy/base/partials/image/imageOffline.html",'<div ng-hide="options.visible===false"><div ng-bind-html="\'ECS_IMG_OFFLINE_WINDOWS2003_TIP\' | translate"></div><div style="position:relative;top:5px"><input ng-hide="value==\'agree\'" class="bk-mr1" ng-click="agree()" type="checkbox" ng-checked="value!=\'show\'"> <span ng-bind-html="\'ECS_IMG_OFFLINE_WINDOWS2003_AGREEMENT\' | translate"></span></div><div class="bk-form-row-txt" ng-show="options.state==\'error\'"><span class="bk-form-status bk-form-error"><i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message" ng-if="options.errorTip" ng-bind-html="options.errorTip"></span><span class="bk-form-status-message" ng-if="!options.errorTip" ng-bind-html="options.stateMessage"></span></span></div></div>'),e.put("scripts/ecsbuy/base/partials/image/marketImage.html",'<div ng-hide="options.visible===false"><div class="bk-form-row-cell"><div class="bk-form-row-text" ng-if="value">{{detail.text}}</div><div class="bk-form-row-li"><span class="bk-rect-select" ng-click="openImageMarket()" data-spm-click="gostr=/aliyun;locaid=selectFromMarketplace"><i class="bk-rect-select-icon" ng-class="{\'bk-button-error\':options.state==\'error\'}"><em class="bk-rect-select-icon-rect"></em> <em class="bk-rect-select-icon-rect"></em> <em class="bk-rect-select-icon-rect"></em> <em class="bk-rect-select-icon-rect"></em></i> <span class="bk-rect-select-txt bk-click-link" ng-class="{\'bk-rect-select-txt-error\':options.state==\'error\'}">{{value?\'ECS_RESELECT_IMAGE\':\'ECS_SELECT_FROM_IMAGE_MARKET\' | translate}}</span></span> <span class="bk-form-row-li-info bk-ml2" ng-if="options.needLogin" ng-bind-html="\'ECS_IMG_NEEDLOGIN\' | translate"><a ng-click="login()" style="cursor: pointer" ng-bind-html="\'ECS_IMG_LOGIN\' | translate"></a></span></div><div class="bk-form-row-txt" ng-bind-html="options.tip" ng-show="options.tip"></div><div class="bk-form-status bk-form-error bk-form-row-txt" ng-if="options.state===\'error\' && options.stateMessage"><i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message" ng-bind-html="options.stateMessage"></span></div></div></div>'),e.put("scripts/ecsbuy/base/partials/image/marketImageDialog.html",'<div data-spm="image"><div class="bk-image-market-filterbox" ng-if="filterModel.showMarketFilterBox"><div class="bk-filterbox-backgroud" ng-click="filterModel.close()"></div></div><div class="bk-dialog-head" aliyun-buy-drag box-class="bk-dialog" fill-left-px="340"><span class="bk-dialog-close bk-dialog-close-thin" data-dismiss="modal" aria-hidden="true" ng-click="$close()"><span class="aliyun-icon-wrong-thin"></span></span><h5 class="bk-dialog-title">{{\'ECS_IMG_MARKET\' | translate}}[{{regionName}}]</h5></div><div class="bk-dialog-body" aliyun-buy-preloader="!isReady"><iframe id="imagemarket-iframe" ng-src="{{iframeSrc}}" class="imagemarket-dialog-iframe" width="800" height="550" border="0"></iframe></div></div>'),e.put("scripts/ecsbuy/base/partials/instanceType/instanceType.html",'<div class="bk-form-row-cell"><div class="bk-pb5 font-size14"><span class="bk-light-gray">{{\'ECS_INSTANCE_TYPE\'|translate}}</span>{{detail.text}}</div><div class="bk-form-row-li" ng-class="{\'bk-mt-20\':detail.text && detail.text !== \'\'}"><div style="float: left"><span class="bk-rect-select bk-security-select" ng-click="openDialog()" data-spm-click="gostr=/aliyun;locaid=selectInstanceType"><i class="bk-rect-select-icon" ng-class="{\'bk-button-error\':options.state==\'error\'}"><em class="bk-rect-select-icon-rect"></em> <em class="bk-rect-select-icon-rect"></em> <em class="bk-rect-select-icon-rect"></em> <em class="bk-rect-select-icon-rect"></em></i> <span class="bk-rect-select-txt bk-click-link" ng-class="{\'bk-rect-select-txt-error\':options.state==\'error\'}">{{\'ECS_INSTANCE_TYPE_RESELECT\'|translate}}</span></span></div><div style="float: left;\n              height: 30px;\n              line-height: 30px;\n              margin-left: 80px" class="bk-color-999" ng-show="historyInstanceType.items.length > 0">{{\'ECS_INSTANCE_TYPE_HISTORY\'|translate}}</div><div style="float: left;margin-left: 15px" ng-show="historyInstanceType.items.length > 0"><span aliyun-buy-select ng-model="historyInstanceType.value" detail="historyInstanceType.detail" option="historyInstanceType.items" long="true" placeholder="{{\'ECS_INSTANCE_TYPE_HISTORY_PH\'|translate}}"></span></div><div aliyun-buy-inline-tips class="aliyun-inline-tips"></div></div></div>'),e.put("scripts/ecsbuy/base/partials/instanceType/instanceTypeDialog.html",'<div data-spm="instance"><div class="bk-dialog-head" aliyun-buy-drag box-class="bk-dialog" fill-left-px="340"><span class="bk-dialog-close bk-dialog-close-thin" data-dismiss="modal" aria-hidden="true" ng-click="$close()"><span class="aliyun-icon-wrong-thin"></span></span><div class="bk-dialog-title-wrapper" style="margin-right: 100px"><h5 class="bk-dialog-title"></h5><div class="bk-theme-generation2 dialog-title-select-wrapper"><span aliyun-buy-select ng-model="customizeGeneration.value" detail="customizeGeneration.detail" option="customizeGeneration.items" short="true"></span></div></div><div class="bk-dialog-title-wrapper"><h5 class="bk-dialog-title">vCPU</h5><div class="bk-theme-generation2 dialog-title-select-wrapper"><span aliyun-buy-select ng-model="cpuFilter.value" detail="cpuFilter.detail" option="cpuFilter.items" placeholder=" vCPU" short="true"></span></div></div><div class="bk-dialog-title-wrapper"><h5 class="bk-dialog-title"></h5><div class="bk-theme-generation2 dialog-title-select-wrapper"><span aliyun-buy-select ng-model="memoryFilter.value" detail="memoryFilter.detail" option="memoryFilter.items" placeholder="" short="true"></span></div></div><div class="bk-dialog-title-wrapper"><h5 class="bk-dialog-title"></h5><input type="text" ng-model="instanceTypeFilter.value" name="instanceTypeFilter" ng-maxlength="18" ng-pattern="/^[0-9a-zA-Z\\.\\-]*$/" ng-change="instanceTypeFilter.change()" placeholder="ecs.sn2.large" class="bk-form-input instance-type-filter-input"></div></div><div class="bk-dialog-body"><!-- <div class="sedi-buy-image-loading" ng-show="isLoading">\n    </div> --><div class="bk-dialog-box" style="height: 475px"><div class="bk-items-min"><div class="filter-bar"><div class="filter-category"><span class="filter-category-label"></span><span class="filter-category-content"><span aliyun-buy-buttontab-light items="computingArchitecture.items" value="computingArchitecture.value" click="computingArchitecture.select" default-value="computingArchitecture.defaultValue"></span></span></div><div class="filter-category"><span class="filter-category-label"></span><span class="filter-category-content"><span aliyun-buy-buttontab-light items="customizeFamily.items" value="customizeFamily.value" click="customizeFamily.select" default-value="customizeFamily.defaultValue"></span></span></div></div><div class="bk-dialog-table-wrapper"><table class="bk-dialog-table" id="instanceTypeTable"><thead><tr class="bk-dialog-table-header"><th></th><th ng-click="sortColumn(\'family\')" data-spm-click="gostr=/aliyun;locaid=sort-family"><span class="bk-cursor-pointer"></span></th><th ng-click="sortColumn(\'instanceType\')" data-spm-click="gostr=/aliyun;locaid=sort-instanceType"><span class="bk-cursor-pointer"></span></th><th ng-click="sortColumn(\'cpu\')" data-spm-click="gostr=/aliyun;locaid=sort-cpu"><span class="bk-cursor-pointer">vCPU</span></th><th ng-click="sortColumn(\'memory\')" data-spm-click="gostr=/aliyun;locaid=sort-memory"><span class="bk-cursor-pointer"></span></th><th ng-show="customizeFamily.value == \'basic\'">baseline </th><th ng-click="sortColumn(\'physicalProcessor\')" data-spm-click="gostr=/aliyun;locaid=sort-physicalProcessor"><span class="bk-cursor-pointer"></span></th><th ng-click="sortColumn(\'clockSpeed\')" data-spm-click="gostr=/aliyun;locaid=sort-clockSpeed"><span class="bk-cursor-pointer"></span></th><th ng-show="tableHeadSetting.intranetBandwidth"></th><th ng-show="tableHeadSetting.privatePPS"></th><th ng-show="customizeFamily.value != \'basic\'"></th><th ng-show="customizeFamily.value != \'basic\'">GPU/FPGA</th><!--<th ng-show="tableHeadSetting.intelAESNI">Intel AES-NI</th>--><!--<th ng-show="tableHeadSetting.intelAVX">Intel AVX</th>--><!--<th ng-show="tableHeadSetting.intelTurbo">Intel Turbo</th>--><!--<th ng-click="settingThead()" style="text-align: right"><span data-spm-click="gostr=/aliyun;locaid=settingThead"--><!--aliyun-buy-tooltip="{templateUrl:\'scripts/ecsbuy/base/partials/instanceType/tableHeadSetting.html\',handle:\'tableHeadHandle\', theme:\'blank\', maxWidth :\'500px\', trigger: \'click\'}"><i--><!--class="icon-setup bk-cursor-pointer"></i></span></th>--></tr></thead><tbody><tr ng-show="instanceType.items.length > 0" class="bk-dialog-table-tr" ng-repeat="item in instanceType.items track by $index" ng-click="instanceType.select(item)" data-spm-click="gostr=/aliyun;locaid={{dotToDash(item.value)}}" ng-mouseenter="item.hover = true" ng-mouseleave="item.hover = false" ng-class="{\'bk-dialog-table-body-even\':$index % 2 }"><td><input ng-value="item.value" ng-model="instanceType.value" name="instanceTypeRaido" type="radio" class="shop-radio"></td><td>{{item.familyName}} <span ng-show="getAskTip(item.family)"><a class="bk-font-size-12 bk-ml1" ng-mousemove="item.hover = true" ng-style="{\'visibility\': item.hover ? \'visible\':\'hidden\', \'color\': \'#9B9EA0\', \'text-decoration\': \'none\'}" href="javascript:;" data-spm-click="gostr=/aliyun;locaid=aksTip-{{dotToDash(item.family)}}" aliyun-buy-tooltip="{{getAskTip(item.family)}}"><i class="aliyun-icon-help"></i></a></span></td><td>{{item.value}}</td><td class="bk-color-000">{{item.cpu}} </td><td class="bk-color-000">{{item.memory}} GB</td><td ng-show="customizeFamily.value == \'basic\'">{{item.baselineCredit != undefined ? item.baselineCredit + \' %\' : \'-\'}}</td><td>{{item.physicalProcessor ? item.physicalProcessor : \'-\'}}</td><td>{{item.clockSpeed ? item.clockSpeed : \'-\'}}</td><td>{{item.intranetBandwidth ? item.intranetBandwidth + \' Gbps\' : \'-\'}}</td><td>{{item.privatePPS ? item.privatePPS + \'  PPS\' : \'-\'}}</td><td ng-show="customizeFamily.value != \'basic\'">{{item.localStorageAmount ? item.localStorageAmount + \' * \' + item.localStorageCapacity + \' GB\' : \'-\'}}</td><td ng-show="customizeFamily.value != \'basic\'">{{item.gpuAmount ? item.gpuAmount + \' * \' + item.gpuSpec : \'-\'}}</td><!--<td ng-show="tableHeadSetting.intelAESNI">-</td>--><!--<td ng-show="tableHeadSetting.intelAVX">-</td>--><!--<td ng-show="tableHeadSetting.intelTurbo">-</td>--><!--<td></td>--></tr><tr ng-show="instanceType.items.length == 0" class="bk-dialog-table-tr"><td ng-show="valueAll.iooptimized == \'none\'" colspan="20" class="bk-text-align-center"> I/O </td><td ng-show="valueAll.iooptimized != \'none\'\n                        && customizeFamily.value == \'basic\'\n                        && customizeGeneration.value == \'last-generation\'" colspan="20" class="bk-text-align-center"></td><td ng-show="valueAll.iooptimized != \'none\' && valueAll.networkType != \'1\'" colspan="20" class="bk-text-align-center"></td><td ng-show="valueAll.iooptimized != \'none\' && valueAll.networkType == \'1\'" colspan="20" class="bk-text-align-center"></td></tr></tbody></table></div></div></div></div><div class="bk-dialog-footer"><span class="footer-label"><span class="footer-text">{{selectedInstanceTypeDetail}}</span></span><span class="footer-ensure" ng-click="ensure()"></span></div></div>'),e.put("scripts/ecsbuy/base/partials/instanceType/tableHeadSetting.html",'<div class="table-header"><div class="table-header-item"><label><input type="checkbox" ng-model="tableHeadSetting.localSSD" name="tableHeadSettingName"><span class="table-header-text"></span></label></div><div class="table-header-item"><label><input type="checkbox" ng-model="tableHeadSetting.GPUFPGA" name="tableHeadSettingName"><span class="table-header-text">GPU/FPGA</span></label></div><!--<div class="table-header-item">\n    <label><input type="checkbox" ng-model="tableHeadSetting.intelAESNI" name="tableHeadSettingName"><span\n      class="table-header-text">Intel AES-NI</span></label>\n  </div>\n  <div class="table-header-item">\n    <label><input type="checkbox" ng-model="tableHeadSetting.intelAVX" name="tableHeadSettingName"><span\n      class="table-header-text">Intel AVX</span></label>\n  </div>\n  <div class="table-header-item">\n    <label><input type="checkbox" ng-model="tableHeadSetting.intelTurbo" name="tableHeadSettingName"><span\n      class="table-header-text">Intel Turbo</span></label>\n  </div>--></div>'),e.put("scripts/ecsbuy/base/partials/network/aliyunBuyEcsVpc.html",'<div ng-hide="options.visible===false || config().visible===false"><!-- <div class="bk-form-row-name"></div> --><div class="bk-form-row-cell bk-select-linkage"><div class="bk-form-row-li"><div class="bk-select-1" aliyun-buy-select-dynamic ng-model="vpcId" ng-disabled="!options.vpcItems" placeholder="{{options.vpcPlaceholder}}" option="options.vpcItems" state="options.state" fetch-config="options.fetchConfigForVpc" detail="options.vpcDetail"></div><div class="bk-select-2" aliyun-buy-select-dynamic ng-model="vswitchId" placeholder="{{options.vswitchPlaceholder}}" ng-disabled="!vpcId" option="options.vswitchItems" state="options.state" fetch-config="options.fetchConfigForVSwitch" detail="options.vswitchDetail" aliyun-buy-tooltip="{content:\'{{options.vswitchHoverTip}}\', theme:\'white\', trigger:\'hover\', offsetX: 20}"></div><span ng-if="options.ipTip"><span ng-bind-html="options.ipTip | translate"></span></span></div><div class="bk-form-row-txt" ng-if="options.tip"><span ng-bind-html="options.tip | translate"></span></div><div class="bk-form-row-txt" ng-if="options.zoneTip" style="margin-top:-5px"><span ng-bind-html="options.zoneTip | translate"></span></div></div></div>'),e.put("scripts/ecsbuy/base/partials/network/networkInterface.html",'<div class="bk-form-row"><div><span class="bk-form-row-name">eth0</span> <span class="bk-form-row-cell"><span class="bk-form-row-li"><span style="width: 150px; display: inline-block;position: relative;top: -3px"></span> <span class="bk-form-row-li-info bk-ml5" style="width:285px; display:inline-block"><span class="bk-color-000" aliyun-truncate-text source-text="{{valueAll.vSwitchText != valueAll.vSwitchId ? (valueAll.vSwitchText + \' / \' + valueAll.vSwitchId) : valueAll.vSwitchId}}" text-length="25" copy-text="true"></span></span> <span class="bk-form-row-li-info bk-ml5"> IP </span></span></span></div><div class="bk-mt4" ng-repeat="slave in interface.slaves track by $index"><span class="bk-form-row-name">eth{{$index + 1}}</span> <span class="bk-form-row-cell"><span class="bk-form-row-li"><span aliyun-buy-select option="interface.options.items" short="true" ng-model="value.interfaceValues[$index]"></span> <span class="bk-form-row-li-info bk-ml5 bk-pull-left" style="float:left"></span> <span aliyun-buy-select-dynamic ng-model="value.vSwitchValues[$index]" state="value.vSwitchStates[$index]" placeholder="{{vSwitch.options.vSwitchPlaceholder}}" option="vSwitch.options.items" fetch-config="vSwitch.options.fetchConfigForVSwitch" detail="options.vpcDetail"></span> <span class="bk-form-row-li-info bk-ml5"> IP </span> <span class="bk-form-row-li-info bk-ml5"><i class="icon-yes bk-green bk-mr1" style="position: relative; top:-3px"></i></span> <span class="bk-form-raw-li-info bk-ml5"><span class="bk-network-interface-delete" data-spm-click="gostr=/aliyun;locaid=deleteInterface" ng-click="removeInterface($index)"><i class="aliyun-icon-wrong-thin"></i></span></span></span></span></div><div class="bk-mt3"><span class="bk-form-row-name"></span> <span class="bk-disk-add" ng-click="addInterface()" data-spm-click="gostr=/aliyun;locaid=addNewInterface"><i class="bk-disk-add-icon" ng-class="{\'bk-disk-add-icon-disabled\':!addible}"><em class="bk-disk-add-icon-line"></em> <em class="bk-disk-add-icon-line-b"></em></i> <span class="bk-disk-add-txt" ng-class="{\'bk-disk-add-txt-disabled\':!addible,\'bk-lnk\':addible}"><span ng-if="addible" ng-bind-html="\'ecs.buy.component.networkInterface.add\' | translate"></span> <span ng-if="!addible" ng-bind-html="\'ecs.buy.component.networkInterface.disableAdd\' | translate"></span></span></span></div></div>'),e.put("scripts/ecsbuy/base/partials/orderConfirm/clouddisk.html",'<div class="bk-scope" style="background: #FBFAF8; padding-bottom: 20px" aliyun-buy-preloader="!ready"><div aliyun-buy-ecs-order-confirm order-data="clouddiskOrderData" commodity-code="yundisk" price-service="priceService" ready="ready"></div><div class="bk-mt5" style="text-align: right"><div class="bk-mt4"><button theme="orange" aliyun-buy-button data-spm-click="gostr=/aliyun;locaid=gotoPay" is-disabled="{{!checked}}" ng-click="purchase()">{{\'YUNDISK_PAY_POSTPAY\'|translate}}</button></div><div class="bk-mt4"><input id="pact" type="checkbox" ng-model="checked" checked="checked" value="1"><label for="pact"><span aliyun-buy-ecs-order-terms></span></label></div><div ng-show="kmsTermUrl"><input id="kmsPact" type="checkbox" ng-model="checked" checked="checked" value="1" style="margin-right: 3px"><label for="kmsPact"><span aliyun-buy-ecs-order-terms order-term-url="{{kmsTermUrl}}" order-term-text="KMS_TERMS"></span></label></div></div></div>'),e.put("scripts/ecsbuy/base/partials/orderConfirm/common.html",'<table class="bk-table" id="order-table"><tbody><tr><th width="1%"></th><th ng-bind-html="\'ECS_ORDER_PNAME\' | translate"></th><th ng-bind-html="\'ECS_ORDER_PAYMETHOD\' | translate"></th><th ng-bind-html="\'ECS_ORDER_TIME\' | translate"></th><th ng-bind-html="\'ECS_ORDER_QUANTITY\' | translate"></th><th ng-bind-html="\'ECS_ORDER_COUPON\' | translate" ng-if="hasCoupon && commodityCode == \'vm\'"></th><th ng-bind-html="\'ECS_ORDER_DISCOUNT\' | translate"></th><th ng-bind-html="\'ECS_ORDER_PRICE\' | translate"></th></tr><tr><td></td><td colspan="8"><span ng-bind-html="\'ECS_ORDER_SERVER\' | translate" ng-show="!channelSwitch.hideAliyunServer"></span></td></tr><tr ng-repeat="line in orderViewData.orderLines track by $index"><td><span class="bk-title-span">{{$index + 1}}.</span></td><td><div class="bk-title-span bk-mb3 bk-mt3" style="font-size: 16px;font-weight: bold">{{line.commodityName}}</div><div><div ng-repeat="item in line.items track by $index"><span ng-if="item.text"><span>{{item.name}}:</span> <span class="bk-ml2">{{item.text}}</span></span></div><div ng-if="line.warningTip" class="bk-mt2"><span>{{\'ECS_RESULT_WARMTIP\'|translate}}</span><span ng-bind-html="line.warningTip"></span></div></div></td><td><span>{{(line.commodityCode == \'vm\' && line.orderType != \'eip-buy\') ? (\'ECS_BUY_YEARMONTH\' | translate): (\'ECS_BUY_POSTPAY\' | translate) }}</span></td><td><span ng-if="line.commodityCode == \'vm\' && line.orderType != \'eip-buy\'"><span ng-switch="line.periodType"><span ng-switch-when="Week">{{line.period}}&nbsp;{{\'ECS_UNIT_WEEKS\'|translate}}</span> <span ng-switch-when="Year">{{line.period}}&nbsp;{{\'ECS_UNIT_YEARS\'|translate}}</span> <span ng-switch-when="Month">{{line.period}}&nbsp;{{\'ECS_UNIT_MONTHS\'|translate}}</span> <span ng-switch-default>{{line.period}}</span></span></span> <span ng-if="line.commodityCode != \'vm\' || line.orderType == \'eip-buy\'">-</span></td><td><span ng-if="line.orderType == \'disk-buy\'">{{line.quantity}} {{\'ECS_DISK_UNIT\' | translate}}</span> <span ng-if="line.orderType == \'volume-buy\'">{{line.quantity}} {{\'ECS_DISK_UNIT\' | translate}}</span> <span ng-if="line.orderType == \'instance-buy\'">{{line.quantity}} {{\'ECS_INSTANCE_UNIT\' | translate}}</span> <span ng-if="line.orderType == \'marketplace-image\'">{{line.quantity}} {{\'ECS_INSTANCE_UNIT\' | translate}}</span></td><td ng-if="line.coupons && line.coupons.length > 0 && line.commodityCode == \'vm\'"><!--  --><span aliyun-buy-ecs-coupon-new coupons="line.coupons" value="couponValueMap[$index]"></span></td><td ng-if="!(line.coupons && line.coupons.length > 0) && hasCoupon && line.commodityCode == \'vm\'"><!--  --><span>-</span></td><td><div ng-if="line.price.trade == line.price.origin && (!line.price.strategies || line.price.strategies.length == 0)">-</div><div class="bk-items-price-offer" ng-if="line.price.trade < line.price.origin"><!--<span class="bk-items-price-cost bk-mr1">--><!--{{\'ECS_OLDPRICE\'|translate}}<span class="bk-cny">&yen;</span>{{line.price.origin | aliyunBuyPriceValue}}{{line.priceUnit}}--><!--</span>--><span class="bk-items-price-rebate">{{\'ECS_REDUCE\'|translate}} <span class="bk-cny" ng-bind-html="(line.price.currency|aliyunBuyPriceCurrency) || \'&yen;\'"></span> <span>{{line.price.discount | aliyunBuyPriceValue}}</span> {{line.price.currency |aliyunBuyPriceCurrencyText}} {{line.priceUnit}}</span></div><div class="bk-items-price-tag" style="display: block" ng-if="line.price.strategies.length > 0"><i class="bk-items-price-tag-title aliyun-icon-giving"></i><div class="bk-items-price-tag-list"><div ng-repeat="strategy in line.price.strategies" title="{{strategy.title}}">{{strategy.name}}</div></div></div></td><td><span ng-if="price.calculating" class="bk-orange bk-items-price-money">{{\'ECS_CALCULATING_PRICE\'|translate}}</span> <span ng-if="!price.calculating && line.price.trade != undefined" class="bk-orange bk-items-price-money"><span class="bk-cny" ng-bind-html="(line.price.currency|aliyunBuyPriceCurrency) || \'&yen;\'"></span> <span>{{line.price.trade | aliyunBuyPriceValue}}</span> {{line.price.currency |aliyunBuyPriceCurrencyText}} {{line.priceUnit}}</span><!--<span ng-if="line.price.trade != undefined" class="bk-orange bk-items-price-money">--><!--<span class="bk-cny">&yen;</span>{{line.price.trade | aliyunBuyPriceValue}}{{line.priceUnit}}--><!--</span>--> <span ng-if="line.price.trade == undefined" class="bk-orange bk-items-price-money">{{\'ECS_PRICE_ERROR\'|translate}}</span> <span><div><span ng-if="line.flowPrice"><span ng-bind-html="\'ECS_ORDER_PUBLICPRICE\' | translate"></span> <span class="bk-orange bk-items-price-money"><span class="bk-cny" ng-bind-html="(line.price.currency|aliyunBuyPriceCurrency) || \'&yen;\'"></span> {{line.flowPrice.order.tradeAmount | aliyunBuyPriceValue}}{{line.price.currency |aliyunBuyPriceCurrencyText}} /GB</span></span></div></span></td></tr></tbody></table>'),e.put("scripts/ecsbuy/base/partials/orderConfirm/dateTimePicker.html",'<div class="bk-form-row-cell"><div class="bk-date-time-picker"><span class="bk-number"><input class="bk-number-input" ng-class="{\'bk-form-input-error\':(options.state===\'error\')}" placeholder="{{config().placeholder}}" style="width:110px; padding:0 20px 0 0" type="text" readonly="true" min="viewModel.minDayStamp" max="viewModel.maxDayStamp" show-weeks="{{config().date.showWeeks}}" show-button-bar="{{config().date.showButtonBar}}" aliyun-buy-datepicker-popup toggle-weeks-text="{{config().date.toggleWeeksText}}" current-text="{{config().date.currentText}}" clear-text="{{config().date.clearText}}" close-text="{{config().date.closeText}}" ng-model="value"> <span class="bk-number-unit" style="left:100px; line-height: 33px"><span class="aliyun-icon-calendar"></span></span></span> <span class="bk-timepicker"><div aliyun-buy-timepicker hour-step="options.hourStep" minute-step="options.minuteStep" mousewheel="{{config().time.mousewheel}}" show-meridian="{{config().time.showMeridian}}" readonly-input="{{config().time.readonlyInput}}" hide-increment-minutes="{{config().time.hideIncrementMinutes}}" ng-model="value"></div></span></div><div class="bk-form-row-txt" ng-bind-html="options.tip" ng-show="options.tip"></div><div class="bk-form-status bk-form-error bk-form-row-txt" ng-if="options.state===\'error\' && options.stateMessage"><i class="bk-form-status-icon aliyun-icon-no3"></i> <span class="bk-form-status-message" ng-bind-html="options.stateMessage"></span></div></div>'),e.put("scripts/ecsbuy/base/partials/orderConfirm/passwordWrapper.html",'<div><div aliyun-new-buy-buttontab options="setupPasswordOptions" detail="setupPasswordDetail" ng-model="setupPasswordValue"></div><div ecs-buy-tips tip-type="tip" tip-id="SETUPPASSWORD__{{setupPasswordValue}}"></div><div class="bk-mb2"></div><span ng-show="setupPasswordValue == \'setupNow\'"><div aliyun-buy-ecs-password options="passwordOptions" value="password"></div></span></div>'),e.put("scripts/ecsbuy/base/partials/orderConfirm/postpay.html",'<div class="bk-scope" style="background: #FBFAF8; padding-bottom: 20px" aliyun-buy-preloader="!ready"><div aliyun-buy-ecs-order-confirm order-data="postpayOrderData" commodity-code="ecs" price="price" price-service="priceService" ready="ready"></div><div class="y-row y-mt5 release-time-picker"><span style="display: inline-block;width: 160px;position: relative;height: 28px;line-height: 28px"><input type="checkbox" style="top: 9px;position: absolute" ng-model="isRelease"><lable ng-click="isRelease=!isRelease" style="left: 25px;position: absolute"></lable></span> <span class="bk-number" ng-show="isRelease"><input class="bk-number-input" style="width:110px; padding:0 20px 0 0" type="text" readonly="readonly" min="minDay" max="maxDay" show-weeks="false" show-button-bar="false" toggle-weeks-text="" aliyun-buy-datepicker-popup current-text="" clear-text="" close-text="" ng-model="releaseTime"> <span class="bk-number-unit" style="left:100px; line-height: 33px"><span class="aliyun-icon-calendar"></span></span></span> <span ng-model="releaseTime" ng-change="changed()" ng-show="isRelease" readonly-input="true" class="bk-timepicker"><div aliyun-buy-timepicker hour-step="hstep" minute-step="mstep" show-meridian="false" readonly-input="true" hide-increment-minutes="true"></div></span><div style="margin-left:25px" ng-if="isRelease"><span class="bk-orange">IP</span></div></div><div class="bk-mt4" ng-if="!isForService"><span ng-if="!channelSwitch.hideImportantTip"><span ng-bind-html="\'ECS_ORDER_IMPORTENTTIP\'|translate"></span> <span style="clear:both"></span></span></div><div class="bk-mt5" style="text-align: right"><div ng-if="price.data.code && payOrderTip" class="bk-mb3 bk-color-red"><span ng-bind-html="payOrderTip"></span></div><div aliyun-buy-ecs-order-button></div></div></div>'),e.put("scripts/ecsbuy/base/partials/orderConfirm/prepay.html",'<div class="bk-scope" style="background: #FBFAF8; padding-bottom: 20px" aliyun-buy-preloader="!ready"><div aliyun-buy-ecs-order-confirm order-data="prepayOrderData" remote-price-action="{{remotePriceAction}}" price="price" commodity-code="vm" ready="ready"></div><!--url--><span ng-if="fromUrl"><div aliyun-buy-ecs-password-wrapper setup-password-value="password.setupPasswordValue" password-value="password.passwordValue" instance-name="password.instanceName" os-kind="{{password.osKind}}"></div></span><div class="bk-clear"></div><div class="bk-mt4" ng-if="!isForService"><span ng-if="!channelSwitch.hideImportantTip"><span ng-bind-html="\'ECS_ORDER_IMPORTENTTIP\'|translate"></span> <span style="clear:both"></span></span></div><div aliyun-buy-ecs-recommend-code ng-show="!channelSwitch.hideRecommendCode" recommend-validation="recommendValidation" recommend-code="recommendCode" order-data="orderData()" price="price"></div><div class="bk-mt5" style="text-align: right"><div aliyun-buy-ecs-price data="price"></div><div ng-if="price.data.code && payOrderTip" class="bk-mt3 bk-color-red"><span ng-bind-html="payOrderTip"></span></div><div aliyun-buy-ecs-order-button></div></div></div>'),e.put("scripts/ecsbuy/base/partials/orderConfirm/recommendCode.html",'<div class="bk-recommend-code"><div><input id="recommendCodeCheckbox" class="checkbox" type="checkbox" ng-model="recommendChecked"><label for="recommendCodeCheckbox"></label><!--<a class="bk-lnk bk-ml1" href="javascript:;" aliyun-buy-tooltip="{content:\'\\\'ASKTIP__TOOLTIP__RECOMMEND_CODE\\\' | translate\', theme:\'white\', trigger:\'click\', offsetX: 20, maxWidth: 510}">\n      <i class="aliyun-icon-help"></i>\n    </a>--><input ng-show="showInput" maxlength="6" type="text" ng-blur="blur()" ng-model="_recommendCode" class="bk-form-input bk-form-input-l2 bk-ml2" ng-class="{\'bk-form-input-error\':!codeValidate}" placeholder="6" style="width:90px"></div><!----><div class="bk-form-status bk-form-warn bk-form-row-txt" ng-if="hadPromotionTip"><i class="bk-form-status-icon aliyun-icon-no3"></i> <span class="bk-form-status-message"></span></div><div class="bk-recommend-tip bk-mt1" ng-if="showTip"><div class="bk-form-status bk-form-error bk-form-row-txt" ng-if="errorTip"><i class="bk-form-status-icon aliyun-icon-no3"></i> <span class="bk-form-status-message" ng-bind-html="errorTip"></span></div><div class="bk-form-status bk-form-success bk-form-row-txt" ng-if="successTip"><i class="bk-form-status-icon aliyun-icon-yes3"></i> <span class="bk-form-status-message" ng-bind-html="successTip"></span></div></div></div>'),e.put("scripts/ecsbuy/base/partials/orderConfirm/volume.html",'<div class="bk-scope" style="background: #FBFAF8; padding-bottom: 20px" aliyun-buy-preloader="!ready"><div aliyun-buy-ecs-order-confirm order-data="volumeOrderData" commodity-code="san" price-service="priceService" ready="ready"></div><div class="bk-mt5" style="text-align: right"><div class="bk-mt4"><button theme="orange" aliyun-buy-button data-spm-click="gostr=/aliyun;locaid=gotoPay" is-disabled="{{!checked}}" ng-click="purchase()">{{\'YUNDISK_PAY_POSTPAY\'|translate}}</button></div><div class="bk-mt4"><input id="pact" type="checkbox" ng-model="checked" checked="checked" value="1"><label for="pact"><span aliyun-buy-ecs-order-terms></span></label></div></div></div>'),e.put("scripts/ecsbuy/base/partials/password/instanceName.html",'<div class="bk-form-row-cell"><div class="bk-form-row-li"><input ng-show="!options.needLogin" ng-focus="focus()" ng-blur="blur()" ng-keyup="blur()" type="text" data-spm-click="gostr=/aliyun;locaid=inputInstanceName" ng-model="instanceName" class="bk-form-input bk-form-input-l2" ng-class="{\'bk-form-input-error\':(!instanceValidate || options.state == \'error\')}" placeholder="{{ options.instNamePlaceholder ? (options.instNamePlaceholder | translate) : (\'ECS_DEFAULT_PH\'|translate)}}"><div aliyun-buy-tooltip="{templateUrl:\'scripts/ecsbuy/base/partials/password/passwordLogin.html\', theme:\'white\'}" ng-if="options.needLogin" class="bk-form-input bk-form-input-l2" style="background: #fff;cursor:text;display: inline-block"></div><span class="bk-form-row-li-info bk-ml2">{{\'ECS_INSTANCE_NAME_EXP_DISCRIPE\'|translate}}</span></div><div class="bk-form-status bk-form-error bk-form-row-txt" ng-if="!instanceValidate || options.state == \'error\'"><i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message">{{\'ECS_INSTANCE_NAME_EXP_DISCRIPE\'|translate}}</span></div></div>'),e.put("scripts/ecsbuy/base/partials/password/keyPairSetting.html",'<div ng-hide="options.visible===false"><div class="bk-form-row-cell"><div class="bk-form-row-li"><div aliyun-buy-select-dynamic ng-model="value" fetch-config="fetchConfig" detail="detail" placeholder="{{options.placeholder}}" option="options.items" state="options.state"></div><a class="bk-ml2 glyphicon glyphicon-refresh bk-lnk" ng-click="refresh()"></a></div><div aliyun-buy-block-tips></div><div class="bk-form-status bk-form-error bk-form-row-txt" ng-if="options.state===\'error\' && options.stateMessage"><i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message" ng-bind-html="options.stateMessage"></span></div></div></div>'),e.put("scripts/ecsbuy/base/partials/password/password.html",'<div class="bk-password" ng-hide="options.visible===false"><form name="setPassword" role="form" novalidate autocomplete="off"><div class="bk-form-row" ng-show="options.loginName"><label class="bk-form-row-name">{{\'ECS_LOGIN_NAME\'|translate}}</label><div class="bk-form-row-cell"><div class="bk-form-row-li-info bk-font-14" style="position: relative;top: -3px">{{options.loginName}}</div></div></div><div class="bk-form-row"><label class="bk-form-row-name">{{\'ECS_LOGIN_PASSWORD\'|translate}}</label><div class="bk-form-row-cell"><div error="options.state==\'error\'" aliyun-buy-ecs-password-input login="login" need-login="options.needLogin" passwords="password1|password2" ng-model="password1" spm="inputPwd" tip="{{\'ECS_PASSWORD_EXP_DISCRIPE\'|translate}}" value="valueObject.password"></div></div></div><div class="bk-form-row"><label class="bk-form-row-name">{{\'ECS_CONFIRM_PASSWORD\'|translate}}</label><div class="bk-form-row-cell"><div error="options.state==\'error\'" aliyun-buy-ecs-password-input login="login" need-login="options.needLogin" passwords="password1|password2" ng-model="password2" spm="confirmPwd" value="valueObject.password"></div></div></div></form></div>'),e.put("scripts/ecsbuy/base/partials/password/passwordInput.html",'<div><div class="bk-form-row-li"><span ng-hide="needLogin"><input ng-class="{\'bk-form-input-error\':error || _error}" class="bk-form-input bk-form-input-l2" ng-model="ngModel" type="password" ng-blur="blur()" ng-focus="_error=false" ng-trim="false" data-spm-click="gostr=/aliyun;locaid={{spm}}"></span> <span aliyun-buy-tooltip="{templateUrl:\'scripts/ecsbuy/base/partials/passwordLogin.html\', theme:\'white\'}" ng-if="needLogin" class="bk-form-input bk-form-input-l2" style="background: #fff;cursor:text;display: inline-block"></span> <span class="bk-form-row-li-info bk-ml2" ng-if="tip" ng-bind="tip"></span></div><div class="bk-form-status bk-form-error bk-form-row-txt" ng-if="_error"><i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message" ng-bind="_error|translate"></span></div></div>'),e.put("scripts/ecsbuy/base/partials/password/passwordLogin.html","<span><a ng-click=\"login()\" ng-bind-html=\"'ECS_PASSWORD_LOGIN' | translate\"></a>{{'ECS_PASSWORD_LOGIN_TIP' | translate}}</span>"),e.put("scripts/ecsbuy/base/partials/recommend/instanceType.html",'<div class="bk-buttontab-recommend"><div class="recommend-item" ng-class="{\'active\': item.active, \'no-stock\': (item.noStock)}" ng-repeat="item in options.items" ng-click="select(item)"><div class="recommend-header">{{item.InstanceType.InstanceType | aliyunBuyText}} <i class="bk-button-icon icon-buy-qing"></i></div><div class="recommend-content"><div class="recommend-text">{{(item.InstanceType.InstanceTypeFamilyDesc.text + "" + item.InstanceType.cpuMemDesc) | aliyunBuyText}}</div></div></div><div class="recommend-none-block" ng-if="!options.items || options.items.length == 0" ng-bind-html="options.tip"></div></div>'),e.put("scripts/ecsbuy/base/partials/securityGroup/aliyunBuyEcsSecurityDialog.html",'<div><div class="bk-dialog-head" aliyun-buy-drag box-class="bk-dialog" fill-left-px="340"><span class="bk-dialog-close bk-dialog-close-thin" data-dismiss="modal" aria-hidden="true" ng-click="$close()"><span class="aliyun-icon-wrong-thin"></span></span><h5 class="bk-dialog-title">{{\'ECS_PLEASE_SELECT_SECURITY\' | translate}}[{{regionName}}]</h5></div><div class="bk-dialog-body"><!-- <div class="sedi-buy-image-loading" ng-show="isLoading">\n        </div> --><div class="bk-dialog-box" style="height: 458px"><div class="bk-items-min" aliyun-buy-preloader="isLoading"><div><span class="bk-search-select"><select class="form-control" ng-model="searchModel.type"><option value="name">{{\'ECS_SECURITY_NAME\'|translate}}</option><option value="id">{{\'ECS_SECURITY_ID\'| translate}}</option></select></span> <input ng-if="searchModel.type==\'name\'" type="text" class="bk-form-input bk-form-search-input" placeholder="{{\'ECS_SECURITY_NAME_PLACE_HOLDER\'|translate}}" ng-model="searchModel.key" ng-keypress="enterSearch($event)"> <input ng-if="searchModel.type==\'id\'" type="text" class="bk-form-input bk-form-search-input" placeholder="{{\'ECS_SECURITY_ID_PLACE_HOLDER\'|translate}}" ng-model="searchModel.key" ng-keypress="enterSearch($event)"> <i class="aliyun-icon-wrong-thin bk-search-close-icon" ng-if="!!searchModel.key" ng-click="clearKey()" style="left: 315px"></i><div class="search-btn" ng-click="search()"><span class="aliyun-icon-Search"></span></div></div><table class="bk-dialog-table"><tr class="bk-dialog-table-header"><th>{{\'ECS_SECURITY_NAME_OR_ID\'|translate}}</th><th>{{\'ECS_SECURITY_CREATETIME\'|translate}}</th><th>{{\'ECS_INSTANCE_NUM\'|translate}}({{\'ECS_INSTANCE_UNIT\'|translate}})</th><th></th></tr><tr class="bk-dialog-table-body" ng-repeat="item in security.securityList" ng-click="useSecurity(item)" ng-class="{\'bk-dialog-table-body-even\':$index % 2 }"><td class="big-td" title="{{item.SecurityGroupName}} / {{item.SecurityGroupId}}">{{item.SecurityGroupName}} / {{item.SecurityGroupId}}</td><td class="middle-td" title="{{item.CreationTime | date:\'yyyy-MM-dd HH:mm:ss\'}}">{{item.CreationTime | date:\'yyyy-MM-dd HH:mm:ss\'}}</td><td class="small-td" title="{{item.ecsCount}}">{{item.EcsCount}}</td><td class="small-td" ng-hide="hideSecurityGroup"><a href="javascript:;" ng-click="viewGroupRule($event, item)" target="_blank">{{\'ecs.buy.component.securityGroup.showGroupRule\' | translate}}></a></td></tr></table><div ng-show="security.securityList.length==0"><div style="height: 320px; line-height: 320px; text-align: center"><div ng-bind-html="\'ECS_SECURITY_NOUSE\' | translate"></div></div></div></div><div class="bk-paging-index-min"><div ng-show="isReady && security.securityList.length" aliyun-buy-pagination total-items="totalItems" ng-model="security.currentPage" items-per-page="itemsPerPage" max-size="8" previous-text="{{\'ECS_PREV\'|translate}}" next-text="{{\'ECS_NEXT\'|translate}}"></div></div></div></div></div>'),e.put("scripts/ecsbuy/base/partials/securityGroup/aliyunBuyEcsSecurityGroup.html",'<div aliyun-buy-anchor="dominator:securityGroup:anchor"><div class="bk-form-row" ng-show="!hasSecurityGroup && loggedIn"><div class="bk-form-row-cell"><div class="bk-form-row-li"><div aliyun-buy-select placeholder="{{options.defaultTypes.placeholder}}" option="options.defaultTypes.items" long="true" ng-model="options.defaultTypes.value" detail="options.defaultTypes.detail" state="options.state"></div><div aliyun-buy-inline-tips class="aliyun-inline-tips"></div></div><div class="bk-form-row-txt" ng-hide="hideSecurityGroup"><div ng-if="options.defaultTypes.value == \'SystemDefault\'" translate="TIP__TEXT__SECURITYGROUP_SYSTEM_DEFAULT" translate-values="{createSecurityGroupLink: options.createSecurityGroupLink,chooseSecurityGroupTipsLink:options.chooseSecurityGroupTipsLink}"></div><div translate="TIP__TEXT__SECURITYGROUP_TIP" translate-values="{createSecurityGroupLink: options.createSecurityGroupLink,chooseSecurityGroupTipsLink:options.chooseSecurityGroupTipsLink}"></div></div></div></div><div class="bk-form-row" ng-show="options.defaultTypes.value == \'SystemDefaultSg\' && !hasSecurityGroup && loggedIn"><span ng-bind-html="\'ecs.buy.component.securityGroup.label\' | translate"></span>&nbsp;&nbsp;<a class="bk-lnk" ng-href="javascript:;" data-spm-click="gostr=/aliyun;locaid=sshAndRdp" aliyun-buy-tooltip="{{options.groupRuleIntro}}"><i class="aliyun-icon-help"></i></a> <span aliyun-buy-checkbox ng-model="options.groupRule.http" display="options.displayGroupRule.http" class="bk-ml3"></span> <a class="bk-lnk" ng-href="javascript:;" data-spm-click="gostr=/aliyun;locaid=http-80-intro" aliyun-buy-tooltip="{{options.http80Intro}}"><i class="aliyun-icon-help"></i></a> <span aliyun-buy-checkbox ng-model="options.groupRule.https" display="options.displayGroupRule.https" class="bk-ml3"></span> <i class="icon-yes bk-green bk-mr1 bk-ml3"></i><span ng-bind-html="options.displayGroupRule.icmp" class="font-size14"></span> <i class="icon-yes bk-green bk-mr1 bk-ml3"></i><span ng-bind-html="options.displayGroupRule.sshAndRdp" class="font-size14"></span> <a class="bk-lnk" ng-href="javascript:;" data-spm-click="gostr=/aliyun;locaid=sshAndRdp" aliyun-buy-tooltip="{{options.sshAndRdpIntro}}"><i class="aliyun-icon-help"></i></a></div><div class="bk-form-row" ng-show="hasSecurityGroup"><div class="bk-form-row-cell bk-security-name-cell"><div class="bk-form-row-txt" ng-if="detail.text && detail.text !== \'\'"><span class="bk-color-000"><span ng-bind-html="\'ecs.buy.label.securityGroup\' | translate"></span>{{detail.text}}</span> <span class="bk-security-tip" ng-show="detail.EcsCountRemain">&nbsp;&nbsp;(<span translate="TIP__TEXT__SECURITYGROUP_REMAIN_ECS_TIP" translate-values="{ecsCount: detail.EcsCount,ecsCountRemain:detail.EcsCountRemain}"></span>)</span></div><div ng-if="detail.text && detail.text !== \'\' && !hideSecurityGroup"><div class="bk-form-row-txt bk-orange"><span translate="TIP__TEXT__SECURITYGROUP_RULE_TIP" translate-values="{createSecurityRuleLink:options.createSecurityRuleLink}"></span></div></div><div class="bk-form-row-li" ng-class="{\'bk-mt-20\':detail.text && detail.text !== \'\'}"><span class="bk-rect-select bk-security-select" ng-click="openSecurityGroups()" data-spm-click="gostr=/aliyun;locaid=selectSecurityGroup"><i class="bk-rect-select-icon" ng-class="{\'bk-button-error\':options.state==\'error\'}"><em class="bk-rect-select-icon-rect"></em> <em class="bk-rect-select-icon-rect"></em> <em class="bk-rect-select-icon-rect"></em> <em class="bk-rect-select-icon-rect"></em></i> <span class="bk-rect-select-txt bk-click-link" ng-class="{\'bk-rect-select-txt-error\':options.state==\'error\'}">{{(detail.text && detail.text !== \'\')?\'ECS_SECURITY_RESELECT\':\'ECS_SECURITY_SELECT_ONE\' | translate}}</span></span><div aliyun-buy-inline-tips class="aliyun-inline-tips"></div></div><div class="bk-form-row-txt bk-security-tip" ng-hide="hideSecurityGroup"><span translate="TIP__TEXT__SECURITYGROUP_TIP" translate-values="{createSecurityGroupLink: options.createSecurityGroupLink,chooseSecurityGroupTipsLink:options.chooseSecurityGroupTipsLink}"></span><!-- <a  class="bk-lnk bk-ml1" href="javascript:;" data-spm-click="gostr=/aliyun;locaid=securityhelp" aliyun-buy-tooltip="{{\'ECS_SECURITY_POP_TIP\' | translate}}">\n          <i class="aliyun-icon-help"></i>\n        </a> --></div></div></div></div>'),e.put("scripts/ecsbuy/base/partials/securityGroup/aliyunBuyEcsSecurityRiskDialog.html",'<div data-spm="riskSgDialog"><div class="bk-dialog-head" aliyun-buy-drag box-class="bk-dialog" fill-left-px="340"><span class="bk-dialog-close bk-dialog-close-thin" data-dismiss="modal" aria-hidden="true" ng-click="$close()"><span class="aliyun-icon-wrong-thin"></span></span><h5 class="bk-dialog-title">:</h5></div><div class="bk-dialog-body"><div class="bk-dialog-box" style="height: 350px"><div class="bk-items-min" aliyun-buy-preloader="isLoading"><div><div class="bk-font-14"><strong>/</strong></div><div class="bk-button bk-button-blue" ng-click="useSafetySg()" data-spm-click="gostr=/aliyun;locaid=useSafetySg" style="line-height: 36px;margin-top: 30px; width: 160px"></div><div ng-if="cloneResult == \'failed\'" class="bk-red" style="margin-top: 10px"><i class="icon-no-2"></i><span class="bk-ml1">{{cloneResultMessage}}</span></div><div style="margin-top: 15px"><strong></strong><span class="bk-gray">src: 0.0.0.0/010.0.0.0/8ECS</span></div><div ng-click="useRiskySg()" data-spm-click="gostr=/aliyun;locaid=useRiskySg" class="bk-button bk-button-white" style="line-height: 36px;margin-top: 30px"></div><div style="margin-top: 15px"><strong></strong><span class="bk-gray">src: 0.0.0.0/010.0.0.0/8/</span></div></div><!--<div ng-show="cloneResult == \'success\'">--><!--<i class="icon-yes-2"></i><span> <a ng-click="viewGroupRule()">>></a></span>--><!--</div>--></div></div></div></div>'),e.put("scripts/ecsbuy/base/partials/simplebuy/instanceClass.html",'<div class="simplebuy-class"><div class="simplebuy-class-title">{{classTyleText}}</div><div class="simplebuy-class-config"><span class="simplebuy-class-config-field" ng-repeat="config in configs"><div class="simplebuy-class-config-field-title">{{config.title}}</div><div class="simplebuy-class-config-field-value">{{config.text}}</div></span></div></div>'),e.put("scripts/ecsbuy/base/partials/simplebuy/selectClass.html",'<div class="bk-form-row-{{config.theme || \'primary\'}}"><div aliyun-new-buy-buttontab class="inline-display" config="config" detail="detail" ng-model="value" options="options"><div simplebuy-instance-class item="item"></div></div><span aliyun-buy-inline-tips></span><!-- <span aliyun-buy-inline-select></span> --><div aliyun-buy-block-tips></div></div>'),e.put("scripts/ecsbuy/base/partials/userdata/aliyunBuyEcsUserdata.html",'<div class="bk-form-row" aliyun-buy-anchor="dominator:userdata:anchor"><div class="bk-form-row-cell"><div class="bk-form-row-li"><div class="bk-mb3"><label><input type="checkbox" ng-model="alreadyBase64" tabindex="0"><span class="bk-ml1 bk-pale"> base64 </span></label></div><textarea class="bk-form-input bk-form-input-l3 bk-text-area-description" ng-model="userdataValue" ng-class="{\'bk-form-input-error\':options.state == \'error\'}"></textarea></div><div aliyun-buy-block-tips></div><div class="bk-form-row-txt" ng-show="options.state==\'error\'"><span class="bk-form-status bk-form-error"><i class="bk-form-status-icon aliyun-icon-no3"></i><span class="bk-form-status-message" ng-if="options.stateMessage" ng-bind-html="options.stateMessage"></span></span></div></div></div>')}])}),define("ecsbuy/console/console-tpl",["angular"],function(e){e.module("aliyun.console.ecsbuy.console.tpl",[]).run(["$templateCache",function(e){e.put("scripts/ecsbuy/console/partials/buyAgain/buyAgain.html",'<div ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div class="bk-theme-generation2 bk-bgcolor-fff"><div class="bk-scope" aliyun-buy-dominator ui-model-id="ecs.buy.buyAgain.ui" biz-model-id="ecs.buy.buyAgain.biz" framework-setting="frameworkSetting" subtotal-align-style="bottom"></div><div ng-hide="isLoading" class="bk-layout-2col-main bk-color-999" style="position: relative;top: -10px"><div class="bk-form-row"><div class="bk-form-row-cell"><div class="bk-form-row-li"><div class="bk-font-size-14 bk-line-height-30" ng-if="raw.instanceDetail.EipAddress.AllocationId"><strong></strong><strong> IP IP</strong></div><div class="bk-font-size-14 bk-line-height-30"> ECS <br><a class="bk-lnk" href="javascript:;" ng-click="visitEcsBuy()">></a></div></div></div></div></div></div><div class="bk-pr5" data-spm="purchase"><div aliyun-buy-price-view config="priceViewConfig" price-result="priceResult"></div><div style="text-align: right" class="bk-theme-generation2 bk-bgcolor-fff"><div ng-if="priceResult.code && payOrderTip" class="bk-mb3 bk-mt3 bk-color-red"><span ng-bind-html="payOrderTip"></span></div><div aliyun-buy-ecs-order-button></div></div></div><div style="height: 50px;clear: both"></div></div>'),e.put("scripts/ecsbuy/console/partials/changeBandwidth/batchChangeBandwidthPayByTraffic.html",'<div ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div class="bk-theme-generation2 bk-bgcolor-fff"><div aliyun-buy-ecs-batch-view-new batch-action-model="batchActionModel" batch-ui-model="batchUiModel"></div><div class="bk-pr5"><div style="text-align: right" class="bk-theme-generation2 bk-bgcolor-fff"><span class="text-danger">{{\'ecs.buy.console.batch.change_bandwidth.tips.throttling\'|translate}}</span><div aliyun-buy-ecs-order-button></div></div></div></div></div>'),e.put("scripts/ecsbuy/console/partials/changeBandwidth/batchChangeBandwidthPayByTrafficOptions.html",'<div ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div class="bk-theme-generation2 bk-bgcolor-fff"><div class="bk-scope" aliyun-buy-dominator ui-model-id="ecs.buy.changeBandwidth.options.ui" biz-model-id="ecs.buy.changeBandwidth.options.biz" framework-setting="frameworkSetting" subtotal-align-style="bottom"></div><span aliyun-buy-ecs-data-spm spm-b="ecschangebandwidthoptions"></span></div><div style="height: 20px;clear: both"></div></div>'),e.put("scripts/ecsbuy/console/partials/changeBandwidth/dialog/batchChangeBandwidthPayByTrafficDialog.html",'<div bindonce><div class="modal-header"><button type="button" class="close" data-dismiss="modal" data-ng-click="close(false)" aria-hidden="true">&times;</button><h3 class="modal-title" ng-bind=" \'ecs.buy.console.batch.change_bandwidth\' | translate"></h3></div><div class="modal-body clearfix"><div aliyun-buy-ecs-change-bandwidth-options instance-id="{{instanceId}}"></div></div><div class="modal-footer"><button class="btn btn-primary" data-ng-click="submit(true)" ng-bind=" \'ECS_OK\' | translate"></button> <button class="btn btn-default" data-ng-click="close(false)" ng-bind=" \'ECS_CANCEL\' | translate"></button></div></div>'),e.put("scripts/ecsbuy/console/partials/changeOs/batchChangeOs.html",'<div ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div class="bk-theme-generation2 bk-bgcolor-fff"><div aliyun-buy-ecs-batch-view-new batch-action-model="batchActionModel" batch-ui-model="batchUiModel"></div><div class="bk-pr5"><div style="text-align: right" class="bk-theme-generation2 bk-bgcolor-fff"><div aliyun-buy-ecs-order-button></div></div></div></div></div>'),e.put("scripts/ecsbuy/console/partials/changeOs/changeOs.html",'<div ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div class="bk-theme-generation2 bk-bgcolor-fff"><div class="bk-scope" aliyun-buy-dominator ui-model-id="ecs.buy.changeOs.ui" biz-model-id="ecs.buy.changeOs.biz" framework-setting="frameworkSetting" subtotal-align-style="bottom"></div><div aliyun-buy-ecs-coupon-new-wrapper class="bk-layout-2col-main" price="priceForCoupon" value="couponNo"></div><span aliyun-buy-ecs-data-spm spm-b="ecsrenew"></span></div><div class="bk-pr5"><div aliyun-buy-price-view config="priceViewConfig" price-result="priceResult"></div><div style="text-align: right" class="bk-theme-generation2 bk-bgcolor-fff"><div ng-if="priceResult.code && payOrderTip" class="bk-mb3 bk-mt3 bk-color-red"><span ng-bind-html="payOrderTip"></span></div><div aliyun-buy-ecs-order-button></div></div></div><div style="height: 50px;clear: both"></div></div>'),e.put("scripts/ecsbuy/console/partials/changeOs/changeOsOptions.html",'<div ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div class="bk-theme-generation2 bk-bgcolor-fff"><div class="bk-scope" aliyun-buy-dominator ui-model-id="ecs.buy.changeOs.options.ui" biz-model-id="ecs.buy.changeOs.options.biz" framework-setting="frameworkSetting" subtotal-align-style="bottom"></div><span aliyun-buy-ecs-data-spm spm-b="ecschangeosoptions"></span></div><div style="height: 20px;clear: both"></div></div>'),e.put("scripts/ecsbuy/console/partials/changeOs/dialog/batchChangeOsDialog.html",'<div bindonce><div class="modal-header"><button type="button" class="close" data-dismiss="modal" data-ng-click="close(false)" aria-hidden="true">&times;</button><h3 class="modal-title" ng-bind=" \'ecs.buy.console.batch.change_os\' | translate"></h3></div><div class="modal-body clearfix bk-theme-mini"><div aliyun-buy-ecs-change-os-options-v2 instance-id="{{instanceId}}"></div></div><div class="modal-footer"><button class="btn btn-primary" data-ng-click="submit(true)" ng-bind=" \'ECS_OK\' | translate"></button> <button class="btn btn-default" data-ng-click="close(false)" ng-bind=" \'ECS_CANCEL\' | translate"></button></div></div>'),e.put("scripts/ecsbuy/console/partials/common/batchActionView.html",'<div class="batch-action-view"><div class="console-step row" bindonce><div class="step step-first col-md-4 step-active" ng-bind="\'ecs.buy.console.batch.step1\'|translate"></div><div class="step col-md-4" ng-bind="\'ecs.buy.console.batch.step2\'|translate"></div><div class="step step-end col-md-4" ng-bind="\'ecs.buy.console.batch.step3\'|translate"></div></div><div ng-show="isLoading" aliyun-loading size="48" style="margin:0 auto;margin-top:50px"></div><div ng-hide="isLoading"><div ng-show="validBatchInfosLength > 0"><table class="table"><thead><tr><th ng-repeat="infoHead in viewData.viewInfoHeads"><span aliyun-buy-render-dynamic-html template="{{infoHead.html}}" ng-show="infoHead.html" bind-scope="colItem.bindScope"></span> <span ng-bind="infoHead.text" ng-show="infoHead.text"></span></th></tr></thead><tbody><tr ng-repeat="(viewInfoIndex,viewInfo) in viewData.viewInfos"><td colspan="10" ng-show="viewInfo._isRemoved"><div class="alert alert-warning text-center"><span ng-bind="\'ecs.buy.console.batch.table.td.del_msg\'|translate"></span> <a href="javascript:;" ng-click="undoRemove(viewInfoIndex)" ng-bind="\'ecs.buy.console.batch.table.td.action_del_undo\'|translate"></a></div></td><td ng-repeat="colItem in viewInfo.colItems" ng-hide="viewInfo._isRemoved" style="{{colItem.style}}"><span aliyun-buy-render-dynamic-html template="{{colItem.html}}" ng-show="colItem.html" bind-scope="colItem.bindScope"></span> <span ng-bind="colItem.text" ng-show="colItem.text"></span></td></tr></tbody></table></div><div ng-show="invalidBatchInfosLength > 0"><div class="margin-top-2 clearfix"><div class="pull-left"><span ng-bind-html="invalidBatchInfosTip"></span><!-- <a href="javascript:;" ng-click="showInvalidEcsList = !showInvalidEcsList"  bo-text="\'ecs.buy.cm.lb.show_invalid\'|translate"></a> --></div></div><table class="table invalid-batch-action-table"><thead><tr><th ng-repeat="infoHead in viewDataForInvalid.viewInfoHeads"><span aliyun-buy-render-dynamic-html template="{{infoHead.html}}" ng-show="infoHead.html" bind-scope="colItem.bindScope || $parent"></span> <span ng-bind="infoHead.text" ng-show="infoHead.text"></span></th></tr></thead><tbody><tr ng-repeat="viewInfo in viewDataForInvalid.viewInfos"><td ng-repeat="colItem in viewInfo.colItems"><span aliyun-buy-render-dynamic-html template="{{colItem.html}}" ng-show="colItem.html" bind-scope="colItem.bindScope || $parent.$parent"></span> <span ng-bind="colItem.text" ng-show="colItem.text"></span></td></tr></tbody></table></div></div></div>'),e.put("scripts/ecsbuy/console/partials/common/commonIntro.html",'<div class="bk-form-row-cell bk-light-gray bk-form-row-txt bk-intro"><div ng-repeat="item in options.items"><div ng-bind-html="item.html" class="{{item.cls}}" style="{{item.style}}"></div></div></div>'),e.put("scripts/ecsbuy/console/partials/downgrade/downgrade.html",'<div ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div class="bk-theme-generation2 bk-bgcolor-fff"><div class="bk-scope" aliyun-buy-dominator ui-model-id="ecs.buy.downgrade.ui" biz-model-id="ecs.buy.downgrade.biz" framework-setting="frameworkSetting" subtotal-align-style="bottom"></div></div><div class="bk-pr5" data-spm="purchase"><div aliyun-buy-price-view config="priceViewConfig" price-result="priceResult"></div><div style="text-align: right" class="bk-theme-generation2 bk-bgcolor-fff"><div ng-if="priceResult.code && payOrderTip" class="bk-mt3 bk-color-red"><span ng-bind-html="payOrderTip"></span></div><div aliyun-buy-ecs-order-button></div></div></div><div style="height: 50px;clear: both"></div></div>'),e.put("scripts/ecsbuy/console/partials/downgradeWithRenew/downgradeWithRenew.html",'<div ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div class="bk-theme-generation2 bk-bgcolor-fff"><div class="bk-scope" aliyun-buy-dominator ui-model-id="ecs.buy.downgradeWithRenew.ui" biz-model-id="ecs.buy.downgradeWithRenew.biz" framework-setting="frameworkSetting" subtotal-align-style="bottom"></div><div aliyun-buy-ecs-coupon-new-wrapper class="bk-layout-2col-main" price="priceForCoupon" value="couponNo"></div><span aliyun-buy-ecs-data-spm spm-b="ecsdowngradewithrenew"></span></div><div class="bk-pr5" data-spm="purchase"><div aliyun-buy-price-view config="priceViewConfig" price-result="priceResult"></div><div style="text-align: right" class="bk-theme-generation2 bk-bgcolor-fff"><div ng-if="priceResult.code && payOrderTip" class="bk-mt3 bk-color-red"><span ng-bind-html="payOrderTip"></span></div><div aliyun-buy-ecs-order-button></div></div></div><div style="height: 50px;clear: both"></div></div>'),e.put("scripts/ecsbuy/console/partials/hpcCluster/hpcClusterScaling.html",'<div ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div class="bk-theme-generation2 bk-bgcolor-fff"><div class="bk-scope" aliyun-buy-dominator ui-model-id="ecs.buy.hpcClusterScaling.ui" biz-model-id="ecs.buy.hpcClusterScaling.biz" framework-setting="frameworkSetting" subtotal-align-style="bottom"></div></div><div class="bk-pr5" data-spm="purchase"><div aliyun-buy-price-view config="priceViewConfig" price-result="priceResult"></div><div style="text-align: right" class="bk-theme-generation2 bk-bgcolor-fff"><div ng-if="priceResult.code && payOrderTip" class="bk-mb3 bk-mt3 bk-color-red"><span ng-bind-html="payOrderTip"></span></div><div aliyun-buy-ecs-order-button></div></div></div><div style="height: 50px;clear: both"></div></div>'),e.put("scripts/ecsbuy/console/partials/instanceDetail.html",'<div class="bk-scope"><div class="bk-order-info"><div class="bk-order-renew-title">{{\'ECS_INSTANCE_INFO\' | translate}}</div><div class="bk-info-name bk-mt3"><span class="bk-font-weight-bold">{{\'ECS_INSTANCE_NAME\' | translate}}</span><span ng-bind="context.instanceName"></span></div><div class="bk-info-row"><table><tbody><tr><td ng-show="context.instanceId"><label class="bk-font-weight-bold">{{\'ECS_INSTANCE_ID\' | translate}}</label><span ng-bind="context.instanceId"></span></td><td><label class="bk-font-weight-bold">{{\'ECS_REGION\' | translate}}</label><span ng-bind="context.region | translate"></span><span ng-show="context.zoneName">{{context.zoneName}}</span></td><td><label class="bk-font-weight-bold">{{\'ECS_CHARGE_TYPE\'|translate}}</label><span>{{context.instanceChargeTypeText |translate}}</span></td></tr><tr><td><label class="bk-font-weight-bold">{{\'ECS_INSTANCE_GENERATION\'|translate}}</label><span>{{context.instanceGeneration}}</span></td><td><label class="bk-font-weight-bold">{{\'ECS_INSTANCE_TYPE\'|translate}}</label><span>{{context.instanceTypeText}}{{context.instanceTypeFamily}}{{context.instanceTypeValue}}</span></td><td><label class="bk-font-weight-bold">{{\'ECS_IO_OPTIMIZED\'|translate}}</label><span>{{context.iooptimized}}</span></td></tr><tr><!----><td><label class="bk-font-weight-bold">{{\'ECS_NETWORK_TYPE\' | translate}}</label><span ng-bind="context.networkType|translate"></span></td><!-- vswitches --><td ng-show="context.vSwitcheId" class="breakall"><label class="bk-font-weight-bold">{{\'ecs.buy.label.vSwitch\'|translate}}</label><span aliyun-truncate-text source-text="{{(context.vSwitcheId == context.vSwitcheName || !context.vSwitcheName) ? context.vSwitcheId : (context.vSwitcheName + \' / \' + context.vSwitcheId)}}" text-length="27" copy-text="true"></span></td><!----><td ng-show="context.securityGroupId" class="breakall"><label class="bk-font-weight-bold">{{\'ecs.buy.label.securityGroup\'|translate}}</label><span aliyun-truncate-text source-text="{{(context.securityGroupId == context.securityGroupName || !context.securityGroupName) ? context.securityGroupId : (context.securityGroupName + \' / \' + context.securityGroupId)}}" text-length="27" copy-text="true"></span></td><td ng-if="context.privateIp"><span><label class="bk-font-weight-bold">{{\'ECS_LAN_IP\'|translate}}</label><span ng-bind="context.privateIp"></span></span></td><td ng-if="context.publicIp"><span><label class="bk-font-weight-bold">{{\'ECS_WAN_IP\'|translate}}</label><span ng-bind="context.publicIp"></span></span></td><td ng-if="context.eipAddress"><span><label class="bk-font-weight-bold">{{\'ECS_EIP_ADDRESS\'|translate}}</label><span ng-bind="context.eipAddress"></span></span></td></tr><tr><!----><td ng-show="context.bandwidthType !== undefined"><label class="bk-font-weight-bold">{{\'ECS_BANDWIDTH_TYPE\' | translate}}</label><span ng-bind="context.bandwidthType|translate"></span></td><!----><td ng-show="context.baseBandWidth !== undefined && context.bandwidthType !== undefined && context.bandwidthType == \'ECS_VIA_FIXED_BANDWIDTH\' && !context.eipAddress"><label><span class="bk-font-weight-bold">{{\'ECS_BASIC_BANDWIDTH\'|translate}}</span></label><span ng-bind="context.baseBandWidth | aliyunBuyEcsShowComponent:\'bandwidth\'"></span></td><!----><td ng-show="context.bandwidthType !== undefined"><label class="bk-font-weight-bold">{{\'ECS_CURRENT_USED_BANDWIDTH\'|translate}} <span ng-if="context.bandwidthByFlow">{{\'ECS_PEAK\'|translate}}</span></label><span ng-bind="context.bandwidth | aliyunBuyEcsShowComponent:\'bandwidth\'"></span></td></tr><tr><td><label class="bk-font-weight-bold">{{\'ECS_SYSDISK\'|translate}}</label><span>{{context.systemdiskSize}}GB {{context.systemdiskCategoryName}}</span></td><td colspan="2"><label class="bk-font-weight-bold">{{\'ECS_OS\'|translate}}</label><span ng-bind="context.os|translate"></span></td></tr><tr><td colspan="8"><label class="bk-font-weight-bold">{{\'ECS_DATADISK\'|translate}}</label><span ng-if="context.datadisk.length === 0">{{\'ecs.buy.label.none\'|translate}}</span> <span ng-if="context.datadisk.length > 0" ng-repeat="disk in context.datadisk track by $index">{{disk}}&nbsp;</span></td></tr></tbody></table></div><div class="bk-info-row" ng-show="context.imageProduct && context.imageStatus == \'ONSALE\'"><table class="bk-mt5"><tbody><tr><td><label class="bk-font-weight-bold">{{\'ECS_IMAGE_SUPPLIER_NAME\'| translate}}</label><span ng-bind="context.supplierName"></span></td></tr><tr><td><label class="bk-font-weight-bold">{{\'ECS_IMAGE_NAME\'| translate}}</label><span>{{context.displayName}}</span></td><td><label class="bk-font-weight-bold">{{\'ECS_IMAGE_VERSION\'|translate}}</label><span>{{context.version}}</span></td></tr></tbody></table></div><div class="bk-info-row" ng-show="context.imageProduct && context.imageStatus == \'OFFSALE\'"><table class="bk-mt5"><tbody><tr><td><label class="bk-font-weight-bold">{{\'ECS_BUSINESS_IMAGE\'|translate}}</label><span>{{\'ECS_IMAGE_OFFSALE_RENEW_TIP\'|translate}}</span></td></tr></tbody></table></div><div class="bk-order-time-row" ng-show="context.expiration"><span>{{\'ECS_EXPIRATION_TIME\'|translate}}</span><span class="bk-order-time-color" ng-bind="context.expiration"></span></div></div></div>'),e.put("scripts/ecsbuy/console/partials/instanceDetailV2.html",'<div class="bk-scope"><div class="bk-order-info"><div class="bk-order-renew-title">{{\'ECS_INSTANCE_INFO\' | translate}}</div><div class="bk-info-name bk-mt3"><span class="bk-font-weight-bold">{{\'ECS_INSTANCE_NAME\' | translate}}</span><span ng-bind="context.instanceName"></span></div><div class="bk-info-row"><table><tbody><tr><td ng-show="context.instanceId"><label class="bk-font-weight-bold">{{\'ECS_INSTANCE_ID\' | translate}}</label><span ng-bind="context.instanceId"></span></td><td><label class="bk-font-weight-bold">{{\'ECS_REGION\' | translate}}</label><span ng-bind="context.region | translate"></span><span ng-show="context.zoneName">{{context.zoneName}}</span></td><td><label class="bk-font-weight-bold">{{\'ECS_CHARGE_TYPE\'|translate}}</label><span>{{context.instanceChargeTypeText |translate}}</span></td></tr><tr><td><label class="bk-font-weight-bold">{{\'ECS_INSTANCE_TYPE\'|translate}}</label><span>{{context.instanceTypeText}}{{context.instanceTypeFamily}}{{context.instanceTypeValue}}</span></td><td></td><td><label class="bk-font-weight-bold">{{\'ECS_IO_OPTIMIZED\'|translate}}</label><span>{{context.iooptimized}}</span></td></tr><tr><!----><td><label class="bk-font-weight-bold">{{\'ECS_NETWORK_TYPE\' | translate}}</label><span ng-bind="context.networkType|translate"></span></td><!-- vswitches --><td ng-show="context.vSwitcheId" class="breakall"><label class="bk-font-weight-bold">{{\'ecs.buy.label.vSwitch\'|translate}}</label><span aliyun-truncate-text source-text="{{(context.vSwitcheId == context.vSwitcheName || !context.vSwitcheName) ? context.vSwitcheId : (context.vSwitcheName + \' / \' + context.vSwitcheId)}}" text-length="27" copy-text="true"></span></td><!----><td ng-show="context.securityGroupId" class="breakall"><label class="bk-font-weight-bold">{{\'ecs.buy.label.securityGroup\'|translate}}</label><span aliyun-truncate-text source-text="{{(context.securityGroupId == context.securityGroupName || !context.securityGroupName) ? context.securityGroupId : (context.securityGroupName + \' / \' + context.securityGroupId)}}" text-length="27" copy-text="true"></span></td><td ng-if="context.privateIp"><span><label class="bk-font-weight-bold">{{\'ECS_LAN_IP\'|translate}}</label><span ng-bind="context.privateIp"></span></span></td><td ng-if="context.publicIp"><span><label class="bk-font-weight-bold">{{\'ECS_WAN_IP\'|translate}}</label><span ng-bind="context.publicIp"></span></span></td><td ng-if="context.eipAddress"><span><label class="bk-font-weight-bold">{{\'ECS_EIP_ADDRESS\'|translate}}</label><span ng-bind="context.eipAddress"></span></span></td></tr><tr><!----><td ng-show="context.bandwidthType !== undefined"><label class="bk-font-weight-bold">{{\'ECS_BANDWIDTH_TYPE\' | translate}}</label><span ng-bind="context.bandwidthType|translate"></span></td><!----><td ng-show="context.baseBandWidth !== undefined && context.bandwidthType !== undefined && context.bandwidthType == \'ECS_VIA_FIXED_BANDWIDTH\' && !context.eipAddress"><label><span class="bk-font-weight-bold">{{\'ECS_BASIC_BANDWIDTH\'|translate}}</span></label><span ng-bind="context.baseBandWidth | aliyunBuyEcsShowComponent:\'bandwidth\'"></span></td><!----><td ng-show="context.bandwidthType !== undefined"><label class="bk-font-weight-bold">{{\'ECS_CURRENT_USED_BANDWIDTH\'|translate}} <span ng-if="context.bandwidthByFlow">{{\'ECS_PEAK\'|translate}}</span></label><span ng-bind="context.bandwidth | aliyunBuyEcsShowComponent:\'bandwidth\'"></span></td></tr><tr><td><label class="bk-font-weight-bold">{{\'ECS_SYSDISK\'|translate}}</label><span>{{context.systemdiskSize}}GB {{context.systemdiskCategoryName}}</span></td><td colspan="2"><label class="bk-font-weight-bold">{{\'ECS_OS\'|translate}}</label><span ng-bind="context.os|translate"></span></td></tr><tr><td colspan="8"><label class="bk-font-weight-bold">{{\'ECS_DATADISK\'|translate}}</label><span ng-if="context.datadisk.length === 0">{{\'ecs.buy.label.none\'|translate}}</span> <span ng-if="context.datadisk.length > 0" ng-repeat="disk in context.datadisk track by $index">{{disk}}&nbsp;</span></td></tr><tr ng-show="context.spotStrategyText"><td><label class="bk-font-weight-bold">{{\'ECS_SPOT_STRATEGY\'|translate}}</label><span>{{context.spotStrategyText | translate}}</span></td><td colspan="2"><label class="bk-font-weight-bold">{{\'ECS_SPOT_PRICE_LIMIT\'|translate}}</label><span>{{context.spotPriceLimit}}</span></td></tr></tbody></table></div><div class="bk-info-row" ng-show="context.imageProduct && context.imageStatus == \'ONSALE\'"><table class="bk-mt5"><tbody><tr><td><label class="bk-font-weight-bold">{{\'ECS_IMAGE_SUPPLIER_NAME\'| translate}}</label><span ng-bind="context.supplierName"></span></td></tr><tr><td><label class="bk-font-weight-bold">{{\'ECS_IMAGE_NAME\'| translate}}</label><span>{{context.displayName}}</span></td><td><label class="bk-font-weight-bold">{{\'ECS_IMAGE_VERSION\'|translate}}</label><span>{{context.version}}</span></td></tr></tbody></table></div><div class="bk-info-row" ng-show="context.imageProduct && context.imageStatus == \'OFFSALE\'"><table class="bk-mt5"><tbody><tr><td><label class="bk-font-weight-bold">{{\'ECS_BUSINESS_IMAGE\'|translate}}</label><span>{{\'ECS_IMAGE_OFFSALE_RENEW_TIP\'|translate}}</span></td></tr></tbody></table></div><div class="bk-order-time-row" ng-show="context.expiration"><span>{{\'ECS_EXPIRATION_TIME\'|translate}}</span><span class="bk-order-time-color" ng-bind="context.expiration"></span></div></div></div>'),e.put("scripts/ecsbuy/console/partials/recycleBin/createInstance.html",'<div ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div class="bk-theme-generation2 bk-bgcolor-fff"><div class="bk-scope" aliyun-buy-dominator ui-model-id="ecs.buy.recycleBin.createInstance.ui" biz-model-id="ecs.buy.recycleBin.createInstance.biz" framework-setting="frameworkSetting" subtotal-align-style="bottom"></div></div><div class="bk-pr5" data-spm="purchase"><div aliyun-buy-price-view config="priceViewConfig" price-result="priceResult"></div><div style="text-align: right" class="bk-theme-generation2 bk-bgcolor-fff"><div ng-if="priceResult.code && payOrderTip" class="bk-mb3 bk-mt3 bk-color-red"><span ng-bind-html="payOrderTip"></span></div><div aliyun-buy-ecs-order-button></div></div></div><div style="height: 50px;clear: both"></div></div>'),e.put("scripts/ecsbuy/console/partials/recycleBin/instanceDetail.html",'<div class="bk-scope"><div class="bk-order-info"><div class="bk-order-renew-title">{{\'ECS_INSTANCE_INFO\' | translate}}</div><div class="bk-mt4"></div><div class="bk-info-row"><table><tbody><tr><td><label class="bk-font-weight-bold">{{\'ECS_REGION\' | translate}}</label><span ng-bind="context.regionName | translate"></span><span ng-show="context.zoneName">{{context.zoneName}}</span></td><td><label class="bk-font-weight-bold">{{\'ECS_CHARGE_TYPE\'|translate}}</label><span>{{context.instanceChargeTypeText |translate}}</span></td></tr><tr><td><label class="bk-font-weight-bold">{{\'ECS_SYSDISK\'|translate}}</label><span>{{context.systemdiskSize}} GB {{context.systemdiskCategoryName}} <span ng-if="context.systemdiskName"><span aliyun-truncate-text source-text="{{context.systemdiskName}}" text-length="27" copy-text="true"></span></span></span></td></tr><tr><td colspan="8"><label class="bk-font-weight-bold">{{\'ECS_DATADISK\'|translate}}</label><span ng-if="context.datadisk.length === 0">{{\'ecs.buy.label.none\'|translate}}</span> <span ng-if="context.datadisk.length > 0" ng-repeat="disk in context.datadisk track by $index">{{disk.text}} <span ng-if="disk.diskName"><span aliyun-truncate-text source-text="{{disk.diskName}}" text-length="27" copy-text="true"></span></span>&nbsp;</span></td></tr></tbody></table></div></div></div>'),e.put("scripts/ecsbuy/console/partials/release/releasePrePaid.html",'<div ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div class="bk-theme-generation2 bk-bgcolor-fff"><div class="bk-scope" aliyun-buy-dominator ui-model-id="ecs.buy.release.ui" biz-model-id="ecs.buy.release.biz" framework-setting="frameworkSetting" subtotal-align-style="bottom"></div><span aliyun-buy-ecs-data-spm spm-b="ecsRelease"></span></div><div class="bk-pr5"><div aliyun-buy-price-view config="priceViewConfig" price-result="priceResult"></div><div style="text-align: right"><div aliyun-buy-ecs-order-button></div></div></div><div style="height: 50px;clear: both"></div></div>'),e.put("scripts/ecsbuy/console/partials/renew/renew.html",'<div ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div class="bk-theme-generation2 bk-bgcolor-fff"><div class="bk-scope" aliyun-buy-dominator ui-model-id="ecs.buy.renew.ui" biz-model-id="ecs.buy.renew.biz" framework-setting="frameworkSetting" subtotal-align-style="bottom"></div><div aliyun-buy-ecs-coupon-new-wrapper class="bk-layout-2col-main" price="priceForCoupon" value="couponNo"></div><span aliyun-buy-ecs-data-spm spm-b="ecsrenew"></span></div><div class="bk-pr5"><div aliyun-buy-price-view config="priceViewConfig" price-result="priceResult"></div><div style="text-align: right" class="bk-theme-generation2 bk-bgcolor-fff"><div ng-if="priceResult.code && payOrderTip" class="bk-mt3 bk-color-red"><span ng-bind-html="payOrderTip"></span></div><div aliyun-buy-ecs-order-button></div></div></div><div style="height: 50px;clear: both"></div></div>'),e.put("scripts/ecsbuy/console/partials/resizeDisk/batchResizeDisk.html",'<div ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div class="bk-theme-generation2 bk-bgcolor-fff"><div aliyun-buy-ecs-batch-view-new batch-action-model="batchActionModel" batch-ui-model="batchUiModel" price-result="priceResult"></div><div class="bk-pr5"><div class="clearfix"><div aliyun-buy-price-view-light ng-show="priceResult" class="pull-right text-right" data="priceResult" options="priceConfig"></div></div><div style="text-align: right" class="bk-theme-generation2 bk-bgcolor-fff"><div aliyun-buy-ecs-order-button></div></div></div></div></div>'),e.put("scripts/ecsbuy/console/partials/resizeDisk/dialog/batchResizeDiskDialog.html",'<div bindonce><div class="modal-header"><button type="button" class="close" data-dismiss="modal" data-ng-click="close(false)" aria-hidden="true">&times;</button><h3 class="modal-title" ng-bind=" \'ecs.buy.console.batch.resize_disk\' | translate"></h3></div><div class="modal-body clearfix"><div aliyun-buy-ecs-resize-disk-options-v2 disk-id="{{diskId}}" region-id="{{regionId}}"></div></div><div class="modal-footer"><button class="btn btn-primary" data-ng-click="submit(true)" ng-bind=" \'ECS_OK\' | translate"></button> <button class="btn btn-default" data-ng-click="close(false)" ng-bind=" \'ECS_CANCEL\' | translate"></button></div></div>'),e.put("scripts/ecsbuy/console/partials/resizeDisk/resizeDiskOptions.html",'<div ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading"><div class="bk-theme-generation2 bk-bgcolor-fff"><div class="bk-scope" aliyun-buy-dominator ui-model-id="ecs.buy.resizeDisk.options.ui" biz-model-id="ecs.buy.resizeDisk.options.biz" framework-setting="frameworkSetting" subtotal-align-style="bottom"></div><span aliyun-buy-ecs-data-spm spm-b="ecsresizediskoptions"></span></div><div style="height: 20px;clear: both"></div></div>'),e.put("scripts/ecsbuy/console/partials/upgrade/aliyunBuyEcsBandwidthHistory.html",'<div><div class="bk-dialog-head"><span class="bk-dialog-close" data-dismiss="modal" aria-hidden="true" ng-click="$close()"><span class="aliyun-icon-wrong"></span></span><h5 class="bk-dialog-title" ng-bind-html="title"></h5></div><div class="bk-dialog-body" aliyun-buy-preloader="!isReady"><div ng-show="allData.length==0 && loadingWrong"><div style="margin: 50px 0; text-align: center"><div ng-bind-html="loadWrongMsg"></div></div></div><div ng-show="allData.length!=0" aliyun-buy-preloader="isLoading" class="ecs-bandwidth-history-chart"><div aliyun-console-chart-d3 config="options" settings="settings"></div><div style="text-align: center"><span ng-repeat="info in allData" class="bk-ml1"><input id="chart-radio-{{$index}}" type="radio" name="year" ng-click="checkIndex($index)" ng-checked="$index==index"><label for="chart-radio-{{$index}}" class="bk-ml1">{{info.year}}</label></span></div></div></div></div>'),e.put("scripts/ecsbuy/console/partials/upgrade/upgrade.html",'<div ng-class="{\'loading-dominator\': isLoading}" aliyun-buy-preloader="isLoading" data-spm="upgrade" class="buy-upgrade-wrapper"><div class="bk-theme-generation2 bk-bgcolor-fff"><div class="bk-scope" aliyun-buy-dominator ui-model-id="ecs.buy.upgrade.ui" biz-model-id="ecs.buy.upgrade.biz" framework-setting="frameworkSetting" subtotal-align-style="bottom"></div><div aliyun-buy-ecs-coupon-new-wrapper class="bk-layout-2col-main" price="priceForCoupon" value="couponNo"></div></div><div class="bk-pr5" data-spm="purchase"><div aliyun-buy-price-view config="priceViewConfig" price-result="priceResult"></div><div style="text-align: right" class="bk-theme-generation2 bk-bgcolor-fff"><div aliyun-buy-ecs-order-button></div></div></div><div style="height: 50px;clear: both"></div></div>')}])}),define("ecsbuy/console/app",["angular","buy-dominator","../i18nConfig","./index","angular-cookies","angular-animate","angular-growl","angular-ui-validate","angular-sanitize","angular-translate","aliyun-ecsbuy-tpl","common-tpl","aliyun-console-bootstrap-tpl","./console-tpl","bindonce","common/modelSystem/modelSystemCore","common/modelSystem/lazyModule","common/directives/viewFramework","common/directives/aliyunCommonDirectives","common/services/topicService","common/helper/objectHelper","common/helper/arrayHelper"],function(e){"use strict";return e.module("ecsbuyConsole",["aliyun.buy.dominator","aliyunCommonServices","aliyunConsoleModelSystem","modelsystem.directives","aliyun.console.viewFramework","aliyun.console.ecsbuy.base.tpl","aliyun.console.ecsbuy.console.tpl","aliyun.console.common.tpl","aliyun.console.bootstrap.tpl","aliyunBuyEcsServices","ecsbuyDirectives","ecsbuyFilters","ecsbuyConsoleDirectives","ecsbuyConsoleFilters","ngCookies"])});